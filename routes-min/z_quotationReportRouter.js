const _0x15c987=_0x37a5;(function(_0x34888f,_0x303f25){const _0x53cd0b=_0x37a5,_0x4570d3=_0x34888f();while(!![]){try{const _0x591f01=parseInt(_0x53cd0b(0x1f7))/0x1+-parseInt(_0x53cd0b(0x297))/0x2*(-parseInt(_0x53cd0b(0x18a))/0x3)+parseInt(_0x53cd0b(0x1dd))/0x4+-parseInt(_0x53cd0b(0x213))/0x5+parseInt(_0x53cd0b(0x1d4))/0x6*(-parseInt(_0x53cd0b(0x25c))/0x7)+-parseInt(_0x53cd0b(0x20d))/0x8+-parseInt(_0x53cd0b(0x229))/0x9*(-parseInt(_0x53cd0b(0x28f))/0xa);if(_0x591f01===_0x303f25)break;else _0x4570d3['push'](_0x4570d3['shift']());}catch(_0x3f58d2){_0x4570d3['push'](_0x4570d3['shift']());}}}(_0x28a0,0x2fb98));const _0x933d56=(function(){const _0x2d4264=_0x37a5,_0x28472e={'omOvL':function(_0x32c9b6,_0x521763){return _0x32c9b6+_0x521763;},'lgxbm':_0x2d4264(0x1d5),'GyJSu':_0x2d4264(0x18c),'FNXls':_0x2d4264(0x2ae),'pNhSj':_0x2d4264(0x1b4),'TuvhN':_0x2d4264(0x1c3),'uhqus':function(_0x1dd12a,_0x272d42){return _0x1dd12a(_0x272d42);},'jqEAy':_0x2d4264(0x21e),'aVbQz':'chain','lwHjb':_0x2d4264(0x180),'Owkoc':function(_0x5e7098){return _0x5e7098();},'MKWwJ':function(_0x15bb30,_0x5cafb4,_0x107703){return _0x15bb30(_0x5cafb4,_0x107703);},'TDbAA':function(_0x3dc0e7,_0x4d9f2d){return _0x3dc0e7===_0x4d9f2d;},'txmuR':_0x2d4264(0x1d8),'iLlMz':_0x2d4264(0x1fd),'jgVBu':function(_0x3e3fb0,_0x4feda6){return _0x3e3fb0!==_0x4feda6;},'plAVK':'EdCvg','lnVdf':'khYqG','BYFod':function(_0x57bb56,_0x150005){return _0x57bb56===_0x150005;},'VuoZu':_0x2d4264(0x179),'BkfEM':'jRMmd'};let _0x2801a7=!![];return function(_0x2e6660,_0x41bfc6){const _0x49b392=_0x2d4264,_0xfe78c4={'hPpbq':_0x28472e['pNhSj'],'goSIN':_0x28472e[_0x49b392(0x20c)],'AlQyj':function(_0x47af9b,_0x201159){const _0x28ac65=_0x49b392;return _0x28472e[_0x28ac65(0x24a)](_0x47af9b,_0x201159);},'QPmtQ':_0x28472e[_0x49b392(0x1f2)],'LuPQO':function(_0x14d4a5,_0x1cc784){const _0xae64e=_0x49b392;return _0x28472e[_0xae64e(0x1d2)](_0x14d4a5,_0x1cc784);},'DNTIP':_0x28472e[_0x49b392(0x1e6)],'CuRiR':_0x28472e[_0x49b392(0x23d)],'pMKkz':function(_0x1aa708){const _0x3e9e46=_0x49b392;return _0x28472e[_0x3e9e46(0x2a5)](_0x1aa708);},'sWcgZ':function(_0x5bb27f,_0xec3f6,_0x38a111){return _0x28472e['MKWwJ'](_0x5bb27f,_0xec3f6,_0x38a111);},'IpwrS':function(_0x1c17d2,_0x410b55){const _0x252f19=_0x49b392;return _0x28472e[_0x252f19(0x1c4)](_0x1c17d2,_0x410b55);},'BfzSm':_0x28472e[_0x49b392(0x252)],'MKpWx':_0x28472e['iLlMz'],'tjUvQ':function(_0x372ccf,_0x328b9e){return _0x28472e['jgVBu'](_0x372ccf,_0x328b9e);},'YkwXV':_0x28472e[_0x49b392(0x29b)],'aiHqo':_0x28472e[_0x49b392(0x287)]};if(_0x28472e[_0x49b392(0x2a2)](_0x28472e['VuoZu'],_0x28472e['BkfEM']))(function(){return![];}[_0x49b392(0x1a5)](_0x28472e[_0x49b392(0x1d2)](_0x28472e[_0x49b392(0x293)],_0x28472e[_0x49b392(0x2ab)]))[_0x49b392(0x205)](_0x28472e[_0x49b392(0x255)]));else{const _0x230944=_0x2801a7?function(){const _0x896621=_0x49b392,_0x2f7eb7={'McvIr':_0xfe78c4['hPpbq'],'IKSTx':_0xfe78c4[_0x896621(0x22e)],'wLtjo':function(_0xf6a14b,_0x3a6cd5){const _0x4f6c30=_0x896621;return _0xfe78c4[_0x4f6c30(0x1e8)](_0xf6a14b,_0x3a6cd5);},'XzIqO':_0xfe78c4['QPmtQ'],'UbrKQ':function(_0x1963e5,_0x39c4e5){const _0x444a3e=_0x896621;return _0xfe78c4[_0x444a3e(0x223)](_0x1963e5,_0x39c4e5);},'sfAVE':_0xfe78c4['DNTIP'],'ZWrTT':function(_0x254742,_0x493c80){const _0x484b85=_0x896621;return _0xfe78c4[_0x484b85(0x223)](_0x254742,_0x493c80);},'SUGvn':_0xfe78c4[_0x896621(0x19e)],'TNZpt':function(_0x18acf6,_0x115771){const _0x33f858=_0x896621;return _0xfe78c4[_0x33f858(0x1e8)](_0x18acf6,_0x115771);},'qylMu':function(_0x5854f9){const _0x5e59a8=_0x896621;return _0xfe78c4[_0x5e59a8(0x1ff)](_0x5854f9);},'eTxPC':function(_0x5bbd8c,_0x2a1dee,_0x4e9861){const _0x46f70e=_0x896621;return _0xfe78c4[_0x46f70e(0x1ca)](_0x5bbd8c,_0x2a1dee,_0x4e9861);}};if(_0xfe78c4[_0x896621(0x204)](_0xfe78c4[_0x896621(0x279)],_0xfe78c4['MKpWx'])){const _0xdec986={'bXLSw':_0x2f7eb7[_0x896621(0x1f6)],'IyEIY':_0x2f7eb7['IKSTx'],'BGNiu':function(_0x408cb8,_0x15450c){const _0x5cd9af=_0x896621;return _0x2f7eb7[_0x5cd9af(0x29c)](_0x408cb8,_0x15450c);},'QWvTA':_0x2f7eb7[_0x896621(0x195)],'tzPiG':function(_0x29b4b2,_0x18274e){return _0x2f7eb7['UbrKQ'](_0x29b4b2,_0x18274e);},'ihNTY':_0x2f7eb7['sfAVE'],'OwEwe':function(_0x28781e,_0x1d6c2b){return _0x2f7eb7['ZWrTT'](_0x28781e,_0x1d6c2b);},'WDgNg':_0x2f7eb7[_0x896621(0x17a)],'lSuww':function(_0x39eeca,_0x28c79c){const _0x10140b=_0x896621;return _0x2f7eb7[_0x10140b(0x1ef)](_0x39eeca,_0x28c79c);},'UfJoK':function(_0x312c0b){const _0x19c42d=_0x896621;return _0x2f7eb7[_0x19c42d(0x184)](_0x312c0b);}};_0x2f7eb7['eTxPC'](_0x1a1ece,this,function(){const _0x141e9c=_0x896621,_0x5612d4=new _0x25ff6c(_0xdec986[_0x141e9c(0x16f)]),_0x5580ea=new _0x58bebd(_0xdec986[_0x141e9c(0x1be)],'i'),_0x4b5857=_0xdec986[_0x141e9c(0x298)](_0x32483f,_0xdec986[_0x141e9c(0x19a)]);!_0x5612d4['test'](_0xdec986[_0x141e9c(0x280)](_0x4b5857,_0xdec986[_0x141e9c(0x275)]))||!_0x5580ea[_0x141e9c(0x1bf)](_0xdec986[_0x141e9c(0x18b)](_0x4b5857,_0xdec986['WDgNg']))?_0xdec986[_0x141e9c(0x288)](_0x4b5857,'0'):_0xdec986[_0x141e9c(0x1fb)](_0x50f75b);})();}else{if(_0x41bfc6){if(_0xfe78c4[_0x896621(0x224)](_0xfe78c4[_0x896621(0x212)],_0xfe78c4[_0x896621(0x1c7)])){const _0x306c4e=_0x41bfc6[_0x896621(0x205)](_0x2e6660,arguments);return _0x41bfc6=null,_0x306c4e;}else{const _0x48f83a=_0x5b38da[_0x896621(0x18e)][_0x896621(0x207)](_0x446ad8=>_0x446ad8[_0x896621(0x18f)]==_0x86ad68);return _0x3d9a2e[_0x896621(0x18e)]=_0x48f83a,_0x3e377b;}}}}:function(){};return _0x2801a7=![],_0x230944;}};}());(function(){const _0x54eb6e=_0x37a5,_0x11cac3={'pCYws':function(_0x10a396,_0x57487e){return _0x10a396>_0x57487e;},'lrgAU':function(_0x5b7e77,_0x57f435){return _0x5b7e77===_0x57f435;},'tsoPf':'Aouxu','VLxnA':_0x54eb6e(0x26b),'IUPOF':'function\x20*\x5c(\x20*\x5c)','IYAzN':_0x54eb6e(0x1c3),'xApHJ':function(_0x3275c3,_0x823dc7){return _0x3275c3(_0x823dc7);},'bcIBC':'init','IrfOL':function(_0x29b736,_0x377102){return _0x29b736+_0x377102;},'OqmLm':'chain','rUrCo':_0x54eb6e(0x180),'mkpPj':function(_0x16fb68,_0xaf1433){return _0x16fb68!==_0xaf1433;},'koQsp':_0x54eb6e(0x21c),'jnfae':function(_0x25c233,_0x25d1e1){return _0x25c233(_0x25d1e1);},'ybfOa':_0x54eb6e(0x1a7),'dsEmP':function(_0x2a7379){return _0x2a7379();},'uvKzo':function(_0x2a06a4,_0x4b8b34,_0x2f0afc){return _0x2a06a4(_0x4b8b34,_0x2f0afc);}};_0x11cac3[_0x54eb6e(0x1bd)](_0x933d56,this,function(){const _0x2b4871=_0x54eb6e,_0xdf51d9={'kxrqz':function(_0x48aff6,_0x167c98){const _0x1025e8=_0x37a5;return _0x11cac3[_0x1025e8(0x1e0)](_0x48aff6,_0x167c98);}};if(_0x11cac3[_0x2b4871(0x1a4)](_0x11cac3[_0x2b4871(0x1a2)],_0x11cac3[_0x2b4871(0x26a)])){const _0x3e3335=_0x51c41f?function(){const _0x184ee3=_0x2b4871;if(_0x54e4eb){const _0x165c3f=_0x3641ae[_0x184ee3(0x205)](_0x4eedc7,arguments);return _0x3e9f97=null,_0x165c3f;}}:function(){};return _0x3f7892=![],_0x3e3335;}else{const _0x5275f7=new RegExp(_0x11cac3[_0x2b4871(0x176)]),_0x419850=new RegExp(_0x11cac3['IYAzN'],'i'),_0x314351=_0x11cac3[_0x2b4871(0x1ae)](_0x480ab7,_0x11cac3[_0x2b4871(0x299)]);if(!_0x5275f7[_0x2b4871(0x1bf)](_0x11cac3[_0x2b4871(0x17e)](_0x314351,_0x11cac3[_0x2b4871(0x1b8)]))||!_0x419850[_0x2b4871(0x1bf)](_0x11cac3[_0x2b4871(0x17e)](_0x314351,_0x11cac3['rUrCo'])))_0x11cac3[_0x2b4871(0x24c)](_0x11cac3['koQsp'],_0x11cac3['koQsp'])?_0x3983ee['close']():_0x11cac3[_0x2b4871(0x1f9)](_0x314351,'0');else{if(_0x11cac3[_0x2b4871(0x1a4)](_0x11cac3[_0x2b4871(0x21d)],_0x11cac3[_0x2b4871(0x21d)]))_0x11cac3[_0x2b4871(0x215)](_0x480ab7);else{const _0x2f9ab6=_0x598d53[_0x2b4871(0x22b)],_0x50118f=_0x55c358[_0x2b4871(0x207)](_0xc366a2=>_0xc366a2[_0x2b4871(0x22b)]==_0x2f9ab6);_0xdf51d9[_0x2b4871(0x1a3)](_0x50118f[_0x2b4871(0x257)],0x0)?_0x28d5d9[_0x2b4871(0x18e)]=_0x50118f[0x0]['tableRows'][_0x2b4871(0x207)](_0x24a596=>_0x24a596[_0x2b4871(0x18f)]==_0x24c250[_0x2b4871(0x18f)]):_0x3b8965['tableRows']=[];}}}})();}());const _0x4061f2=(function(){const _0x1253aa=_0x37a5,_0x234c65={'JGEAq':_0x1253aa(0x292),'umDXF':function(_0x3d574c,_0x27e3d8){return _0x3d574c===_0x27e3d8;},'eEGPw':_0x1253aa(0x202),'rLVQc':_0x1253aa(0x1d9),'YOIJY':function(_0x5bcadc,_0x1f94ea){return _0x5bcadc!==_0x1f94ea;},'vKFOJ':'CdWEk'};let _0x2cd923=!![];return function(_0x50c77d,_0x33922d){const _0x2222ef=_0x1253aa,_0x2df59e={'PqMWk':_0x234c65[_0x2222ef(0x261)],'UrAzH':function(_0x284627,_0x54689e){const _0x52c283=_0x2222ef;return _0x234c65[_0x52c283(0x1c8)](_0x284627,_0x54689e);},'lTJuh':_0x234c65[_0x2222ef(0x1e2)],'dqSEc':function(_0x2613a1,_0x537b88){const _0x5c96b4=_0x2222ef;return _0x234c65[_0x5c96b4(0x1c8)](_0x2613a1,_0x537b88);},'WiaEw':_0x234c65[_0x2222ef(0x2a6)]};if(_0x234c65['YOIJY'](_0x234c65[_0x2222ef(0x284)],_0x234c65[_0x2222ef(0x284)]))_0x4e869d[_0x2222ef(0x1b1)]();else{const _0x2ebe6f=_0x2cd923?function(){const _0x204287=_0x2222ef;if(_0x2df59e[_0x204287(0x1ec)](_0x2df59e['lTJuh'],_0x2df59e['lTJuh'])){if(_0x33922d){if(_0x2df59e['dqSEc'](_0x2df59e['WiaEw'],_0x2df59e[_0x204287(0x1f5)])){const _0x1504cf=_0x33922d[_0x204287(0x205)](_0x50c77d,arguments);return _0x33922d=null,_0x1504cf;}else return!![];}}else _0x22d622[_0x204287(0x2b3)](_0x35767d[_0x204287(0x28d)]),_0x137d44['send'](_0x3cae46[_0x204287(0x222)]({'isLoad':!0x1,'class':_0x2df59e[_0x204287(0x1e9)],'title':_0x2ab79f,'selectMonth':_0xa405c0,'msg':_0x3b62c1[_0x204287(0x28d)]}));}:function(){};return _0x2cd923=![],_0x2ebe6f;}};}()),_0x1158b3=_0x4061f2(this,function(){const _0x16a79b=_0x37a5,_0x1b3c47={'UMyvf':function(_0xf2b0f5,_0x9119f9){return _0xf2b0f5(_0x9119f9);},'hUohJ':function(_0x2f5002){return _0x2f5002();},'Xwcjx':function(_0x1c0d0b,_0x4cc416){return _0x1c0d0b===_0x4cc416;},'QLujn':_0x16a79b(0x20e),'djDpo':_0x16a79b(0x251),'GeZsf':function(_0x5768ab,_0x1c2a61){return _0x5768ab+_0x1c2a61;},'UlXRS':_0x16a79b(0x27a),'kGpcr':_0x16a79b(0x21a),'hFsdC':function(_0x392b0f,_0x53b9a4){return _0x392b0f!==_0x53b9a4;},'jwKTn':_0x16a79b(0x1b9),'TKyBM':_0x16a79b(0x2b3),'exsQG':_0x16a79b(0x277),'eBNgZ':_0x16a79b(0x17f),'KqVlk':_0x16a79b(0x1c0),'DHUkn':'exception','pDcyL':'table','PHRHA':_0x16a79b(0x192),'rXdmO':function(_0x3fbfb4,_0x653d87){return _0x3fbfb4<_0x653d87;},'QkNQI':_0x16a79b(0x175),'dPVIE':_0x16a79b(0x225)};let _0xc22ba4;try{if(_0x1b3c47['Xwcjx'](_0x1b3c47[_0x16a79b(0x197)],_0x1b3c47[_0x16a79b(0x2b2)]))_0x1b3c47[_0x16a79b(0x20b)](_0x359076,0x0);else{const _0x59b368=_0x1b3c47[_0x16a79b(0x20b)](Function,_0x1b3c47[_0x16a79b(0x23b)](_0x1b3c47['GeZsf'](_0x1b3c47['UlXRS'],_0x1b3c47['kGpcr']),');'));_0xc22ba4=_0x1b3c47[_0x16a79b(0x26e)](_0x59b368);}}catch(_0x4fe35c){_0x1b3c47[_0x16a79b(0x238)](_0x1b3c47[_0x16a79b(0x1f4)],_0x1b3c47[_0x16a79b(0x1f4)])?_0x1b3c47[_0x16a79b(0x26e)](_0x59e0b2):_0xc22ba4=window;}const _0x573fa5=_0xc22ba4[_0x16a79b(0x1ad)]=_0xc22ba4[_0x16a79b(0x1ad)]||{},_0x4c0dc3=[_0x1b3c47[_0x16a79b(0x190)],_0x1b3c47[_0x16a79b(0x1e7)],_0x1b3c47[_0x16a79b(0x281)],_0x1b3c47['KqVlk'],_0x1b3c47[_0x16a79b(0x273)],_0x1b3c47['pDcyL'],_0x1b3c47['PHRHA']];for(let _0x73457b=0x0;_0x1b3c47[_0x16a79b(0x183)](_0x73457b,_0x4c0dc3[_0x16a79b(0x257)]);_0x73457b++){if(_0x1b3c47[_0x16a79b(0x27c)](_0x1b3c47['QkNQI'],_0x1b3c47['dPVIE'])){const _0x415c0c=_0x40c366[_0x16a79b(0x205)](_0x56f951,arguments);return _0x7cc8ac=null,_0x415c0c;}else{const _0x4cbf38=_0x4061f2[_0x16a79b(0x1a5)][_0x16a79b(0x217)][_0x16a79b(0x1b6)](_0x4061f2),_0x2692eb=_0x4c0dc3[_0x73457b],_0xe518a0=_0x573fa5[_0x2692eb]||_0x4cbf38;_0x4cbf38[_0x16a79b(0x2b6)]=_0x4061f2[_0x16a79b(0x1b6)](_0x4061f2),_0x4cbf38[_0x16a79b(0x269)]=_0xe518a0[_0x16a79b(0x269)][_0x16a79b(0x1b6)](_0xe518a0),_0x573fa5[_0x2692eb]=_0x4cbf38;}}});function _0x37a5(_0x41528e,_0x3cfb93){const _0x323884=_0x28a0();return _0x37a5=function(_0x1158b3,_0x4061f2){_0x1158b3=_0x1158b3-0x16d;let _0x2cca9c=_0x323884[_0x1158b3];return _0x2cca9c;},_0x37a5(_0x41528e,_0x3cfb93);}_0x1158b3();import _0x5941e6 from'express';const _=_0x5941e6[_0x15c987(0x1b5)]();import{MongoClient as _0x45e6bf}from'mongodb';import _0x16cede from'ejs';import _0x529ab4 from'path';import _0x197083 from'fs';import*as _0x441187 from'../mymodule/myDateTime.js';import*as _0x4aab9b from'../mymodule/myUsers.js';import*as _0x50fd5d from'../mymodule/myModule.js';import*as _0x106b64 from'../mymodule/myDocs.js';function _0x28a0(){const _0x16fdd8=['lhnKW','docsReport','tqotH','hUohJ','QgGZs','TQtGv','VlSKf','BTvkn','DHUkn','RceMQ','ihNTY','TyoNB','warn','bpRJk','BfzSm','return\x20(function()\x20','quotation_report.ejs','Xwcjx','jYjoD','PAGE_REPORT_QUOTATION','Unknown','tzPiG','eBNgZ','Ubcsp','YVBZK','vKFOJ','tojkx','OrLWQ','lnVdf','lSuww','join','CAsMX','getSettings','status','message','green','30IYFzbT','mUUtG','itemsReport','red','lgxbm','toArray','LCNPk','DWhzd','52AnWlSk','BGNiu','bcIBC','getCollName_by_DocTitle','plAVK','wLtjo','originalUrl','pqYvs','exception','split','JSjpD','BYFod','while\x20(true)\x20{}','โหลดข้อมูลเรียบร้อยแล้ว','Owkoc','rLVQc','RgJRl','getSessionData','lFWzD','ไม่พบชื่อคอเล็กชั่น','GyJSu','call','IUIXh','stateObject','reportItems.ejs','FMpGO','connect','djDpo','log','mHTBI','fc-dodgerblue','__proto__','fc-orange','qPTLb','pCYAy','bXLSw','DmyeQ','FuHkk','reportDoc.ejs','TUKLt','BdPyY','pgMTA','IUPOF','bVuFQ','AKtXP','Nokqy','SUGvn','kKhPi','jFeOM','muBey','IrfOL','info','input','TQVII','tCIcT','rXdmO','qylMu',',\x20(','dFarG','vUvBW','readFileSync','OMKdD','40647ZgiBXs','OwEwe','gger','hScme','tableRows','itemId','TKyBM','YLQNC','trace','isAuth','/calendar','XzIqO','vQFNG','QLujn','$customerId','------------------','QWvTA','cJZSR','$_id','string','CuRiR','TAzRf','MahNz','nYiXE','tsoPf','kxrqz','lrgAU','constructor','wAGEb','XzwsD','xgfbq','WLSkc','bFzZq','rMKcK','kqTPy','console','xApHJ','zhuNq','hWBvF','close','nWDce','TMUAS','function\x20*\x5c(\x20*\x5c)','Router','bind','JPylG','OqmLm','QgyMP','Ucecw','/report/invoice','CwrcU','uvKzo','IyEIY','test','error','HZate','UQUpU','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','TDbAA','Vskxe','req.body\x20===>\x20','aiHqo','umDXF','/report','sWcgZ','table','สร้าง','forEach','MONTH_NAMES','BZTVA','KnpGq','wICWQ','omOvL','-----------------','906IDFoXn','debu','iblJI','wIEdX','AMRIW','xHMgL','MmgIq','counter','dbUrl','103968uVFYVa','zKpXw','docs','pCYws','utf8','eEGPw','bvUsB','LadvE','dbColl_quotation','aVbQz','exsQG','AlQyj','PqMWk','VdbDC','tcAfL','UrAzH','koYDb','render','TNZpt','$docDate','ihdow','jqEAy','lexGk','jwKTn','WiaEw','McvIr','191712xLnDXv','getItems_for_report','jnfae','xKZBz','UfJoK','CYuFa','FAOuD','YiavF','pMKkz','Krugm','gGYbw','QHbhj','XJfJC','IpwrS','apply','aubZR','filter','SbdwI','kfzBB','HLkZH','UMyvf','TuvhN','1542104gDxeHv','ZJipC','xMIJC','getDocs_Conclude','collection','YkwXV','107850IieCTr','sendFile','dsEmP','tzdAJ','prototype','yeSZI','flash','{}.constructor(\x22return\x20this\x22)(\x20)','renderView','Lehpl','ybfOa','init','msg','eMNHQ','send','stringify','LuPQO','tjUvQ','tvUwd','Yrdxk','cMRFO','eOjGN','35019WOkHCw','fc-green','docId','uDyHD','/report/bill','goSIN','YNXGp','ZtSKF','dbName','NqeLo','rIdNz','hvdxG','FkjPz','$proposerId','PbdDa','hFsdC','dlFry','$tableRows','GeZsf','jJEyS','lwHjb','action','gbZbX','KiCap','unshift','exloU','MJpbM','hAgRP','map','FsNdh','Oucbb','sort','UZNbY','uhqus','fc-red','mkpPj','body','iUMZI','aggregate','WQajo','mgPiY','txmuR','post','formatDate','FNXls','$proposerFullname','length','ยกเลิก','$docStatusNumber','/report/receipt','$tableRows.itemId','7966FeheNV','EImsR','chain','PTQAP','qxKFe','JGEAq','OkmJz','pFBtG','LvAfT','uDCip','fvsrw','mHCUL','yWcKI','toString','VLxnA'];_0x28a0=function(){return _0x16fdd8;};return _0x28a0();}import _0x2d93e8 from'../middleware/mainAuth.js';const O='/report/quotation',U=_0x15c987(0x1bb),C=_0x15c987(0x25a),E=_0x15c987(0x22d),W=[O,U,C,E],z=[U+_0x15c987(0x194),O+_0x15c987(0x194),C+_0x15c987(0x194),E+'/calendar'],K=[U+'/report',O+_0x15c987(0x1c9),C+_0x15c987(0x1c9),E+_0x15c987(0x1c9)],F={'docStatus':{'$switch':{'branches':[{'case':{'$eq':[_0x15c987(0x259),0x1]},'then':_0x15c987(0x1cc)},{'case':{'$eq':[_0x15c987(0x259),0x2]},'then':'จบ'},{'case':{'$eq':[_0x15c987(0x259),0xa]},'then':_0x15c987(0x258)}],'default':_0x15c987(0x27f)}},'docStatusColor':{'$switch':{'branches':[{'case':{'$eq':[_0x15c987(0x259),0x1]},'then':_0x15c987(0x2b5)},{'case':{'$eq':['$docStatusNumber',0x2]},'then':_0x15c987(0x22a)},{'case':{'$eq':[_0x15c987(0x259),0xa]},'then':_0x15c987(0x2b7)}],'default':_0x15c987(0x24b)}}},P=global[_0x15c987(0x1e5)],X=global[_0x15c987(0x27e)],Y=_0x15c987(0x27b);_['get'](W,_0x2d93e8['isAuth'],async(_0x2747db,_0x2955fe)=>{const _0xf27e58=_0x15c987,_0x4587af={'KnpGq':_0xf27e58(0x2a3),'CAsMX':'counter','Krugm':function(_0x585436,_0x1487b9){return _0x585436!==_0x1487b9;},'RgJRl':_0xf27e58(0x22c),'ADWNy':_0xf27e58(0x1a0),'FuHkk':_0xf27e58(0x21f),'cJZSR':'userFlash','EGmpq':function(_0x5a7cf6,_0x50a278){return _0x5a7cf6!==_0x50a278;},'yWcKI':'eqspi','pFBtG':'MpgPq'};console[_0xf27e58(0x2b3)](_0xf27e58(0x1d3)+_0x2747db[_0xf27e58(0x29d)]+_0xf27e58(0x199));const _0x469e9c=_0x2747db[_0xf27e58(0x29d)],_0x51899b=_0x469e9c+_0xf27e58(0x1c9),_0x5558b4=_0x469e9c+'/calendar';try{if(_0x4587af[_0xf27e58(0x200)](_0x4587af[_0xf27e58(0x2a7)],_0x4587af['ADWNy'])){const _0x2eca1b=await _0x106b64['getUsers_for_report'](),_0x494f50=await _0x106b64[_0xf27e58(0x1f8)](),_0x56c9f0=await _0x106b64['getDocs_MonthUnique'](P),_0x6c1275=await _0x106b64[_0xf27e58(0x210)](P),_0x9673e3=await _0x50fd5d[_0xf27e58(0x21b)](Y,_0x2955fe,{'title':X,'time':_0x441187[_0xf27e58(0x254)](new Date()),'msg':_0x2747db[_0xf27e58(0x219)](_0x4587af[_0xf27e58(0x171)]),'userFlash':_0x2747db[_0xf27e58(0x219)](_0x4587af[_0xf27e58(0x19b)]),..._0x4aab9b[_0xf27e58(0x2a8)](_0x2747db),...await _0x50fd5d[_0xf27e58(0x28b)](),'PATH_MAIN':_0x469e9c,'PATH_REPORT':_0x51899b,'PATH_CALENDAR':_0x5558b4,'monthDocs':_0x56c9f0,'dataUsersJson':JSON['stringify'](_0x2eca1b),'dataItemsJson':JSON[_0xf27e58(0x222)](_0x494f50),'dataDocConclude':JSON[_0xf27e58(0x222)](_0x6c1275)});_0x2955fe[_0xf27e58(0x221)](_0x9673e3);}else _0x220d0c[_0xf27e58(0x2b3)](_0xa29fbc),_0x224bb3['status'](0x194)[_0xf27e58(0x214)](_0x3dbd6c);}catch(_0x549cd3){if(_0x4587af['EGmpq'](_0x4587af[_0xf27e58(0x268)],_0x4587af[_0xf27e58(0x263)]))console[_0xf27e58(0x2b3)](_0x549cd3),_0x2955fe[_0xf27e58(0x28c)](0x194)[_0xf27e58(0x214)](file404);else return function(_0xf15767){}['constructor'](efTwYe[_0xf27e58(0x1d0)])[_0xf27e58(0x205)](efTwYe[_0xf27e58(0x28a)]);}}),_[_0x15c987(0x253)](K,_0x2d93e8[_0x15c987(0x193)],async(_0x226c88,_0x4019b4)=>{const _0xb52ed6=_0x15c987,_0x2efcde={'yIdyv':function(_0x45c390,_0x457538){return _0x45c390(_0x457538);},'MPVTY':function(_0x36e053,_0x18c3cb){return _0x36e053>_0x18c3cb;},'LvAfT':function(_0x3b8b3a,_0x3a66d5){return _0x3b8b3a>_0x3a66d5;},'LCNPk':function(_0x41108a,_0x2be38c){return _0x41108a!==_0x2be38c;},'XJfJC':'rpnwU','qbmZR':'vZFRj','JSjpD':function(_0x8a6645,_0xde108c){return _0x8a6645===_0xde108c;},'DWhzd':'gyXHy','MmgIq':function(_0x8e7a7e,_0xcbc00f){return _0x8e7a7e!==_0xcbc00f;},'mHCUL':_0xb52ed6(0x226),'Oucbb':_0xb52ed6(0x18d),'jFeOM':_0xb52ed6(0x292),'XFlKW':function(_0x3665f9,_0x4ef565){return _0x3665f9+_0x4ef565;},'CYuFa':_0xb52ed6(0x1d5),'NqeLo':'gger','BTvkn':_0xb52ed6(0x23e),'YVBZK':function(_0xebf216,_0x243e0e){return _0xebf216(_0x243e0e);},'mUUtG':function(_0x4aceb8,_0x4b0f05){return _0x4aceb8-_0x4b0f05;},'EfFKM':function(_0x159410,_0x10910f){return _0x159410!==_0x10910f;},'dFarG':_0xb52ed6(0x227),'EImsR':function(_0x5f34ab,_0x4d293c){return _0x5f34ab==_0x4d293c;},'CHKAe':_0xb52ed6(0x26c),'KiCap':function(_0x3c6bd7,_0x3e537b){return _0x3c6bd7!==_0x3e537b;},'dhHwe':'mlFvg','nYiXE':_0xb52ed6(0x27d),'dlFry':_0xb52ed6(0x172),'OrLWQ':_0xb52ed6(0x1e1),'yeSZI':_0xb52ed6(0x291),'bWwjP':function(_0x16d6e5,_0x17f0a3){return _0x16d6e5!==_0x17f0a3;},'UZNbY':_0xb52ed6(0x1de),'uDCip':_0xb52ed6(0x1c1),'WLSkc':_0xb52ed6(0x23a),'oetpd':_0xb52ed6(0x25b),'ihdow':_0xb52ed6(0x19c),'bFzZq':'$docId','pqYvs':_0xb52ed6(0x1f0),'bVuFQ':_0xb52ed6(0x198),'vQFNG':'$customerName','Ubcsp':_0xb52ed6(0x236),'eMNHQ':_0xb52ed6(0x256),'CzrRx':'$docStatusNumber','cEmRg':_0xb52ed6(0x2af),'lFWzD':_0xb52ed6(0x28e),'OkmJz':'cyqac','yMfmD':_0xb52ed6(0x1b0),'aubZR':_0xb52ed6(0x1b2),'vUvBW':'aUSOz'};let {selectMonth:_0x37e4cb,reportType:_0x33d576,itemId:_0x41058e,searchItem:_0x2f2f50,userId:_0x2cfd19,searchUser:_0x4dbf7c,docId:_0x5959d7}=_0x226c88[_0xb52ed6(0x24d)];_0x2cfd19=_0x2cfd19&&_0x2efcde[_0xb52ed6(0x283)](Number,_0x2cfd19);const [_0x10a220,_0x2770ed]=_0x37e4cb[_0xb52ed6(0x2a0)]('-');let _0x5960a0=''+(global[_0xb52ed6(0x1ce)][_0x2efcde[_0xb52ed6(0x290)](_0x2efcde[_0xb52ed6(0x283)](parseInt,_0x2770ed),0x1)]+'\x20'+_0x10a220);_0x2cfd19&&(_0x5960a0+=_0xb52ed6(0x185)+_0x2cfd19+')\x20'+_0x4dbf7c),_0x41058e&&(_0x5960a0+=',\x20('+_0x41058e+')\x20'+_0x2f2f50),_0x5959d7&&(_0x5960a0+=',\x20'+_0x5959d7);const _0x56c4b6=new _0x45e6bf(global[_0xb52ed6(0x1dc)]);try{if(_0x2efcde['EfFKM'](_0x2efcde[_0xb52ed6(0x186)],_0x2efcde['dFarG'])){if(_0x444622)return _0x381082;else VyHmWF['yIdyv'](_0x232e05,0x0);}else{await _0x56c4b6[_0xb52ed6(0x2b1)]();const _0xfdca8e=_0x56c4b6['db'](global[_0xb52ed6(0x231)])['collection'](P);if(_0x2efcde['EImsR'](_0x33d576,_0x2efcde['CHKAe'])){if(_0x2efcde[_0xb52ed6(0x240)](_0x2efcde['dhHwe'],_0x2efcde[_0xb52ed6(0x1a1)])){const _0x4a33dc=[{'$match':{'docDate':{'$regex':'^'+_0x37e4cb}}},{'$project':{'_id':0x0,'docId':0x1,'docDate':0x1,'docStatusNumber':0x1,'customerId':0x1,'customerName':0x1,'totalAmount':0x1,'vatAmount':0x1,'netAmount':0x1,'proposerId':0x1,'proposerFullname':0x1,...F}}];_0x2cfd19&&_0x4a33dc[_0xb52ed6(0x241)]({'$match':{'proposerId':_0x2cfd19}}),_0x41058e&&_0x4a33dc[_0xb52ed6(0x241)]({'$match':{'tableRows.itemId':_0x41058e}}),_0x5959d7&&_0x4a33dc[_0xb52ed6(0x241)]({'$match':{'docId':_0x5959d7}});const _0x204f84=await _0xfdca8e[_0xb52ed6(0x24f)](_0x4a33dc)[_0xb52ed6(0x294)](),_0x5a972e=_0x529ab4[_0xb52ed6(0x289)](folderForm,_0x2efcde[_0xb52ed6(0x239)]),_0x33002c=_0x197083[_0xb52ed6(0x188)](_0x5a972e,_0x2efcde['OrLWQ']);var _0x590a8b=_0x16cede[_0xb52ed6(0x1ee)](_0x33002c,{'title':_0x5960a0,'data':_0x204f84});}else{const _0x30f49c=_0x9b2bab[_0xb52ed6(0x1df)];return _0x30f49c&&_0x2efcde[_0xb52ed6(0x264)](_0x30f49c[_0xb52ed6(0x257)],0x0)&&_0x30f49c[_0xb52ed6(0x1cd)](_0x2a3abf=>{const _0x271ca0=_0xb52ed6,_0xa690f8=_0x2a3abf[_0x271ca0(0x22b)],_0x29f593=_0x36bd3d[_0x271ca0(0x207)](_0x67bca8=>_0x67bca8[_0x271ca0(0x22b)]==_0xa690f8);_0x2efcde['MPVTY'](_0x29f593[_0x271ca0(0x257)],0x0)?_0x2a3abf[_0x271ca0(0x18e)]=_0x29f593[0x0][_0x271ca0(0x18e)]['filter'](_0x443f7f=>_0x443f7f[_0x271ca0(0x18f)]==_0x304014[_0x271ca0(0x18f)]):_0x2a3abf[_0x271ca0(0x18e)]=[];}),_0x1e3731;}}else{if(_0x2efcde[_0xb52ed6(0x25d)](_0x33d576,_0x2efcde[_0xb52ed6(0x218)])){if(_0x2efcde['bWwjP'](_0x2efcde[_0xb52ed6(0x249)],_0x2efcde[_0xb52ed6(0x265)])){const _0x408656=[{'$match':{'docDate':{'$regex':'^'+_0x37e4cb}}},{'$unwind':_0x2efcde[_0xb52ed6(0x1a9)]},{'$group':{'_id':_0x2efcde['oetpd']}},{'$project':{'_id':0x0,'itemId':_0x2efcde[_0xb52ed6(0x1f1)]}},{'$sort':{'itemId':0x1}}];_0x2cfd19&&_0x408656['unshift']({'$match':{'proposerId':_0x2cfd19}}),_0x41058e&&_0x408656[_0xb52ed6(0x241)]({'$match':{'tableRows.itemId':_0x41058e}}),_0x5959d7&&_0x408656[_0xb52ed6(0x241)]({'$match':{'docId':_0x5959d7}});const _0x39c1d2=await _0xfdca8e[_0xb52ed6(0x24f)](_0x408656)[_0xb52ed6(0x294)]();let _0xa171c4=_0x41058e?[_0x41058e]:_0x39c1d2[_0xb52ed6(0x245)](_0x5f0b29=>_0x5f0b29[_0xb52ed6(0x18f)]);_0xa171c4=_0xa171c4[_0xb52ed6(0x207)](_0xcbca90=>_0xcbca90!='');const _0x3eefc3=[{'$match':{'docDate':{'$regex':'^'+_0x37e4cb}}},{'$match':{'tableRows.itemId':{'$in':_0xa171c4}}},{'$unwind':_0x2efcde['WLSkc']},{'$group':{'_id':_0x2efcde['oetpd'],'docs':{'$addToSet':{'docId':_0x2efcde[_0xb52ed6(0x1aa)],'docDate':_0x2efcde[_0xb52ed6(0x29e)],'customerId':_0x2efcde[_0xb52ed6(0x177)],'customerName':_0x2efcde[_0xb52ed6(0x196)],'proposerId':_0x2efcde[_0xb52ed6(0x282)],'proposerFullname':_0x2efcde[_0xb52ed6(0x220)],'docStatusNumber':_0x2efcde['CzrRx'],...F}}}},{'$project':{'_id':0x0,'itemId':_0x2efcde[_0xb52ed6(0x1f1)],'docs':0x1}}];_0x2cfd19&&_0x3eefc3[_0xb52ed6(0x241)]({'$match':{'proposerId':_0x2cfd19}}),_0x41058e&&_0x3eefc3[_0xb52ed6(0x241)]({'$match':{'tableRows.itemId':_0x41058e}}),_0x5959d7&&_0x3eefc3[_0xb52ed6(0x241)]({'$match':{'docId':_0x5959d7}});let _0x955efd=await _0xfdca8e[_0xb52ed6(0x24f)](_0x3eefc3)[_0xb52ed6(0x294)]();_0x955efd=_0x955efd[_0xb52ed6(0x207)](_0x255d83=>_0x255d83[_0xb52ed6(0x18f)]!=''),_0x41058e&&(_0x955efd=_0x955efd[_0xb52ed6(0x207)](_0x1b504c=>_0x41058e==_0x1b504c[_0xb52ed6(0x18f)]));let _0xef8625=await _0xfdca8e[_0xb52ed6(0x24f)]([{'$match':{'docDate':{'$regex':'^'+_0x37e4cb}}},{'$match':{'tableRows.itemId':{'$in':_0xa171c4}}},{'$project':{'_id':0x0,'docId':0x1,'tableRows':0x1}}])[_0xb52ed6(0x294)]();_0x41058e&&(_0xef8625=_0xef8625[_0xb52ed6(0x245)](_0x12f24d=>{const _0x5abff7=_0xb52ed6;if(_0x2efcde[_0x5abff7(0x295)](_0x2efcde[_0x5abff7(0x203)],_0x2efcde['qbmZR'])){const _0x32e37e=_0x12f24d[_0x5abff7(0x18e)][_0x5abff7(0x207)](_0x5a99d4=>_0x5a99d4['itemId']==_0x41058e);return _0x12f24d[_0x5abff7(0x18e)]=_0x32e37e,_0x12f24d;}else{const _0x39ad58=_0x3a63cb[_0x5abff7(0x205)](_0x3b26e0,arguments);return _0x1bf8ba=null,_0x39ad58;}})),_0x955efd[_0xb52ed6(0x245)](_0x2d5fc9=>{const _0x412d23=_0xb52ed6,_0x3ea3aa={'qxKFe':function(_0x5b997b,_0x382610){const _0x476302=_0x37a5;return _0x2efcde[_0x476302(0x2a1)](_0x5b997b,_0x382610);},'FkjPz':_0x2efcde[_0x412d23(0x296)],'Vskxe':function(_0x1cb31b,_0x4cfb49){return _0x2efcde['MPVTY'](_0x1cb31b,_0x4cfb49);}};if(_0x2efcde[_0x412d23(0x1da)](_0x2efcde[_0x412d23(0x267)],_0x2efcde[_0x412d23(0x247)])){const _0x39a19d=_0x2d5fc9[_0x412d23(0x1df)];return _0x39a19d&&_0x2efcde[_0x412d23(0x264)](_0x39a19d[_0x412d23(0x257)],0x0)&&_0x39a19d['forEach'](_0x2b2778=>{const _0x1dadcc=_0x412d23;if(_0x3ea3aa[_0x1dadcc(0x260)](_0x3ea3aa['FkjPz'],_0x3ea3aa[_0x1dadcc(0x235)])){const _0x32866f=_0x2b2778[_0x1dadcc(0x22b)],_0x55d7e8=_0xef8625[_0x1dadcc(0x207)](_0x4a5a7d=>_0x4a5a7d[_0x1dadcc(0x22b)]==_0x32866f);_0x3ea3aa[_0x1dadcc(0x1c5)](_0x55d7e8[_0x1dadcc(0x257)],0x0)?_0x2b2778[_0x1dadcc(0x18e)]=_0x55d7e8[0x0][_0x1dadcc(0x18e)][_0x1dadcc(0x207)](_0x7d22cb=>_0x7d22cb[_0x1dadcc(0x18f)]==_0x2d5fc9[_0x1dadcc(0x18f)]):_0x2b2778['tableRows']=[];}else return _0x1e36bb;}),_0x2d5fc9;}else{const _0x3195f4=_0x2b2d4b?function(){if(_0x5a359c){const _0x16cac8=_0x22182b['apply'](_0x234f39,arguments);return _0xf6cd6a=null,_0x16cac8;}}:function(){};return _0x1d207b=![],_0x3195f4;}}),_0x955efd[_0xb52ed6(0x248)]((_0x3fffb6,_0x214fd8)=>_0x3fffb6[_0xb52ed6(0x18f)]>_0x214fd8['itemId']?0x1:-0x1);const _0x370f34=_0x529ab4[_0xb52ed6(0x289)](folderForm,_0x2efcde['cEmRg']),_0x58b5fe=_0x197083[_0xb52ed6(0x188)](_0x370f34,_0x2efcde[_0xb52ed6(0x286)]);var _0x590a8b=_0x16cede[_0xb52ed6(0x1ee)](_0x58b5fe,{'title':_0x5960a0,'data':_0x955efd});}else _0x6340fe[_0xb52ed6(0x2b3)](_0x313d8d),_0x48cd9a[_0xb52ed6(0x221)](_0x3a7ec6['stringify']({'isLoad':!0x1,'class':_0x2efcde['jFeOM'],'msg':_0x4072c3[_0xb52ed6(0x28d)]}));}}return _0x4019b4[_0xb52ed6(0x221)](JSON[_0xb52ed6(0x222)]({'isLoad':!0x0,'class':_0x2efcde[_0xb52ed6(0x2a9)],'htmlDiv':_0x590a8b}));}}catch(_0x568474){_0x2efcde[_0xb52ed6(0x240)](_0x2efcde[_0xb52ed6(0x262)],_0x2efcde['yMfmD'])?(console['log'](_0x568474),_0x4019b4[_0xb52ed6(0x221)](JSON['stringify']({'isLoad':!0x1,'class':_0x2efcde[_0xb52ed6(0x17c)],'msg':_0x568474['message']}))):function(){return!![];}[_0xb52ed6(0x1a5)](VyHmWF['XFlKW'](VyHmWF[_0xb52ed6(0x1fc)],VyHmWF[_0xb52ed6(0x232)]))['call'](VyHmWF[_0xb52ed6(0x272)]);}finally{_0x2efcde['JSjpD'](_0x2efcde[_0xb52ed6(0x206)],_0x2efcde[_0xb52ed6(0x187)])?_0x2ac668=_0x7753a3:_0x56c4b6[_0xb52ed6(0x1b1)]();}}),_[_0x15c987(0x253)](z,_0x2d93e8[_0x15c987(0x193)],async(_0x5a0366,_0x59921a)=>{const _0x1c3985=_0x15c987,_0x1bfd93={'BZTVA':function(_0x56cb63,_0x55105f){return _0x56cb63(_0x55105f);},'kqTPy':function(_0x36c265,_0xc096d6){return _0x36c265+_0xc096d6;},'hvdxG':_0x1c3985(0x27a),'jJEyS':_0x1c3985(0x21a),'tcAfL':function(_0x8da6c3){return _0x8da6c3();},'exloU':function(_0x595d6c,_0x548a01){return _0x595d6c+_0x548a01;},'TQVII':function(_0x2aafd1,_0xcb102a){return _0x2aafd1+_0xcb102a;},'fCxDT':function(_0x2bb842){return _0x2bb842();},'msyow':_0x1c3985(0x2b3),'OMKdD':_0x1c3985(0x277),'lexGk':_0x1c3985(0x17f),'xMIJC':'error','AKtXP':_0x1c3985(0x29f),'rMKcK':_0x1c3985(0x1cb),'QgGZs':_0x1c3985(0x192),'hAgRP':function(_0x594286,_0x527b3a){return _0x594286<_0x527b3a;},'iUMZI':_0x1c3985(0x1c6),'gGYbw':function(_0x4c7832,_0xcf75a5){return _0x4c7832-_0xcf75a5;},'NPkSm':function(_0x103d4e,_0x25a9e3){return _0x103d4e(_0x25a9e3);},'DmyeQ':_0x1c3985(0x292),'KTfJO':_0x1c3985(0x2aa),'jkMzs':function(_0x13f806,_0x356191){return _0x13f806===_0x356191;},'LEOWx':'ypxGg','xgfbq':_0x1c3985(0x17d),'jBeJp':_0x1c3985(0x28e),'YvbCy':_0x1c3985(0x2a4),'mHTBI':function(_0x571f30,_0x1f6604){return _0x571f30!==_0x1f6604;},'FsNdh':_0x1c3985(0x243),'TQtGv':function(_0x251acb,_0x4ced0f){return _0x251acb===_0x4ced0f;},'PbdDa':_0x1c3985(0x1c2),'YLQNC':_0x1c3985(0x16e)};console['log'](_0x1c3985(0x1d3)+_0x5a0366['originalUrl']+_0x1c3985(0x199)),console[_0x1c3985(0x2b3)](_0x1bfd93[_0x1c3985(0x24e)],_0x5a0366[_0x1c3985(0x24d)]);const {selectMonth:_0x2a24ff,userId:_0x1df425,searchUser:_0x1f1a2f,itemId:_0x4b094e,searchItem:_0x115d54,docId:_0x7ae3df,docTitle:_0x5769b9}=_0x5a0366[_0x1c3985(0x24d)],[_0x4f718f,_0x406c09]=_0x2a24ff['split']('-'),_0x345f9f=global['MONTH_NAMES'][_0x1bfd93[_0x1c3985(0x201)](_0x1bfd93['NPkSm'](parseInt,_0x406c09),0x1)]+'\x20'+_0x4f718f,_0x42607b=_0x106b64[_0x1c3985(0x29a)](_0x5769b9);if(!_0x42607b)return _0x59921a[_0x1c3985(0x221)](JSON[_0x1c3985(0x222)]({'isStatus':!0x1,'class':_0x1bfd93[_0x1c3985(0x170)],'msg':_0x1bfd93['KTfJO']}));let _0x389da9=''+_0x345f9f;_0x1df425&&(_0x389da9+=_0x1c3985(0x185)+_0x1df425+')\x20'+_0x1f1a2f),_0x4b094e&&(_0x389da9+=_0x1c3985(0x185)+_0x4b094e+')\x20'+_0x115d54),_0x7ae3df&&(_0x389da9+=',\x20'+_0x7ae3df);const _0x314545=new _0x45e6bf(global[_0x1c3985(0x1dc)]);try{if(_0x1bfd93['jkMzs'](_0x1bfd93['LEOWx'],_0x1bfd93[_0x1c3985(0x1a8)])){const _0x143288=NdfXaA[_0x1c3985(0x1cf)](_0x27dede,NdfXaA[_0x1c3985(0x1ac)](NdfXaA[_0x1c3985(0x1ac)](NdfXaA[_0x1c3985(0x234)],NdfXaA[_0x1c3985(0x23c)]),');'));_0xa6594b=NdfXaA[_0x1c3985(0x1eb)](_0x143288);}else{await _0x314545[_0x1c3985(0x2b1)]();const _0x5d2860=_0x314545['db'](global[_0x1c3985(0x231)])[_0x1c3985(0x211)](_0x42607b),_0x5d1421=[{'$match':{'docDate':{'$regex':'^'+_0x2a24ff}}},{'$project':{'_id':0x0,'docId':0x1,'docDate':0x1,'docStatusNumber':0x1,'customerId':0x1,'customerName':0x1,'netAmount':0x1,'proposerId':0x1,'proposerFullname':0x1,...F}}];_0x1df425&&_0x5d1421[_0x1c3985(0x241)]({'$match':{'borrowerId':_0x1df425}}),_0x4b094e&&_0x5d1421[_0x1c3985(0x241)]({'$match':{'tableRows.itemId':_0x4b094e}}),_0x7ae3df&&_0x5d1421[_0x1c3985(0x241)]({'$match':{'docId':_0x7ae3df}});const _0x3ffa94=await _0x5d2860[_0x1c3985(0x24f)](_0x5d1421)[_0x1c3985(0x294)]();_0x389da9+='\x20(\x20จำนวน='+_0x3ffa94[_0x1c3985(0x257)]+'\x20)',_0x59921a[_0x1c3985(0x221)](JSON[_0x1c3985(0x222)]({'isLoad':!0x0,'class':_0x1bfd93['jBeJp'],'title':_0x389da9,'dataDocs':_0x3ffa94,'selectMonth':_0x2a24ff,'msg':_0x1bfd93['YvbCy']}));}}catch(_0x1a97cf){if(_0x1bfd93[_0x1c3985(0x2b4)](_0x1bfd93[_0x1c3985(0x246)],_0x1bfd93[_0x1c3985(0x246)])){const _0x70618f=_0x27b295[_0x1c3985(0x1a5)]['prototype'][_0x1c3985(0x1b6)](_0x3f5b10),_0x36f13d=_0x300e03[_0x47a331],_0x182d95=_0x2d6999[_0x36f13d]||_0x70618f;_0x70618f['__proto__']=_0x147ff3['bind'](_0x5bb8a4),_0x70618f[_0x1c3985(0x269)]=_0x182d95[_0x1c3985(0x269)][_0x1c3985(0x1b6)](_0x182d95),_0x4995a9[_0x36f13d]=_0x70618f;}else console[_0x1c3985(0x2b3)](_0x1a97cf['message']),_0x59921a['send'](JSON[_0x1c3985(0x222)]({'isLoad':!0x1,'class':_0x1bfd93['DmyeQ'],'title':_0x389da9,'selectMonth':_0x2a24ff,'msg':_0x1a97cf[_0x1c3985(0x28d)]}));}finally{if(_0x1bfd93[_0x1c3985(0x270)](_0x1bfd93[_0x1c3985(0x237)],_0x1bfd93[_0x1c3985(0x191)])){let _0x58ec19;try{const _0x66b3fa=NdfXaA[_0x1c3985(0x1cf)](_0x174882,NdfXaA[_0x1c3985(0x242)](NdfXaA[_0x1c3985(0x181)](NdfXaA[_0x1c3985(0x234)],NdfXaA[_0x1c3985(0x23c)]),');'));_0x58ec19=NdfXaA['fCxDT'](_0x66b3fa);}catch(_0x532a2d){_0x58ec19=_0xd51079;}const _0x47c266=_0x58ec19[_0x1c3985(0x1ad)]=_0x58ec19[_0x1c3985(0x1ad)]||{},_0x3397ac=[NdfXaA['msyow'],NdfXaA[_0x1c3985(0x189)],NdfXaA[_0x1c3985(0x1f3)],NdfXaA[_0x1c3985(0x20f)],NdfXaA[_0x1c3985(0x178)],NdfXaA[_0x1c3985(0x1ab)],NdfXaA[_0x1c3985(0x26f)]];for(let _0x5b3ea2=0x0;NdfXaA[_0x1c3985(0x244)](_0x5b3ea2,_0x3397ac[_0x1c3985(0x257)]);_0x5b3ea2++){const _0x57ce4b=_0x52b386[_0x1c3985(0x1a5)]['prototype'][_0x1c3985(0x1b6)](_0x2bb87d),_0x330565=_0x3397ac[_0x5b3ea2],_0x4ee871=_0x47c266[_0x330565]||_0x57ce4b;_0x57ce4b['__proto__']=_0x1a71aa[_0x1c3985(0x1b6)](_0xac2a85),_0x57ce4b[_0x1c3985(0x269)]=_0x4ee871[_0x1c3985(0x269)]['bind'](_0x4ee871),_0x47c266[_0x330565]=_0x57ce4b;}}else _0x314545[_0x1c3985(0x1b1)]();}});export default _;function _0x480ab7(_0x334c5b){const _0x783b48=_0x15c987,_0x4627bc={'IUIXh':function(_0x538504,_0x4bd2ee){return _0x538504(_0x4bd2ee);},'wICWQ':function(_0x17cf21,_0x4e688c){return _0x17cf21===_0x4e688c;},'iblJI':_0x783b48(0x228),'UtQGd':_0x783b48(0x2b0),'gbZbX':'ZxRrN','kfzBB':_0x783b48(0x1b4),'VlSKf':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','fhgUg':_0x783b48(0x21e),'zhuNq':function(_0xf8b7be,_0x13a608){return _0xf8b7be+_0x13a608;},'ZtSKF':_0x783b48(0x25e),'LadvE':_0x783b48(0x180),'TUKLt':function(_0x455bae,_0x1784c6){return _0x455bae(_0x1784c6);},'tojkx':function(_0x142d2a){return _0x142d2a();},'yhHpA':function(_0x2da105,_0x1ed90c){return _0x2da105===_0x1ed90c;},'MIZEK':_0x783b48(0x19d),'Ucecw':function(_0x16bcff,_0x1c57bd){return _0x16bcff===_0x1c57bd;},'PTQAP':_0x783b48(0x16d),'bpRJk':_0x783b48(0x2a3),'WQajo':_0x783b48(0x1db),'ZNbQj':function(_0x46b14c,_0x37c086){return _0x46b14c!==_0x37c086;},'BdPyY':function(_0x38d193,_0x234ae8){return _0x38d193+_0x234ae8;},'QLRwR':function(_0x43be0b,_0x4a4a0b){return _0x43be0b/_0x4a4a0b;},'TAzRf':_0x783b48(0x257),'wAGEb':function(_0x1f6cba,_0x365d5c){return _0x1f6cba%_0x365d5c;},'xKZBz':function(_0xb2a9e0,_0x36282a){return _0xb2a9e0!==_0x36282a;},'SbdwI':_0x783b48(0x276),'bvUsB':'debu','rIdNz':_0x783b48(0x18c),'CwrcU':_0x783b48(0x23e),'tzdAJ':function(_0xf60eeb,_0x37949c){return _0xf60eeb===_0x37949c;},'koYDb':'CJJly','tqotH':'EpPxM','YNXGp':'stateObject','JPylG':function(_0x109060,_0x1a377b){return _0x109060(_0x1a377b);}};function _0x505489(_0x409df9){const _0x2eeeae=_0x783b48,_0x100a41={'pdIGg':_0x4627bc[_0x2eeeae(0x209)],'RceMQ':_0x4627bc[_0x2eeeae(0x271)],'HLkZH':function(_0x468f91,_0xf214ed){return _0x4627bc['IUIXh'](_0x468f91,_0xf214ed);},'TMUAS':_0x4627bc['fhgUg'],'tCIcT':function(_0x48a669,_0x2d2968){const _0x23100d=_0x2eeeae;return _0x4627bc[_0x23100d(0x1af)](_0x48a669,_0x2d2968);},'VdbDC':_0x4627bc[_0x2eeeae(0x230)],'fvsrw':function(_0x138b32,_0x3ca8a9){return _0x4627bc['zhuNq'](_0x138b32,_0x3ca8a9);},'kKhPi':_0x4627bc[_0x2eeeae(0x1e4)],'YiavF':function(_0x3bc60b,_0x2431fc){const _0x415145=_0x2eeeae;return _0x4627bc[_0x415145(0x173)](_0x3bc60b,_0x2431fc);},'wIEdX':function(_0x38253){const _0x24c119=_0x2eeeae;return _0x4627bc[_0x24c119(0x285)](_0x38253);}};if(_0x4627bc['yhHpA'](typeof _0x409df9,_0x4627bc['MIZEK']))return _0x4627bc[_0x2eeeae(0x1ba)](_0x4627bc[_0x2eeeae(0x25f)],_0x4627bc[_0x2eeeae(0x25f)])?function(_0xaa1589){}[_0x2eeeae(0x1a5)](_0x4627bc[_0x2eeeae(0x278)])[_0x2eeeae(0x205)](_0x4627bc[_0x2eeeae(0x250)]):![];else{if(_0x4627bc['ZNbQj'](_0x4627bc[_0x2eeeae(0x174)]('',_0x4627bc['QLRwR'](_0x409df9,_0x409df9))[_0x4627bc[_0x2eeeae(0x19f)]],0x1)||_0x4627bc[_0x2eeeae(0x1d1)](_0x4627bc[_0x2eeeae(0x1a6)](_0x409df9,0x14),0x0))_0x4627bc[_0x2eeeae(0x1fa)](_0x4627bc[_0x2eeeae(0x208)],_0x4627bc[_0x2eeeae(0x208)])?_0x4627bc[_0x2eeeae(0x2ad)](_0xd3cfeb,'0'):function(){const _0x30cde6=_0x2eeeae;if(_0x4627bc[_0x30cde6(0x1d1)](_0x4627bc[_0x30cde6(0x1d6)],_0x4627bc[_0x30cde6(0x1d6)]))return!![];else{if(_0x2f1b82){const _0x48b6fa=_0x332dda[_0x30cde6(0x205)](_0xd6e353,arguments);return _0xc512d2=null,_0x48b6fa;}}}[_0x2eeeae(0x1a5)](_0x4627bc[_0x2eeeae(0x174)](_0x4627bc[_0x2eeeae(0x1e3)],_0x4627bc[_0x2eeeae(0x233)]))[_0x2eeeae(0x2ac)](_0x4627bc[_0x2eeeae(0x1bc)]);else{if(_0x4627bc[_0x2eeeae(0x216)](_0x4627bc[_0x2eeeae(0x1ed)],_0x4627bc[_0x2eeeae(0x26d)])){if(_0x30486e){const _0x3fb362=_0x303abb[_0x2eeeae(0x205)](_0x32edd2,arguments);return _0x3115b5=null,_0x3fb362;}}else(function(){const _0x53daea=_0x2eeeae;if(_0x4627bc['wICWQ'](_0x4627bc['UtQGd'],_0x4627bc[_0x53daea(0x23f)])){const _0x4bd753=new _0x48b434(_0x100a41['pdIGg']),_0x2390fd=new _0x3fb297(_0x100a41[_0x53daea(0x274)],'i'),_0x3f604b=_0x100a41[_0x53daea(0x20a)](_0x155405,_0x100a41[_0x53daea(0x1b3)]);!_0x4bd753[_0x53daea(0x1bf)](_0x100a41[_0x53daea(0x182)](_0x3f604b,_0x100a41[_0x53daea(0x1ea)]))||!_0x2390fd['test'](_0x100a41[_0x53daea(0x266)](_0x3f604b,_0x100a41[_0x53daea(0x17b)]))?_0x100a41[_0x53daea(0x1fe)](_0x3f604b,'0'):_0x100a41[_0x53daea(0x1d7)](_0x5e41c8);}else return![];}['constructor'](_0x4627bc[_0x2eeeae(0x174)](_0x4627bc[_0x2eeeae(0x1e3)],_0x4627bc[_0x2eeeae(0x233)]))[_0x2eeeae(0x205)](_0x4627bc[_0x2eeeae(0x22f)]));}}_0x4627bc[_0x2eeeae(0x1b7)](_0x505489,++_0x409df9);}try{if(_0x334c5b)return _0x505489;else _0x4627bc[_0x783b48(0x1b7)](_0x505489,0x0);}catch(_0x4c3494){}}