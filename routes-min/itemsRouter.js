const _0x2e3f8f=_0x311c;function _0x311c(_0xdf2abf,_0x33a6c1){const _0x1f0498=_0x4ff5();return _0x311c=function(_0x49603e,_0xde7a82){_0x49603e=_0x49603e-0x1d7;let _0x5ad98b=_0x1f0498[_0x49603e];return _0x5ad98b;},_0x311c(_0xdf2abf,_0x33a6c1);}(function(_0x2163e5,_0x1e0ffc){const _0x1af514=_0x311c,_0xd30815=_0x2163e5();while(!![]){try{const _0x46ba06=parseInt(_0x1af514(0x32a))/0x1*(parseInt(_0x1af514(0x23f))/0x2)+parseInt(_0x1af514(0x1e9))/0x3+-parseInt(_0x1af514(0x206))/0x4*(-parseInt(_0x1af514(0x303))/0x5)+-parseInt(_0x1af514(0x2e7))/0x6+parseInt(_0x1af514(0x30a))/0x7+-parseInt(_0x1af514(0x35d))/0x8*(-parseInt(_0x1af514(0x39e))/0x9)+-parseInt(_0x1af514(0x25b))/0xa;if(_0x46ba06===_0x1e0ffc)break;else _0xd30815['push'](_0xd30815['shift']());}catch(_0x18c346){_0xd30815['push'](_0xd30815['shift']());}}}(_0x4ff5,0x9fc81));const _0x29d29c=(function(){const _0x5b88f2=_0x311c,_0x4b6422={'pubiV':_0x5b88f2(0x274),'xpMGz':_0x5b88f2(0x1f7),'tBJJb':function(_0x5168c9,_0x42cee6){return _0x5168c9===_0x42cee6;},'ILKao':_0x5b88f2(0x37d),'TDyaM':_0x5b88f2(0x1db),'NWqVW':_0x5b88f2(0x3b2),'jiNVM':_0x5b88f2(0x2ec),'utFBE':_0x5b88f2(0x208),'PqbrW':function(_0x17362e,_0x17108e){return _0x17362e(_0x17108e);},'VWLXJ':_0x5b88f2(0x368),'MxaVR':function(_0xb3054f,_0x2c78a7){return _0xb3054f+_0x2c78a7;},'SyStZ':_0x5b88f2(0x266),'cjZWF':'input','DqzrG':function(_0x57a547){return _0x57a547();},'fbYuI':function(_0x2c0eec,_0x145092,_0x55bbfb){return _0x2c0eec(_0x145092,_0x55bbfb);},'DsNNT':function(_0x53f6c8,_0xa0c8ba){return _0x53f6c8===_0xa0c8ba;},'FcHmu':_0x5b88f2(0x2ab)};let _0x302016=!![];return function(_0x5695d1,_0x12290d){const _0x11d9e8=_0x5b88f2,_0x327e51={'JfelC':_0x4b6422[_0x11d9e8(0x29f)],'XFMWz':_0x4b6422['xpMGz'],'ZAKQR':function(_0x56b832,_0x47d9d0){const _0x581242=_0x11d9e8;return _0x4b6422[_0x581242(0x28c)](_0x56b832,_0x47d9d0);},'XsBDY':_0x4b6422['ILKao'],'GoYJk':_0x4b6422[_0x11d9e8(0x2a5)],'bbvdQ':_0x4b6422['NWqVW'],'mTnwl':_0x4b6422['jiNVM'],'rJjoa':_0x4b6422[_0x11d9e8(0x2c9)],'BxpTC':function(_0x533cee,_0x3039d7){const _0x10b6d2=_0x11d9e8;return _0x4b6422[_0x10b6d2(0x249)](_0x533cee,_0x3039d7);},'XSCCl':_0x4b6422[_0x11d9e8(0x378)],'XsWUZ':function(_0x2e4b53,_0x2c84c8){const _0x3fd089=_0x11d9e8;return _0x4b6422[_0x3fd089(0x286)](_0x2e4b53,_0x2c84c8);},'gjeAP':_0x4b6422[_0x11d9e8(0x2b9)],'CxdYr':_0x4b6422[_0x11d9e8(0x39f)],'RZpiZ':function(_0x5f5940,_0x5355f5){const _0x1b59a3=_0x11d9e8;return _0x4b6422[_0x1b59a3(0x249)](_0x5f5940,_0x5355f5);},'JVyPW':function(_0xfec4af){return _0x4b6422['DqzrG'](_0xfec4af);},'jgtNf':function(_0x3e713d,_0x42849a,_0x6dc694){const _0x2a1ff3=_0x11d9e8;return _0x4b6422[_0x2a1ff3(0x26f)](_0x3e713d,_0x42849a,_0x6dc694);}};if(_0x4b6422[_0x11d9e8(0x2d3)](_0x4b6422[_0x11d9e8(0x35c)],_0x4b6422[_0x11d9e8(0x35c)])){const _0x2891a0=_0x302016?function(){const _0x33e3f8=_0x11d9e8;if(_0x327e51['ZAKQR'](_0x327e51[_0x33e3f8(0x393)],_0x327e51[_0x33e3f8(0x393)])){if(_0x12290d){if(_0x327e51[_0x33e3f8(0x27a)](_0x327e51[_0x33e3f8(0x33a)],_0x327e51[_0x33e3f8(0x219)])){const _0x42ad96=new _0xac5764('.*'+_0x20ae7b+'.*','i');_0x263d9d[_0x33e3f8(0x38d)]({'$match':{'$or':[{'itemId':{'$regex':_0x42ad96}},{'itemName':{'$regex':_0x42ad96}}]}});}else{const _0x5a7755=_0x12290d[_0x33e3f8(0x3ad)](_0x5695d1,arguments);return _0x12290d=null,_0x5a7755;}}}else return function(_0x5a7c01){}['constructor'](_0x327e51['JfelC'])['apply'](_0x327e51[_0x33e3f8(0x21c)]);}:function(){};return _0x302016=![],_0x2891a0;}else{const _0x16a1e9={'cHrMH':_0x327e51[_0x11d9e8(0x1f8)],'lvLBa':_0x327e51[_0x11d9e8(0x23a)],'RqgZi':function(_0x1caf24,_0x2a55db){const _0x4f0974=_0x11d9e8;return _0x327e51[_0x4f0974(0x33c)](_0x1caf24,_0x2a55db);},'bqUCd':_0x327e51[_0x11d9e8(0x29d)],'usujX':function(_0x359da5,_0x1b17d0){return _0x327e51['XsWUZ'](_0x359da5,_0x1b17d0);},'iKlJA':_0x327e51[_0x11d9e8(0x263)],'PCoHh':_0x327e51[_0x11d9e8(0x306)],'AcdPS':function(_0x2c322c,_0x124562){const _0x29a338=_0x11d9e8;return _0x327e51[_0x29a338(0x21b)](_0x2c322c,_0x124562);},'oWkCz':function(_0x1b8556){const _0xe84b9e=_0x11d9e8;return _0x327e51[_0xe84b9e(0x26a)](_0x1b8556);}};_0x327e51[_0x11d9e8(0x340)](_0xce0d94,this,function(){const _0x59b2e7=_0x11d9e8,_0x283d30=new _0x5f409a(_0x16a1e9['cHrMH']),_0x413b44=new _0x4975f4(_0x16a1e9[_0x59b2e7(0x32e)],'i'),_0x59fffe=_0x16a1e9[_0x59b2e7(0x335)](_0xe3c20,_0x16a1e9['bqUCd']);!_0x283d30[_0x59b2e7(0x1f0)](_0x16a1e9[_0x59b2e7(0x305)](_0x59fffe,_0x16a1e9[_0x59b2e7(0x280)]))||!_0x413b44['test'](_0x16a1e9['usujX'](_0x59fffe,_0x16a1e9[_0x59b2e7(0x341)]))?_0x16a1e9['AcdPS'](_0x59fffe,'0'):_0x16a1e9[_0x59b2e7(0x362)](_0x189059);})();}};}());(function(){const _0xe90ee4=_0x311c,_0x41ace0={'jmcEV':'msg','gaTuv':'red','tlvQf':function(_0x546f8b,_0x4309f8){return _0x546f8b!==_0x4309f8;},'jSzFE':_0xe90ee4(0x389),'YVvdq':_0xe90ee4(0x2b1),'dCHbz':_0xe90ee4(0x2ec),'IEzYp':_0xe90ee4(0x208),'rbpzW':function(_0x316b7e,_0x538a4a){return _0x316b7e(_0x538a4a);},'gHfZM':_0xe90ee4(0x368),'TDCNu':function(_0x112a5e,_0x2f470b){return _0x112a5e+_0x2f470b;},'pHCxs':_0xe90ee4(0x266),'sbbRb':function(_0x5ef091,_0x50215d){return _0x5ef091+_0x50215d;},'HcqCv':_0xe90ee4(0x26e),'iRnqM':_0xe90ee4(0x2ea),'nwCIF':_0xe90ee4(0x339),'cbEGA':function(_0x2c7d16,_0x68f410){return _0x2c7d16===_0x68f410;},'Cqsqk':'Axudt','arZDj':function(_0x536df7){return _0x536df7();},'Tkxua':function(_0x14986f,_0x691fd,_0x4cf24d){return _0x14986f(_0x691fd,_0x4cf24d);}};_0x41ace0['Tkxua'](_0x29d29c,this,function(){const _0x439043=_0xe90ee4;if(_0x41ace0[_0x439043(0x2a7)](_0x41ace0[_0x439043(0x28e)],_0x41ace0[_0x439043(0x38f)])){const _0x178088=new RegExp(_0x41ace0[_0x439043(0x31f)]),_0x575b87=new RegExp(_0x41ace0[_0x439043(0x21a)],'i'),_0x29279a=_0x41ace0[_0x439043(0x29b)](_0x2eb546,_0x41ace0[_0x439043(0x3a2)]);if(!_0x178088[_0x439043(0x1f0)](_0x41ace0[_0x439043(0x360)](_0x29279a,_0x41ace0[_0x439043(0x26c)]))||!_0x575b87['test'](_0x41ace0[_0x439043(0x39b)](_0x29279a,_0x41ace0[_0x439043(0x31b)])))_0x41ace0[_0x439043(0x2a7)](_0x41ace0[_0x439043(0x385)],_0x41ace0['nwCIF'])?_0x41ace0[_0x439043(0x29b)](_0x29279a,'0'):_0x1f6af0[_0x439043(0x27e)]();else{if(_0x41ace0[_0x439043(0x31e)](_0x41ace0[_0x439043(0x272)],_0x41ace0['Cqsqk']))_0x41ace0[_0x439043(0x372)](_0x2eb546);else{if(_0x682593){const _0x460395=_0xb8b3ec[_0x439043(0x3ad)](_0x3f4216,arguments);return _0x536835=null,_0x460395;}}}}else return _0x134b17[_0x439043(0x304)](_0x44a385[_0x439043(0x21f)]),_0x393bcc[_0x439043(0x2b4)](_0x41ace0[_0x439043(0x326)],{'class':_0x41ace0[_0x439043(0x33e)],'text':''+_0x283d1e[_0x439043(0x21f)]}),_0x5470db[_0x439043(0x373)](_0x3c647f);})();}());const _0xde7a82=(function(){const _0x517554=_0x311c,_0x55a6cd={'qmhQE':function(_0x17b60d,_0x519429){return _0x17b60d(_0x519429);},'Nprwk':function(_0x3dbce2,_0x868c9a){return _0x3dbce2>_0x868c9a;},'tqRZU':function(_0xcc8996,_0x2a159a,_0x149214,_0xa8f4f4,_0x3fd48d){return _0xcc8996(_0x2a159a,_0x149214,_0xa8f4f4,_0x3fd48d);},'yVDDk':function(_0x335a1c){return _0x335a1c();},'IUDbV':function(_0x997f5,_0x431aa4){return _0x997f5===_0x431aa4;},'aQhkL':_0x517554(0x213),'MEMLh':_0x517554(0x261),'LLJIK':_0x517554(0x2dd),'kmuFt':_0x517554(0x269),'AaYMa':_0x517554(0x3c0)};let _0x1e64c8=!![];return function(_0xd81a5,_0x23a4f){const _0xa0a633=_0x517554,_0x2b7b9a={'LlVXT':function(_0xe65cc7,_0x33c685){return _0x55a6cd['qmhQE'](_0xe65cc7,_0x33c685);},'LzGTY':function(_0x35ccde,_0x455a40){const _0x4c5382=_0x311c;return _0x55a6cd[_0x4c5382(0x397)](_0x35ccde,_0x455a40);},'wgkmI':function(_0x4f28b0,_0x1d98ce,_0x3cac5f,_0x540cff,_0xccb40e){return _0x55a6cd['tqRZU'](_0x4f28b0,_0x1d98ce,_0x3cac5f,_0x540cff,_0xccb40e);},'CtOEf':function(_0x527cf9){const _0x57ffc7=_0x311c;return _0x55a6cd[_0x57ffc7(0x355)](_0x527cf9);},'lAEAb':function(_0x169385,_0x173e62){return _0x55a6cd['IUDbV'](_0x169385,_0x173e62);},'vegPr':_0x55a6cd[_0xa0a633(0x2e0)],'vtCky':function(_0xd4ebd,_0x200df6){return _0x55a6cd['IUDbV'](_0xd4ebd,_0x200df6);},'HOcpZ':_0x55a6cd[_0xa0a633(0x2d6)],'XnZmk':_0x55a6cd[_0xa0a633(0x363)]};if(_0x55a6cd[_0xa0a633(0x202)](_0x55a6cd['kmuFt'],_0x55a6cd[_0xa0a633(0x1fe)]))_0x2b7b9a[_0xa0a633(0x1d9)](_0x43a083,_0x38de88);else{const _0x4d0c6d=_0x1e64c8?function(){const _0x9e5829=_0xa0a633,_0x3bf89d={'IFEiH':function(_0x2249d6,_0x31c5a3,_0xf9472e,_0x21c8d1,_0x44d129){const _0x2deca2=_0x311c;return _0x2b7b9a[_0x2deca2(0x2fe)](_0x2249d6,_0x31c5a3,_0xf9472e,_0x21c8d1,_0x44d129);},'zyqxz':function(_0x344a7b){const _0x573161=_0x311c;return _0x2b7b9a[_0x573161(0x1eb)](_0x344a7b);}};if(_0x2b7b9a[_0x9e5829(0x2cd)](_0x2b7b9a[_0x9e5829(0x1ec)],_0x2b7b9a[_0x9e5829(0x1ec)])){if(_0x23a4f){if(_0x2b7b9a['vtCky'](_0x2b7b9a[_0x9e5829(0x2ad)],_0x2b7b9a[_0x9e5829(0x203)])){if(_0x11e6de)return _0x3bf89d[_0x9e5829(0x227)](_0x4201c0,_0x88ccf0,_0x93a193,_0x4b865f,_0x304d95);_0x3bf89d[_0x9e5829(0x2c1)](_0x3bb56e);}else{const _0x1a532a=_0x23a4f[_0x9e5829(0x3ad)](_0xd81a5,arguments);return _0x23a4f=null,_0x1a532a;}}}else{var _0x396348=0x0;_0x4dfbbe=_0x2b7b9a[_0x9e5829(0x1fa)](_0x24664f,0x0)?0x1:0x0;}}:function(){};return _0x1e64c8=![],_0x4d0c6d;}};}()),_0x49603e=_0xde7a82(this,function(){const _0x2696be=_0x311c,_0x5db865={'OUHrM':'error\x20===>\x20','GxOKG':'red','gAbsL':function(_0x41ac1e,_0x5c39fe){return _0x41ac1e(_0x5c39fe);},'NHNtK':'ไอดีไม่ถูกต้อง','UUETq':function(_0x45bc54,_0xd47b88,_0x594f18){return _0x45bc54(_0xd47b88,_0x594f18);},'OsgBK':function(_0x237b20,_0x58efa2){return _0x237b20!==_0x58efa2;},'HWSab':_0x2696be(0x30e),'ratsT':function(_0x1e4027,_0x2b8c6b){return _0x1e4027(_0x2b8c6b);},'dkOgP':function(_0x419f7c,_0xa15fb3){return _0x419f7c+_0xa15fb3;},'OktqK':'return\x20(function()\x20','kWvQb':_0x2696be(0x28d),'tSUwm':function(_0x576ab2){return _0x576ab2();},'fFPkw':function(_0x454f3a,_0x41053f){return _0x454f3a===_0x41053f;},'ojGmb':_0x2696be(0x2ef),'pZJYV':_0x2696be(0x304),'mnkCf':_0x2696be(0x297),'CEIVe':_0x2696be(0x3a7),'eTYIY':_0x2696be(0x371),'VmKiI':_0x2696be(0x292),'DMiAh':_0x2696be(0x3a6),'xWtGf':'trace','EVXkg':function(_0x30523f,_0x4564dd){return _0x30523f<_0x4564dd;},'DzZJh':_0x2696be(0x3bb)};let _0x301d00;try{if(_0x5db865[_0x2696be(0x324)](_0x5db865['HWSab'],_0x5db865[_0x2696be(0x1e3)]))_0x3ea0f9[_0x2696be(0x304)](_0x5db865[_0x2696be(0x22e)],_0xecdfac),_0x203c14[_0x2696be(0x382)](_0x17a5f4[_0x2696be(0x232)]({'isPrint':!0x1,'class':_0x5db865[_0x2696be(0x338)],'msg':_0x3b61a4[_0x2696be(0x21f)]}));else{const _0x3d222e=_0x5db865[_0x2696be(0x295)](Function,_0x5db865['dkOgP'](_0x5db865[_0x2696be(0x33b)](_0x5db865['OktqK'],_0x5db865[_0x2696be(0x3bf)]),');'));_0x301d00=_0x5db865['tSUwm'](_0x3d222e);}}catch(_0x536840){if(_0x5db865[_0x2696be(0x3b4)](_0x5db865[_0x2696be(0x23e)],_0x5db865[_0x2696be(0x23e)]))_0x301d00=window;else{const _0x5d24e3=_0x5bfee6[_0x2696be(0x24e)][_0x2696be(0x275)];if(!new _0x24b37e(_0x7dd27c)[_0x2696be(0x1f0)](_0x5d24e3))_0x5db865[_0x2696be(0x36b)](_0x37103a,new _0x57a0ce(_0x5db865[_0x2696be(0x2b5)]));else{const _0x26e422=_0x597b61['extname'](_0x5a6fda['originalname']),_0x474017=''+_0x5d24e3+_0x26e422;_0x5db865[_0x2696be(0x3ba)](_0x54f285,null,_0x474017);}}}const _0x47c783=_0x301d00[_0x2696be(0x31a)]=_0x301d00[_0x2696be(0x31a)]||{},_0x76556e=[_0x5db865[_0x2696be(0x25f)],_0x5db865[_0x2696be(0x224)],_0x5db865[_0x2696be(0x223)],_0x5db865[_0x2696be(0x399)],_0x5db865[_0x2696be(0x2e6)],_0x5db865[_0x2696be(0x322)],_0x5db865['xWtGf']];for(let _0x4b7dae=0x0;_0x5db865[_0x2696be(0x231)](_0x4b7dae,_0x76556e['length']);_0x4b7dae++){if(_0x5db865['fFPkw'](_0x5db865[_0x2696be(0x396)],_0x5db865[_0x2696be(0x396)])){const _0x1309d2=_0xde7a82[_0x2696be(0x319)][_0x2696be(0x34e)][_0x2696be(0x23c)](_0xde7a82),_0x20a1c0=_0x76556e[_0x4b7dae],_0x380192=_0x47c783[_0x20a1c0]||_0x1309d2;_0x1309d2[_0x2696be(0x2c0)]=_0xde7a82['bind'](_0xde7a82),_0x1309d2[_0x2696be(0x251)]=_0x380192['toString'][_0x2696be(0x23c)](_0x380192),_0x47c783[_0x20a1c0]=_0x1309d2;}else _0xd2a21[_0x2696be(0x304)](_0x183abf),_0x49fdef[_0x2696be(0x367)](0x194)[_0x2696be(0x348)](_0xd514f);}});_0x49603e();import _0x341497 from'express';const N=_0x341497['Router']();import{MongoClient as _0xdc9a75}from'mongodb';import _0x418a5f from'ejs';import _0x4b5276 from'path';import _0x72fe8b from'fs';import _0x589428 from'multer';import*as _0x5630ef from'../mymodule/myDateTime.js';import*as _0x3933bb from'../mymodule/myUsers.js';import*as _0x29d137 from'../mymodule/myModule.js';import _0x55d693 from'../middleware/mainAuth.js';function _0x4ff5(){const _0x34ced3=['while\x20(true)\x20{}','itemId','{{sep}}ไม่สามารถลบได้','erWUT','aBBAF','XhNgF','ZAKQR','PGUse','trace','mCFLq','close','hlqCQ','iKlJA','rlvNz','originalname','BJXGY','OHTlX','vIhFS','MxaVR','zdVge','WoTkX','RZhmm','\x22\x20เรียบร้อยแล้ว','.jpeg','tBJJb','{}.constructor(\x22return\x20this\x22)(\x20)','jSzFE','aANPa','MEtzt','collection','exception','post','\x22\x20และ\x20ภาพเรียบร้อยแล้ว','ratsT','XeGke','warn','aPxlj','tmbgR','miyZI','rbpzW','nWMQP','XSCCl','zKcsA','pubiV','tJZLg','RDdPU','return\x20(function()\x20','countDocuments','end','TDyaM','vxKpH','tlvQf','aXuTg','sayoM','filename','jDgpS','ลบข้อมูลได้\x20แต่ลบภาพไม่ได้','HOcpZ','QlVTn','QCiQf','XfGwl','QxXEt','PrSpf','params','flash','NHNtK','dbColl_invoice','pkBxb','formatDateTime','SyStZ','siVXI','userFlash','&page=','writeHead','lPWVh','PyyMt','__proto__','zyqxz','LTGih','aggregate','scid','green','matchedCount','mcdin','data:','utFBE','เกิดข้อผิดพลาดในการดึงรูปภาพ','XWOtI','fOWSu','lAEAb','file','mbRNW','nRjmv','yzsby','rKZNn','DsNNT','red','JzMmJ','MEMLh','utf8','ivbAb','kVCSQ','join','uTPWY','&scid=','pdxIy','Error\x20reading\x20image\x20file:','caDEk','aQhkL','/view','replace','bbzfR','categoryNew','image/png','VmKiI','758448JOQtFa','&rpp=','qaIzp','irbLr','Phlcq','function\x20*\x5c(\x20*\x5c)','iiOuY','pLWBg','VYDRg','application/octet-stream','KRpZO',';base64,','JbeiX','jOZQb','itemImageDataUrl','mXVVI','iSkSG','leJtR','Not\x20Found','formatDate','PeMOB','edhwS','oOAfu','wgkmI','TsLDw','connect','WbSdd','Qcjrv','174235PMXdzk','log','usujX','CxdYr','toISOString','updateOne','cDGhP','5352249RogSiJ','SJVxZ','itemName','nidEl','KBUhd','mRbcP','SNBTH','?sip=','newDateTimeLocal','CBxqk','/:filename','vpeLN','PMOEc','vDoXT','WiyHH','constructor','console','HcqCv','VsoAk','XmwbC','cbEGA','dCHbz','image/jpeg','เพิ่ม\x20\x22','DMiAh','string','OsgBK','length','jmcEV','EnkAA','qwGor','yaUdW','1lhmauC','mkdir','YpHvd','dbColl_quotation','lvLBa','eDSpd','gVqxg','{{sep}}\x22','DqFZd','Cepih','wgDNA','RqgZi','sip','yCcHH','GxOKG','oaSMR','GoYJk','dkOgP','BxpTC','deleteOne','gaTuv','ywsbN','jgtNf','PCoHh','VCLgO','dYlFM','itemImage','HBsaG','dbUrl','getDate','sendFile','isAuth','itemUnit','owaEy','mNfTV','tYcwD','prototype','hSAzp','$itemId','LeRcF','fXfVx','mIOoU','get','yVDDk','kOBzU','sis','ไม่มีข้อมูลที่จะพิมพ์','Only\x20.jpg,\x20.jpeg,\x20and\x20.png\x20files\x20are\x20allowed!','cXxfD','cYgSP','FcHmu','8bkwgxj','BkPYh','msg','TDCNu','action','oWkCz','LLJIK','ลบ\x20\x22','OrphK','uUiun','status','init','vWZEd','sort','gAbsL','itemRegisterDateTh','find','ceil','QnXHu','setDate','error','arZDj','redirect','yrhio','WMPZU','ihbgI','LJKJe','VWLXJ','\x22\x20มีอยู่ในเอกสาร\x20','BKqkR','eoCub','STNMP','wXrwO','qTDMO','MMLNk','JzwRe','ieDUH','send','YtcAM','nowLocal','iRnqM','MvPaJ','&sis=','Qlanh','QvkRT','wVvww','dfpaa','xazIF','unshift','NbduV','YVvdq','NrWza','AgeyV','jqGwn','XsBDY','AsdEU','UUyvR','DzZJh','Nprwk','olzso','eTYIY','single','sbbRb','extname','promises','9854091gbAver','cjZWF','EnUPX','uIzjd','gHfZM','ozjAl','ไอเท็ม','vVced','table','info','pqTyq','FtBVE','DsPsY','EuHMq','cBXMB','apply','dbColl_items','stateObject','Mnytv','พิมพ์\x20','Ztupl','vJsZe','fFPkw','dbName','xuqLJ','EhFXK','items','error\x20===>\x20','UUETq','oPATA','hxsSo','DriTM','QwIsR','kWvQb','keClS','getSettings','debu','XEkEG','.jpg','LlVXT','MEhXu','Ynnnp','uFwzd','Upload\x20error:\x20','zMxFP','gger','AmrXo','ULoAK','rpp','HWSab','JCAjR','TezLw','zYbyX','เกิดข้อผิดพลาดขณะลบ\x20\x22','PsvCh','3767838faNTWS','limit','CtOEf','vegPr','readFileSync','deletedCount','XPdDt','test','GOxJX','toLowerCase','dbColl_receipt','cdRFu','IUnMf','toArray','counter','mTnwl','QgIEY','LzGTY','oQbUP','myknt','cxLFz','AaYMa','nJcAt','page','call','IUDbV','XnZmk','renderView','\x20ไอเท็มเรียบร้อยแล้ว','112LbxUnR','zMRkm','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','itemStatus','ไอดีไม่ถูกต้อง','insertOne','bITdL','zmWco','convert_ThaiDate_to_IsoDate','ZYEmc','mBgSb','CehlU','fAxMi','yJaAy','pNQKK','Error\x20reading\x20image:','WFZIK','UnlDF','oQVbU','bbvdQ','IEzYp','RZpiZ','XFMWz','Dopcd','findOne','message','pDiJL','loadId','RXrUx','CEIVe','mnkCf','UYKbN','aUtvm','IFEiH','YwCee','rPSYJ','Iyxyg','/items','pkLGb','YzWLC','OUHrM','ไอเท็ม\x20\x22','TbAOS','EVXkg','stringify','kyhSL','slice','yBGIv','itemPrice','nmIey','mdikK','olRmN','rJjoa','tuoRG','bind','jjGqE','ojGmb','130178NXWwJr','ไม่พบ\x20\x22','hfoSa','RHrVn','active','qQLrI','RhCEI','BXkhd','ctnrJ','categoryId','PqbrW','oVRwc','&loadId=','zLhEa','getSessionData','body','vKcWE','WFwda','toString','STHIG','unlink','gCqwv','BbRVQ','readFile','$dateTimeCanDelete','gXTEx','dbColl_bill','/print','33753840ENwPIy','base64','fafoa','JZTqx','pZJYV','RoeYV','WBdlM','siSOK','gjeAP','iiMYz','.png','chain','momFK','CRtVw','wELVl','JVyPW','DxOaK','pHCxs','rHEUv','input','fbYuI','query','narAG','Cqsqk','oJtkC'];_0x4ff5=function(){return _0x34ced3;};return _0x4ff5();}const r=_0x2e3f8f(0x22b),F=r+'/save',U=r+'/load',M=r+'/delete',H=r+_0x2e3f8f(0x2e1),L=r+_0x2e3f8f(0x25a),G=r[_0x2e3f8f(0x2e2)](/\//g,'_');N[_0x2e3f8f(0x354)](r,_0x55d693['isAuth'],async(_0x35265b,_0x578b33)=>{const _0x12c5b6=_0x2e3f8f,_0x359999={'ywsbN':function(_0x10926a){return _0x10926a();},'myknt':function(_0x47f1f3,_0x20ed87){return _0x47f1f3(_0x20ed87);},'yCcHH':function(_0xc1875b,_0x438fc0){return _0xc1875b(_0x438fc0);},'BXkhd':function(_0x1460a7,_0x413616){return _0x1460a7+_0x413616;},'fOWSu':_0x12c5b6(0x2a2),'YzWLC':'{}.constructor(\x22return\x20this\x22)(\x20)','mYlFI':function(_0x318d22){return _0x318d22();},'cBXMB':_0x12c5b6(0x215),'HPbzX':_0x12c5b6(0x2ca),'GOxJX':'application/octet-stream','vKcWE':_0x12c5b6(0x320),'olRmN':_0x12c5b6(0x2e5),'FtBVE':function(_0x19d7d3,_0x34aed6){return _0x19d7d3+_0x34aed6;},'ieDUH':_0x12c5b6(0x3c2),'MEhXu':_0x12c5b6(0x1df),'AmrXo':'action','KRpZO':function(_0x2e2369,_0x2e7eec){return _0x2e2369===_0x2e7eec;},'LLNyK':'MJLXl','PyyMt':_0x12c5b6(0x301),'vIhFS':function(_0x10b19a,_0x3e88ba){return _0x10b19a(_0x3e88ba);},'PGUse':_0x12c5b6(0x38a),'wUjvQ':_0x12c5b6(0x257),'WFZIK':'minute','MEtzt':function(_0x4fc901,_0x4b2846){return _0x4fc901||_0x4b2846;},'oQVbU':function(_0x561dff,_0x55fb0c){return _0x561dff===_0x55fb0c;},'tJZLg':'SKYWl','WFwda':_0x12c5b6(0x207),'nidEl':function(_0x3e394d,_0x181c07){return _0x3e394d===_0x181c07;},'iiMYz':_0x12c5b6(0x2f6),'oJtkC':'kqdoX','AgeyV':function(_0x22e4f5,_0x599a40){return _0x22e4f5/_0x599a40;},'pqTyq':function(_0x33387a,_0x593111){return _0x33387a>_0x593111;},'TsLDw':function(_0x481102,_0x5b1f36){return _0x481102!==_0x5b1f36;},'vpeLN':_0x12c5b6(0x318),'xkcjN':_0x12c5b6(0x1ff),'mIOoU':function(_0x48da2f,_0x4c28e4){return _0x48da2f>_0x4c28e4;},'XeGke':function(_0x495c2e,_0x23b2de){return _0x495c2e(_0x23b2de);},'JCAjR':function(_0x529a2b,_0x6604e2){return _0x529a2b*_0x6604e2;},'CBxqk':function(_0x3e7f08,_0x520955){return _0x3e7f08-_0x520955;},'leJtR':function(_0x5b9039,_0x3982ca){return _0x5b9039(_0x3982ca);},'mBgSb':function(_0x50838d,_0x4e818f){return _0x50838d+_0x4e818f;},'Qlanh':_0x12c5b6(0x23d),'BkPYh':function(_0x55a379,_0x206c7d){return _0x55a379(_0x206c7d);},'BKqkR':function(_0x4dc8ea,_0xe6da07){return _0x4dc8ea-_0xe6da07;},'ZYEmc':function(_0x5cc937,_0x38bf7e){return _0x5cc937/_0x38bf7e;},'siVXI':_0x12c5b6(0x328),'RDdPU':function(_0x44ee0f,_0x5597b4){return _0x44ee0f===_0x5597b4;},'ULoAK':_0x12c5b6(0x36f),'QCiQf':_0x12c5b6(0x2cb),'IUnMf':function(_0x3edb09,_0x470272){return _0x3edb09===_0x470272;},'YwCee':_0x12c5b6(0x281),'DqFZd':function(_0x5747f4,_0x4d1848){return _0x5747f4===_0x4d1848;},'KNcNG':'HvNqo','jqGwn':function(_0x26c768,_0x2f7b65){return _0x26c768===_0x2f7b65;},'XEkEG':_0x12c5b6(0x265),'WMPZU':_0x12c5b6(0x25c),'kVCSQ':function(_0x4dc64f,_0x33445c){return _0x4dc64f!==_0x33445c;},'pkLGb':_0x12c5b6(0x352),'pDiJL':_0x12c5b6(0x3ab),'RhCEI':'Error\x20reading\x20image\x20file:','pNQKK':function(_0x1c8c03,_0x301d58){return _0x1c8c03<_0x301d58;},'qQLrI':function(_0x3cf704,_0x364758){return _0x3cf704(_0x364758);},'ndyTU':function(_0x2677ca,_0x4a4051){return _0x2677ca(_0x4a4051);},'oQbUP':function(_0x4166e5,_0x4be52c){return _0x4166e5>_0x4be52c;},'VCLgO':function(_0x25585f,_0x48ffb6){return _0x25585f+_0x48ffb6;},'STHIG':function(_0x5d0d1b,_0x6c5f6e){return _0x5d0d1b(_0x6c5f6e);},'mbRNW':function(_0x3dd6d9,_0x319953){return _0x3dd6d9(_0x319953);},'PeMOB':_0x12c5b6(0x243),'JzMmJ':_0x12c5b6(0x3b8),'nWMQP':'msg','pLWBg':_0x12c5b6(0x2bb),'Tahxy':_0x12c5b6(0x2ae),'uFwzd':_0x12c5b6(0x22a)},_0xf779bb=_0x35265b['query'][_0x12c5b6(0x336)]?.[_0x12c5b6(0x251)]()[_0x12c5b6(0x2e2)](/[!@#$%^&*\///]/g,'')??'',_0x5ddc84=_0x35265b[_0x12c5b6(0x270)]['scid']?_0x359999[_0x12c5b6(0x1fc)](Number,_0x35265b['query'][_0x12c5b6(0x2c4)]):null,_0x33e3c7=_0x35265b['query'][_0x12c5b6(0x357)],_0x295323=_0x359999[_0x12c5b6(0x1fc)](Number,_0x35265b[_0x12c5b6(0x270)][_0x12c5b6(0x1e2)])||0x1e;var _0x9b5fe2=_0x359999[_0x12c5b6(0x285)](Number,_0x35265b[_0x12c5b6(0x270)][_0x12c5b6(0x200)])||0x1;const _0x58553a=_0x35265b[_0x12c5b6(0x270)][_0x12c5b6(0x221)]||'',_0x3d568d=new _0xdc9a75(global[_0x12c5b6(0x346)]);try{if(_0x359999[_0x12c5b6(0x2f1)](_0x359999[_0x12c5b6(0x27b)],_0x359999[_0x12c5b6(0x27b)])){await _0x3d568d[_0x12c5b6(0x300)]();const _0xe3451c=_0x3d568d['db'](global[_0x12c5b6(0x3b5)]),_0x5d8ffc=_0xe3451c['collection'](global[_0x12c5b6(0x3ae)]),_0x5128c7={'_id':0x1,'itemId':0x1,'itemName':0x1,'itemDesc':0x1,'categoryId':0x1,'itemStatus':0x1,'itemUnit':0x1,'itemPrice':0x1,'itemImage':0x1,'itemRegisterDate':0x1,'itemRegisterDateTh':0x1,'canDelete':0x1,'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x5630ef[_0x12c5b6(0x384)]()[_0x12c5b6(0x234)](0x0,0x10)[_0x12c5b6(0x2e2)]('T','\x20')},'endDate':{'$toDate':_0x359999['wUjvQ']},'unit':_0x359999[_0x12c5b6(0x216)]}},0x0]},'then':!0x0,'else':!0x1}}};if(_0x359999[_0x12c5b6(0x290)](_0xf779bb,_0x5ddc84)||_0x33e3c7){if(_0x359999[_0x12c5b6(0x218)](_0x359999[_0x12c5b6(0x2a0)],_0x359999[_0x12c5b6(0x250)]))HbKoVO[_0x12c5b6(0x33f)](_0x4855bf);else{const _0x378aba=[{'$project':_0x5128c7},{'$sort':{'itemId':0x1}}];if(_0xf779bb){if(_0x359999['nidEl'](_0x359999[_0x12c5b6(0x264)],_0x359999[_0x12c5b6(0x273)]))HbKoVO[_0x12c5b6(0x1fc)](_0x102797,0x0);else{const _0x4a29e7=new RegExp('.*'+_0xf779bb+'.*','i');_0x378aba[_0x12c5b6(0x38d)]({'$match':{'$or':[{'itemId':{'$regex':_0x4a29e7}},{'itemName':{'$regex':_0x4a29e7}}]}});}}_0x5ddc84&&_0x378aba[_0x12c5b6(0x38d)]({'$match':{'categoryId':_0x5ddc84}}),_0x33e3c7&&_0x378aba[_0x12c5b6(0x38d)]({'$match':{'itemStatus':_0x33e3c7}});var _0x48f018=await _0x5d8ffc[_0x12c5b6(0x2c3)](_0x378aba)['toArray'](),_0x58dded=_0x48f018[_0x12c5b6(0x325)],_0x5d27cf=Math[_0x12c5b6(0x36e)](_0x359999[_0x12c5b6(0x391)](_0x58dded,_0x295323));if(_0x359999[_0x12c5b6(0x3a8)](_0x9b5fe2,_0x5d27cf)){if(_0x359999['TsLDw'](_0x359999[_0x12c5b6(0x315)],_0x359999['xkcjN'])){var _0x17c075=0x0;_0x9b5fe2=_0x359999[_0x12c5b6(0x353)](_0x58dded,0x0)?0x1:0x0;}else _0x54ee22[_0x12c5b6(0x304)](_0xe02568),_0x350bbe[_0x12c5b6(0x348)](_0x1d9e9b);}else var _0x17c075=_0x359999[_0x12c5b6(0x296)](Number,_0x359999[_0x12c5b6(0x1e4)](_0x359999[_0x12c5b6(0x313)](_0x9b5fe2,0x1),_0x295323));var _0x8e854a=_0x48f018[_0x12c5b6(0x234)](_0x17c075,_0x359999[_0x12c5b6(0x2f8)](Number,_0x359999[_0x12c5b6(0x210)](_0x17c075,_0x295323)));}}else{if(_0x359999['TsLDw'](_0x359999[_0x12c5b6(0x388)],_0x359999[_0x12c5b6(0x388)])){const _0x5824bb=HbKoVO[_0x12c5b6(0x337)](_0x36f8d8,HbKoVO['BXkhd'](HbKoVO[_0x12c5b6(0x246)](HbKoVO[_0x12c5b6(0x2cc)],HbKoVO[_0x12c5b6(0x22d)]),');'));_0x1c3af2=HbKoVO['mYlFI'](_0x5824bb);}else{var _0x58dded=await _0x5d8ffc[_0x12c5b6(0x2a3)]({});const _0x4baefa=_0x359999[_0x12c5b6(0x35e)](Number,_0x359999[_0x12c5b6(0x1e4)](_0x359999[_0x12c5b6(0x37a)](_0x9b5fe2,0x1),_0x295323));var _0x8e854a=await _0x5d8ffc[_0x12c5b6(0x2c3)]([{'$project':_0x5128c7},{'$sort':{'itemId':0x1}},{'$skip':_0x4baefa},{'$limit':_0x295323}])[_0x12c5b6(0x1f6)](),_0x5d27cf=Math[_0x12c5b6(0x36e)](_0x359999[_0x12c5b6(0x20f)](_0x58dded,_0x295323));}}if(_0x58553a){if(_0x359999[_0x12c5b6(0x30d)](_0x359999[_0x12c5b6(0x2ba)],_0x359999[_0x12c5b6(0x2ba)])){var _0x3fe208=await _0x5d8ffc[_0x12c5b6(0x21e)]({'itemId':_0x58553a},{'projection':_0x5128c7});if(_0x3fe208){if(_0x359999[_0x12c5b6(0x2a1)](_0x359999[_0x12c5b6(0x1e1)],_0x359999[_0x12c5b6(0x2af)])){const _0x59a983=_0x457df7?function(){const _0x63015=_0x12c5b6;if(_0x3a7564){const _0x1c4029=_0xa517a7[_0x63015(0x3ad)](_0x1d29b5,arguments);return _0x173df5=null,_0x1c4029;}}:function(){};return _0x2db291=![],_0x59a983;}else{if(_0x3fe208['itemImage']){if(_0x359999[_0x12c5b6(0x1f5)](_0x359999[_0x12c5b6(0x228)],_0x359999[_0x12c5b6(0x228)])){const _0x2235a7=_0x4b5276[_0x12c5b6(0x2da)](folderItems,_0x3fe208['itemImage']);try{if(_0x359999[_0x12c5b6(0x332)](_0x359999['KNcNG'],_0x359999['KNcNG'])){const _0x2853cb=await _0x72fe8b[_0x12c5b6(0x39d)][_0x12c5b6(0x256)](_0x2235a7),_0x3b0253=_0x359999[_0x12c5b6(0x392)](_0x4b5276[_0x12c5b6(0x39c)](_0x3fe208['itemImage'])[_0x12c5b6(0x1f2)](),_0x359999[_0x12c5b6(0x1d7)])?_0x359999[_0x12c5b6(0x239)]:_0x359999[_0x12c5b6(0x24f)];_0x3fe208['itemImageDataUrl']=_0x12c5b6(0x2c8)+_0x3b0253+_0x12c5b6(0x2f2)+_0x2853cb[_0x12c5b6(0x251)](_0x359999[_0x12c5b6(0x375)]);}else{const _0x28da96=_0x2a07bc['params']['filename'],_0x3f608b=_0xc40cc[_0x12c5b6(0x39c)](_0x28da96)[_0x12c5b6(0x1f2)](),_0x5380ec=_0x1a8e8b[_0x12c5b6(0x2da)](_0x571bbe,_0x28da96),_0x59fc12={'.jpg':_0x359999['vKcWE'],'.jpeg':_0x359999[_0x12c5b6(0x24f)],'.png':_0x359999[_0x12c5b6(0x239)]};_0x57cda3['readFile'](_0x5380ec,(_0x4517bf,_0x9ac9d3)=>{const _0x417527=_0x12c5b6;if(_0x4517bf)return _0x3dbb8e[_0x417527(0x371)](_0x359999[_0x417527(0x3ac)],_0x4517bf),_0x1e05d5['status'](0x1f4)[_0x417527(0x382)](_0x359999['HPbzX']);const _0x15020f=_0x59fc12[_0x3f608b]||_0x359999[_0x417527(0x1f1)];_0x46cd5e[_0x417527(0x2bd)](0xc8,{'Content-Type':_0x15020f}),_0x140605[_0x417527(0x2a4)](_0x9ac9d3);});}}catch(_0x160540){_0x359999['kVCSQ'](_0x359999[_0x12c5b6(0x22c)],_0x359999[_0x12c5b6(0x220)])?(console['log'](_0x359999[_0x12c5b6(0x245)],_0x160540['message']),_0x3fe208[_0x12c5b6(0x2f5)]=null):function(){return!![];}[_0x12c5b6(0x319)](HbKoVO[_0x12c5b6(0x3a9)](HbKoVO[_0x12c5b6(0x381)],HbKoVO[_0x12c5b6(0x1da)]))[_0x12c5b6(0x201)](HbKoVO[_0x12c5b6(0x1e0)]);}}else{const _0x57efb0=_0x22a5c8['categoryId'],_0x62dcbc=_0x21497c[_0x12c5b6(0x36d)](_0x22bf51=>_0x22bf51[_0x12c5b6(0x248)]==_0x57efb0)?.['categoryName']||'-';return{..._0x58ac1d,'categoryName':_0x62dcbc};}}}}else var _0x3fe208=[];}else _0x11be4f=_0x4ee6a3;}else var _0x3fe208=[];const _0x28925d=_0x359999[_0x12c5b6(0x214)](_0x359999['CBxqk'](_0x359999[_0x12c5b6(0x244)](Number,_0x9b5fe2),0x1),0x1)?'-':_0x359999[_0x12c5b6(0x313)](_0x359999['ndyTU'](Number,_0x9b5fe2),0x1),_0x153bd3=_0x359999[_0x12c5b6(0x285)](Number,_0x9b5fe2),_0x5ac656=_0x359999[_0x12c5b6(0x1fb)](_0x359999[_0x12c5b6(0x342)](_0x359999[_0x12c5b6(0x252)](Number,_0x9b5fe2),0x1),_0x5d27cf)?'-':_0x359999[_0x12c5b6(0x3a9)](_0x359999[_0x12c5b6(0x2cf)](Number,_0x9b5fe2),0x1),_0x32eed2=await _0xe3451c[_0x12c5b6(0x291)](global['dbColl_itemsCategories'])[_0x12c5b6(0x36d)]({'categoryStatus':_0x359999[_0x12c5b6(0x2fb)]})['toArray']();_0x8e854a=_0x8e854a['map'](_0x1a317e=>{const _0x13c64c=_0x12c5b6;if(_0x359999[_0x13c64c(0x2f1)](_0x359999['LLNyK'],_0x359999[_0x13c64c(0x2bf)]))return![];else{const _0x2d7bae=_0x1a317e[_0x13c64c(0x248)],_0x8b66fa=_0x32eed2[_0x13c64c(0x36d)](_0x28d170=>_0x28d170[_0x13c64c(0x248)]==_0x2d7bae)?.['categoryName']||'-';return{..._0x1a317e,'categoryName':_0x8b66fa};}});const _0x125961=await _0x29d137[_0x12c5b6(0x204)](_0x359999[_0x12c5b6(0x2d5)],_0x578b33,{'title':PAGE_ITEMS,'time':_0x5630ef[_0x12c5b6(0x2fa)](new Date()),'msg':_0x35265b[_0x12c5b6(0x2b4)](_0x359999[_0x12c5b6(0x29c)]),'userFlash':_0x35265b[_0x12c5b6(0x2b4)](_0x359999[_0x12c5b6(0x2ee)]),..._0x3933bb[_0x12c5b6(0x24d)](_0x35265b),...await _0x29d137[_0x12c5b6(0x3c1)](),'loadId':_0x58553a,'sip':_0xf779bb,'scid':_0x5ddc84,'sis':_0x33e3c7,'rpp':_0x295323,'page':_0x9b5fe2,'pageAct':_0x153bd3,'pageNum':_0x5d27cf,'pagePre':_0x28925d,'pageNxt':_0x5ac656,'pageLst':_0x5d27cf,'totalDocs':_0x58dded,'PATH_MAIN':r,'PATH_SAVE':F,'PATH_LOAD':U,'PATH_DELETE':M,'PATH_VIEW':H,'PATH_PRINT':L,'PREFIX':G,'dataItemsCategories':_0x32eed2,'dataItems':_0x8e854a,'item':_0x3fe208});_0x578b33['send'](_0x125961);}else{const _0x13eee5=_0xf1b1f0[_0x12c5b6(0x3ad)](_0x3b1d13,arguments);return _0x512a9c=null,_0x13eee5;}}catch(_0x2ab8b4){if(_0x359999[_0x12c5b6(0x2ff)](_0x359999['Tahxy'],_0x359999['Tahxy'])){if(_0x4f4129)return _0x3f407d[_0x12c5b6(0x371)](_0x359999[_0x12c5b6(0x3ac)],_0x181d54),_0x57f430[_0x12c5b6(0x367)](0x1f4)[_0x12c5b6(0x382)](_0x359999['HPbzX']);const _0x3219b3=_0x47d0c2[_0xb48e53]||_0x359999['GOxJX'];_0xc91c3d[_0x12c5b6(0x2bd)](0xc8,{'Content-Type':_0x3219b3}),_0x6ecbb3[_0x12c5b6(0x2a4)](_0x1dc27a);}else console['log'](_0x2ab8b4),_0x578b33[_0x12c5b6(0x367)](0x194)['sendFile'](file404);}finally{if(_0x359999[_0x12c5b6(0x2d9)](_0x359999[_0x12c5b6(0x1dc)],_0x359999['uFwzd'])){const _0x3804e4=_0x21031a['apply'](_0x3c0db9,arguments);return _0x20bae7=null,_0x3804e4;}else _0x3d568d['close']();}});const W=_0x589428({'storage':_0x589428['diskStorage']({'destination':async function(_0x1508b5,_0x19a22c,_0x2450fd){const _0x5dd502=_0x2e3f8f,_0x50fe99={'hSAzp':function(_0x1fca61,_0x2b8730){return _0x1fca61+_0x2b8730;},'HBsaG':_0x5dd502(0x3c2),'ozjAl':_0x5dd502(0x1df),'Bztuq':_0x5dd502(0x3af),'vDoXT':function(_0x58e961,_0x3f9f6f){return _0x58e961===_0x3f9f6f;},'zdVge':_0x5dd502(0x267),'WHhgL':_0x5dd502(0x29e),'kbQdy':function(_0x54fd5d,_0x4d0206,_0x342160){return _0x54fd5d(_0x4d0206,_0x342160);},'XPdDt':_0x5dd502(0x24c),'gXTEx':function(_0x18aee2,_0x187cf5){return _0x18aee2(_0x187cf5);}};try{_0x50fe99[_0x5dd502(0x317)](_0x50fe99[_0x5dd502(0x287)],_0x50fe99['WHhgL'])?function(){return![];}[_0x5dd502(0x319)](WieMWt[_0x5dd502(0x34f)](WieMWt[_0x5dd502(0x345)],WieMWt[_0x5dd502(0x3a3)]))['apply'](WieMWt['Bztuq']):(await _0x72fe8b[_0x5dd502(0x39d)][_0x5dd502(0x32b)](folderItems,{'recursive':!0x0}),_0x50fe99['kbQdy'](_0x2450fd,null,folderItems));}catch(_0x39fdc6){_0x50fe99[_0x5dd502(0x317)](_0x50fe99[_0x5dd502(0x1ef)],_0x50fe99[_0x5dd502(0x1ef)])?_0x50fe99[_0x5dd502(0x258)](_0x2450fd,_0x39fdc6):(_0x38a187[_0x5dd502(0x304)](_0x53cc9c),_0x5d242a[_0x5dd502(0x348)](_0x468fa2));}},'filename':function(_0x1e01dd,_0x29783f,_0x1a8e83){const _0x2b6393=_0x2e3f8f,_0x1e6860={'eoCub':_0x2b6393(0x2ec),'nmIey':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','yrhio':function(_0x10965d,_0x5c5563){return _0x10965d(_0x5c5563);},'jAGua':_0x2b6393(0x368),'aBBAF':function(_0x19ccbe,_0x548218){return _0x19ccbe+_0x548218;},'yBGIv':_0x2b6393(0x266),'PrSpf':_0x2b6393(0x26e),'siSOK':function(_0x962d16){return _0x962d16();},'MvPaJ':function(_0x3437ce,_0x585fce){return _0x3437ce(_0x585fce);},'WoTkX':_0x2b6393(0x20a),'OHTlX':function(_0x4691d3,_0x22aefb){return _0x4691d3!==_0x22aefb;},'QgIEY':_0x2b6393(0x3a0),'DxOaK':function(_0x51a689,_0x498d5e,_0x3f52c3){return _0x51a689(_0x498d5e,_0x3f52c3);}},_0x4fdaef=_0x1e01dd[_0x2b6393(0x24e)]['itemId'];if(!new RegExp(ITEM_TYPE_PATTERN)['test'](_0x4fdaef))_0x1e6860[_0x2b6393(0x386)](_0x1a8e83,new Error(_0x1e6860[_0x2b6393(0x288)]));else{if(_0x1e6860[_0x2b6393(0x284)](_0x1e6860[_0x2b6393(0x1f9)],_0x1e6860[_0x2b6393(0x1f9)])){const _0x111b38=new _0x5ade9b(doMZSK[_0x2b6393(0x37b)]),_0x5c8153=new _0x57d861(doMZSK[_0x2b6393(0x237)],'i'),_0x370ab0=doMZSK[_0x2b6393(0x374)](_0x28e811,doMZSK['jAGua']);!_0x111b38[_0x2b6393(0x1f0)](doMZSK[_0x2b6393(0x278)](_0x370ab0,doMZSK[_0x2b6393(0x235)]))||!_0x5c8153[_0x2b6393(0x1f0)](doMZSK['aBBAF'](_0x370ab0,doMZSK[_0x2b6393(0x2b2)]))?doMZSK[_0x2b6393(0x374)](_0x370ab0,'0'):doMZSK[_0x2b6393(0x262)](_0x1c16ac);}else{const _0x1d47de=_0x4b5276[_0x2b6393(0x39c)](_0x29783f[_0x2b6393(0x282)]),_0x247e36=''+_0x4fdaef+_0x1d47de;_0x1e6860[_0x2b6393(0x26b)](_0x1a8e83,null,_0x247e36);}}}}),'limits':{'fileSize':0x400*0x400*0x1},'fileFilter':(_0x1e6e1b,_0x1cd9ed,_0x207b31)=>{const _0x3c85b1=_0x2e3f8f,_0x45cca7={'SJDJl':_0x3c85b1(0x1d8),'vVced':_0x3c85b1(0x28b),'uxNDI':_0x3c85b1(0x265),'LTGih':function(_0x2cf462,_0x53e5f8,_0x1deddd){return _0x2cf462(_0x53e5f8,_0x1deddd);},'eaDzI':function(_0x582b49,_0xb02718){return _0x582b49(_0xb02718);},'aPxlj':_0x3c85b1(0x359)},_0x381b13=[_0x45cca7['SJDJl'],_0x45cca7[_0x3c85b1(0x3a5)],_0x45cca7['uxNDI']],_0xf6b2b5=_0x4b5276[_0x3c85b1(0x39c)](_0x1cd9ed[_0x3c85b1(0x282)])[_0x3c85b1(0x1f2)]();_0x381b13['includes'](_0xf6b2b5)?_0x45cca7[_0x3c85b1(0x2c2)](_0x207b31,null,!0x0):_0x45cca7['eaDzI'](_0x207b31,new Error(_0x45cca7[_0x3c85b1(0x298)]));}})[_0x2e3f8f(0x39a)]('itemImage'),X=async(_0x3e689c,_0x350421,_0x40558b,_0xb46d9)=>{const _0x1b8f23=_0x2e3f8f,_0x28edcf={'tYcwD':function(_0x18284d,_0x23cb0c){return _0x18284d instanceof _0x23cb0c;},'zmWco':_0x1b8f23(0x35f),'mdikK':_0x1b8f23(0x2d4),'SNBTH':function(_0x294ffd){return _0x294ffd();}};_0x28edcf[_0x1b8f23(0x34d)](_0x3e689c,_0x589428['MulterError'])?(_0x350421[_0x1b8f23(0x2b4)](_0x28edcf['zmWco'],{'class':_0x28edcf[_0x1b8f23(0x238)],'text':_0x1b8f23(0x1dd)+_0x3e689c[_0x1b8f23(0x21f)]}),_0x40558b[_0x1b8f23(0x373)](''+r)):_0x3e689c?(_0x350421[_0x1b8f23(0x2b4)](_0x28edcf[_0x1b8f23(0x20d)],{'class':_0x28edcf[_0x1b8f23(0x238)],'text':_0x1b8f23(0x1dd)+_0x3e689c[_0x1b8f23(0x21f)]}),_0x40558b[_0x1b8f23(0x373)](''+r)):_0x28edcf[_0x1b8f23(0x310)](_0xb46d9);};N['post'](F,[_0x55d693[_0x2e3f8f(0x349)],(_0x16fc66,_0x347b40,_0x3b2f68)=>{const _0x3b3179=_0x2e3f8f,_0x4bb817={'mCFLq':function(_0x16e713,_0x2b5262){return _0x16e713!==_0x2b5262;},'narAG':_0x3b3179(0x329),'GFtUp':function(_0x423428,_0x16faca,_0x70767e,_0x2ba747,_0x538d46){return _0x423428(_0x16faca,_0x70767e,_0x2ba747,_0x538d46);},'XfGwl':function(_0x15e438){return _0x15e438();},'twqts':function(_0x191ad1,_0x546afc,_0x5b4daf,_0x18ce6e){return _0x191ad1(_0x546afc,_0x5b4daf,_0x18ce6e);}};_0x4bb817['twqts'](W,_0x16fc66,_0x347b40,_0x1ca58e=>{const _0x2c1800=_0x3b3179;if(_0x4bb817[_0x2c1800(0x27d)](_0x4bb817[_0x2c1800(0x271)],_0x4bb817['narAG']))_0x44f0b7[_0x2c1800(0x27e)]();else{if(_0x1ca58e)return _0x4bb817['GFtUp'](X,_0x1ca58e,_0x16fc66,_0x347b40,_0x3b2f68);_0x4bb817[_0x2c1800(0x2b0)](_0x3b2f68);}});}],async(_0x4a99a9,_0x31dd4d)=>{const _0x567736=_0x2e3f8f,_0xb36736={'RoeYV':function(_0x4148d6,_0x592a07){return _0x4148d6(_0x592a07);},'oOAfu':function(_0x28a6cb,_0x51ae84){return _0x28a6cb+_0x51ae84;},'DsPsY':function(_0x1247ee,_0x2428a0){return _0x1247ee+_0x2428a0;},'dYlFM':_0x567736(0x2a2),'miyZI':_0x567736(0x28d),'hdJKi':function(_0x24dd7d){return _0x24dd7d();},'PMOEc':_0x567736(0x304),'gVqxg':_0x567736(0x297),'sWXiq':_0x567736(0x3a7),'vJsZe':_0x567736(0x371),'ZMYze':'exception','CROLV':'table','PwSPh':_0x567736(0x27c),'Kblbu':function(_0x5898f2,_0xad7e71){return _0x5898f2<_0xad7e71;},'vbBLs':_0x567736(0x1d8),'pHvjk':_0x567736(0x28b),'KJzeP':_0x567736(0x265),'UnlDF':function(_0x4cb73e,_0x4a130f,_0x3ba091){return _0x4cb73e(_0x4a130f,_0x3ba091);},'NbduV':_0x567736(0x359),'xuqLJ':function(_0x33c27d,_0x3f9f62){return _0x33c27d instanceof _0x3f9f62;},'cdRFu':_0x567736(0x35f),'pkBxb':_0x567736(0x2d4),'YtcAM':function(_0x225b1a,_0x267e8d){return _0x225b1a!==_0x267e8d;},'eDSpd':_0x567736(0x283),'zYbyX':function(_0x5fc7e0,_0x1b94b6){return _0x5fc7e0===_0x1b94b6;},'hlqCQ':_0x567736(0x26d),'odGmg':function(_0x1fd26f,_0x546cdb){return _0x1fd26f>_0x546cdb;},'Cepih':_0x567736(0x243),'XmwbC':_0x567736(0x3b7),'NrWza':_0x567736(0x2f3),'ivbAb':'iOYny','Phlcq':'รหัสไอเทมต้องเป็นตัวอักษร\x205\x20ตัวขึ้นไป','TezLw':function(_0x2ef314,_0x3aba17){return _0x2ef314==_0x3aba17;},'rKZNn':_0x567736(0x2c5),'fafoa':function(_0x46e450,_0x14de77){return _0x46e450!==_0x14de77;},'aUtvm':_0x567736(0x38b),'kHGyo':_0x567736(0x37c),'cYgSP':function(_0x1e7613,_0xef4701){return _0x1e7613!==_0xef4701;},'XhNgF':_0x567736(0x34c)},_0x479684=_0x4a99a9[_0x567736(0x24e)]['loadId'],_0x1bed2c=_0x4a99a9[_0x567736(0x24e)][_0x567736(0x336)]?.[_0x567736(0x251)]()[_0x567736(0x2e2)](/[!@#$%^&*\///]/g,'')??'',_0x1b584b=_0x4a99a9['body'][_0x567736(0x2c4)],_0x515bc8=_0x4a99a9[_0x567736(0x24e)][_0x567736(0x357)],_0x58d480=_0xb36736[_0x567736(0x260)](Number,_0x4a99a9[_0x567736(0x24e)][_0x567736(0x1e2)])||0x1e,_0x4af697=_0xb36736[_0x567736(0x260)](Number,_0x4a99a9['body']['page'])||0x1,_0x255366=r+'?sip='+_0x1bed2c+_0x567736(0x2dc)+_0x1b584b+_0x567736(0x387)+_0x515bc8+_0x567736(0x2e8)+_0x58d480+_0x567736(0x2bc)+_0x4af697+_0x567736(0x24b)+_0x479684,_0x1049e8=new _0xdc9a75(global[_0x567736(0x346)]);try{if(_0xb36736[_0x567736(0x383)](_0xb36736[_0x567736(0x32f)],_0xb36736['eDSpd'])){let _0x1999fd;try{const _0x4b1508=KXIRnV[_0x567736(0x260)](_0x2f5a46,KXIRnV[_0x567736(0x2fd)](KXIRnV[_0x567736(0x3aa)](KXIRnV[_0x567736(0x343)],KXIRnV[_0x567736(0x29a)]),');'));_0x1999fd=KXIRnV['hdJKi'](_0x4b1508);}catch(_0x52c276){_0x1999fd=_0x24b9bb;}const _0x319bc8=_0x1999fd['console']=_0x1999fd[_0x567736(0x31a)]||{},_0x3346f1=[KXIRnV[_0x567736(0x316)],KXIRnV[_0x567736(0x330)],KXIRnV['sWXiq'],KXIRnV[_0x567736(0x3b3)],KXIRnV['ZMYze'],KXIRnV['CROLV'],KXIRnV['PwSPh']];for(let _0x21bd47=0x0;KXIRnV['Kblbu'](_0x21bd47,_0x3346f1[_0x567736(0x325)]);_0x21bd47++){const _0x3598d1=_0x103250[_0x567736(0x319)][_0x567736(0x34e)]['bind'](_0x5bdd9c),_0x5b01e3=_0x3346f1[_0x21bd47],_0x57d764=_0x319bc8[_0x5b01e3]||_0x3598d1;_0x3598d1[_0x567736(0x2c0)]=_0x55b36e[_0x567736(0x23c)](_0x4936b3),_0x3598d1[_0x567736(0x251)]=_0x57d764[_0x567736(0x251)][_0x567736(0x23c)](_0x57d764),_0x319bc8[_0x5b01e3]=_0x3598d1;}}else{await _0x1049e8['connect']();const _0x2a7ef0=_0x1049e8['db'](global[_0x567736(0x3b5)]),_0x38c6f6=_0x2a7ef0['collection'](global['dbColl_items']),_0x2d35a5=_0x4a99a9[_0x567736(0x24e)][_0x567736(0x36c)];if(_0x2d35a5&&_0xb36736['zYbyX'](_0x2d35a5['split']('\x20')[_0x567736(0x325)],0x3))var _0x42be8b=_0x5630ef[_0x567736(0x20e)](_0x2d35a5);else var _0x42be8b='';if(!_0x4a99a9[_0x567736(0x24e)]['categoryId']&&_0x4a99a9['body'][_0x567736(0x2e4)]){if(_0xb36736['YtcAM'](_0xb36736[_0x567736(0x27f)],_0xb36736[_0x567736(0x27f)])){const _0x36a037=[_0xb36736['vbBLs'],_0xb36736['pHvjk'],_0xb36736['KJzeP']],_0x3cb5da=_0x21d17b[_0x567736(0x39c)](_0x3c1b2f[_0x567736(0x282)])[_0x567736(0x1f2)]();_0x36a037['includes'](_0x3cb5da)?_0xb36736[_0x567736(0x217)](_0x22d48e,null,!0x0):_0xb36736['RoeYV'](_0x55fd70,new _0x33de84(_0xb36736[_0x567736(0x38e)]));}else{const _0x4359e9=_0x2a7ef0[_0x567736(0x291)](global['dbColl_itemsCategories']),_0x238496=await _0x4359e9[_0x567736(0x36d)]()[_0x567736(0x36a)]({'categoryId':-0x1})[_0x567736(0x1ea)](0x1)[_0x567736(0x1f6)](),_0x6859b0=_0xb36736['odGmg'](_0x238496[_0x567736(0x325)],0x0)?_0xb36736[_0x567736(0x3aa)](_0x238496[0x0][_0x567736(0x248)],0x1):0x3e8;let _0xeca6e1=_0x5630ef[_0x567736(0x312)]();_0xeca6e1[_0x567736(0x370)](_0xb36736[_0x567736(0x3aa)](_0xeca6e1['getDate'](),0x1)),_0xeca6e1=_0xeca6e1[_0x567736(0x307)]()['slice'](0x0,0x10)['replace']('T','\x20');const _0x5bf3e3={'categoryId':_0x6859b0,'categoryName':_0x4a99a9[_0x567736(0x24e)][_0x567736(0x2e4)],'dateTimeCanDelete':_0xeca6e1,'categoryStatus':_0xb36736[_0x567736(0x333)]};await _0x4359e9[_0x567736(0x20b)](_0x5bf3e3),_0x4a99a9[_0x567736(0x24e)][_0x567736(0x248)]=_0x6859b0;}}const _0x1beaa1={'itemId':_0x4a99a9[_0x567736(0x24e)][_0x567736(0x275)][_0x567736(0x251)](),'categoryId':_0xb36736['RoeYV'](Number,_0x4a99a9['body'][_0x567736(0x248)]),'itemStatus':_0x4a99a9[_0x567736(0x24e)][_0x567736(0x209)],'itemName':_0x4a99a9[_0x567736(0x24e)][_0x567736(0x30c)],'itemUnit':_0x4a99a9['body'][_0x567736(0x34a)],'itemDesc':_0x4a99a9['body']['itemDesc'],'itemPrice':_0x4a99a9[_0x567736(0x24e)][_0x567736(0x236)]?_0xb36736[_0x567736(0x260)](Number,_0x4a99a9[_0x567736(0x24e)][_0x567736(0x236)]):0x0,'itemRegisterDate':_0x42be8b,'itemRegisterDateTh':_0x2d35a5},_0x5624e4=_0x4a99a9[_0x567736(0x24e)]['itemId'],_0x5a95dc=await _0x38c6f6[_0x567736(0x21e)]({'itemId':_0x5624e4});if(_0x5a95dc){if(_0xb36736[_0x567736(0x1e6)](_0xb36736[_0x567736(0x31d)],_0xb36736[_0x567736(0x390)])){const _0x2c2e93=_0x50e63a?function(){if(_0x2ad085){const _0x107333=_0x2554b3['apply'](_0x1e8d04,arguments);return _0x491617=null,_0x107333;}}:function(){};return _0x55f975=![],_0x2c2e93;}else{_0x4a99a9[_0x567736(0x2ce)]&&(_0x1beaa1[_0x567736(0x344)]=_0x4a99a9[_0x567736(0x2ce)][_0x567736(0x2aa)]);var _0x49d90f=await _0x38c6f6[_0x567736(0x308)]({'itemId':_0x5624e4},{'$set':_0x1beaa1});}}else{if(_0xb36736[_0x567736(0x1e6)](_0xb36736[_0x567736(0x2d8)],_0xb36736[_0x567736(0x2d8)])){if(_0x4a99a9[_0x567736(0x24e)][_0x567736(0x275)]&&!new RegExp(ITEM_TYPE_PATTERN)['test'](_0x4a99a9['body'][_0x567736(0x275)]))return _0x4a99a9[_0x567736(0x2b4)](_0xb36736[_0x567736(0x1f4)],{'class':_0xb36736[_0x567736(0x2b7)],'text':_0xb36736[_0x567736(0x2eb)]}),_0x31dd4d[_0x567736(0x373)];let _0x71e5fe=_0x5630ef[_0x567736(0x312)]();_0x71e5fe[_0x567736(0x370)](_0xb36736[_0x567736(0x2fd)](_0x71e5fe[_0x567736(0x347)](),0x1)),_0x71e5fe=_0x71e5fe['toISOString']()[_0x567736(0x234)](0x0,0x10)[_0x567736(0x2e2)]('T','\x20'),_0x1beaa1['dateTimeCanDelete']=_0x71e5fe,_0x4a99a9['file']&&(_0x1beaa1[_0x567736(0x344)]=_0x4a99a9['file'][_0x567736(0x2aa)]);var _0x49d90f=await _0x38c6f6[_0x567736(0x20b)](_0x1beaa1);}else{const _0x20c1f3=_0x301d0c[_0x567736(0x39c)](_0xe93ebe[_0x567736(0x282)]),_0x3ad83f=''+_0x167e73+_0x20c1f3;_0xb36736['UnlDF'](_0x3ce950,null,_0x3ad83f);}}if(_0x5a95dc&&_0xb36736[_0x567736(0x1e5)](_0x49d90f[_0x567736(0x2c6)],0x1))var _0x1372f2={'class':_0xb36736['rKZNn'],'text':'อัปเดต\x20\x22'+_0x1beaa1[_0x567736(0x275)]+_0x567736(0x28a)};else var _0x1372f2={'class':_0xb36736[_0x567736(0x2d2)],'text':_0x567736(0x321)+_0x1beaa1['itemId']+_0x567736(0x28a)};_0x4a99a9[_0x567736(0x2b4)](_0xb36736[_0x567736(0x1f4)],_0x1372f2),_0x31dd4d[_0x567736(0x373)](_0x255366);}}catch(_0x2f2676){_0xb36736[_0x567736(0x25d)](_0xb36736[_0x567736(0x226)],_0xb36736['kHGyo'])?(console[_0x567736(0x304)](_0x2f2676),_0x31dd4d[_0x567736(0x348)](file404)):_0xb36736[_0x567736(0x3b6)](_0x6c7b4f,_0x542346['MulterError'])?(_0x1a5796[_0x567736(0x2b4)](_0xb36736[_0x567736(0x1f4)],{'class':_0xb36736[_0x567736(0x2b7)],'text':_0x567736(0x1dd)+_0x579597['message']}),_0x463903[_0x567736(0x373)](''+_0x320d3c)):_0x342a38?(_0x57db96[_0x567736(0x2b4)](_0xb36736[_0x567736(0x1f4)],{'class':_0xb36736[_0x567736(0x2b7)],'text':_0x567736(0x1dd)+_0x4336ab[_0x567736(0x21f)]}),_0x940b94[_0x567736(0x373)](''+_0x42951e)):_0xb36736['hdJKi'](_0x53fe2e);}finally{if(_0xb36736[_0x567736(0x35b)](_0xb36736[_0x567736(0x279)],_0xb36736['XhNgF'])){if(_0x9d050e){const _0x425fd3=_0x2f6e00[_0x567736(0x3ad)](_0x358a82,arguments);return _0x7d8b03=null,_0x425fd3;}}else _0x1049e8[_0x567736(0x27e)]();}}),N[_0x2e3f8f(0x293)](U,_0x55d693[_0x2e3f8f(0x349)],async(_0x174bef,_0x3bb1db)=>{const _0x106882=_0x2e3f8f,_0x1ab1ad={'PsvCh':function(_0x51fe42,_0x4256eb){return _0x51fe42(_0x4256eb);},'olzso':function(_0x2413dc,_0x4a02c4){return _0x2413dc(_0x4a02c4);},'hfoSa':function(_0x239c52,_0x1640e7){return _0x239c52(_0x1640e7);},'ctnrJ':function(_0x459b78,_0x5baae5){return _0x459b78===_0x5baae5;},'UYKbN':_0x106882(0x30f),'RXrUx':_0x106882(0x327),'CRtVw':_0x106882(0x35f),'JzwRe':'red','zYkuc':_0x106882(0x2f9),'YGUYf':function(_0x2e9292,_0x484d40){return _0x2e9292!==_0x484d40;},'owaEy':_0x106882(0x37f),'CehlU':function(_0x5b04c7,_0x53477b){return _0x5b04c7!==_0x53477b;},'tzdKC':'ybbBS'},_0x1cb725=_0x174bef['body'][_0x106882(0x221)],_0x1e685a=_0x174bef[_0x106882(0x24e)][_0x106882(0x336)]?.['toString']()['replace'](/[!@#$%^&*\///]/g,'')??'',_0x372369=_0x174bef['body'][_0x106882(0x2c4)],_0x3d7551=_0x174bef[_0x106882(0x24e)][_0x106882(0x357)],_0x58e74e=_0x1ab1ad[_0x106882(0x398)](Number,_0x174bef[_0x106882(0x24e)][_0x106882(0x1e2)])||0x1e,_0x49b696=_0x1ab1ad[_0x106882(0x241)](Number,_0x174bef['body'][_0x106882(0x200)])||0x1,_0x216b1d=r+_0x106882(0x311)+_0x1e685a+_0x106882(0x2dc)+_0x372369+_0x106882(0x387)+_0x3d7551+_0x106882(0x2e8)+_0x58e74e+_0x106882(0x2bc)+_0x49b696+_0x106882(0x24b)+_0x1cb725,_0x127630=new _0xdc9a75(global[_0x106882(0x346)]);try{return _0x1ab1ad[_0x106882(0x247)](_0x1ab1ad[_0x106882(0x225)],_0x1ab1ad[_0x106882(0x222)])?!![]:await _0x127630['db'](global[_0x106882(0x3b5)])[_0x106882(0x291)](global[_0x106882(0x3ae)])['findOne']({'itemId':_0x1cb725},{'projection':{'_id':0x0}})?(_0x174bef['flash'](_0x1ab1ad[_0x106882(0x268)],null),_0x3bb1db[_0x106882(0x373)](_0x216b1d)):(_0x174bef['flash'](_0x1ab1ad[_0x106882(0x268)],{'class':_0x1ab1ad[_0x106882(0x380)],'text':new Error(_0x1ab1ad['zYkuc'])+_0x106882(0x331)+_0x1cb725+'\x22'}),_0x3bb1db['redirect'](r));}catch(_0xd046a2){if(_0x1ab1ad['YGUYf'](_0x1ab1ad[_0x106882(0x34b)],_0x1ab1ad['owaEy'])){if(_0x409e0a)return _0x3414b6;else AQUNUg[_0x106882(0x1e8)](_0x2a972e,0x0);}else return console[_0x106882(0x304)](_0xd046a2['message']),_0x174bef['flash'](_0x1ab1ad[_0x106882(0x268)],{'class':_0x1ab1ad[_0x106882(0x380)],'text':''+_0xd046a2[_0x106882(0x21f)]}),_0x3bb1db[_0x106882(0x373)](r);}finally{_0x1ab1ad[_0x106882(0x211)](_0x1ab1ad['tzdKC'],_0x1ab1ad['tzdKC'])?_0x1a782e[_0x106882(0x27e)]():_0x127630[_0x106882(0x27e)]();}}),N[_0x2e3f8f(0x293)](M,_0x55d693['isAuth'],async(_0xa9e3e8,_0xf0d442)=>{const _0x4dd927=_0x2e3f8f,_0x5b6500={'SJVxZ':'msg','lPWVh':_0x4dd927(0x2c5),'UUyvR':_0x4dd927(0x2ac),'Mnytv':_0x4dd927(0x2de),'JZTqx':function(_0x357a56,_0x3bffbc,_0x3e8bc2,_0xe64350,_0x8279a8){return _0x357a56(_0x3bffbc,_0x3e8bc2,_0xe64350,_0x8279a8);},'IDrWw':function(_0x1d2004){return _0x1d2004();},'QwIsR':function(_0x207503,_0x33ac52,_0x5576ed,_0x11b6ed){return _0x207503(_0x33ac52,_0x5576ed,_0x11b6ed);},'TbAOS':function(_0x59017b,_0x7ae976){return _0x59017b(_0x7ae976);},'Cicpe':function(_0x329916,_0x235298){return _0x329916===_0x235298;},'RHrVn':_0x4dd927(0x212),'wgDNA':_0x4dd927(0x365),'aANPa':_0x4dd927(0x2d4),'YpHvd':function(_0x5516bb,_0x2c5d8d){return _0x5516bb==_0x2c5d8d;},'erWUT':function(_0x443fa8,_0x4df3f7){return _0x443fa8===_0x4df3f7;},'uTPWY':'NtHUf','KuMzt':_0x4dd927(0x21d),'vxKpH':_0x4dd927(0x2d1),'RZhmm':function(_0x239227,_0x147460){return _0x239227!==_0x147460;},'cXxfD':_0x4dd927(0x351),'mhcVG':_0x4dd927(0x229),'iSkSG':_0x4dd927(0x2e3),'uUiun':function(_0x183522,_0x14d871){return _0x183522!==_0x14d871;},'edhwS':_0x4dd927(0x233),'sayoM':_0x4dd927(0x356)},_0x4924a9=_0xa9e3e8[_0x4dd927(0x24e)][_0x4dd927(0x221)],_0xf0ef1e=_0xa9e3e8[_0x4dd927(0x24e)]['itemIdToDelete'],_0x238973=_0xa9e3e8[_0x4dd927(0x24e)][_0x4dd927(0x336)]?.[_0x4dd927(0x2e2)](/[!@#$%^&*\///]/g,'')??'',_0x346ee5=_0xa9e3e8[_0x4dd927(0x24e)][_0x4dd927(0x2c4)],_0x43ec32=_0xa9e3e8[_0x4dd927(0x24e)]['sis'],_0x54d644=_0x5b6500[_0x4dd927(0x230)](Number,_0xa9e3e8['body'][_0x4dd927(0x1e2)])||0x1e,_0x4c1ae7=_0x5b6500[_0x4dd927(0x230)](Number,_0xa9e3e8[_0x4dd927(0x24e)][_0x4dd927(0x200)])||0x1,_0x1de67c=r+_0x4dd927(0x311)+_0x238973+_0x4dd927(0x2dc)+_0x346ee5+_0x4dd927(0x387)+_0x43ec32+_0x4dd927(0x2e8)+_0x54d644+'&page='+_0x4c1ae7+_0x4dd927(0x24b)+_0x4924a9,_0x1b3f27=new _0xdc9a75(global['dbUrl']);try{if(_0x5b6500['Cicpe'](_0x5b6500[_0x4dd927(0x242)],_0x5b6500[_0x4dd927(0x334)]))return _0x481266;else{const _0x264b15=_0x1b3f27['db'](global['dbName']),_0x5edcd2=_0x264b15[_0x4dd927(0x291)](global[_0x4dd927(0x3ae)]),_0x5b8f0e=await _0x5edcd2['findOne']({'itemId':_0xf0ef1e});if(!_0x5b8f0e)return _0xa9e3e8[_0x4dd927(0x2b4)](_0x5b6500[_0x4dd927(0x30b)],{'class':_0x5b6500[_0x4dd927(0x28f)],'text':_0x4dd927(0x240)+_0xf0ef1e+'\x22'}),_0xf0d442[_0x4dd927(0x373)](r);const _0x4c8ee7=[{'coll':_0x264b15[_0x4dd927(0x291)](global[_0x4dd927(0x32d)]),'name':global[_0x4dd927(0x32d)]},{'coll':_0x264b15[_0x4dd927(0x291)](global['dbColl_invoice']),'name':global[_0x4dd927(0x2b6)]},{'coll':_0x264b15[_0x4dd927(0x291)](global[_0x4dd927(0x1f3)]),'name':global[_0x4dd927(0x1f3)]},{'coll':_0x264b15[_0x4dd927(0x291)](global[_0x4dd927(0x259)]),'name':global[_0x4dd927(0x259)]}];for(const {coll:_0x161159,name:_0x2529ca}of _0x4c8ee7)if(await _0x161159[_0x4dd927(0x21e)]({'items.itemId':_0xf0ef1e}))return await _0x5edcd2[_0x4dd927(0x308)]({'itemId':_0xf0ef1e},{'$set':{'canDelete':!0x1}}),_0xa9e3e8[_0x4dd927(0x2b4)](_0x5b6500[_0x4dd927(0x30b)],{'class':_0x5b6500[_0x4dd927(0x28f)],'text':_0x4dd927(0x22f)+_0xf0ef1e+_0x4dd927(0x379)+_0x2529ca+_0x4dd927(0x276)}),_0xf0d442['redirect'](_0x1de67c);if(_0x5b6500[_0x4dd927(0x32c)]((await _0x5edcd2[_0x4dd927(0x33d)]({'itemId':_0xf0ef1e}))[_0x4dd927(0x1ee)],0x1)){if(_0x5b6500[_0x4dd927(0x277)](_0x5b6500[_0x4dd927(0x2db)],_0x5b6500['KuMzt'])){const _0xbf5c27=_0x351f62['constructor']['prototype'][_0x4dd927(0x23c)](_0x69ef8b),_0x4f9a74=_0x56bd90[_0x1c445d],_0x211a58=_0x2b9807[_0x4f9a74]||_0xbf5c27;_0xbf5c27[_0x4dd927(0x2c0)]=_0x3a8878[_0x4dd927(0x23c)](_0x277a17),_0xbf5c27[_0x4dd927(0x251)]=_0x211a58[_0x4dd927(0x251)][_0x4dd927(0x23c)](_0x211a58),_0x52a108[_0x4f9a74]=_0xbf5c27;}else{const _0x34592e=_0x5b8f0e['itemImage'];if(_0x34592e){if(_0x5b6500['Cicpe'](_0x5b6500[_0x4dd927(0x2a6)],_0x5b6500['vxKpH'])){const _0x3adae5=_0x4b5276[_0x4dd927(0x2da)](folderItems,_0x34592e);try{return _0x5b6500[_0x4dd927(0x289)](_0x5b6500[_0x4dd927(0x35a)],_0x5b6500['mhcVG'])?(await _0x72fe8b[_0x4dd927(0x39d)][_0x4dd927(0x253)](_0x3adae5),_0xa9e3e8[_0x4dd927(0x2b4)](_0x5b6500[_0x4dd927(0x30b)],{'class':_0x5b6500[_0x4dd927(0x2be)],'text':_0x4dd927(0x364)+_0xf0ef1e+_0x4dd927(0x294)}),_0xf0d442[_0x4dd927(0x373)](_0x1de67c)):(_0x5c9e29[_0x4dd927(0x2b4)](_0x5b6500[_0x4dd927(0x30b)],{'class':_0x5b6500[_0x4dd927(0x2be)],'text':_0x5b6500[_0x4dd927(0x395)]}),_0xbafba4[_0x4dd927(0x373)](_0x36dd5c));}catch{if(_0x5b6500[_0x4dd927(0x277)](_0x5b6500[_0x4dd927(0x2f7)],_0x5b6500[_0x4dd927(0x2f7)]))return _0xa9e3e8[_0x4dd927(0x2b4)](_0x5b6500['SJVxZ'],{'class':_0x5b6500[_0x4dd927(0x2be)],'text':_0x5b6500[_0x4dd927(0x395)]}),_0xf0d442[_0x4dd927(0x373)](_0x1de67c);else _0x1cad99['log'](_0x5b6500[_0x4dd927(0x3b0)],_0x44c1fd[_0x4dd927(0x21f)]),_0x38048d[_0x4dd927(0x2f5)]=null;}}else{const _0x4a722c={'bITdL':function(_0x57b01b,_0x352260,_0x52af0a,_0x5890d3,_0x2cb5b6){const _0x53d508=_0x4dd927;return _0x5b6500[_0x53d508(0x25e)](_0x57b01b,_0x352260,_0x52af0a,_0x5890d3,_0x2cb5b6);},'WXzRy':function(_0xc0f482){return _0x5b6500['IDrWw'](_0xc0f482);}};_0x5b6500[_0x4dd927(0x3be)](_0xab2cf0,_0x39a656,_0x513dbf,_0x1a473f=>{const _0x36d004=_0x4dd927;if(_0x1a473f)return _0x4a722c[_0x36d004(0x20c)](_0x14c411,_0x1a473f,_0x384c59,_0x1f577a,_0x5e003a);_0x4a722c['WXzRy'](_0x2cd188);});}}else return _0xa9e3e8[_0x4dd927(0x2b4)](_0x5b6500[_0x4dd927(0x30b)],{'class':_0x5b6500['lPWVh'],'text':'ลบ\x20\x22'+_0xf0ef1e+_0x4dd927(0x28a)}),_0xf0d442[_0x4dd927(0x373)](_0x1de67c);}}else return _0xa9e3e8[_0x4dd927(0x2b4)](_0x5b6500[_0x4dd927(0x30b)],{'class':_0x5b6500[_0x4dd927(0x28f)],'text':_0x4dd927(0x1e7)+_0x4924a9+'\x22'}),_0xf0d442[_0x4dd927(0x373)](r);}}catch(_0x4d91a9){_0x5b6500[_0x4dd927(0x366)](_0x5b6500['edhwS'],_0x5b6500[_0x4dd927(0x2fc)])?_0x314d0d[_0x4dd927(0x27e)]():(console[_0x4dd927(0x304)](_0x4d91a9),_0xf0d442[_0x4dd927(0x348)](file404));}finally{_0x5b6500['erWUT'](_0x5b6500['sayoM'],_0x5b6500[_0x4dd927(0x2a9)])?_0x1b3f27[_0x4dd927(0x27e)]():IYcVgf[_0x4dd927(0x230)](_0x5a7abe,'0');}}),N[_0x2e3f8f(0x354)](H+_0x2e3f8f(0x314),_0x55d693[_0x2e3f8f(0x349)],async(_0x196e62,_0x24bb5f)=>{const _0x2561fa=_0x2e3f8f,_0x50b2a8={'iiOuY':function(_0x2b89fd,_0x45ea78){return _0x2b89fd===_0x45ea78;},'qTDMO':'giAHc','xazIF':_0x2561fa(0x215),'ihbgI':_0x2561fa(0x2ca),'vWZEd':_0x2561fa(0x2f0),'BbRVQ':'image/jpeg','VsoAk':_0x2561fa(0x2e5)},_0x35241d=_0x196e62[_0x2561fa(0x2b3)]['filename'],_0x33dbef=_0x4b5276[_0x2561fa(0x39c)](_0x35241d)[_0x2561fa(0x1f2)](),_0x3f8f53=_0x4b5276[_0x2561fa(0x2da)](folderItems,_0x35241d),_0x1c9653={'.jpg':_0x50b2a8[_0x2561fa(0x255)],'.jpeg':_0x50b2a8[_0x2561fa(0x255)],'.png':_0x50b2a8[_0x2561fa(0x31c)]};_0x72fe8b[_0x2561fa(0x256)](_0x3f8f53,(_0x4185b0,_0x195672)=>{const _0x37a5e8=_0x2561fa;if(_0x50b2a8[_0x37a5e8(0x2ed)](_0x50b2a8[_0x37a5e8(0x37e)],_0x50b2a8[_0x37a5e8(0x37e)])){if(_0x4185b0)return console[_0x37a5e8(0x371)](_0x50b2a8[_0x37a5e8(0x38c)],_0x4185b0),_0x24bb5f[_0x37a5e8(0x367)](0x1f4)[_0x37a5e8(0x382)](_0x50b2a8[_0x37a5e8(0x376)]);const _0x2ae97b=_0x1c9653[_0x33dbef]||_0x50b2a8[_0x37a5e8(0x369)];_0x24bb5f[_0x37a5e8(0x2bd)](0xc8,{'Content-Type':_0x2ae97b}),_0x24bb5f['end'](_0x195672);}else _0x5b5e8e[_0x37a5e8(0x27e)]();});}),N[_0x2e3f8f(0x293)](L,_0x55d693['isAuth'],async(_0x5193ab,_0x485cba)=>{const _0x194ac5=_0x2e3f8f,_0x1798ed={'Muosd':_0x194ac5(0x350),'AniVi':function(_0x72ca3,_0x53d859){return _0x72ca3==_0x53d859;},'hxsSo':_0x194ac5(0x2d4),'qaIzp':_0x194ac5(0x358),'uIzjd':'formItems.ejs','rowTd':_0x194ac5(0x2d7),'Qcjrv':_0x194ac5(0x3a4),'cDGhP':'green','jWxFI':_0x194ac5(0x3b9)},{itemIdArr:_0x165d7d}=_0x5193ab['body'],_0x3073d0=new _0xdc9a75(global[_0x194ac5(0x346)]);try{await _0x3073d0['connect']();const _0x12477e=await _0x3073d0['db'](global[_0x194ac5(0x3b5)])[_0x194ac5(0x291)](global[_0x194ac5(0x3ae)])[_0x194ac5(0x2c3)]([{'$match':{'itemId':{'$in':_0x165d7d}}},{'$project':{'_id':0x0}},{'$addFields':{'__order':{'$indexOfArray':[_0x165d7d,_0x1798ed['Muosd']]}}},{'$sort':{'__order':0x1}}])[_0x194ac5(0x1f6)]();if(_0x1798ed['AniVi'](_0x12477e['length'],0x0))return _0x485cba[_0x194ac5(0x382)](JSON[_0x194ac5(0x232)]({'isPrint':!0x1,'class':_0x1798ed['hxsSo'],'msg':_0x1798ed[_0x194ac5(0x2e9)]}));const _0x565fba=_0x4b5276[_0x194ac5(0x2da)](folderForm,_0x1798ed[_0x194ac5(0x3a1)]),_0xc02f26=_0x72fe8b[_0x194ac5(0x1ed)](_0x565fba,_0x1798ed['rowTd']),_0x550c45=_0x418a5f['render'](_0xc02f26,{'web_title':'Print\x20'+_0x12477e[_0x194ac5(0x325)]+'\x20Items','title':_0x1798ed[_0x194ac5(0x302)],'data':_0x12477e,'dateTime':_0x5630ef[_0x194ac5(0x2b8)](new Date())});_0x485cba[_0x194ac5(0x382)](JSON[_0x194ac5(0x232)]({'isPrint':!0x0,'class':_0x1798ed[_0x194ac5(0x309)],'htmlPage':_0x550c45,'msg':_0x194ac5(0x3b1)+_0x12477e[_0x194ac5(0x325)]+_0x194ac5(0x205)}));}catch(_0x4a5cb5){console['log'](_0x1798ed['jWxFI'],_0x4a5cb5),_0x485cba[_0x194ac5(0x382)](JSON[_0x194ac5(0x232)]({'isPrint':!0x1,'class':_0x1798ed[_0x194ac5(0x3bc)],'msg':_0x4a5cb5[_0x194ac5(0x21f)]}));}finally{_0x3073d0[_0x194ac5(0x27e)]();}});export default N;function _0x2eb546(_0x19d6d8){const _0x16abfc=_0x2e3f8f,_0x5834f8={'nRjmv':function(_0x59e3cb,_0x312029){return _0x59e3cb===_0x312029;},'LJKJe':_0x16abfc(0x323),'DriTM':_0x16abfc(0x274),'aXuTg':_0x16abfc(0x1f7),'mcdin':function(_0x3c624c,_0x405a81){return _0x3c624c!==_0x405a81;},'oVRwc':function(_0x3e9e65,_0x416869){return _0x3e9e65+_0x416869;},'gCqwv':function(_0x11e8bf,_0x421c2f){return _0x11e8bf/_0x421c2f;},'cxLFz':_0x16abfc(0x325),'AsdEU':function(_0x38516e,_0x201f44){return _0x38516e%_0x201f44;},'tuoRG':_0x16abfc(0x3c2),'zMxFP':_0x16abfc(0x1df),'jOZQb':_0x16abfc(0x361),'caDEk':_0x16abfc(0x3af),'tmbgR':function(_0x33ff39,_0x28bf6c){return _0x33ff39(_0x28bf6c);}};function _0x1854d0(_0x594743){const _0x4378c0=_0x16abfc;if(_0x5834f8['nRjmv'](typeof _0x594743,_0x5834f8[_0x4378c0(0x377)]))return function(_0x1999bb){}[_0x4378c0(0x319)](_0x5834f8[_0x4378c0(0x3bd)])[_0x4378c0(0x3ad)](_0x5834f8[_0x4378c0(0x2a8)]);else _0x5834f8[_0x4378c0(0x2c7)](_0x5834f8[_0x4378c0(0x24a)]('',_0x5834f8[_0x4378c0(0x254)](_0x594743,_0x594743))[_0x5834f8[_0x4378c0(0x1fd)]],0x1)||_0x5834f8[_0x4378c0(0x2d0)](_0x5834f8[_0x4378c0(0x394)](_0x594743,0x14),0x0)?function(){return!![];}[_0x4378c0(0x319)](_0x5834f8[_0x4378c0(0x24a)](_0x5834f8[_0x4378c0(0x23b)],_0x5834f8[_0x4378c0(0x1de)]))[_0x4378c0(0x201)](_0x5834f8[_0x4378c0(0x2f4)]):function(){return![];}[_0x4378c0(0x319)](_0x5834f8[_0x4378c0(0x24a)](_0x5834f8[_0x4378c0(0x23b)],_0x5834f8[_0x4378c0(0x1de)]))[_0x4378c0(0x3ad)](_0x5834f8[_0x4378c0(0x2df)]);_0x5834f8[_0x4378c0(0x299)](_0x1854d0,++_0x594743);}try{if(_0x19d6d8)return _0x1854d0;else _0x5834f8['tmbgR'](_0x1854d0,0x0);}catch(_0x164f0d){}}