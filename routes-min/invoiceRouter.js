function _0x25f1(){const _0x143cf4=['gQGTu','ufuSu','WSuXp','LZBof','MRtAN','collection','PwMzK','SgrJB','toArray','ไม่สามารถบันทึกเอกสาร\x20สถานะ\x20','input','EkqNy','8727130hWoCjJ','5829888BkXEEb','DMopF','length','TRaJZ','OjthH','while\x20(true)\x20{}','init','VRVjl','DBIeT','สถานะเอกสารผิดผลาด','Ihqzq','GGDpx','xKwah','limit','\x20เรียบร้อยแล้ว{{sep}}[บันทึกการแก้ไข]','NYXnJ','218404QULrzs','Nzgpl','PWgHU','modifiedCount','NAkGi','JbGCM','SPYru','/search','RHtKM','red','console','vxHtB','ChtYR','NEyuW','JfXCh','DYcwm','sendFile','debu','AvDld','bmxOH','getMonth','OZCRq','shift','Ukyjf','gtNgI','VwmwI','PSUGO','AYNaL','ABugV','12577662ZRAvLI','invoice.ejs','log','selectBottomLeftSignature','bEFVW','nfFDG','Jsnxp','tIdxX','UjIUL','cyJrC','xBKem','ftVWL','msApw','eCgtT','JbEGT','TlCrD','txvtc','__proto__','LOGO_INVOICE_FILENAME','getLogoBase64Src','getFullYear','gqGuH','qbhMw','AcBNG','txKLC','rQcGa','wuhIf','IGsmT','iqbsZ','vFpyp','zxKaH','updateOne','xebOx','lqeQO','body','lEqQn','VTjlU','rdymb','/save','nIpGL','ommra','AghIj','send','wDpjV','863665tdJfzW','NzAhc','TbqlO','HJiEz','xGRmX','jMXAv','2426553IuYwWe','slice','convert_DocDataType','nfbqI','ZThCp','bind','sOmeH','ifBuK','eyviu','uroFA','/fetch/modal','flash','sXQxi','Wswsa','dNdNj','vQVjb','getSessionData_sign','call','docId','อัปเดท\x20','NinEt','find','uKSKR','iRQaq','WWKXh','isAuth','jPzhD','gbnpW','dbColl_invoice','xLNkt','kxyEb','chain','trace','zCvFA','VObZE','mLtGn','16LsiRRu','uFUGY','acknowledged','Pceqe','ykRfE','test','constructor','mDOPY','JRiZs','7PzuRMI','wQjjR','MXINH','padStart','EEWue','OOCTa','oVlhA','info','ULcml','vQrmO','GFkNL','jviXD','LgxVZ','findOne','dYaGw','PgpGm','replace','HvjGv','jwWFL','ftEuY','dVnTf','byYak','DOC_STATUS','aKexL','SUyBt','OXDag','/load','uGDZb','/changes','aYIOp','ckerq','RlDkD','getSessionData','ZcErz','apply','EJEHX','stringify','jPLRe','ECwJb','PdnkK','IszYV','icMPt','getSettingsByCollection','oISNn','NIZcS','toString','EhPWH','YPSUE','BzRTT','846176FpWixt','CdfcG','GvXhI','exception','HhJzy','rpHcD','-00001','docStatusNumber','\x20ได้','prototype','gger','dbKfh','GTMlT','{}.constructor(\x22return\x20this\x22)(\x20)','\x20เรียบร้อยแล้ว','สร้างเอกสารใหม่\x20','hzRFS','vFpIs','status','mqOiN','qFsZI','/invoice','yellow','BPoSa','kXieA','QCeFh','counter','renderView','stateObject','kovVa','message','QSULt','close','4sAQuAR','OMVOm','JMbZt','action','dbColl_settings_Invoice','sOhka','dbName','function\x20*\x5c(\x20*\x5c)','FxnbS','string','userFlash','gOPea','pMMvR','MKvIo','ampth','KiSDh','djoYA','XIXoj','VwbUr','jgGJP','split','formatDateTime','query','keYkA','QRWZZ','qASbN','nnFWj','return\x20(function()\x20','70dDITdF','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','VOfZA','kPuCc','push','nxnps','Hkxoy','FNpZn','post','kJnfM','OqlxS','tPdYP','qFyRd'];_0x25f1=function(){return _0x143cf4;};return _0x25f1();}const _0x1ffe22=_0x360f;function _0x360f(_0x334bde,_0x36af15){const _0x3345de=_0x25f1();return _0x360f=function(_0x432555,_0x3ad8ce){_0x432555=_0x432555-0x151;let _0x48f10f=_0x3345de[_0x432555];return _0x48f10f;},_0x360f(_0x334bde,_0x36af15);}(function(_0xb60faa,_0xe3986f){const _0x2bbe81=_0x360f,_0x39fd16=_0xb60faa();while(!![]){try{const _0x1a0db6=parseInt(_0x2bbe81(0x23e))/0x1*(parseInt(_0x2bbe81(0x19d))/0x2)+-parseInt(_0x2bbe81(0x179))/0x3+parseInt(_0x2bbe81(0x1f8))/0x4*(-parseInt(_0x2bbe81(0x22d))/0x5)+parseInt(_0x2bbe81(0x22e))/0x6+parseInt(_0x2bbe81(0x1a6))/0x7*(-parseInt(_0x2bbe81(0x1d7))/0x8)+parseInt(_0x2bbe81(0x25b))/0x9+-parseInt(_0x2bbe81(0x214))/0xa*(parseInt(_0x2bbe81(0x173))/0xb);if(_0x1a0db6===_0xe3986f)break;else _0x39fd16['push'](_0x39fd16['shift']());}catch(_0x350555){_0x39fd16['push'](_0x39fd16['shift']());}}}(_0x25f1,0xdd5f8));const _0x387005=(function(){const _0x171f2b=_0x360f,_0x20b233={'cyJrC':function(_0x2e3661,_0x3908e0){return _0x2e3661!==_0x3908e0;},'DMopF':_0x171f2b(0x1a5),'DYcwm':function(_0x219a60,_0x3edb8a){return _0x219a60!==_0x3edb8a;},'sXQxi':_0x171f2b(0x1d4),'absBL':_0x171f2b(0x1b0),'YPSUE':function(_0x26790c,_0x125d5b){return _0x26790c===_0x125d5b;},'PwMzK':'ONrnW'};let _0x3b6861=!![];return function(_0xdb1941,_0x5821f0){const _0x877c3f=_0x171f2b,_0x575857={'JMbZt':function(_0x27df39,_0x7baa4c){const _0x152400=_0x360f;return _0x20b233[_0x152400(0x264)](_0x27df39,_0x7baa4c);},'PdnkK':_0x20b233[_0x877c3f(0x22f)],'ABugV':function(_0x2820cb,_0x4dd34d){const _0x52c4d1=_0x877c3f;return _0x20b233[_0x52c4d1(0x24d)](_0x2820cb,_0x4dd34d);},'Ihqzq':_0x20b233[_0x877c3f(0x185)],'dbKfh':_0x20b233['absBL']};if(_0x20b233[_0x877c3f(0x1d5)](_0x20b233[_0x877c3f(0x227)],_0x20b233['PwMzK'])){const _0x202b05=_0x3b6861?function(){const _0x152d5a=_0x877c3f;if(_0x575857[_0x152d5a(0x1fa)](_0x575857[_0x152d5a(0x1cd)],_0x575857['PdnkK']))_0x370e05['close']();else{if(_0x5821f0){if(_0x575857[_0x152d5a(0x25a)](_0x575857[_0x152d5a(0x238)],_0x575857[_0x152d5a(0x1e2)])){const _0x841ab2=_0x5821f0['apply'](_0xdb1941,arguments);return _0x5821f0=null,_0x841ab2;}else _0x4643e8=_0x4f8b18;}}}:function(){};return _0x3b6861=![],_0x202b05;}else return!![];};}());(function(){const _0x178c60=_0x360f,_0x56d607={'NzAhc':function(_0x265378,_0x227d4a){return _0x265378+_0x227d4a;},'wQjjR':'debu','AvDld':_0x178c60(0x1e1),'RVHvA':_0x178c60(0x1f3),'SPYru':function(_0x387a02,_0x38c8f4){return _0x387a02===_0x38c8f4;},'oISNn':_0x178c60(0x1d2),'SUyBt':_0x178c60(0x1ff),'UyEty':_0x178c60(0x215),'nfFDG':function(_0x490ce9,_0x54dc80){return _0x490ce9(_0x54dc80);},'TMvKq':_0x178c60(0x234),'rKqnN':'chain','Jsnxp':_0x178c60(0x22b),'OOCTa':function(_0x3bed38,_0x1e07b5){return _0x3bed38===_0x1e07b5;},'zXsNp':_0x178c60(0x1c5),'zCvFA':_0x178c60(0x153),'ChtYR':function(_0x3b77cf,_0x2e7b3b){return _0x3b77cf(_0x2e7b3b);},'jMXAv':_0x178c60(0x1fd),'CRNcD':function(_0x45c0e9){return _0x45c0e9();},'vQrmO':function(_0xde52ec,_0x539163,_0x46ec01){return _0xde52ec(_0x539163,_0x46ec01);}};_0x56d607[_0x178c60(0x1af)](_0x387005,this,function(){const _0x1ec5e5=_0x178c60;if(_0x56d607[_0x1ec5e5(0x244)](_0x56d607[_0x1ec5e5(0x1d1)],_0x56d607[_0x1ec5e5(0x1d1)])){const _0x403f8d=new RegExp(_0x56d607[_0x1ec5e5(0x1be)]),_0x200314=new RegExp(_0x56d607['UyEty'],'i'),_0x32d239=_0x56d607[_0x1ec5e5(0x260)](_0x1b93b4,_0x56d607['TMvKq']);if(!_0x403f8d['test'](_0x56d607[_0x1ec5e5(0x174)](_0x32d239,_0x56d607['rKqnN']))||!_0x200314[_0x1ec5e5(0x1a2)](_0x56d607[_0x1ec5e5(0x174)](_0x32d239,_0x56d607[_0x1ec5e5(0x261)]))){if(_0x56d607[_0x1ec5e5(0x1ab)](_0x56d607['zXsNp'],_0x56d607[_0x1ec5e5(0x19a)])){const _0x2df79d=_0x39788e[_0x1ec5e5(0x1a3)][_0x1ec5e5(0x1e0)]['bind'](_0x56107b),_0x4c8092=_0x165d61[_0x5f392a],_0x598828=_0x54cbd7[_0x4c8092]||_0x2df79d;_0x2df79d[_0x1ec5e5(0x158)]=_0x2c1c9f[_0x1ec5e5(0x17e)](_0x11605f),_0x2df79d['toString']=_0x598828[_0x1ec5e5(0x1d3)][_0x1ec5e5(0x17e)](_0x598828),_0x555841[_0x4c8092]=_0x2df79d;}else _0x56d607[_0x1ec5e5(0x24a)](_0x32d239,'0');}else{if(_0x56d607[_0x1ec5e5(0x244)](_0x56d607[_0x1ec5e5(0x178)],_0x56d607[_0x1ec5e5(0x178)]))_0x56d607['CRNcD'](_0x1b93b4);else return _0x298e40;}}else(function(){return![];}['constructor'](_0x56d607[_0x1ec5e5(0x174)](_0x56d607[_0x1ec5e5(0x1a7)],_0x56d607[_0x1ec5e5(0x250)]))[_0x1ec5e5(0x1c8)](_0x56d607['RVHvA']));})();}());const _0x3ad8ce=(function(){const _0x1eaeab=_0x360f,_0x3d79fa={'ykRfE':function(_0x384728,_0x57e3f3,_0x3f8cba){return _0x384728(_0x57e3f3,_0x3f8cba);},'ECwJb':function(_0x23c5c3,_0x42b4e3){return _0x23c5c3(_0x42b4e3);},'kXieA':function(_0x259b8e,_0x191383){return _0x259b8e+_0x191383;},'uGDZb':_0x1eaeab(0x213),'Pceqe':_0x1eaeab(0x1e4),'romdD':function(_0x2f25a2,_0x1dc861){return _0x2f25a2===_0x1dc861;},'BzRTT':_0x1eaeab(0x15f),'TlCrD':function(_0x249acf,_0x1e8068){return _0x249acf!==_0x1e8068;},'gbnpW':_0x1eaeab(0x23f),'SgrJB':'function\x20*\x5c(\x20*\x5c)','IszYV':_0x1eaeab(0x215),'WHLKZ':_0x1eaeab(0x234),'keYkA':_0x1eaeab(0x198),'AcBNG':function(_0x30ac59,_0x11eb2e){return _0x30ac59+_0x11eb2e;},'uFUGY':_0x1eaeab(0x22b),'sOmeH':function(_0x43795f){return _0x43795f();},'oVlhA':function(_0x452614,_0x22ebd4){return _0x452614===_0x22ebd4;},'eCgtT':'evmrQ'};let _0x20871e=!![];return function(_0x5a50ed,_0x404cc3){const _0x55c89f=_0x1eaeab,_0x59538e={'xLNkt':function(_0x41a55c,_0x518595){return _0x3d79fa['ECwJb'](_0x41a55c,_0x518595);},'BRtbj':function(_0xa2284f,_0x1b5df2){const _0x187ebe=_0x360f;return _0x3d79fa[_0x187ebe(0x1ef)](_0xa2284f,_0x1b5df2);},'xKwah':_0x3d79fa[_0x55c89f(0x1c1)],'iRBda':_0x3d79fa[_0x55c89f(0x1a0)],'FNpZn':function(_0x310bb9,_0x40becf){return _0x3d79fa['romdD'](_0x310bb9,_0x40becf);},'wDpjV':_0x3d79fa[_0x55c89f(0x1d6)],'CjzZy':function(_0xfa4914,_0x399382){const _0x6df2cf=_0x55c89f;return _0x3d79fa[_0x6df2cf(0x156)](_0xfa4914,_0x399382);},'TbqlO':_0x3d79fa[_0x55c89f(0x194)],'gqvME':_0x3d79fa[_0x55c89f(0x228)],'kPuCc':_0x3d79fa[_0x55c89f(0x1ce)],'xGRmX':_0x3d79fa['WHLKZ'],'Wswsa':function(_0x5d2edb,_0x5b99eb){const _0x2e4c78=_0x55c89f;return _0x3d79fa[_0x2e4c78(0x1ef)](_0x5d2edb,_0x5b99eb);},'LgxVZ':_0x3d79fa[_0x55c89f(0x20f)],'rdymb':function(_0x3887e0,_0x5a0875){const _0x10f522=_0x55c89f;return _0x3d79fa[_0x10f522(0x15e)](_0x3887e0,_0x5a0875);},'zxKaH':_0x3d79fa[_0x55c89f(0x19e)],'ftEuY':function(_0x387d41,_0x451326){const _0x351e3b=_0x55c89f;return _0x3d79fa[_0x351e3b(0x1cc)](_0x387d41,_0x451326);},'AYNaL':function(_0x24fc0f){const _0x71bce5=_0x55c89f;return _0x3d79fa[_0x71bce5(0x17f)](_0x24fc0f);}};if(_0x3d79fa[_0x55c89f(0x1ac)](_0x3d79fa[_0x55c89f(0x154)],_0x3d79fa[_0x55c89f(0x154)])){const _0x441250=_0x20871e?function(){const _0x220261=_0x55c89f,_0x1a742a={'VRVjl':function(_0x2da975,_0x1daed9){const _0x2ecf84=_0x360f;return _0x59538e[_0x2ecf84(0x196)](_0x2da975,_0x1daed9);},'QRWZZ':function(_0x1e1e6,_0x3f79a8){return _0x59538e['BRtbj'](_0x1e1e6,_0x3f79a8);},'ommra':_0x59538e[_0x220261(0x23a)],'NAkGi':_0x59538e['iRBda']};if(_0x59538e[_0x220261(0x21b)](_0x59538e[_0x220261(0x172)],_0x59538e[_0x220261(0x172)])){if(_0x404cc3){if(_0x59538e['CjzZy'](_0x59538e[_0x220261(0x175)],_0x59538e[_0x220261(0x175)]))_0x4aa568=_0x1a742a[_0x220261(0x235)](_0x46ee7f,_0x1a742a[_0x220261(0x210)](_0x1a742a['QRWZZ'](_0x1a742a[_0x220261(0x16f)],_0x1a742a[_0x220261(0x242)]),');'))();else{const _0x1d7254=_0x404cc3[_0x220261(0x1c8)](_0x5a50ed,arguments);return _0x404cc3=null,_0x1d7254;}}}else _0x4137a6[_0x220261(0x25d)](_0x1a84e6),_0x4b0a69[_0x220261(0x1e9)](0x194)[_0x220261(0x24e)](_0x404bf9);}:function(){};return _0x20871e=![],_0x441250;}else _0x3d79fa[_0x55c89f(0x1a1)](_0x344ef1,this,function(){const _0xb27815=_0x55c89f,_0x4881a2=new _0x5ef068(_0x59538e['gqvME']),_0x1a23ff=new _0x8b15dd(_0x59538e[_0xb27815(0x217)],'i'),_0x2ab927=_0x59538e[_0xb27815(0x196)](_0x52829f,_0x59538e[_0xb27815(0x177)]);!_0x4881a2[_0xb27815(0x1a2)](_0x59538e[_0xb27815(0x186)](_0x2ab927,_0x59538e[_0xb27815(0x1b2)]))||!_0x1a23ff[_0xb27815(0x1a2)](_0x59538e[_0xb27815(0x16c)](_0x2ab927,_0x59538e[_0xb27815(0x165)]))?_0x59538e[_0xb27815(0x1b9)](_0x2ab927,'0'):_0x59538e[_0xb27815(0x259)](_0x2d80fd);})();};}()),_0x432555=_0x3ad8ce(this,function(){const _0x3cb646=_0x360f,_0x5b443d={'MKvIo':function(_0x10ba00,_0x385332){return _0x10ba00+_0x385332;},'UZcLl':_0x3cb646(0x24f),'mLtGn':_0x3cb646(0x1e1),'NQQdU':_0x3cb646(0x1fb),'imEFv':function(_0x533393,_0x100b46){return _0x533393(_0x100b46);},'dVnTf':function(_0x4c57d9,_0x42be69){return _0x4c57d9===_0x42be69;},'lqeQO':_0x3cb646(0x15c),'jgGJP':_0x3cb646(0x1e7),'vFpyp':_0x3cb646(0x170),'FxnbS':_0x3cb646(0x160),'Ukyjf':function(_0x102b11,_0x526225){return _0x102b11+_0x526225;},'ZThCp':_0x3cb646(0x213),'UjIUL':_0x3cb646(0x1e4),'xBKem':function(_0x317c62,_0x1be031){return _0x317c62!==_0x1be031;},'vFpIs':_0x3cb646(0x21f),'ampth':_0x3cb646(0x1f6),'OqlxS':function(_0x201a87){return _0x201a87();},'KiSDh':_0x3cb646(0x25d),'xebOx':'warn','EnNKc':_0x3cb646(0x1ad),'oimku':'error','icMPt':_0x3cb646(0x1da),'RpJyX':'table','PWgHU':_0x3cb646(0x199),'PgpGm':function(_0x3c8699,_0x25127d){return _0x3c8699<_0x25127d;},'VOfZA':_0x3cb646(0x223)},_0x55da2f=function(){const _0x28a11c=_0x3cb646,_0x508d29={'ckerq':function(_0x2ffec4,_0xc1d3f8){return _0x5b443d['imEFv'](_0x2ffec4,_0xc1d3f8);}};if(_0x5b443d[_0x28a11c(0x1ba)](_0x5b443d[_0x28a11c(0x168)],_0x5b443d[_0x28a11c(0x20b)])){const _0x562433=_0x5428ee['apply'](_0xa57709,arguments);return _0x531044=null,_0x562433;}else{let _0x14f961;try{_0x5b443d[_0x28a11c(0x1ba)](_0x5b443d[_0x28a11c(0x164)],_0x5b443d[_0x28a11c(0x200)])?function(){return!![];}['constructor'](_0x5b443d[_0x28a11c(0x205)](_0x5b443d['UZcLl'],_0x5b443d[_0x28a11c(0x19c)]))[_0x28a11c(0x18a)](_0x5b443d['NQQdU']):_0x14f961=_0x5b443d['imEFv'](Function,_0x5b443d[_0x28a11c(0x205)](_0x5b443d[_0x28a11c(0x255)](_0x5b443d[_0x28a11c(0x17d)],_0x5b443d[_0x28a11c(0x263)]),');'))();}catch(_0x55003e){if(_0x5b443d[_0x28a11c(0x151)](_0x5b443d[_0x28a11c(0x1e8)],_0x5b443d[_0x28a11c(0x206)]))_0x14f961=window;else{if(_0x12192b)return _0x45ecd5;else _0x508d29[_0x28a11c(0x1c4)](_0xe5a13b,0x0);}}return _0x14f961;}},_0x591c54=_0x5b443d[_0x3cb646(0x21e)](_0x55da2f),_0x46252d=_0x591c54[_0x3cb646(0x248)]=_0x591c54[_0x3cb646(0x248)]||{},_0x466939=[_0x5b443d[_0x3cb646(0x207)],_0x5b443d[_0x3cb646(0x167)],_0x5b443d['EnNKc'],_0x5b443d['oimku'],_0x5b443d[_0x3cb646(0x1cf)],_0x5b443d['RpJyX'],_0x5b443d[_0x3cb646(0x240)]];for(let _0x29c3aa=0x0;_0x5b443d[_0x3cb646(0x1b5)](_0x29c3aa,_0x466939['length']);_0x29c3aa++){if(_0x5b443d[_0x3cb646(0x1ba)](_0x5b443d[_0x3cb646(0x216)],_0x5b443d[_0x3cb646(0x216)])){const _0x2a8afc=_0x3ad8ce['constructor'][_0x3cb646(0x1e0)][_0x3cb646(0x17e)](_0x3ad8ce),_0x3ecb1f=_0x466939[_0x29c3aa],_0x19f25c=_0x46252d[_0x3ecb1f]||_0x2a8afc;_0x2a8afc[_0x3cb646(0x158)]=_0x3ad8ce[_0x3cb646(0x17e)](_0x3ad8ce),_0x2a8afc[_0x3cb646(0x1d3)]=_0x19f25c['toString']['bind'](_0x19f25c),_0x46252d[_0x3ecb1f]=_0x2a8afc;}else{_0x48e163=!0x1;return;}}});_0x432555();import _0x5c7db7 from'express';const N=_0x5c7db7['Router']();import{MongoClient as _0x51c50d}from'mongodb';import'path';import*as _0x5eab3d from'../mymodule/myDateTime.js';import*as _0x5e88db from'../mymodule/myUsers.js';import*as _0x17fc39 from'../mymodule/myModule.js';import*as _0x1bb70d from'../mymodule/myDocs.js';import _0x2c9b07 from'../middleware/mainAuth.js';const i=_0x1ffe22(0x1ec),P=_0x1ffe22(0x183),D=i+_0x1ffe22(0x16d),F=i+_0x1ffe22(0x1c2),H=i+_0x1ffe22(0x1c0),J=i+_0x1ffe22(0x245),L=i+'/status',M=i+'/print',U=i[_0x1ffe22(0x1b6)](/\//g,'_'),$=global[_0x1ffe22(0x195)],V=global[_0x1ffe22(0x1fc)],G=_0x1ffe22(0x25c),R=global[_0x1ffe22(0x159)];N['get'](i,_0x2c9b07[_0x1ffe22(0x192)],async(_0x4dc581,_0x319a10)=>{const _0x4ad812=_0x1ffe22,_0x28c6e7={'nnFWj':function(_0x5e212f,_0x5bf180){return _0x5e212f(_0x5bf180);},'jwWFL':function(_0xe66954,_0x61f545){return _0xe66954(_0x61f545);},'EEWue':function(_0x2333e4,_0x5af0e8){return _0x2333e4+_0x5af0e8;},'eyviu':_0x4ad812(0x213),'GGDpx':'{}.constructor(\x22return\x20this\x22)(\x20)','OXDag':function(_0x2b0a1e,_0x13f645){return _0x2b0a1e!==_0x13f645;},'kxyEb':'crEsN','EXBvU':'msg','djoYA':_0x4ad812(0x202),'ufuSu':function(_0x465d8f,_0x119040){return _0x465d8f===_0x119040;},'pMMvR':_0x4ad812(0x1f0)},{docId:_0xb40636,sip:_0x1f3400,sip_q:_0x20d15a}=_0x4dc581[_0x4ad812(0x20e)];try{if(_0x28c6e7[_0x4ad812(0x1bf)](_0x28c6e7['kxyEb'],_0x28c6e7[_0x4ad812(0x197)]))flSjjW[_0x4ad812(0x212)](_0x54a9bd,'0');else{const {dataSettings:_0x66acd8}=await _0x17fc39['getSettings'](),{dataSettings:_0x4501ee}=await _0x17fc39[_0x4ad812(0x1d0)](V),_0x4d24e2=_0x5e88db[_0x4ad812(0x189)](_0x4dc581),_0x46c5ef=await _0x17fc39[_0x4ad812(0x1f2)](G,_0x319a10,{'title':PAGE_INVOICE,'time':_0x5eab3d['formatDate'](new Date()),'msg':_0x4dc581[_0x4ad812(0x184)](_0x28c6e7['EXBvU']),'userFlash':_0x4dc581[_0x4ad812(0x184)](_0x28c6e7[_0x4ad812(0x208)]),..._0x4d24e2,'logoSrc_base64':_0x17fc39[_0x4ad812(0x15a)](R),'dataSettings':_0x66acd8,..._0x4501ee,'COLL_NAME':$,'PATH_MAIN':i,'PATH_SEARCH':J,'PATH_FETCH':P,'PATH_SAVE':D,'PATH_LOAD':H,'PATH_STATUS':L,'PATH_PRINT':M,'PATH_CHANGES':F,'PREFIX':U,'DOC_STATUS':JSON['stringify'](global[_0x4ad812(0x1bc)]),'DOC_ID':_0xb40636,'SIP':_0x1f3400,'SIP_QUOTATION':_0x20d15a});_0x319a10[_0x4ad812(0x171)](_0x46c5ef);}}catch(_0x33042f){if(_0x28c6e7[_0x4ad812(0x222)](_0x28c6e7[_0x4ad812(0x204)],_0x28c6e7['pMMvR']))console[_0x4ad812(0x25d)](_0x33042f),_0x319a10[_0x4ad812(0x1e9)](0x194)['sendFile'](file404);else{let _0x5e5dab;try{_0x5e5dab=flSjjW[_0x4ad812(0x1b8)](_0x34f897,flSjjW[_0x4ad812(0x1aa)](flSjjW[_0x4ad812(0x1aa)](flSjjW[_0x4ad812(0x181)],flSjjW[_0x4ad812(0x239)]),');'))();}catch(_0x42a93c){_0x5e5dab=_0x36af14;}return _0x5e5dab;}}}),N[_0x1ffe22(0x21c)](D,_0x2c9b07['isAuth'],async(_0x339bfc,_0x5a6cd6)=>{const _0xce4a2d=_0x1ffe22,_0x2699a4={'HvjGv':function(_0x366d4a,_0x264179){return _0x366d4a(_0x264179);},'iqbsZ':function(_0x38f291,_0xc18685){return _0x38f291(_0xc18685);},'NYXnJ':function(_0x3cdb21,_0x1a03a6){return _0x3cdb21+_0x1a03a6;},'wuhIf':function(_0x34fe74,_0x1e12c0){return _0x34fe74!==_0x1e12c0;},'HJiEz':_0xce4a2d(0x20a),'OZCRq':function(_0x27eb1c,_0x2a1bf0){return _0x27eb1c===_0x2a1bf0;},'mDOPY':function(_0x31af61,_0x4f0de4){return _0x31af61!==_0x4f0de4;},'EJEHX':'nJWQD','nfbqI':'EHHOZ','ylrRW':function(_0x10fb5f,_0x4b9086,_0x4ed0c9){return _0x10fb5f(_0x4b9086,_0x4ed0c9);},'jPzhD':function(_0x26dde6){return _0x26dde6();},'NEyuW':_0xce4a2d(0x247),'FiaRS':function(_0x3145b4){return _0x3145b4();},'QPooz':_0xce4a2d(0x1ff),'txvtc':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','dNdNj':function(_0x2d6432,_0x5bf947){return _0x2d6432(_0x5bf947);},'JcFQV':_0xce4a2d(0x234),'JfXCh':_0xce4a2d(0x198),'ifBuK':'input','mZpaA':function(_0x13dae5){return _0x13dae5();},'JbGCM':_0xce4a2d(0x233),'CjCIt':_0xce4a2d(0x1f1),'VTjlU':function(_0x13c70c,_0x4635ce){return _0x13c70c(_0x4635ce);},'kovVa':function(_0x46ec90,_0x24ac7c){return _0x46ec90===_0x24ac7c;},'nxnps':_0xce4a2d(0x236),'rpHcD':function(_0x3f1c71,_0x377a20){return _0x3f1c71===_0x377a20;},'PSUGO':_0xce4a2d(0x1ee),'GvXhI':function(_0x218195,_0x144d72){return _0x218195(_0x144d72);},'WWKXh':function(_0x4a9d6f,_0x2387bb){return _0x4a9d6f&&_0x2387bb;},'uroFA':_0xce4a2d(0x21a),'CdfcG':_0xce4a2d(0x155),'gtNgI':function(_0x2841f7,_0x315594){return _0x2841f7>_0x315594;},'VwmwI':function(_0x2ff91c,_0x1637c1){return _0x2ff91c!==_0x1637c1;},'WGDgu':_0xce4a2d(0x251),'KVFVp':function(_0x293551,_0x553da8){return _0x293551+_0x553da8;},'MRtAN':'green','aKexL':function(_0x536e2b,_0x45174f){return _0x536e2b==_0x45174f;},'EkqNy':_0xce4a2d(0x1eb),'qASbN':'ไม่พบเอกสารที่ต้องการอัปเดท\x20หรือ{{sep}}ไม่สามารถบันทึกเอกสารที่ตนเองไม่ได้สร้าง','lEqQn':function(_0x1ef296,_0x504c8e){return _0x1ef296===_0x504c8e;},'lvPjZ':_0xce4a2d(0x188),'sAzrA':_0xce4a2d(0x1db),'ZcErz':_0xce4a2d(0x209),'gVIxN':_0xce4a2d(0x262),'jviXD':function(_0xe5f626,_0x46f7cf){return _0xe5f626<_0x46f7cf;},'aYIOp':_0xce4a2d(0x1ed),'TRaJZ':_0xce4a2d(0x15d),'OjthH':_0xce4a2d(0x1f9),'jPLRe':function(_0x3b8aac,_0x5e8f25){return _0x3b8aac>_0x5e8f25;},'TSZWS':function(_0x37e2e6,_0x436b5d){return _0x37e2e6<_0x436b5d;},'gOPea':function(_0x9e1935,_0x378e25){return _0x9e1935==_0x378e25;},'ftVWL':_0xce4a2d(0x237),'kJnfM':_0xce4a2d(0x18d),'dYaGw':_0xce4a2d(0x162),'nIpGL':function(_0x43f066){return _0x43f066();}},_0x25a139=[];let _0x1defc6=!0x1;const _0x3a1d5c=async()=>{const _0x2e8e3d=_0xce4a2d;if(_0x2699a4[_0x2e8e3d(0x161)](_0x2699a4[_0x2e8e3d(0x176)],_0x2699a4[_0x2e8e3d(0x176)])){const _0x5cdb6d=_0x36fe69?function(){const _0x31de2d=_0x2e8e3d;if(_0x3d24bd){const _0x4ae749=_0x3e3f0d[_0x31de2d(0x1c8)](_0x4c01a8,arguments);return _0x18d130=null,_0x4ae749;}}:function(){};return _0x45eb25=![],_0x5cdb6d;}else{if(_0x2699a4[_0x2e8e3d(0x253)](_0x25a139[_0x2e8e3d(0x230)],0x0)){if(_0x2699a4[_0x2e8e3d(0x1a4)](_0x2699a4[_0x2e8e3d(0x1c9)],_0x2699a4[_0x2e8e3d(0x17c)])){_0x1defc6=!0x1;return;}else{const _0x10e8c2=_0x36491a[0x0][_0x2e8e3d(0x18b)][_0x2e8e3d(0x20c)]('/'),_0x3c8539=_0x2699a4[_0x2e8e3d(0x1b7)](_0x260f1c,_0x10e8c2[0x1]['split']('-')[0x1]);_0x138408=''+_0x2a4a41+_0x1f08ac+'/'+_0x321fbc+'-'+_0x2699a4[_0x2e8e3d(0x163)](_0x3d37eb,_0x2699a4['NYXnJ'](_0x3c8539,0x1))['padStart'](0x5,'0');}}_0x1defc6=!0x0;const {req:_0x4bd741,res:_0x2440f8}=_0x25a139[_0x2e8e3d(0x254)]();await _0x2699a4['ylrRW'](_0x1055cd,_0x4bd741,_0x2440f8),_0x2699a4[_0x2e8e3d(0x193)](_0x3a1d5c);}},_0x1055cd=async(_0x5efa3b,_0x15843a)=>{const _0x2f8c79=_0xce4a2d,_0x888fee={'gQGTu':_0x2699a4[_0x2f8c79(0x243)],'MXINH':_0x2699a4['CjCIt'],'RHtKM':function(_0x271863,_0x1396b1){const _0x417b98=_0x2f8c79;return _0x2699a4[_0x417b98(0x16b)](_0x271863,_0x1396b1);}};if(_0x2699a4[_0x2f8c79(0x1f4)](_0x2699a4[_0x2f8c79(0x219)],_0x2699a4['nxnps'])){const _0x585ceb=new _0x51c50d(global['dbUrl']);try{if(_0x2699a4[_0x2f8c79(0x1dc)](_0x2699a4[_0x2f8c79(0x258)],_0x2699a4[_0x2f8c79(0x258)])){let {userId:_0x1edb99,userFullname:_0x3d2c02}=_0x5e88db[_0x2f8c79(0x1c6)](_0x5efa3b);_0x1edb99=_0x1edb99&&_0x2699a4[_0x2f8c79(0x1d9)](Number,_0x1edb99),_0x5efa3b[_0x2f8c79(0x169)]=_0x1bb70d[_0x2f8c79(0x17b)](_0x5efa3b[_0x2f8c79(0x169)]);const _0x30ddd2=_0x585ceb['db'](global[_0x2f8c79(0x1fe)])[_0x2f8c79(0x226)]($),_0x27f952=_0x5efa3b['body'][_0x2f8c79(0x1de)],_0x643203=_0x5efa3b[_0x2f8c79(0x169)]['docId']?_0x5efa3b[_0x2f8c79(0x169)][_0x2f8c79(0x18b)]:null;if(_0x2699a4[_0x2f8c79(0x191)](!_0x27f952,!_0x643203)){if(_0x2699a4[_0x2f8c79(0x161)](_0x2699a4[_0x2f8c79(0x182)],_0x2699a4[_0x2f8c79(0x1d8)])){const _0x2c45fc=await _0x30ddd2[_0x2f8c79(0x18e)]()['sort']({'_id':-0x1})[_0x2f8c79(0x23b)](0x1)[_0x2f8c79(0x229)](),_0x2f30fe=new Date()[_0x2f8c79(0x15b)]()[_0x2f8c79(0x1d3)]()[_0x2f8c79(0x17a)](-0x2),_0x4d7bbb=_0x2699a4['NYXnJ'](new Date()[_0x2f8c79(0x252)](),0x1)[_0x2f8c79(0x1d3)]()[_0x2f8c79(0x1a9)](0x2,'0'),_0x4a8d88='IV';let _0xbd949a=''+_0x4a8d88+_0x2f30fe+'/'+_0x4d7bbb+_0x2f8c79(0x1dd);if(_0x2699a4[_0x2f8c79(0x256)](_0x2c45fc[_0x2f8c79(0x230)],0x0)){if(_0x2699a4['VwmwI'](_0x2699a4['WGDgu'],_0x2699a4['WGDgu'])){if(_0x954b0b){const _0x45efcb=_0x1a0a19['apply'](_0xde5d9c,arguments);return _0x21ce06=null,_0x45efcb;}}else{const _0xf66225=_0x2c45fc[0x0][_0x2f8c79(0x18b)][_0x2f8c79(0x20c)]('/'),_0x5c0bd2=_0x2699a4[_0x2f8c79(0x187)](Number,_0xf66225[0x1][_0x2f8c79(0x20c)]('-')[0x1]);_0xbd949a=''+_0x4a8d88+_0x2f30fe+'/'+_0x4d7bbb+'-'+_0x2699a4[_0x2f8c79(0x187)](String,_0x2699a4['KVFVp'](_0x5c0bd2,0x1))[_0x2f8c79(0x1a9)](0x5,'0');}}_0x5efa3b['body'][_0x2f8c79(0x18b)]=_0xbd949a,_0x5efa3b['body'][_0x2f8c79(0x1de)]=0x1,await _0x30ddd2['insertOne'](_0x5efa3b['body']),_0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'isSave':!0x0,'class':_0x2699a4[_0x2f8c79(0x225)],'msg':_0x2f8c79(0x1e6)+_0xbd949a+'\x20เรียบร้อยแล้ว','docId':_0xbd949a,'docStatusNumber':0x1}));}else _0x2bc833[_0x2f8c79(0x25d)](_0x53e4d1),_0x537d33[_0x2f8c79(0x171)](_0x373f15[_0x2f8c79(0x1ca)]({'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x24b)],'msg':_0x53092f['message']}));}else{if(_0x2699a4[_0x2f8c79(0x1bd)](_0x27f952,0x1)&&_0x643203){if(_0x2699a4['rpHcD'](_0x2699a4['EkqNy'],_0x2699a4[_0x2f8c79(0x22c)])){const _0x4fe8ee=await _0x30ddd2[_0x2f8c79(0x1b3)]({'docId':_0x643203,'proposerId':_0x1edb99});if(!_0x4fe8ee)return _0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x24b)],'msg':_0x2699a4[_0x2f8c79(0x211)]}));const _0xa9bcd0=await _0x30ddd2['updateOne']({'docId':_0x643203,'proposerId':_0x1edb99},{'$set':_0x5efa3b[_0x2f8c79(0x169)]});if(_0x2699a4[_0x2f8c79(0x256)](_0xa9bcd0[_0x2f8c79(0x241)],0x0)){if(_0x2699a4[_0x2f8c79(0x16a)](_0x2699a4['lvPjZ'],_0x2699a4['sAzrA']))rIyyxr['FiaRS'](_0x36c077);else{const _0xf87415=_0x1bb70d['getChangeHistory'](_0x4fe8ee,_0x5efa3b['body']);if(_0x2699a4['gtNgI'](_0xf87415['length'],0x0)){if(_0x2699a4[_0x2f8c79(0x1a4)](_0x2699a4[_0x2f8c79(0x1c7)],_0x2699a4['gVIxN'])){const _0xe29e80={'dateTime':_0x5eab3d[_0x2f8c79(0x20d)](new Date()),'userId':_0x1edb99,'userFullname':_0x3d2c02,'changes':_0xf87415};return await _0x30ddd2[_0x2f8c79(0x166)]({'docId':_0x643203},{'$push':{'changesHistory':{'$each':[_0xe29e80],'$position':0x0}}}),_0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'docId':_0x643203,'docStatusNumber':_0x27f952,'isSave':!0x0,'class':_0x2699a4[_0x2f8c79(0x225)],'msg':_0x2f8c79(0x18c)+_0x643203+_0x2f8c79(0x23c)}));}else return function(_0x452e04){}[_0x2f8c79(0x1a3)](MoZXKI[_0x2f8c79(0x221)])['apply'](MoZXKI[_0x2f8c79(0x1a8)]);}else return _0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'docId':_0x643203,'docStatusNumber':_0x27f952,'isSave':!0x0,'class':_0x2699a4[_0x2f8c79(0x225)],'msg':'อัปเดท\x20'+_0x643203+_0x2f8c79(0x1e5)}));}}else{if(_0xa9bcd0['acknowledged']&&_0x2699a4[_0x2f8c79(0x1b1)](_0xa9bcd0[_0x2f8c79(0x241)],0x1))return _0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'docId':_0x643203,'docStatusNumber':_0x27f952,'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x1c3)],'msg':'\x22'+_0x643203+'\x22\x20ไม่มีการเปลี่ยนแปลงข้อมูล'}));}}else{const _0x347f7d=new _0x386cc8(rIyyxr['QPooz']),_0x1154cb=new _0x1979da(rIyyxr[_0x2f8c79(0x157)],'i'),_0x29bafd=rIyyxr['dNdNj'](_0xd81e46,rIyyxr['JcFQV']);!_0x347f7d['test'](rIyyxr[_0x2f8c79(0x23d)](_0x29bafd,rIyyxr[_0x2f8c79(0x24c)]))||!_0x1154cb[_0x2f8c79(0x1a2)](rIyyxr[_0x2f8c79(0x23d)](_0x29bafd,rIyyxr[_0x2f8c79(0x180)]))?rIyyxr[_0x2f8c79(0x163)](_0x29bafd,'0'):rIyyxr['mZpaA'](_0x911f29);}}else{if(_0x2699a4[_0x2f8c79(0x1bd)](_0x27f952,0x2)&&_0x643203){if(_0x2699a4[_0x2f8c79(0x16a)](_0x2699a4[_0x2f8c79(0x231)],_0x2699a4[_0x2f8c79(0x232)])){const _0x143523=_0x363483[_0x2f8c79(0x1c8)](_0x32d4a8,arguments);return _0x5b86c9=null,_0x143523;}else{if(!await _0x30ddd2[_0x2f8c79(0x1b3)]({'docId':_0x643203,'proposerId':_0x1edb99}))return _0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x24b)],'msg':_0x2699a4['qASbN']}));const _0x438d63=await _0x30ddd2['updateOne']({'docId':_0x643203,'proposerId':_0x1edb99},{'$set':{'selectProposerSignature':_0x5efa3b[_0x2f8c79(0x169)]['selectProposerSignature'],'selectBottomLeftSignature':_0x5efa3b[_0x2f8c79(0x169)][_0x2f8c79(0x25e)]}});if(_0x2699a4[_0x2f8c79(0x1cb)](_0x438d63[_0x2f8c79(0x241)],0x0))return _0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'docId':_0x643203,'docStatusNumber':_0x27f952,'isSave':!0x0,'class':_0x2699a4[_0x2f8c79(0x225)],'msg':_0x2f8c79(0x18c)+_0x643203+_0x2f8c79(0x1e5)}));if(_0x438d63[_0x2f8c79(0x19f)]&&_0x2699a4['TSZWS'](_0x438d63[_0x2f8c79(0x241)],0x1))return _0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'docId':_0x643203,'docStatusNumber':_0x27f952,'isSave':!0x1,'class':_0x2699a4['aYIOp'],'msg':'\x22'+_0x643203+'\x22\x20ไม่มีการเปลี่ยนแปลงข้อมูล'}));}}else return _0x2699a4[_0x2f8c79(0x203)](_0x27f952,0xa)?_0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x24b)],'msg':_0x2f8c79(0x22a)+_0x27f952+_0x2f8c79(0x1df)})):_0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x24b)],'msg':_0x2699a4[_0x2f8c79(0x152)]}));}}}else return![];}catch(_0x78684d){_0x2699a4['mDOPY'](_0x2699a4[_0x2f8c79(0x21d)],_0x2699a4[_0x2f8c79(0x21d)])?MoZXKI[_0x2f8c79(0x246)](_0x17a93d,0x0):(console['log'](_0x78684d),_0x15843a[_0x2f8c79(0x171)](JSON[_0x2f8c79(0x1ca)]({'isSave':!0x1,'class':_0x2699a4[_0x2f8c79(0x24b)],'msg':_0x78684d[_0x2f8c79(0x1f5)]})));}finally{if(_0x2699a4[_0x2f8c79(0x257)](_0x2699a4[_0x2f8c79(0x1b4)],_0x2699a4[_0x2f8c79(0x1b4)])){if(_0x35ba3e){const _0x3e53d1=_0x2553b1['apply'](_0x4b379d,arguments);return _0x5e1c2b=null,_0x3e53d1;}}else _0x585ceb[_0x2f8c79(0x1f7)]();}}else{const _0x336ee8=_0x4af220?function(){if(_0x5cdf8e){const _0x3f8b84=_0x3788e1['apply'](_0x41bc7f,arguments);return _0x1ca132=null,_0x3f8b84;}}:function(){};return _0x3e9d8e=![],_0x336ee8;}};_0x25a139[_0xce4a2d(0x218)]({'req':_0x339bfc,'res':_0x5a6cd6}),_0x1defc6||_0x2699a4[_0xce4a2d(0x16e)](_0x3a1d5c);});export default N;function _0x1b93b4(_0x50c45d){const _0x5ec9fa=_0x1ffe22,_0x24a0a9={'YkEuR':function(_0x5a1de4,_0x1858f3){return _0x5a1de4===_0x1858f3;},'zjjqh':_0x5ec9fa(0x201),'uKSKR':_0x5ec9fa(0x233),'sOkOI':_0x5ec9fa(0x1f1),'bEFVW':function(_0x5de81a,_0x1ee6e3){return _0x5de81a!==_0x1ee6e3;},'mqOiN':function(_0x1b3691,_0x7719f4){return _0x1b3691+_0x7719f4;},'LZBof':function(_0x43dc26,_0xb8b87){return _0x43dc26/_0xb8b87;},'GTMlT':_0x5ec9fa(0x230),'vxHtB':function(_0x5a6de5,_0x4fb8c4){return _0x5a6de5===_0x4fb8c4;},'VObZE':function(_0x36206f,_0x338039){return _0x36206f%_0x338039;},'VbQTU':_0x5ec9fa(0x24f),'qFyRd':_0x5ec9fa(0x1e1),'byYak':_0x5ec9fa(0x1fb),'XoKVP':function(_0x504950,_0x2e5d95){return _0x504950+_0x2e5d95;},'ULcml':'stateObject','iRQaq':function(_0x11ba35,_0xc04386){return _0x11ba35(_0xc04386);},'GTqEp':function(_0x3f3c7d,_0x248fce){return _0x3f3c7d(_0x248fce);}};function _0x325444(_0x1a1d28){const _0x5565c9=_0x5ec9fa;if(_0x24a0a9['YkEuR'](typeof _0x1a1d28,_0x24a0a9['zjjqh']))return function(_0x19981d){}['constructor'](_0x24a0a9[_0x5565c9(0x18f)])['apply'](_0x24a0a9['sOkOI']);else _0x24a0a9[_0x5565c9(0x25f)](_0x24a0a9[_0x5565c9(0x1ea)]('',_0x24a0a9[_0x5565c9(0x224)](_0x1a1d28,_0x1a1d28))[_0x24a0a9[_0x5565c9(0x1e3)]],0x1)||_0x24a0a9[_0x5565c9(0x249)](_0x24a0a9[_0x5565c9(0x19b)](_0x1a1d28,0x14),0x0)?function(){return!![];}['constructor'](_0x24a0a9[_0x5565c9(0x1ea)](_0x24a0a9['VbQTU'],_0x24a0a9['qFyRd']))[_0x5565c9(0x18a)](_0x24a0a9[_0x5565c9(0x1bb)]):function(){return![];}[_0x5565c9(0x1a3)](_0x24a0a9['XoKVP'](_0x24a0a9['VbQTU'],_0x24a0a9[_0x5565c9(0x220)]))['apply'](_0x24a0a9[_0x5565c9(0x1ae)]);_0x24a0a9[_0x5565c9(0x190)](_0x325444,++_0x1a1d28);}try{if(_0x50c45d)return _0x325444;else _0x24a0a9['GTqEp'](_0x325444,0x0);}catch(_0x5c3ac0){}}