const _0x221b35=_0x3e48;(function(_0x2468d7,_0x65eb8e){const _0xd2ee58=_0x3e48,_0x120963=_0x2468d7();while(!![]){try{const _0x3b0aae=parseInt(_0xd2ee58(0x1e5))/0x1*(-parseInt(_0xd2ee58(0x2e8))/0x2)+-parseInt(_0xd2ee58(0x28c))/0x3+parseInt(_0xd2ee58(0x2a5))/0x4*(-parseInt(_0xd2ee58(0x2f7))/0x5)+-parseInt(_0xd2ee58(0x249))/0x6*(parseInt(_0xd2ee58(0x2f6))/0x7)+parseInt(_0xd2ee58(0x2d3))/0x8+-parseInt(_0xd2ee58(0x21f))/0x9+parseInt(_0xd2ee58(0x257))/0xa;if(_0x3b0aae===_0x65eb8e)break;else _0x120963['push'](_0x120963['shift']());}catch(_0x28ba79){_0x120963['push'](_0x120963['shift']());}}}(_0x8f49,0x29871));const _0x2c2bf5=(function(){const _0x10fce9=_0x3e48,_0x1991b6={'UHkgt':_0x10fce9(0x28b),'xzkXH':_0x10fce9(0x2db),'wjvul':function(_0x1c7bd4,_0x5e3b9d){return _0x1c7bd4(_0x5e3b9d);},'tJMQi':'init','sEVOa':function(_0x5847b9,_0x44defc){return _0x5847b9+_0x44defc;},'bQRxV':_0x10fce9(0x2d1),'WJipB':_0x10fce9(0x2f1),'lvKNb':function(_0xccad7d){return _0xccad7d();},'cVmdf':function(_0x1aced2,_0x5506fd,_0xacaf60){return _0x1aced2(_0x5506fd,_0xacaf60);},'YWZPW':function(_0x2bf5aa){return _0x2bf5aa();},'OpfYk':function(_0x14050b,_0x184dad){return _0x14050b!==_0x184dad;},'xSgIr':_0x10fce9(0x210),'TMZSC':function(_0xe859f5,_0x268163){return _0xe859f5===_0x268163;},'rFsen':_0x10fce9(0x224),'eRkIg':_0x10fce9(0x284),'NtyYM':'laZsB','auxAA':_0x10fce9(0x2dd)};let _0x35b488=!![];return function(_0x29e3fd,_0x3b1e1b){const _0x589a2e=_0x10fce9,_0x567f6b={'cNQZH':_0x1991b6[_0x589a2e(0x1f0)],'wFZZl':_0x1991b6[_0x589a2e(0x1f3)],'PnsBp':function(_0x4cdd07,_0x123772){const _0x333f6e=_0x589a2e;return _0x1991b6[_0x333f6e(0x2fa)](_0x4cdd07,_0x123772);},'wXEHJ':_0x1991b6[_0x589a2e(0x23f)],'jATbV':function(_0x4a627e,_0x2fb6c9){const _0x16adc7=_0x589a2e;return _0x1991b6[_0x16adc7(0x217)](_0x4a627e,_0x2fb6c9);},'cNSRx':_0x1991b6[_0x589a2e(0x25a)],'povwE':function(_0x5ce380,_0x3b387e){const _0x2a6ee5=_0x589a2e;return _0x1991b6[_0x2a6ee5(0x217)](_0x5ce380,_0x3b387e);},'YkYye':_0x1991b6[_0x589a2e(0x281)],'QntfR':function(_0x289e28){return _0x1991b6['lvKNb'](_0x289e28);},'CoXdn':function(_0x4388b1,_0x3dce17,_0x59985b){const _0x27cf1d=_0x589a2e;return _0x1991b6[_0x27cf1d(0x215)](_0x4388b1,_0x3dce17,_0x59985b);},'oQeFO':function(_0x6b73a2){const _0x1f6cf2=_0x589a2e;return _0x1991b6[_0x1f6cf2(0x331)](_0x6b73a2);},'QQtbW':function(_0x19845d,_0x10633f){const _0x23fabc=_0x589a2e;return _0x1991b6[_0x23fabc(0x2c8)](_0x19845d,_0x10633f);},'pEQKs':_0x1991b6[_0x589a2e(0x2f0)],'GhpPu':function(_0x539f4d,_0x1803b5){return _0x1991b6['TMZSC'](_0x539f4d,_0x1803b5);},'rRYaT':_0x1991b6['rFsen'],'vmuxs':_0x1991b6['eRkIg']};if(_0x1991b6[_0x589a2e(0x2c0)](_0x1991b6[_0x589a2e(0x31c)],_0x1991b6[_0x589a2e(0x2ce)]))_0x11a88e[_0x589a2e(0x272)]();else{const _0x4d5f1d=_0x35b488?function(){const _0x304dec=_0x589a2e,_0x663363={'GMjdz':_0x567f6b['cNQZH'],'byuKn':_0x567f6b[_0x304dec(0x328)],'qrQNi':function(_0x2b4a2b,_0x1361b2){return _0x567f6b['PnsBp'](_0x2b4a2b,_0x1361b2);},'BhhCF':_0x567f6b[_0x304dec(0x256)],'YOagY':function(_0x2b6adc,_0x5cfd80){const _0x538060=_0x304dec;return _0x567f6b[_0x538060(0x274)](_0x2b6adc,_0x5cfd80);},'TUUGN':_0x567f6b[_0x304dec(0x25f)],'fbVCl':_0x567f6b[_0x304dec(0x2eb)],'JZdJf':function(_0x4aba79,_0x2f4dfa){const _0x57171f=_0x304dec;return _0x567f6b[_0x57171f(0x2b1)](_0x4aba79,_0x2f4dfa);},'lhnDP':function(_0x1da22){const _0x39f70d=_0x304dec;return _0x567f6b[_0x39f70d(0x1f4)](_0x1da22);}};if(_0x567f6b[_0x304dec(0x24d)](_0x567f6b[_0x304dec(0x2c5)],_0x567f6b['pEQKs'])){const _0x12822f={'JlcYk':_0x567f6b['cNQZH'],'CQXtz':_0x567f6b['wFZZl'],'zouOK':function(_0x434c20,_0xf370c7){return _0x567f6b['PnsBp'](_0x434c20,_0xf370c7);},'wMBdx':_0x567f6b[_0x304dec(0x256)],'tzfre':function(_0x512c28,_0x1328ca){const _0x8d6cc2=_0x304dec;return _0x567f6b[_0x8d6cc2(0x253)](_0x512c28,_0x1328ca);},'kZXEB':_0x567f6b[_0x304dec(0x25f)],'qfTip':function(_0x5783a5,_0x31c4fe){return _0x567f6b['povwE'](_0x5783a5,_0x31c4fe);},'Kifqz':_0x567f6b['YkYye'],'rAHjY':function(_0x48247e){const _0x3e496c=_0x304dec;return _0x567f6b[_0x3e496c(0x26c)](_0x48247e);}};_0x567f6b[_0x304dec(0x2cf)](_0x4c492c,this,function(){const _0x3d7ffd=_0x304dec,_0x23ed05=new _0x455e08(_0x12822f[_0x3d7ffd(0x30a)]),_0x4abf2f=new _0x54cf58(_0x12822f[_0x3d7ffd(0x20a)],'i'),_0x5b22d6=_0x12822f[_0x3d7ffd(0x1fb)](_0x16971c,_0x12822f[_0x3d7ffd(0x1ea)]);!_0x23ed05[_0x3d7ffd(0x21e)](_0x12822f['tzfre'](_0x5b22d6,_0x12822f[_0x3d7ffd(0x22a)]))||!_0x4abf2f[_0x3d7ffd(0x21e)](_0x12822f['qfTip'](_0x5b22d6,_0x12822f[_0x3d7ffd(0x2cb)]))?_0x12822f[_0x3d7ffd(0x1fb)](_0x5b22d6,'0'):_0x12822f[_0x3d7ffd(0x241)](_0x55e980);})();}else{if(_0x3b1e1b){if(_0x567f6b[_0x304dec(0x1e4)](_0x567f6b[_0x304dec(0x2a7)],_0x567f6b[_0x304dec(0x2f4)])){const _0x3a5885=new _0x1c25ee(_0x663363[_0x304dec(0x304)]),_0x5e1f0c=new _0x448a1f(_0x663363[_0x304dec(0x24a)],'i'),_0x333c99=_0x663363[_0x304dec(0x243)](_0x37d090,_0x663363['BhhCF']);!_0x3a5885[_0x304dec(0x21e)](_0x663363[_0x304dec(0x2e0)](_0x333c99,_0x663363['TUUGN']))||!_0x5e1f0c[_0x304dec(0x21e)](_0x663363['YOagY'](_0x333c99,_0x663363[_0x304dec(0x2f5)]))?_0x663363[_0x304dec(0x2d7)](_0x333c99,'0'):_0x663363[_0x304dec(0x2c2)](_0x4a6856);}else{const _0x2ff4a5=_0x3b1e1b['apply'](_0x29e3fd,arguments);return _0x3b1e1b=null,_0x2ff4a5;}}}}:function(){};return _0x35b488=![],_0x4d5f1d;}};}());(function(){const _0x2dd102=_0x3e48,_0x1b40e7={'KgaWI':function(_0x3374e5,_0x21aa93){return _0x3374e5(_0x21aa93);},'OZrRi':function(_0x169822,_0x5c4b6d){return _0x169822+_0x5c4b6d;},'PShos':_0x2dd102(0x30b),'jgjwH':_0x2dd102(0x300),'AbNOQ':_0x2dd102(0x27f),'lNUnJ':function(_0x33137a,_0x3dfa4c){return _0x33137a===_0x3dfa4c;},'cFneh':_0x2dd102(0x313),'FAwAZ':_0x2dd102(0x228),'ktHxy':_0x2dd102(0x28b),'zoUyq':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','xyQEU':'init','KwQNV':'chain','uPKWN':_0x2dd102(0x2f1),'kMasX':function(_0x49e9aa,_0x5b9c95){return _0x49e9aa!==_0x5b9c95;},'nkPia':_0x2dd102(0x207),'UYoRM':_0x2dd102(0x299),'QmnPj':function(_0x48ac4a){return _0x48ac4a();},'tgyEV':function(_0x269718,_0x3c80bb,_0x430ef4){return _0x269718(_0x3c80bb,_0x430ef4);}};_0x1b40e7[_0x2dd102(0x28f)](_0x2c2bf5,this,function(){const _0x27e6cd=_0x2dd102;if(_0x1b40e7[_0x27e6cd(0x282)](_0x1b40e7[_0x27e6cd(0x28e)],_0x1b40e7['FAwAZ']))_0x1b40e7[_0x27e6cd(0x305)](_0x34505f,0x0);else{const _0x4121a1=new RegExp(_0x1b40e7[_0x27e6cd(0x22f)]),_0x4e350a=new RegExp(_0x1b40e7['zoUyq'],'i'),_0x4e52ea=_0x1b40e7[_0x27e6cd(0x305)](_0x4fd248,_0x1b40e7['xyQEU']);if(!_0x4121a1['test'](_0x1b40e7[_0x27e6cd(0x1fc)](_0x4e52ea,_0x1b40e7[_0x27e6cd(0x267)]))||!_0x4e350a[_0x27e6cd(0x21e)](_0x1b40e7[_0x27e6cd(0x1fc)](_0x4e52ea,_0x1b40e7[_0x27e6cd(0x29f)])))_0x1b40e7[_0x27e6cd(0x2f2)](_0x1b40e7[_0x27e6cd(0x265)],_0x1b40e7[_0x27e6cd(0x265)])?function(){return![];}[_0x27e6cd(0x29a)](_0x1b40e7[_0x27e6cd(0x1fc)](_0x1b40e7[_0x27e6cd(0x22e)],_0x1b40e7[_0x27e6cd(0x247)]))[_0x27e6cd(0x323)](_0x1b40e7['AbNOQ']):_0x1b40e7[_0x27e6cd(0x305)](_0x4e52ea,'0');else{if(_0x1b40e7['lNUnJ'](_0x1b40e7[_0x27e6cd(0x327)],_0x1b40e7[_0x27e6cd(0x327)]))_0x1b40e7[_0x27e6cd(0x211)](_0x4fd248);else{const _0x588b79=_0x3e8772?function(){const _0x4f0c0f=_0x27e6cd;if(_0x37d00d){const _0x4c2312=_0x4bf0fc[_0x4f0c0f(0x323)](_0x1dc2df,arguments);return _0x36df0f=null,_0x4c2312;}}:function(){};return _0x4a79a0=![],_0x588b79;}}}})();}());const _0x27ff8e=(function(){const _0x2d2b15=_0x3e48,_0x4b1c8d={'tJPjh':_0x2d2b15(0x2cd),'JWXLs':_0x2d2b15(0x2c6),'WrQEC':function(_0x383102,_0xf36ea4){return _0x383102!==_0xf36ea4;},'OHPZp':_0x2d2b15(0x233),'QCEfc':'JCgkW','ihmtR':function(_0x1e8921,_0x43c55d){return _0x1e8921===_0x43c55d;},'lXVVN':_0x2d2b15(0x2c9),'aHTLM':function(_0x271ec9,_0x2dbd3f){return _0x271ec9===_0x2dbd3f;},'gbulW':_0x2d2b15(0x214),'EvPUc':_0x2d2b15(0x246)};let _0x591107=!![];return function(_0x5b096f,_0xd20dfe){const _0x119c54=_0x2d2b15,_0x7a08a7={'Nrerc':_0x4b1c8d['tJPjh'],'yMTyH':_0x4b1c8d[_0x119c54(0x213)],'oukWe':function(_0x25818c,_0x3faf86){const _0x11b758=_0x119c54;return _0x4b1c8d[_0x11b758(0x225)](_0x25818c,_0x3faf86);},'KBFrM':_0x4b1c8d[_0x119c54(0x206)],'oNEYK':_0x4b1c8d[_0x119c54(0x29c)],'NzNXg':function(_0x69b490,_0x51ecec){return _0x4b1c8d['ihmtR'](_0x69b490,_0x51ecec);},'Hactw':_0x4b1c8d[_0x119c54(0x1ec)]};if(_0x4b1c8d['aHTLM'](_0x4b1c8d[_0x119c54(0x2c7)],_0x4b1c8d[_0x119c54(0x2bb)])){const _0x221646=_0x1f0f97?function(){const _0x47989d=_0x119c54;if(_0x282924){const _0x2eb40a=_0x524ec2[_0x47989d(0x323)](_0x56b883,arguments);return _0x1c7b55=null,_0x2eb40a;}}:function(){};return _0x2bcf51=![],_0x221646;}else{const _0x3e418a=_0x591107?function(){const _0x524e64=_0x119c54,_0x47bdd3={'aOIQc':_0x7a08a7[_0x524e64(0x306)],'ghhTi':_0x7a08a7['yMTyH']};if(_0x7a08a7['oukWe'](_0x7a08a7[_0x524e64(0x2a6)],_0x7a08a7[_0x524e64(0x2c3)])){if(_0xd20dfe){if(_0x7a08a7['NzNXg'](_0x7a08a7[_0x524e64(0x301)],_0x7a08a7[_0x524e64(0x301)])){const _0x373739=_0xd20dfe[_0x524e64(0x323)](_0x5b096f,arguments);return _0xd20dfe=null,_0x373739;}else _0xb7f47e[_0x524e64(0x2bf)](_0x47bdd3[_0x524e64(0x291)],_0x620753[_0x524e64(0x28d)]),_0x2fdc37['send'](_0x335130[_0x524e64(0x26a)]({'isPrint':!0x1,'class':_0x47bdd3['ghhTi'],'msg':_0x4c8975[_0x524e64(0x28d)]}));}}else _0x3c7a99['close']();}:function(){};return _0x591107=![],_0x3e418a;}};}()),_0x5cccd0=_0x27ff8e(this,function(){const _0x45f1dc=_0x3e48,_0x5e03b1={'RDKoF':_0x45f1dc(0x2d0),'MzAUT':'red','HJPLS':function(_0x54bc3a,_0x497edf){return _0x54bc3a===_0x497edf;},'kNfwF':'OGhiw','IcXuv':_0x45f1dc(0x333),'GUHSz':_0x45f1dc(0x20e),'ttmNt':function(_0x54fcff,_0x306294){return _0x54fcff(_0x306294);},'jqIrG':function(_0x47406f,_0xd00fe8){return _0x47406f+_0xd00fe8;},'LnZxL':_0x45f1dc(0x2b9),'ijZLk':_0x45f1dc(0x26b),'KpfqD':_0x45f1dc(0x31a),'lfHOc':_0x45f1dc(0x260),'SMMZR':function(_0x283d8c,_0x1fe606){return _0x283d8c+_0x1fe606;},'ihQyN':function(_0x548c66,_0x41a7d4){return _0x548c66+_0x41a7d4;},'FIxWp':function(_0x3b7700){return _0x3b7700();},'BniwL':'log','zCRHS':_0x45f1dc(0x2be),'okmcs':'info','JNIjt':_0x45f1dc(0x2fc),'cXaSM':_0x45f1dc(0x21d),'bbhTL':_0x45f1dc(0x2a1),'EBLzY':'trace','czlcy':function(_0x1a3f83,_0x163869){return _0x1a3f83<_0x163869;},'sYWht':_0x45f1dc(0x1f6),'IZZrs':'DueUO'},_0x11bdf5=function(){const _0x2fcbbd=_0x45f1dc,_0x2a0114={'jJMGq':_0x5e03b1[_0x2fcbbd(0x2ee)],'dlsmE':_0x5e03b1['MzAUT']};if(_0x5e03b1[_0x2fcbbd(0x26d)](_0x5e03b1[_0x2fcbbd(0x316)],_0x5e03b1[_0x2fcbbd(0x203)]))_0x441d5a['log'](_0x2c0dcd),_0x3c7cdb[_0x2fcbbd(0x2ac)](_0x2a0114[_0x2fcbbd(0x290)],{'class':_0x2a0114[_0x2fcbbd(0x252)],'text':''+_0x2262da[_0x2fcbbd(0x28d)]}),_0x354534['status'](0x194)['sendFile'](_0x30d651);else{let _0x20b844;try{if(_0x5e03b1['HJPLS'](_0x5e03b1['GUHSz'],_0x5e03b1[_0x2fcbbd(0x24b)]))_0x20b844=_0x5e03b1[_0x2fcbbd(0x286)](Function,_0x5e03b1['jqIrG'](_0x5e03b1['jqIrG'](_0x5e03b1[_0x2fcbbd(0x2a0)],_0x5e03b1[_0x2fcbbd(0x30e)]),');'))();else return _0x38de70[_0x2fcbbd(0x2ac)](_0x2a0114[_0x2fcbbd(0x290)],{'class':_0x2a0114['dlsmE'],'text':_0x346cd5['message']}),_0x15bfec[_0x2fcbbd(0x26e)](_0xcf2fb5);}catch(_0x4413d7){if(_0x5e03b1[_0x2fcbbd(0x26d)](_0x5e03b1['KpfqD'],_0x5e03b1['lfHOc'])){const _0x51fab7=_0x5c0698[_0x2fcbbd(0x323)](_0x282d7a,arguments);return _0x502efa=null,_0x51fab7;}else _0x20b844=window;}return _0x20b844;}},_0x2a69e7=_0x5e03b1[_0x45f1dc(0x2ea)](_0x11bdf5),_0x4d0aa8=_0x2a69e7[_0x45f1dc(0x29e)]=_0x2a69e7['console']||{},_0x23e852=[_0x5e03b1[_0x45f1dc(0x1f5)],_0x5e03b1[_0x45f1dc(0x201)],_0x5e03b1[_0x45f1dc(0x1ef)],_0x5e03b1[_0x45f1dc(0x2e1)],_0x5e03b1[_0x45f1dc(0x21c)],_0x5e03b1[_0x45f1dc(0x1e9)],_0x5e03b1['EBLzY']];for(let _0x53d542=0x0;_0x5e03b1[_0x45f1dc(0x227)](_0x53d542,_0x23e852[_0x45f1dc(0x2aa)]);_0x53d542++){if(_0x5e03b1[_0x45f1dc(0x26d)](_0x5e03b1[_0x45f1dc(0x30d)],_0x5e03b1[_0x45f1dc(0x24f)]))_0x537e7f=_0x5e03b1['ttmNt'](_0x4cfd0c,_0x5e03b1[_0x45f1dc(0x30f)](_0x5e03b1[_0x45f1dc(0x262)](_0x5e03b1[_0x45f1dc(0x2a0)],_0x5e03b1[_0x45f1dc(0x30e)]),');'))();else{const _0x2a2f2e=_0x27ff8e['constructor'][_0x45f1dc(0x205)]['bind'](_0x27ff8e),_0x93b5fe=_0x23e852[_0x53d542],_0x4c25d1=_0x4d0aa8[_0x93b5fe]||_0x2a2f2e;_0x2a2f2e['__proto__']=_0x27ff8e['bind'](_0x27ff8e),_0x2a2f2e[_0x45f1dc(0x1fe)]=_0x4c25d1[_0x45f1dc(0x1fe)][_0x45f1dc(0x2bd)](_0x4c25d1),_0x4d0aa8[_0x93b5fe]=_0x2a2f2e;}}});_0x5cccd0();import _0x387618 from'express';const $=_0x387618[_0x221b35(0x2b2)]();import{MongoClient as _0x477d8e,ObjectId as _0x19084f}from'mongodb';import _0x2189a6 from'ejs';function _0x3e48(_0x21019a,_0x13e570){const _0x419c97=_0x8f49();return _0x3e48=function(_0x5cccd0,_0x27ff8e){_0x5cccd0=_0x5cccd0-0x1e4;let _0x2ff613=_0x419c97[_0x5cccd0];return _0x2ff613;},_0x3e48(_0x21019a,_0x13e570);}import _0x2c259e from'fs';import _0x275357 from'path';import*as _0x24fb3b from'../mymodule/myDateTime.js';import*as _0x176a16 from'../mymodule/myUsers.js';import*as _0x43cc84 from'../mymodule/myModule.js';import _0x319977 from'../middleware/mainAuth.js';const l=_0x221b35(0x302),T=l+_0x221b35(0x2de),P=l+_0x221b35(0x25c),E=l+_0x221b35(0x2e6),H=l+'/import',S=l+_0x221b35(0x1fa),J=l['replace'](/\//g,'_');$[_0x221b35(0x24e)](l,_0x319977['isOA'],async(_0x5693e4,_0x3c26a5)=>{const _0x336c70=_0x221b35,_0xb3d9f={'gYeut':_0x336c70(0x2d0),'UNhCe':'red','hvKnz':function(_0x296dcb,_0x1a440b){return _0x296dcb(_0x1a440b);},'jZNIn':function(_0x264a73,_0x1b1cd0){return _0x264a73+_0x1b1cd0;},'xYzQr':_0x336c70(0x30b),'nVTlD':_0x336c70(0x300),'gEhJB':_0x336c70(0x2ad),'EOyHt':function(_0x3662b6,_0x428811){return _0x3662b6(_0x428811);},'KfCpw':function(_0x2dab8b,_0x4eec2d){return _0x2dab8b(_0x4eec2d);},'nXuYj':function(_0x4848af,_0x26e739){return _0x4848af(_0x26e739);},'rqrPm':function(_0x2226c1,_0x503136){return _0x2226c1*_0x503136;},'goJuT':function(_0x3a908f,_0x3fb30d){return _0x3a908f-_0x3fb30d;},'TYWRX':function(_0x3edc58,_0x3822fb){return _0x3edc58===_0x3822fb;},'neUuo':_0x336c70(0x1fd),'QXfJk':_0x336c70(0x1e8),'iRuxF':_0x336c70(0x319),'rvBae':function(_0x29f20d,_0x4a88cd){return _0x29f20d!==_0x4a88cd;},'rSOmz':_0x336c70(0x2ec),'NOBlO':_0x336c70(0x1ff),'sXwQM':_0x336c70(0x240),'MViHi':function(_0x215020,_0x112864){return _0x215020/_0x112864;},'towCT':function(_0x59fd1f,_0x319484){return _0x59fd1f<_0x319484;},'UUbOs':function(_0x559ba2,_0x4dedbb){return _0x559ba2-_0x4dedbb;},'KyvbW':function(_0x2319bf,_0x5b6150){return _0x2319bf-_0x5b6150;},'BiLzx':function(_0x5a99c6,_0x2d6028){return _0x5a99c6(_0x2d6028);},'erpgk':function(_0x3f770c,_0x7fa21c){return _0x3f770c>_0x7fa21c;},'NmpWC':function(_0x551464,_0x4f06fc){return _0x551464+_0x4f06fc;},'IeIir':function(_0x21c864,_0x1821af){return _0x21c864(_0x1821af);},'NoHeE':function(_0xaba98d,_0x1e9298){return _0xaba98d!==_0x1e9298;},'LADSi':_0x336c70(0x329),'GbEGe':_0x336c70(0x2ed),'NgQwW':_0x336c70(0x2a3),'AvbfC':'customers','iLMNg':_0x336c70(0x248),'EfYCH':'DVVJc','WBZud':_0x336c70(0x204)},_0x518357=_0x5693e4[_0x336c70(0x254)][_0x336c70(0x242)]?.[_0x336c70(0x2f9)]()['replace'](/[$.*?]/g,'\x20')||'',_0x516a99=_0xb3d9f[_0x336c70(0x20f)](Number,_0x5693e4[_0x336c70(0x254)][_0x336c70(0x298)])||0x14,_0x22c12a=_0xb3d9f[_0x336c70(0x27c)](Number,_0x5693e4[_0x336c70(0x254)][_0x336c70(0x32c)])||0x1,_0x1c6137=_0x5693e4[_0x336c70(0x254)][_0x336c70(0x1f7)]||'',_0x17e9a3=_0xb3d9f[_0x336c70(0x202)](Number,_0xb3d9f[_0x336c70(0x216)](_0xb3d9f['goJuT'](_0x22c12a,0x1),_0x516a99)),_0x559936=new _0x477d8e(dbUrl);try{if(_0xb3d9f[_0x336c70(0x2e3)](_0xb3d9f[_0x336c70(0x292)],_0xb3d9f[_0x336c70(0x292)])){const _0x4d2d2d={'_id':0x1,'customerId':0x1,'customerStatus':0x1,'customerType':0x1,'customerName':0x1,'customerAddress1':0x1,'customerAddress2':0x1,'customerPhone':0x1,'customerWebsite':0x1,'customerEmail':0x1,'customerIdentityId':0x1,'customerTaxId':0x1,'customerContactPerson':0x1,'canDelete':0x1,'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x24fb3b[_0x336c70(0x259)]()[_0x336c70(0x2df)](0x0,0x10)['replace']('T','\x20')},'endDate':{'$toDate':_0xb3d9f['QXfJk']},'unit':_0xb3d9f[_0x336c70(0x20d)]}},0x0]},'then':!0x0,'else':!0x1}}};await _0x559936[_0x336c70(0x294)]();const _0x3bfea0=_0x559936['db'](dbName)['collection'](global[_0x336c70(0x2dc)]);if(_0x518357){if(_0xb3d9f[_0x336c70(0x293)](_0xb3d9f[_0x336c70(0x30c)],_0xb3d9f['NOBlO'])){const _0x1ec7dc=new RegExp(_0x518357[_0x336c70(0x25b)](/[.*+?^${}()|[\]\\]/g,_0xb3d9f[_0x336c70(0x318)]),'i');var _0x47a643=await _0x3bfea0[_0x336c70(0x266)]({'$or':[{'customerId':{'$regex':_0x1ec7dc}},{'customerName':{'$regex':_0x1ec7dc}}]});}else return _0x24ca87[_0x336c70(0x2ac)](_0xb3d9f[_0x336c70(0x2b5)],{'class':_0xb3d9f[_0x336c70(0x231)],'text':''+_0x20f58a[_0x336c70(0x28d)]}),_0x56724f['redirect'](_0x16bd5b);}else var _0x47a643=await _0x3bfea0['countDocuments']({});const _0x592d7a=Math['ceil'](_0xb3d9f[_0x336c70(0x235)](_0x47a643,_0x516a99)),_0x59699a=_0xb3d9f[_0x336c70(0x2a2)](_0xb3d9f[_0x336c70(0x1e7)](_0xb3d9f[_0x336c70(0x202)](Number,_0x22c12a),0x1),0x1)?'-':_0xb3d9f[_0x336c70(0x312)](_0xb3d9f[_0x336c70(0x31e)](Number,_0x22c12a),0x1),_0x4baf04=_0xb3d9f['BiLzx'](Number,_0x22c12a),_0x379270=_0xb3d9f[_0x336c70(0x2b6)](_0xb3d9f[_0x336c70(0x317)](_0xb3d9f[_0x336c70(0x268)](Number,_0x22c12a),0x1),_0x592d7a)?'-':_0xb3d9f[_0x336c70(0x2a4)](_0xb3d9f[_0x336c70(0x27c)](Number,_0x22c12a),0x1),_0x551ea0=[{'$project':_0x4d2d2d},{'$sort':{'customerId':0x1}},{'$skip':_0x17e9a3},{'$limit':_0x516a99}];if(_0x518357){if(_0xb3d9f[_0x336c70(0x2e2)](_0xb3d9f[_0x336c70(0x273)],_0xb3d9f[_0x336c70(0x2e7)])){const _0x29d54c=_0x518357?new RegExp(''+_0x518357,'i'):new RegExp('.*');_0x551ea0[_0x336c70(0x2a8)]({'$match':{'$or':[{'customerId':{'$regex':_0x29d54c}},{'customerName':{'$regex':_0x29d54c}}]}});}else return!![];}const _0x85679f=await _0x3bfea0[_0x336c70(0x269)](_0x551ea0)['toArray']();if(_0x1c6137){if(_0xb3d9f[_0x336c70(0x2e3)](_0xb3d9f[_0x336c70(0x32a)],_0xb3d9f[_0x336c70(0x32a)])){var _0x3c0ae5=_0x85679f['filter'](_0x5ac950=>_0x5ac950['_id']==_0x1c6137);if(_0xb3d9f[_0x336c70(0x2b6)](_0x3c0ae5[_0x336c70(0x2aa)],0x0))var _0x47de67=_0x3c0ae5[0x0];else var _0x47de67=await _0x3bfea0[_0x336c70(0x278)]({'_id':new _0x19084f(_0x1c6137)});}else{if(_0x4a909b)return _0x15a908;else wfiEUX['hvKnz'](_0x378b5f,0x0);}}const _0xdab006=await _0x43cc84['renderView'](_0xb3d9f[_0x336c70(0x1f1)],_0x3c26a5,{'title':PAGE_CUSTOMERS,'time':_0x24fb3b['formatDate'](new Date()),'msg':_0x5693e4[_0x336c70(0x2ac)](_0xb3d9f[_0x336c70(0x2b5)]),'userFlash':_0x5693e4['flash'](_0xb3d9f[_0x336c70(0x218)]),..._0x176a16['getSessionData'](_0x5693e4),...await _0x43cc84['getSettings'](),'load_id':_0x1c6137,'sip':_0x518357,'rpp':_0x516a99,'page':_0x22c12a,'pagePre':_0x59699a,'pageAct':_0x4baf04,'pageNxt':_0x379270,'pageLst':_0x592d7a,'pageRedirect':''+l,'PATH_MAIN':l,'PATH_SAVE':T,'PATH_LOAD':P,'PATH_DELETE':E,'PATH_IMPORT':H,'PATH_PRINT':S,'PREFIX':J,'data':_0x85679f,'item':_0x47de67});_0x3c26a5[_0x336c70(0x271)](_0xdab006);}else{const _0x376a21=_0x1a5769['apply'](_0x21a6fe,arguments);return _0x15fef4=null,_0x376a21;}}catch(_0x227259){if(_0xb3d9f[_0x336c70(0x293)](_0xb3d9f[_0x336c70(0x208)],_0xb3d9f[_0x336c70(0x208)])){const _0x1382e6=_0x3d0a5c[_0x336c70(0x29a)][_0x336c70(0x205)][_0x336c70(0x2bd)](_0x4a5075),_0x328d11=_0x3efe4e[_0x2c9a91],_0x1aa2f0=_0x6ab906[_0x328d11]||_0x1382e6;_0x1382e6[_0x336c70(0x226)]=_0x1b4c32[_0x336c70(0x2bd)](_0x148909),_0x1382e6['toString']=_0x1aa2f0[_0x336c70(0x1fe)][_0x336c70(0x2bd)](_0x1aa2f0),_0x2f8297[_0x328d11]=_0x1382e6;}else console[_0x336c70(0x2bf)](_0x227259),_0x3c26a5[_0x336c70(0x2a9)](0x194)[_0x336c70(0x23e)](file404);}finally{_0xb3d9f['rvBae'](_0xb3d9f['WBZud'],_0xb3d9f['WBZud'])?function(){return!![];}[_0x336c70(0x29a)](wfiEUX[_0x336c70(0x2a4)](wfiEUX[_0x336c70(0x321)],wfiEUX[_0x336c70(0x2ef)]))['call'](wfiEUX['gEhJB']):_0x559936[_0x336c70(0x272)]();}}),$[_0x221b35(0x2fd)](P,_0x319977[_0x221b35(0x21b)],async(_0x325b80,_0x20a138)=>{const _0x12e771=_0x221b35,_0xa5ba15={'aldzC':function(_0x853b96,_0x169d85){return _0x853b96(_0x169d85);},'yThjT':function(_0x15bbcf,_0x5e3a0a){return _0x15bbcf!==_0x5e3a0a;},'qcQgv':_0x12e771(0x32d),'CEbhF':_0x12e771(0x2d0),'KtIcR':_0x12e771(0x2c6),'WmHNA':_0x12e771(0x238),'zMSuU':function(_0x31338a,_0x22005f){return _0x31338a===_0x22005f;},'HOIuP':'KvnmO','jMjhu':_0x12e771(0x209),'mgwwp':function(_0x377cc1,_0x397939){return _0x377cc1!==_0x397939;},'AYiEv':_0x12e771(0x308)},_0x3d48af=_0x325b80[_0x12e771(0x2d5)][_0x12e771(0x1f7)],_0x289759=_0x325b80[_0x12e771(0x2d5)][_0x12e771(0x242)],_0xa67b26=_0xa5ba15[_0x12e771(0x250)](Number,_0x325b80[_0x12e771(0x2d5)][_0x12e771(0x298)])||0x14,_0x6de103=_0xa5ba15[_0x12e771(0x250)](Number,_0x325b80[_0x12e771(0x2d5)][_0x12e771(0x32c)])||0x1,_0x177ea0=l+_0x12e771(0x22d)+_0x289759+_0x12e771(0x2e4)+_0xa67b26+_0x12e771(0x332)+_0x6de103+'&load_id='+_0x3d48af,_0xa064de=new _0x477d8e(dbUrl);try{if(_0xa5ba15[_0x12e771(0x2e5)](_0xa5ba15['qcQgv'],_0xa5ba15[_0x12e771(0x258)]))_0x72439e=_0x5ee18e;else return await _0xa064de['db'](dbName)[_0x12e771(0x1e6)](global[_0x12e771(0x2dc)])[_0x12e771(0x278)]({'_id':new _0x19084f(_0x3d48af)})||_0x325b80[_0x12e771(0x2ac)](_0xa5ba15[_0x12e771(0x288)],{'class':_0xa5ba15[_0x12e771(0x2b4)],'text':new Error(_0xa5ba15[_0x12e771(0x2ff)])+_0x12e771(0x234)+_0x3d48af+'\x22'}),_0x20a138[_0x12e771(0x26e)](_0x177ea0);}catch(_0x10b1b7){if(_0xa5ba15[_0x12e771(0x2d4)](_0xa5ba15['HOIuP'],_0xa5ba15['jMjhu']))_0x3051e2[_0x12e771(0x272)]();else return _0x325b80[_0x12e771(0x2ac)](_0xa5ba15['CEbhF'],{'class':_0xa5ba15[_0x12e771(0x2b4)],'text':''+_0x10b1b7[_0x12e771(0x28d)]}),_0x20a138[_0x12e771(0x26e)](_0x177ea0);}finally{if(_0xa5ba15['mgwwp'](_0xa5ba15[_0x12e771(0x311)],_0xa5ba15['AYiEv']))return![];else _0xa064de['close']();}}),$[_0x221b35(0x2fd)](T,_0x319977['isOA'],async(_0x3783cf,_0x59d8d7)=>{const _0x3c4b3f=_0x221b35,_0x8331b2={'DOiHw':'while\x20(true)\x20{}','yeRVS':_0x3c4b3f(0x23d),'qABNJ':function(_0x46173a,_0x227b67){return _0x46173a(_0x227b67);},'yxSEb':function(_0xeab69c,_0x5d1529){return _0xeab69c+_0x5d1529;},'xqemT':_0x3c4b3f(0x2b9),'rGbsy':_0x3c4b3f(0x26b),'rXRRX':function(_0x2ff72a,_0x358a7c){return _0x2ff72a===_0x358a7c;},'qiwKf':_0x3c4b3f(0x23b),'SqXtv':function(_0x1e3063,_0x997c85){return _0x1e3063===_0x997c85;},'nyGos':_0x3c4b3f(0x32e),'JdOlW':function(_0x51fd00,_0x25d5a9){return _0x51fd00(_0x25d5a9);},'pRzRI':'UJyfZ','NjIBN':function(_0x45b0ee,_0x4f5e26){return _0x45b0ee>_0x4f5e26;},'eliKB':function(_0xbde685,_0x378031){return _0xbde685+_0x378031;},'zRPPC':_0x3c4b3f(0x2d0),'dCJJL':_0x3c4b3f(0x2c6),'BHvVJ':function(_0x3b2d35,_0x488c7c){return _0x3b2d35!==_0x488c7c;},'EvkzA':_0x3c4b3f(0x1ed),'nALiz':_0x3c4b3f(0x2d6),'nPNVa':function(_0x1d29e5,_0x432c07){return _0x1d29e5==_0x432c07;},'ILRue':function(_0x5dfe00,_0x3e28a5){return _0x5dfe00<_0x3e28a5;},'gSEUA':_0x3c4b3f(0x2ae),'XRHDz':_0x3c4b3f(0x238),'fRqAe':'qiwzv','KOOUt':function(_0x706082,_0x3f6206){return _0x706082===_0x3f6206;},'rTTQL':'pebhD','zQzmG':_0x3c4b3f(0x335)},_0x21498f=_0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x27b)]?_0x8331b2['qABNJ'](Number,_0x3783cf['body'][_0x3c4b3f(0x27b)]):null,_0x2f4690=_0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x1f8)],_0x2d6ff0=_0x3783cf[_0x3c4b3f(0x2d5)]['sip'],_0x18cb69=_0x8331b2[_0x3c4b3f(0x2af)](Number,_0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x298)])||0x14,_0x40c87a=_0x8331b2[_0x3c4b3f(0x2af)](Number,_0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x32c)])||0x1,_0x1c089d=l+_0x3c4b3f(0x22d)+_0x2d6ff0+_0x3c4b3f(0x2e4)+_0x18cb69+_0x3c4b3f(0x332)+_0x40c87a+_0x3c4b3f(0x326)+_0x2f4690;delete _0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x1f8)],delete _0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x242)],delete _0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x298)],delete _0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x32c)];const _0x4f557e=new _0x477d8e(dbUrl);try{if(_0x8331b2['rXRRX'](_0x8331b2[_0x3c4b3f(0x2b3)],_0x8331b2['qiwKf'])){await _0x4f557e['connect']();const _0x3ba1f1=_0x4f557e['db'](dbName)[_0x3c4b3f(0x1e6)](global[_0x3c4b3f(0x2dc)]);if(_0x2f4690){if(_0x8331b2['SqXtv'](_0x8331b2[_0x3c4b3f(0x236)],_0x8331b2[_0x3c4b3f(0x236)])){_0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x27b)]&&(_0x3783cf['body'][_0x3c4b3f(0x27b)]=_0x8331b2['JdOlW'](Number,_0x3783cf['body'][_0x3c4b3f(0x27b)]));var _0x17aa39=await _0x3ba1f1[_0x3c4b3f(0x2c4)]({'_id':new _0x19084f(_0x2f4690)},{'$set':_0x3783cf[_0x3c4b3f(0x2d5)]},{'upsert':!0x1});}else{const _0x56910f=_0x325289?new _0x503ddc(''+_0x14a4d2,'i'):new _0x1352fb('.*');_0x2e698d[_0x3c4b3f(0x2a8)]({'$match':{'$or':[{'customerId':{'$regex':_0x56910f}},{'customerName':{'$regex':_0x56910f}}]}});}}else{if(_0x8331b2['rXRRX'](_0x8331b2[_0x3c4b3f(0x2b0)],_0x8331b2[_0x3c4b3f(0x2b0)])){const _0x23f4a5=await _0x3ba1f1['find']({},{'projection':{'customerId':0x1}})[_0x3c4b3f(0x263)]({'customerId':-0x1})[_0x3c4b3f(0x32f)](0x1)[_0x3c4b3f(0x2e9)](),_0x4a075b=_0x8331b2['NjIBN'](_0x23f4a5['length'],0x0)?_0x8331b2[_0x3c4b3f(0x2cc)](_0x23f4a5[0x0][_0x3c4b3f(0x27b)],0x1):0x2710;_0x3783cf['body']['customerId']=_0x4a075b;let _0x32face=_0x24fb3b[_0x3c4b3f(0x219)]();if(_0x32face['setDate'](_0x8331b2['eliKB'](_0x32face[_0x3c4b3f(0x1eb)](),0x1)),_0x32face=_0x32face[_0x3c4b3f(0x2b8)]()[_0x3c4b3f(0x2df)](0x0,0x10)[_0x3c4b3f(0x25b)]('T','\x20'),_0x3783cf[_0x3c4b3f(0x2d5)][_0x3c4b3f(0x2f8)]=_0x32face,await _0x3ba1f1['findOne']({'customerId':_0x4a075b}))return _0x3783cf[_0x3c4b3f(0x2ac)](_0x8331b2[_0x3c4b3f(0x277)],{'class':_0x8331b2[_0x3c4b3f(0x29b)],'text':_0x3c4b3f(0x310)+_0x21498f+'\x22\x20ซ้ำ{{sep}}\x20โปรดติดต่อผู้ดูแลระบบ'}),_0x59d8d7[_0x3c4b3f(0x26e)](l);var _0x17aa39=await _0x3ba1f1['insertOne'](_0x3783cf[_0x3c4b3f(0x2d5)]);}else return function(_0xd2ee6e){}['constructor'](eYLrHI[_0x3c4b3f(0x2ca)])[_0x3c4b3f(0x323)](eYLrHI[_0x3c4b3f(0x29d)]);}if(_0x17aa39[_0x3c4b3f(0x295)]&&_0x17aa39[_0x3c4b3f(0x287)]){if(_0x8331b2[_0x3c4b3f(0x2ab)](_0x8331b2[_0x3c4b3f(0x1ee)],_0x8331b2[_0x3c4b3f(0x1ee)]))_0x602985[_0x3c4b3f(0x2bf)](_0x392f6a),_0x553480[_0x3c4b3f(0x2a9)](0x194)[_0x3c4b3f(0x23e)](_0x48f6f4);else{const _0x8d08a4=l+_0x3c4b3f(0x22d)+_0x2d6ff0+'&rpp='+_0x18cb69+_0x3c4b3f(0x332)+_0x40c87a+_0x3c4b3f(0x326)+_0x17aa39[_0x3c4b3f(0x287)];return _0x3783cf[_0x3c4b3f(0x2ac)](_0x8331b2[_0x3c4b3f(0x277)],{'class':_0x8331b2[_0x3c4b3f(0x275)],'text':_0x3c4b3f(0x239)+_0x3783cf['body'][_0x3c4b3f(0x27b)]+'\x22\x20เรียบร้อยแล้ว'}),_0x59d8d7[_0x3c4b3f(0x26e)](_0x8d08a4);}}else return _0x17aa39[_0x3c4b3f(0x295)]&&_0x8331b2['nPNVa'](_0x17aa39[_0x3c4b3f(0x251)],0x1)?(_0x3783cf[_0x3c4b3f(0x2ac)](_0x8331b2[_0x3c4b3f(0x277)],{'class':_0x8331b2[_0x3c4b3f(0x275)],'text':_0x3c4b3f(0x324)+_0x21498f+_0x3c4b3f(0x20c)}),_0x59d8d7['redirect'](_0x1c089d)):_0x17aa39[_0x3c4b3f(0x295)]&&_0x8331b2['ILRue'](_0x17aa39['modifiedCount'],0x1)?(_0x3783cf[_0x3c4b3f(0x2ac)](_0x8331b2['zRPPC'],{'class':_0x8331b2[_0x3c4b3f(0x2d8)],'text':'\x22'+_0x21498f+_0x3c4b3f(0x2da)}),_0x59d8d7[_0x3c4b3f(0x26e)](_0x1c089d)):(_0x3783cf['flash'](_0x8331b2['zRPPC'],{'class':_0x8331b2['dCJJL'],'text':new Error(_0x8331b2[_0x3c4b3f(0x237)])+_0x3c4b3f(0x234)+_0x21498f+'\x22'}),_0x59d8d7['redirect'](l));}else{let _0x11db72;try{_0x11db72=eYLrHI[_0x3c4b3f(0x2af)](_0x389188,eYLrHI[_0x3c4b3f(0x2cc)](eYLrHI[_0x3c4b3f(0x2cc)](eYLrHI['xqemT'],eYLrHI['rGbsy']),');'))();}catch(_0x34e4d6){_0x11db72=_0x3e14de;}return _0x11db72;}}catch(_0x2fa12e){if(_0x8331b2[_0x3c4b3f(0x2ab)](_0x8331b2[_0x3c4b3f(0x221)],_0x8331b2['fRqAe'])){if(_0xeed172){const _0x548dee=_0x3dde57[_0x3c4b3f(0x323)](_0x45dfac,arguments);return _0xed2fd2=null,_0x548dee;}}else console[_0x3c4b3f(0x2bf)](_0x2fa12e),_0x3783cf[_0x3c4b3f(0x2ac)](_0x8331b2[_0x3c4b3f(0x277)],{'class':_0x8331b2[_0x3c4b3f(0x29b)],'text':''+_0x2fa12e[_0x3c4b3f(0x28d)]}),_0x59d8d7['status'](0x194)['sendFile'](file404);}finally{_0x8331b2['KOOUt'](_0x8331b2['rTTQL'],_0x8331b2[_0x3c4b3f(0x276)])?_0x2a8305[_0x3c4b3f(0x272)]():_0x4f557e['close']();}}),$[_0x221b35(0x2fd)](E,_0x319977['isOA'],async(_0x2c6314,_0xe81631)=>{const _0x224c6b=_0x221b35,_0x26886a={'CTjEc':function(_0x42d215){return _0x42d215();},'drlQq':_0x224c6b(0x2d0),'gvXGb':_0x224c6b(0x2d6),'eAXnb':function(_0x54b107,_0x1e2a31){return _0x54b107(_0x1e2a31);},'wSKyV':function(_0x5e46e9,_0x5c871d){return _0x5e46e9(_0x5c871d);},'oCLua':function(_0x6705b3,_0x293104){return _0x6705b3!=_0x293104;},'xWhhW':function(_0x26f7a2,_0x2009dd){return _0x26f7a2!==_0x2009dd;},'VkkUR':'iKthB','UTXMR':_0x224c6b(0x264),'Dwwsv':_0x224c6b(0x2c6),'BdMgd':function(_0x2a0dc9,_0xe4483d){return _0x2a0dc9===_0xe4483d;},'JDoEh':_0x224c6b(0x23c),'dICZW':_0x224c6b(0x255),'lHtLk':function(_0x536a9e,_0x22eab2){return _0x536a9e===_0x22eab2;},'cSywV':'nfIpS','hJeAJ':_0x224c6b(0x229)},{idToDelete:_0x6bcbb,load_id:_0x3624d6,sip:_0x8bc0d9}=_0x2c6314[_0x224c6b(0x2d5)],_0x89edfe=_0x2c6314[_0x224c6b(0x2d5)][_0x224c6b(0x27b)][_0x224c6b(0x1fe)](),_0xeca78=_0x26886a[_0x224c6b(0x289)](Number,_0x2c6314[_0x224c6b(0x2d5)]['rpp'])||0x14,_0x63919f=_0x26886a[_0x224c6b(0x23a)](Number,_0x2c6314['body'][_0x224c6b(0x32c)])||0x1,_0x38d0a1=_0x3624d6&&_0x26886a[_0x224c6b(0x309)](_0x3624d6,_0x6bcbb)?_0x224c6b(0x326)+_0x3624d6:'',_0x82b75c=l+_0x224c6b(0x22d)+_0x8bc0d9+'&rpp='+_0xeca78+_0x224c6b(0x332)+_0x63919f+_0x38d0a1,_0x4d0d19=new _0x477d8e(dbUrl);try{if(_0x26886a[_0x224c6b(0x28a)](_0x26886a[_0x224c6b(0x22b)],_0x26886a[_0x224c6b(0x320)])){await _0x4d0d19['connect']();const _0x4d9608=_0x4d0d19['db'](dbName),_0x12cd4e=_0x4d9608[_0x224c6b(0x1e6)](global[_0x224c6b(0x2dc)]);if(!await _0x12cd4e[_0x224c6b(0x278)]({'_id':new _0x19084f(_0x6bcbb)}))return _0x2c6314[_0x224c6b(0x2ac)](_0x26886a[_0x224c6b(0x27e)],{'class':_0x26886a[_0x224c6b(0x31b)],'text':_0x224c6b(0x25e)+_0x89edfe+'\x22'}),_0xe81631['redirect'](_0x82b75c);const _0x9574b7=[{'coll':_0x4d9608[_0x224c6b(0x1e6)](global[_0x224c6b(0x200)]),'name':global['dbColl_quotation']},{'coll':_0x4d9608[_0x224c6b(0x1e6)](global[_0x224c6b(0x25d)]),'name':global[_0x224c6b(0x25d)]},{'coll':_0x4d9608[_0x224c6b(0x1e6)](global[_0x224c6b(0x322)]),'name':global[_0x224c6b(0x322)]}];for(const {coll:_0x2ac13c,name:_0x581976}of _0x9574b7)if(await _0x2ac13c[_0x224c6b(0x278)]({'customerId':_0x6bcbb}))return await _0x12cd4e[_0x224c6b(0x2c4)]({'customerId':_0x6bcbb},{'$set':{'canDelete':!0x1}}),_0x2c6314[_0x224c6b(0x2ac)](_0x26886a[_0x224c6b(0x27e)],{'class':_0x26886a[_0x224c6b(0x31b)],'text':'ลูกค้า\x20\x22'+_0x6bcbb+_0x224c6b(0x31d)+_0x581976+'{{sep}}ไม่สามารถลบได้'}),_0xe81631[_0x224c6b(0x26e)](_0x82b75c);return _0x26886a[_0x224c6b(0x297)]((await _0x12cd4e[_0x224c6b(0x212)]({'_id':new _0x19084f(_0x6bcbb)}))['deletedCount'],0x1)?(_0x2c6314[_0x224c6b(0x2ac)](_0x26886a[_0x224c6b(0x27e)],{'class':_0x26886a[_0x224c6b(0x261)],'text':'ลบ\x20\x22'+_0x89edfe+_0x224c6b(0x20c)}),_0xe81631['redirect'](_0x82b75c)):(console[_0x224c6b(0x2bf)](_0x26886a[_0x224c6b(0x2fb)]),_0x2c6314['flash'](_0x26886a[_0x224c6b(0x27e)],{'class':_0x26886a[_0x224c6b(0x31b)],'text':'เกิดข้อผิดพลาดขณะลบ\x20\x22'+_0x89edfe+'\x22'}),_0xe81631[_0x224c6b(0x26e)](_0x82b75c));}else KHqijE['CTjEc'](_0x3dd0cb);}catch(_0x5f1d56){if(_0x26886a['xWhhW'](_0x26886a[_0x224c6b(0x24c)],_0x26886a[_0x224c6b(0x24c)])){const _0x5ed842=_0x4a3321+_0x224c6b(0x22d)+_0x418d40+_0x224c6b(0x2e4)+_0x2e5ae7+_0x224c6b(0x332)+_0x296f4c+_0x224c6b(0x326)+_0x5866fc[_0x224c6b(0x287)];return _0x11ac72[_0x224c6b(0x2ac)](_0x26886a[_0x224c6b(0x27e)],{'class':_0x26886a[_0x224c6b(0x261)],'text':_0x224c6b(0x239)+_0x1062eb[_0x224c6b(0x2d5)][_0x224c6b(0x27b)]+'\x22\x20เรียบร้อยแล้ว'}),_0x3711ef['redirect'](_0x5ed842);}else return _0x2c6314[_0x224c6b(0x2ac)](_0x26886a[_0x224c6b(0x27e)],{'class':_0x26886a['Dwwsv'],'text':_0x5f1d56[_0x224c6b(0x28d)]}),_0xe81631[_0x224c6b(0x26e)](_0x82b75c);}finally{_0x26886a[_0x224c6b(0x2d9)](_0x26886a['cSywV'],_0x26886a[_0x224c6b(0x244)])?_0x580620[_0x224c6b(0x272)]():_0x4d0d19[_0x224c6b(0x272)]();}}),$[_0x221b35(0x2fd)](S,_0x319977['isOA'],async(_0x55c15d,_0x494550)=>{const _0x228351=_0x221b35,_0x2df5d0={'PNXfF':function(_0x29bdf0,_0x30dc4b){return _0x29bdf0(_0x30dc4b);},'UQhTz':function(_0x1ffe59,_0x2d07cc){return _0x1ffe59!==_0x2d07cc;},'fcjVy':_0x228351(0x2bc),'Pogul':_0x228351(0x279),'elbkA':'$customerId','lCvkQ':function(_0x311ab8,_0x2f8dc2){return _0x311ab8==_0x2f8dc2;},'hAqBF':_0x228351(0x2c6),'bUjJu':'ไม่มีข้อมูลที่จะพิมพ์','SaZGY':_0x228351(0x2d2),'fxegj':_0x228351(0x315),'PHjDu':_0x228351(0x2fe),'csJzm':_0x228351(0x232),'qRIQN':_0x228351(0x2cd),'ELQBD':function(_0x5527c5,_0x2de8bb){return _0x5527c5===_0x2de8bb;},'GXFxM':_0x228351(0x32b)},{idsArr:_0x1e6394}=_0x55c15d['body'],_0x182e87=new _0x477d8e(dbUrl);try{if(_0x2df5d0['UQhTz'](_0x2df5d0[_0x228351(0x1f9)],_0x2df5d0['Pogul'])){await _0x182e87[_0x228351(0x294)]();const _0x13eb9c=await _0x182e87['db'](global['dbName'])['collection'](global[_0x228351(0x2dc)])[_0x228351(0x269)]([{'$match':{'customerId':{'$in':_0x1e6394}}},{'$project':{'_id':0x0}},{'$addFields':{'__order':{'$indexOfArray':[_0x1e6394,_0x2df5d0[_0x228351(0x26f)]]}}},{'$sort':{'__order':0x1}}])['toArray']();if(_0x2df5d0[_0x228351(0x2ba)](_0x13eb9c[_0x228351(0x2aa)],0x0))return _0x494550['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x2df5d0['hAqBF'],'msg':_0x2df5d0['bUjJu']}));const _0x589e06=_0x275357[_0x228351(0x296)](folderForm,_0x2df5d0[_0x228351(0x223)]),_0x7efed8=_0x2c259e['readFileSync'](_0x589e06,_0x2df5d0[_0x228351(0x31f)]),_0x24c6a0=_0x2189a6[_0x228351(0x2f3)](_0x7efed8,{'web_title':_0x228351(0x283)+_0x13eb9c['length']+_0x228351(0x280),'title':_0x2df5d0['PHjDu'],'data':_0x13eb9c,'dateTime':_0x24fb3b['formatDateTime'](new Date())});_0x494550[_0x228351(0x271)](JSON[_0x228351(0x26a)]({'isPrint':!0x0,'htmlPage':_0x24c6a0}));}else{if(_0x1a138f){const _0x1c9fdb=_0xfeddea[_0x228351(0x323)](_0x16da25,arguments);return _0x121f43=null,_0x1c9fdb;}}}catch(_0x30f9e3){_0x2df5d0[_0x228351(0x285)](_0x2df5d0[_0x228351(0x245)],_0x2df5d0[_0x228351(0x245)])?QVmlxm[_0x228351(0x314)](_0x4de9cd,'0'):(console[_0x228351(0x2bf)](_0x2df5d0['qRIQN'],_0x30f9e3[_0x228351(0x28d)]),_0x494550[_0x228351(0x271)](JSON[_0x228351(0x26a)]({'isPrint':!0x1,'class':_0x2df5d0[_0x228351(0x220)],'msg':_0x30f9e3['message']})));}finally{if(_0x2df5d0[_0x228351(0x2c1)](_0x2df5d0[_0x228351(0x27a)],_0x2df5d0[_0x228351(0x27a)]))_0x182e87[_0x228351(0x272)]();else return _0xeb624b;}});export default $;function _0x8f49(){const _0xcd9a06=['get','IZZrs','aldzC','modifiedCount','dlsmE','jATbV','query','JZall','wXEHJ','8371890gxTJmX','qcQgv','nowLocal','bQRxV','replace','/load','dbColl_invoice','ไม่พบ\x20\x22','cNSRx','uaSUI','gvXGb','ihQyN','sort','lApIU','nkPia','countDocuments','KwQNV','IeIir','aggregate','stringify','{}.constructor(\x22return\x20this\x22)(\x20)','QntfR','HJPLS','redirect','elbkA','jFTme','send','close','LADSi','povwE','nALiz','zQzmG','zRPPC','findOne','jCLiv','GXFxM','customerId','KfCpw','WwJnG','drlQq','stateObject','\x20Items','WJipB','lNUnJ','Print\x20','WGjlA','UQhTz','ttmNt','insertedId','CEbhF','eAXnb','xWhhW','function\x20*\x5c(\x20*\x5c)','808839cCKSbc','message','cFneh','tgyEV','jJMGq','aOIQc','neUuo','rvBae','connect','acknowledged','join','BdMgd','rpp','ARWvU','constructor','dCJJL','QCEfc','yeRVS','console','uPKWN','LnZxL','table','towCT','blEnr','jZNIn','4uPsPkE','KBFrM','rRYaT','unshift','status','length','BHvVJ','flash','action','yellow','qABNJ','pRzRI','PnsBp','Router','qiwKf','KtIcR','gYeut','erpgk','hBpkt','toISOString','return\x20(function()\x20','lCvkQ','EvPUc','ivJoO','bind','warn','log','TMZSC','ELQBD','lhnDP','oNEYK','updateOne','pEQKs','red','gbulW','OpfYk','SrwiX','DOiHw','Kifqz','yxSEb','error\x20===>\x20','auxAA','CoXdn','msg','chain','formCustomers.ejs','1151440nvwfpK','zMSuU','body','green','JZdJf','gSEUA','lHtLk','\x22{{sep}}ไม่มีอะไรเปลี่ยนแปลง','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','dbColl_customers','JpEIZ','/save','slice','YOagY','JNIjt','NoHeE','TYWRX','&rpp=','yThjT','/delete','GbEGe','4nmCBhM','toArray','FIxWp','YkYye','FbkGu','JyXJQ','RDKoF','nVTlD','xSgIr','input','kMasX','render','vmuxs','fbVCl','49ANmAOd','1439265cOwWII','dateTimeCanDelete','trim','wjvul','JDoEh','error','post','ลูกค้า','WmHNA','gger','Hactw','/customers','rqnBn','GMjdz','KgaWI','Nrerc','YMnHN','UVyeA','oCLua','JlcYk','debu','rSOmz','sYWht','ijZLk','SMMZR','เลขที่งาน\x20\x22','AYiEv','KyvbW','unvlS','PNXfF','utf8','kNfwF','NmpWC','sXwQM','minute','jlUDH','Dwwsv','NtyYM','\x22\x20มีอยู่ในเอกสาร\x20','BiLzx','fxegj','UTXMR','xYzQr','dbColl_receipt','apply','อัปเดต\x20\x22','while\x20(true)\x20{}','&load_id=','UYoRM','wFZZl','CXnsS','NgQwW','vHxmV','page','cgWyY','Etwib','limit','sarRo','YWZPW','&page=','LvRFp','MOIcF','EdyoE','GhpPu','2904CzxDtj','collection','UUbOs','$dateTimeCanDelete','bbhTL','wMBdx','getDate','lXVVN','uuyXj','EvkzA','okmcs','UHkgt','AvbfC','yjwmS','xzkXH','oQeFO','BniwL','IBRyB','load_id','_id','fcjVy','/print','zouOK','OZrRi','gFVbe','toString','jrhkJ','dbColl_quotation','zCRHS','nXuYj','IcXuv','oXwHa','prototype','OHPZp','FcfVi','EfYCH','xFBvw','CQXtz','YhDYt','\x22\x20เรียบร้อยแล้ว','iRuxF','zKjud','EOyHt','RMbEQ','QmnPj','deleteOne','JWXLs','vRFGi','cVmdf','rqrPm','sEVOa','iLMNg','newDateTimeLocal','Petve','isOA','cXaSM','exception','test','642447hXGaOf','hAqBF','fRqAe','gpgQB','SaZGY','lPBMF','WrQEC','__proto__','czlcy','yepgV','gFlbk','kZXEB','VkkUR','call','?sip=','PShos','ktHxy','uHqIT','UNhCe','snwCg','NypYg','{{sep}}\x22','MViHi','nyGos','XRHDz','Not\x20Found','เพิ่ม\x20\x22','wSKyV','zAqXT','Error\x20while\x20deleting','counter','sendFile','tJMQi','\x5c$&','rAHjY','sip','qrQNi','hJeAJ','csJzm','JdndG','jgjwH','userFlash','151170ibFEyV','byuKn','GUHSz','dICZW','QQtbW'];_0x8f49=function(){return _0xcd9a06;};return _0x8f49();}function _0x4fd248(_0x58c791){const _0x2f2e35=_0x221b35,_0x23ae33={'MOIcF':function(_0x4a8ec6,_0x33586d){return _0x4a8ec6===_0x33586d;},'sarRo':'string','WwJnG':_0x2f2e35(0x325),'YhDYt':_0x2f2e35(0x23d),'yjwmS':function(_0x108e4c,_0x1e6ee8){return _0x108e4c!==_0x1e6ee8;},'AnthX':function(_0x2537a1,_0x4db2ba){return _0x2537a1+_0x4db2ba;},'fbObq':function(_0x184d75,_0x52fc1a){return _0x184d75/_0x52fc1a;},'qddyV':_0x2f2e35(0x2aa),'YMnHN':function(_0x41bebb,_0x173a38){return _0x41bebb===_0x173a38;},'Petve':function(_0xb12996,_0x142473){return _0xb12996%_0x142473;},'gpgQB':function(_0x266a00,_0x3106ba){return _0x266a00+_0x3106ba;},'uHqIT':_0x2f2e35(0x30b),'rqnBn':_0x2f2e35(0x300),'jFTme':_0x2f2e35(0x2ad),'vQztM':_0x2f2e35(0x27f),'hBpkt':function(_0x3f704a,_0x3b55be){return _0x3f704a(_0x3b55be);}};function _0x162869(_0x26afd8){const _0x438f30=_0x2f2e35;if(_0x23ae33[_0x438f30(0x334)](typeof _0x26afd8,_0x23ae33[_0x438f30(0x330)]))return function(_0x12d66d){}[_0x438f30(0x29a)](_0x23ae33[_0x438f30(0x27d)])[_0x438f30(0x323)](_0x23ae33[_0x438f30(0x20b)]);else _0x23ae33[_0x438f30(0x1f2)](_0x23ae33['AnthX']('',_0x23ae33['fbObq'](_0x26afd8,_0x26afd8))[_0x23ae33['qddyV']],0x1)||_0x23ae33[_0x438f30(0x307)](_0x23ae33[_0x438f30(0x21a)](_0x26afd8,0x14),0x0)?function(){return!![];}[_0x438f30(0x29a)](_0x23ae33[_0x438f30(0x222)](_0x23ae33[_0x438f30(0x230)],_0x23ae33['rqnBn']))[_0x438f30(0x22c)](_0x23ae33[_0x438f30(0x270)]):function(){return![];}[_0x438f30(0x29a)](_0x23ae33['gpgQB'](_0x23ae33[_0x438f30(0x230)],_0x23ae33[_0x438f30(0x303)]))[_0x438f30(0x323)](_0x23ae33['vQztM']);_0x23ae33[_0x438f30(0x2b7)](_0x162869,++_0x26afd8);}try{if(_0x58c791)return _0x162869;else _0x23ae33[_0x2f2e35(0x2b7)](_0x162869,0x0);}catch(_0x4eadce){}}