const _0x400e59=_0x4943;(function(_0x195fe4,_0x46f787){const _0x3c2906=_0x4943,_0x15f690=_0x195fe4();while(!![]){try{const _0x237949=parseInt(_0x3c2906(0x1a3))/0x1+-parseInt(_0x3c2906(0x104))/0x2+parseInt(_0x3c2906(0x8b))/0x3*(parseInt(_0x3c2906(0xb4))/0x4)+parseInt(_0x3c2906(0x97))/0x5*(-parseInt(_0x3c2906(0xff))/0x6)+parseInt(_0x3c2906(0x185))/0x7+parseInt(_0x3c2906(0x125))/0x8*(parseInt(_0x3c2906(0x164))/0x9)+-parseInt(_0x3c2906(0x106))/0xa*(parseInt(_0x3c2906(0x122))/0xb);if(_0x237949===_0x46f787)break;else _0x15f690['push'](_0x15f690['shift']());}catch(_0x298f74){_0x15f690['push'](_0x15f690['shift']());}}}(_0x51eb,0x2924c));function _0x4943(_0x358292,_0x2df48a){const _0x5e1991=_0x51eb();return _0x4943=function(_0x37e034,_0x2e3404){_0x37e034=_0x37e034-0x86;let _0x50d9fd=_0x5e1991[_0x37e034];return _0x50d9fd;},_0x4943(_0x358292,_0x2df48a);}const _0x50cac8=(function(){const _0x400f79=_0x4943,_0x3933d5={'LcXHh':function(_0x4b051e,_0x24d9d4){return _0x4b051e(_0x24d9d4);},'BGhXm':function(_0x5e9692,_0x5abab1){return _0x5e9692!==_0x5abab1;},'Uxiln':'SBxfR','TeEMY':'DfFww','vomsQ':_0x400f79(0xe3),'bXeiK':_0x400f79(0xb2)};let _0x463a36=!![];return function(_0x2e3b86,_0x4b38d7){const _0x54f037=_0x400f79,_0x581a6e={'YKPCU':function(_0x10febe,_0x4bec18){const _0x2335e7=_0x4943;return _0x3933d5[_0x2335e7(0xb1)](_0x10febe,_0x4bec18);},'usbRG':function(_0x4beff5,_0x435ddf){return _0x3933d5['BGhXm'](_0x4beff5,_0x435ddf);},'vzsZM':_0x3933d5['Uxiln'],'ObCZs':_0x3933d5[_0x54f037(0x1e4)],'UAxfR':_0x3933d5[_0x54f037(0x14f)]};if(_0x3933d5[_0x54f037(0x17e)](_0x3933d5[_0x54f037(0x96)],_0x3933d5[_0x54f037(0x96)]))_0x581a6e[_0x54f037(0x188)](_0x5d4d1f,0x0);else{const _0x18d9dc=_0x463a36?function(){const _0x897e22=_0x54f037;if(_0x581a6e['usbRG'](_0x581a6e['vzsZM'],_0x581a6e[_0x897e22(0xf2)])){if(_0x4b38d7){if(_0x581a6e[_0x897e22(0x19c)](_0x581a6e[_0x897e22(0x176)],_0x581a6e[_0x897e22(0x176)]))return![];else{const _0x52fe57=_0x4b38d7[_0x897e22(0x19d)](_0x2e3b86,arguments);return _0x4b38d7=null,_0x52fe57;}}}else{const _0x477c99=_0x2116e9['constructor'][_0x897e22(0xac)][_0x897e22(0xf3)](_0x15fa52),_0xa5c9ca=_0x51c78a[_0x482a4f],_0x3dfe62=_0x5d20e5[_0xa5c9ca]||_0x477c99;_0x477c99['__proto__']=_0x4d4dad['bind'](_0x4aa265),_0x477c99[_0x897e22(0x16a)]=_0x3dfe62[_0x897e22(0x16a)][_0x897e22(0xf3)](_0x3dfe62),_0x4ba549[_0xa5c9ca]=_0x477c99;}}:function(){};return _0x463a36=![],_0x18d9dc;}};}());(function(){const _0x17d1aa=_0x4943,_0xd95752={'tfwZB':function(_0x24c0f8,_0x22c996){return _0x24c0f8+_0x22c996;},'jgOao':_0x17d1aa(0xa6),'CSWvP':_0x17d1aa(0x115),'jkgaO':_0x17d1aa(0x156),'OfzjS':_0x17d1aa(0xf5),'kVseG':_0x17d1aa(0xfc),'djVvj':function(_0xebc560,_0x304353){return _0xebc560(_0x304353);},'QupHN':_0x17d1aa(0x126),'xICgu':function(_0x2f0ecd,_0x57d0a3){return _0x2f0ecd+_0x57d0a3;},'LelPe':_0x17d1aa(0xfa),'BJEGH':'input','bMNaO':function(_0x42b2cb){return _0x42b2cb();},'KHVyN':function(_0x23e13b,_0x549a20,_0x560536){return _0x23e13b(_0x549a20,_0x560536);},'SSjgv':function(_0x1dc853,_0x327f69){return _0x1dc853!==_0x327f69;},'iRVgw':_0x17d1aa(0xa5),'dqRPT':function(_0x2c84f0,_0x59abd7){return _0x2c84f0(_0x59abd7);},'ugBAx':function(_0x44b9ae,_0x440651){return _0x44b9ae+_0x440651;},'zIylx':function(_0xb4905e,_0x208233){return _0xb4905e===_0x208233;},'hyAxQ':_0x17d1aa(0xc9),'aiaTo':_0x17d1aa(0x132),'QGWDw':'uXTnv','KJZvP':function(_0x1af595){return _0x1af595();}};_0xd95752[_0x17d1aa(0x146)](_0x50cac8,this,function(){const _0x3bc678=_0x17d1aa,_0x5f39b4={'hidXg':_0xd95752[_0x3bc678(0x184)],'uvmhz':_0xd95752['kVseG'],'Idzdp':function(_0x1047f6,_0x53df07){const _0x47cc4e=_0x3bc678;return _0xd95752[_0x47cc4e(0x123)](_0x1047f6,_0x53df07);},'dFmMb':_0xd95752[_0x3bc678(0xc2)],'MFIHP':function(_0x37ee7f,_0x1b70c9){const _0x5595de=_0x3bc678;return _0xd95752[_0x5595de(0x8a)](_0x37ee7f,_0x1b70c9);},'vkorM':_0xd95752[_0x3bc678(0x1c0)],'mvADt':_0xd95752[_0x3bc678(0x1bf)],'lJcaL':function(_0x57bf8c,_0x2770ad){const _0x42ea21=_0x3bc678;return _0xd95752[_0x42ea21(0x123)](_0x57bf8c,_0x2770ad);},'mtIoh':function(_0x2279f6){const _0x3e1d90=_0x3bc678;return _0xd95752[_0x3e1d90(0x175)](_0x2279f6);},'FxAbz':function(_0x2acb8c,_0x3fbe3e,_0x2fbeb7){const _0x18f86c=_0x3bc678;return _0xd95752[_0x18f86c(0x146)](_0x2acb8c,_0x3fbe3e,_0x2fbeb7);}};if(_0xd95752['SSjgv'](_0xd95752[_0x3bc678(0x160)],_0xd95752['iRVgw'])){const _0x5f54a0={'UsMFL':_0x5f39b4[_0x3bc678(0x1a1)],'epWNM':_0x5f39b4[_0x3bc678(0x107)],'dSEKG':function(_0x50b5db,_0xb77ec6){const _0x26751e=_0x3bc678;return _0x5f39b4[_0x26751e(0x150)](_0x50b5db,_0xb77ec6);},'wjkJZ':_0x5f39b4['dFmMb'],'caMFx':function(_0x1fd6c9,_0x1bcff8){const _0x27af09=_0x3bc678;return _0x5f39b4[_0x27af09(0x181)](_0x1fd6c9,_0x1bcff8);},'lzmnX':_0x5f39b4[_0x3bc678(0x110)],'yYMhc':function(_0x21a4f1,_0x3c1721){const _0x12f2a1=_0x3bc678;return _0x5f39b4[_0x12f2a1(0x181)](_0x21a4f1,_0x3c1721);},'dsaMQ':_0x5f39b4[_0x3bc678(0x87)],'CjPsa':function(_0xbc635d,_0x496ec2){return _0x5f39b4['lJcaL'](_0xbc635d,_0x496ec2);},'KQUjX':function(_0x37742e){const _0x59eb69=_0x3bc678;return _0x5f39b4[_0x59eb69(0xce)](_0x37742e);}};_0x5f39b4[_0x3bc678(0x12f)](_0x35543a,this,function(){const _0x1e8de9=_0x3bc678,_0x308578=new _0x3bf726(_0x5f54a0['UsMFL']),_0x372afb=new _0x151cc8(_0x5f54a0[_0x1e8de9(0x11e)],'i'),_0x2d5b85=_0x5f54a0['dSEKG'](_0x2306d8,_0x5f54a0[_0x1e8de9(0xa1)]);!_0x308578[_0x1e8de9(0x10e)](_0x5f54a0[_0x1e8de9(0x1ca)](_0x2d5b85,_0x5f54a0[_0x1e8de9(0x1c8)]))||!_0x372afb['test'](_0x5f54a0['yYMhc'](_0x2d5b85,_0x5f54a0[_0x1e8de9(0x1c7)]))?_0x5f54a0['CjPsa'](_0x2d5b85,'0'):_0x5f54a0[_0x1e8de9(0x1c5)](_0x111456);})();}else{const _0x481042=new RegExp(_0xd95752[_0x3bc678(0x184)]),_0x425d84=new RegExp(_0xd95752[_0x3bc678(0x1ae)],'i'),_0x4fad85=_0xd95752['dqRPT'](_0x1e51b0,_0xd95752[_0x3bc678(0xc2)]);!_0x481042[_0x3bc678(0x10e)](_0xd95752[_0x3bc678(0xe4)](_0x4fad85,_0xd95752[_0x3bc678(0x1c0)]))||!_0x425d84[_0x3bc678(0x10e)](_0xd95752['ugBAx'](_0x4fad85,_0xd95752[_0x3bc678(0x1bf)]))?_0xd95752['zIylx'](_0xd95752['hyAxQ'],_0xd95752[_0x3bc678(0x105)])?_0x55e81e[_0x3bc678(0x167)]():_0xd95752[_0x3bc678(0x102)](_0x4fad85,'0'):_0xd95752[_0x3bc678(0x1bd)](_0xd95752[_0x3bc678(0x10a)],_0xd95752['QGWDw'])?_0xd95752[_0x3bc678(0x170)](_0x1e51b0):function(){return!![];}[_0x3bc678(0x18c)](_0xd95752[_0x3bc678(0x199)](_0xd95752[_0x3bc678(0xef)],_0xd95752[_0x3bc678(0x13e)]))[_0x3bc678(0x119)](_0xd95752[_0x3bc678(0x18a)]);}})();}());const _0x2e3404=(function(){const _0x1f4ba3=_0x4943,_0x13b2d8={'uuqul':_0x1f4ba3(0xbf),'ijWvO':_0x1f4ba3(0xde),'dkXNt':function(_0x3a8607,_0x4a7c26){return _0x3a8607===_0x4a7c26;},'HVTCh':_0x1f4ba3(0x158),'cFAAP':function(_0x4deecc,_0x23fd85){return _0x4deecc!==_0x23fd85;},'eAjfb':_0x1f4ba3(0xe0),'JxJiO':_0x1f4ba3(0xbc),'azmDG':_0x1f4ba3(0xe9),'ulvdH':_0x1f4ba3(0x191),'WKUYl':'ANCAI','lIPyt':'tlxdi'};let _0x5b5961=!![];return function(_0x4f331e,_0x47da39){const _0x4ed4c3=_0x1f4ba3,_0x2d9bad={'RwSbL':_0x13b2d8[_0x4ed4c3(0xf4)],'mQOze':_0x13b2d8[_0x4ed4c3(0x1dc)],'CnTWp':function(_0x58e0c1,_0x1ff5aa){const _0x19ab4a=_0x4ed4c3;return _0x13b2d8[_0x19ab4a(0x103)](_0x58e0c1,_0x1ff5aa);},'RciYv':_0x13b2d8['HVTCh'],'AppHU':function(_0x3bd650,_0x5c0ebb){const _0x1354a6=_0x4ed4c3;return _0x13b2d8[_0x1354a6(0x18d)](_0x3bd650,_0x5c0ebb);},'iUKQM':_0x13b2d8['eAjfb'],'uEIBt':_0x13b2d8[_0x4ed4c3(0x149)],'cSukj':_0x13b2d8[_0x4ed4c3(0x1be)],'Ncywx':_0x13b2d8[_0x4ed4c3(0x16f)]};if(_0x13b2d8[_0x4ed4c3(0x18d)](_0x13b2d8[_0x4ed4c3(0xd4)],_0x13b2d8['lIPyt'])){const _0x59d89e=_0x5b5961?function(){const _0x404b7f=_0x4ed4c3;if(_0x2d9bad['CnTWp'](_0x2d9bad[_0x404b7f(0xe8)],_0x2d9bad['RciYv'])){if(_0x47da39){if(_0x2d9bad[_0x404b7f(0x15d)](_0x2d9bad[_0x404b7f(0xad)],_0x2d9bad[_0x404b7f(0x136)])){const _0x4b337a=_0x47da39[_0x404b7f(0x19d)](_0x4f331e,arguments);return _0x47da39=null,_0x4b337a;}else return function(_0x505e1f){}[_0x404b7f(0x18c)](_0x2d9bad[_0x404b7f(0xfd)])[_0x404b7f(0x19d)](_0x2d9bad['mQOze']);}}else{if(_0x3ab226){const _0x4738a2=_0x4df78e['apply'](_0x51462a,arguments);return _0x48fff8=null,_0x4738a2;}}}:function(){};return _0x5b5961=![],_0x59d89e;}else return _0x504659[_0x4ed4c3(0xa3)](_0x2d9bad[_0x4ed4c3(0xca)],{'class':_0x2d9bad['Ncywx'],'text':_0x279acc[_0x4ed4c3(0xaf)]}),_0x9197da[_0x4ed4c3(0x1cc)](_0x59ab8e);};}()),_0x37e034=_0x2e3404(this,function(){const _0x3c660d=_0x4943,_0x49a6c3={'PTyil':_0x3c660d(0xe9),'yykIy':'red','kwlpU':function(_0x2bc3d8,_0x5e76cb){return _0x2bc3d8(_0x5e76cb);},'OHUkp':function(_0x12903b,_0x5ea8a0){return _0x12903b!==_0x5ea8a0;},'ffgmA':_0x3c660d(0x177),'MBwKR':function(_0x232b5f,_0x23cc14){return _0x232b5f===_0x23cc14;},'QDqtu':'HGEIe','wTfHs':_0x3c660d(0x144),'mvyks':function(_0xae534,_0x41b359){return _0xae534+_0x41b359;},'UIPVb':'return\x20(function()\x20','eRRVx':_0x3c660d(0x1ce),'ehXXQ':_0x3c660d(0xd2),'oiWer':function(_0x26ba09){return _0x26ba09();},'eBZkW':_0x3c660d(0x148),'CCvEj':_0x3c660d(0x88),'hWdWH':'info','TquCB':_0x3c660d(0x1ac),'icNlO':_0x3c660d(0xb5),'jYDiA':_0x3c660d(0x182),'BnKLL':_0x3c660d(0x109),'NUiZf':function(_0x5020fd,_0x29712a){return _0x5020fd<_0x29712a;},'UZbQc':function(_0x182235,_0x23bcb7){return _0x182235===_0x23bcb7;},'JHDOM':_0x3c660d(0x168),'nJZyp':_0x3c660d(0x1d1)},_0x3ee60b=function(){const _0x31df02=_0x3c660d,_0x4a8484={'tmFSF':_0x49a6c3[_0x31df02(0xc6)],'ZdcdG':_0x49a6c3[_0x31df02(0x1ab)]};if(_0x49a6c3[_0x31df02(0x1b4)](_0x49a6c3[_0x31df02(0x137)],_0x49a6c3[_0x31df02(0x137)]))_0x48b842[_0x31df02(0x148)](_0xc2a185),_0x35f78f[_0x31df02(0xa3)](_0x4a8484[_0x31df02(0x114)],{'class':_0x4a8484['ZdcdG'],'text':''+_0x4812ed[_0x31df02(0xaf)]}),_0x5a67d9['status'](0x194)[_0x31df02(0xe5)](_0x18f77a);else{let _0x2839db;try{if(_0x49a6c3['MBwKR'](_0x49a6c3['QDqtu'],_0x49a6c3['wTfHs']))return _0x2424ec[_0x31df02(0xa3)](_0x49a6c3[_0x31df02(0xc6)],{'class':_0x49a6c3[_0x31df02(0x1ab)],'text':''+_0x3f7b1a[_0x31df02(0xaf)]}),_0x282b42[_0x31df02(0x1cc)](_0x2de602);else _0x2839db=_0x49a6c3[_0x31df02(0x94)](Function,_0x49a6c3[_0x31df02(0x162)](_0x49a6c3[_0x31df02(0x162)](_0x49a6c3[_0x31df02(0x195)],_0x49a6c3[_0x31df02(0xfb)]),');'))();}catch(_0x4a48d0){_0x49a6c3['OHUkp'](_0x49a6c3[_0x31df02(0x100)],_0x49a6c3['ehXXQ'])?_0x49a6c3[_0x31df02(0x94)](_0x3c21ff,'0'):_0x2839db=window;}return _0x2839db;}},_0x37248c=_0x49a6c3['oiWer'](_0x3ee60b),_0x49fa81=_0x37248c['console']=_0x37248c['console']||{},_0x3fecd6=[_0x49a6c3[_0x3c660d(0x90)],_0x49a6c3['CCvEj'],_0x49a6c3[_0x3c660d(0xc7)],_0x49a6c3[_0x3c660d(0x120)],_0x49a6c3[_0x3c660d(0x140)],_0x49a6c3[_0x3c660d(0x1a2)],_0x49a6c3[_0x3c660d(0x1da)]];for(let _0x1b7186=0x0;_0x49a6c3[_0x3c660d(0x12a)](_0x1b7186,_0x3fecd6[_0x3c660d(0x134)]);_0x1b7186++){if(_0x49a6c3[_0x3c660d(0x129)](_0x49a6c3[_0x3c660d(0x196)],_0x49a6c3[_0x3c660d(0x19b)])){const _0xb622bc=_0x4c6e56?function(){const _0x4c3f58=_0x3c660d;if(_0x1201f3){const _0x1c96d2=_0x490cc2[_0x4c3f58(0x19d)](_0x10cc73,arguments);return _0x1b8330=null,_0x1c96d2;}}:function(){};return _0x28c013=![],_0xb622bc;}else{const _0x1eed20=_0x2e3404[_0x3c660d(0x18c)][_0x3c660d(0xac)][_0x3c660d(0xf3)](_0x2e3404),_0x926ee0=_0x3fecd6[_0x1b7186],_0x50d6b8=_0x49fa81[_0x926ee0]||_0x1eed20;_0x1eed20[_0x3c660d(0xc4)]=_0x2e3404['bind'](_0x2e3404),_0x1eed20[_0x3c660d(0x16a)]=_0x50d6b8[_0x3c660d(0x16a)][_0x3c660d(0xf3)](_0x50d6b8),_0x49fa81[_0x926ee0]=_0x1eed20;}}});_0x37e034();import _0xf058b3 from'express';const $=_0xf058b3[_0x400e59(0x153)]();import{MongoClient as _0x458d17,ObjectId as _0x317426}from'mongodb';import _0x5da27f from'ejs';import _0x4457a5 from'fs';import _0x1bdd59 from'path';import*as _0x5a89e2 from'../mymodule/myDateTime.js';import*as _0x4e9a74 from'../mymodule/myUsers.js';import*as _0x20988b from'../mymodule/myModule.js';function _0x51eb(){const _0x1ba759=['ลูกค้า\x20\x22','pnyrH','MaXYi','CktNg','rtdzR','sort','VyeXK','TeEMY','ceil','mvADt','warn','body','xICgu','279agRHaE','CUFtK','wfkdL','KjFOA','Ayjiy','eBZkW','Qlcpo','opCMq','aggregate','kwlpU','\x22\x20เรียบร้อยแล้ว','bXeiK','25CzNuHd','QVgFm','pwstR','TPPqi','อัปเดต\x20\x22','cywez','wwsKp','ZGdDc','stateObject','JpNgw','wjkJZ','euoZc','flash','AFDyd','WPHPm','debu','EGhgK','uZQNl','insertedId','pSLGp','setDate','prototype','iUKQM','Vuljp','message','gSQnY','LcXHh','phxLa','ssCAS','4756efCkik','exception','input','yUDgz','trim','error\x20===>\x20','ไม่มีข้อมูลที่จะพิมพ์','EVnqb','mNDeP','qGbcr','uCbQR','while\x20(true)\x20{}','mzAFA','updateOne','QupHN','getDate','__proto__','bPtGm','PTyil','hWdWH','qmWFg','ePHKR','cSukj','eeMdq','$dateTimeCanDelete','xTiHb','mtIoh','userFlash','fJgpW','iNyfT','jLUBM','TsVKN','WKUYl','MIfWr','KfBSG','/print','เพิ่ม\x20\x22','nkKEh','yoirT','\x22{{sep}}ไม่มีอะไรเปลี่ยนแปลง','query','nmSzu','counter','Zbegt','WkwiY','sip','HWyvy','UZlGH','ugBAx','sendFile','UByaQ','$customerId','RciYv','msg','&rpp=','formCustomers.ejs','bHVUM','mDHtW','XxBfZ','jgOao','Error\x20while\x20deleting','wsXyx','ObCZs','bind','uuqul','function\x20*\x5c(\x20*\x5c)','get','{{sep}}ไม่สามารถลบได้','toISOString','connect','chain','eRRVx','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','RwSbL','TTJeF','81066SreXbV','ehXXQ','uFWDl','dqRPT','dkXNt','524602OoORTw','aiaTo','32650TejIQC','uvmhz','deletedCount','trace','QGWDw','DOOyI','WtLew','skNak','test','dbColl_receipt','vkorM','qPqvp','Print\x20','oBdxn','tmFSF','gger','CVUNZ','YJVxu','xpWuD','call','FyCRD','ไม่พบ\x20\x22','isOA','gGnxk','epWNM','&page=','TquCB','DdEJj','385qtxRfD','djVvj','Not\x20Found','190648bQhbEl','init','green','FKtVG','UZbQc','NUiZf','UnFRw','newDateTimeLocal','EdovV','cNimV','FxAbz','VLsPR','jTAtd','vkBbk','XqIRR','length','Fwvxl','uEIBt','ffgmA','collection','XjhFU','aegih','{{sep}}\x22','AWkqn','oAwaN','CSWvP','npcTV','icNlO','join','SJqqB','/delete','ZLagF','fYtbV','KHVyN','urLJO','log','JxJiO','ypVWE','_id','dnsuA','rpp','dbName','vomsQ','Idzdp','NZfqt','YOvEK','Router','ลูกค้า','\x22\x20ซ้ำ{{sep}}\x20โปรดติดต่อผู้ดูแลระบบ','action','status','gOcEB','VGSum','bskoc','limit','getSessionData','AppHU','NqvXL','MpPiF','iRVgw','page','mvyks','nEwPk','45VqJYUD','WhUNs','deleteOne','close','gPfxP','GYaOe','toString','?sip=','minute','dbColl_customers','vCwFs','ulvdH','KJZvP','Hmawc','egPZs','vOdpA','Fcghu','bMNaO','UAxfR','qzdwn','pjbku','pctde','stringify','TdPJk','kQfbe','ynKZs','BGhXm','wFkzC','rfhrW','MFIHP','table','acknowledged','OfzjS','1210475lxBcQr','SaAik','render','YKPCU','eGMgS','jkgaO','load_id','constructor','cFAAP','TXnwm','xErMP','LdJOy','red','PUeVQ','customers','find','UIPVb','JHDOM','เกิดข้อผิดพลาดขณะลบ\x20\x22','&load_id=','tfwZB','ptWDs','nJZyp','usbRG','apply','nmHPb','xryCu','EzFhr','hidXg','jYDiA','209998vLkTMY','findOne','fXakU','Hujjm','wQbWZ','HVNTb','toArray','modifiedCount','yykIy','error','icpDq','kVseG','yRkKQ','readFileSync','post','nQnJn','return\x20(function()\x20','OHUkp','ShivN','CAAOX','replace','DMDgY','customerId','ibInw','yellow','Byool','zIylx','azmDG','BJEGH','LelPe','dbColl_quotation','string','ZPmTK','เลขที่งาน\x20\x22','KQUjX','cFgnU','dsaMQ','lzmnX','wfqal','caMFx','DAyCB','redirect','KBopq','{}.constructor(\x22return\x20this\x22)(\x20)','lPknU','send','kxrlf','ลบ\x20\x22','dWcKv','dDpnm','HFRXb','countDocuments','/save','RqUlZ','yuxfT','BnKLL','\x5c$&','ijWvO'];_0x51eb=function(){return _0x1ba759;};return _0x51eb();}import _0x276d1f from'../middleware/mainAuth.js';const l='/customers',T=l+_0x400e59(0x1d7),P=l+'/load',E=l+_0x400e59(0x143),H=l+'/import',S=l+_0x400e59(0xd7),J=l[_0x400e59(0x1b7)](/\//g,'_');$[_0x400e59(0xf6)](l,_0x276d1f[_0x400e59(0x11c)],async(_0x2b2a9a,_0x3b0112)=>{const _0x13e38d=_0x400e59,_0x3c33b1={'npcTV':_0x13e38d(0xf5),'KghBD':_0x13e38d(0xfc),'ZPmTK':function(_0xcf1e1a,_0xfeed9){return _0xcf1e1a(_0xfeed9);},'dDpnm':_0x13e38d(0x126),'Ayjiy':function(_0x382fbb,_0x50671f){return _0x382fbb+_0x50671f;},'wFkzC':_0x13e38d(0xfa),'GYaOe':function(_0x4fd8f7,_0x52167b){return _0x4fd8f7+_0x52167b;},'ptWDs':_0x13e38d(0xb6),'DdEJj':function(_0x5a390d){return _0x5a390d();},'yuxfT':function(_0x118772,_0x372c51){return _0x118772(_0x372c51);},'MIfWr':function(_0x4a00f9,_0x42f606){return _0x4a00f9(_0x42f606);},'MaXYi':function(_0x1bc93f,_0x37f0b6){return _0x1bc93f(_0x37f0b6);},'YOvEK':function(_0x156082,_0x425f0c){return _0x156082*_0x425f0c;},'SaAik':function(_0x22c56c,_0x19b6b0){return _0x22c56c-_0x19b6b0;},'RqUlZ':function(_0x487dad,_0x2cadbc){return _0x487dad!==_0x2cadbc;},'VGSum':_0x13e38d(0xe6),'HFRXb':'UsvBF','wsXyx':_0x13e38d(0xcc),'eeMdq':_0x13e38d(0x16c),'wfqal':function(_0x15acd0,_0x5723fd){return _0x15acd0===_0x5723fd;},'nmSzu':_0x13e38d(0xfe),'skNak':_0x13e38d(0x18f),'XbxgE':_0x13e38d(0x1db),'fyWOj':function(_0x2a9f4f,_0x3d0340){return _0x2a9f4f/_0x3d0340;},'xpWuD':function(_0x5a0ce2,_0x3c3a3f){return _0x5a0ce2<_0x3c3a3f;},'CAAOX':function(_0x40d9a3,_0x211fdd){return _0x40d9a3(_0x211fdd);},'wQbWZ':function(_0x325d52,_0x5651d0){return _0x325d52-_0x5651d0;},'NkmJk':function(_0x2be67d,_0x5dfae9){return _0x2be67d(_0x5dfae9);},'QVgFm':function(_0x465ece,_0x4590ce){return _0x465ece>_0x4590ce;},'mLEpt':function(_0x8e7001,_0x8c7c61){return _0x8e7001+_0x8c7c61;},'XjhFU':_0x13e38d(0x1cb),'YKKss':_0x13e38d(0x1e3),'VLsPR':_0x13e38d(0x13c),'lKMGO':_0x13e38d(0x193),'lPknU':_0x13e38d(0xe9),'XDoGk':_0x13e38d(0xcf),'WhUNs':_0x13e38d(0x1a5),'ynKZs':'Xwmvx','wfkdL':'vVjhL'},_0x21f999=_0x2b2a9a['query'][_0x13e38d(0xe1)]?.[_0x13e38d(0xb8)]()[_0x13e38d(0x1b7)](/[$.*?]/g,'\x20')||'',_0x5dde52=_0x3c33b1[_0x13e38d(0x1d9)](Number,_0x2b2a9a['query'][_0x13e38d(0x14d)])||0x14,_0x113288=_0x3c33b1[_0x13e38d(0xd5)](Number,_0x2b2a9a[_0x13e38d(0xdc)][_0x13e38d(0x161)])||0x1,_0x13155d=_0x2b2a9a[_0x13e38d(0xdc)][_0x13e38d(0x18b)]||'',_0x7f6955=_0x3c33b1[_0x13e38d(0x1df)](Number,_0x3c33b1[_0x13e38d(0x152)](_0x3c33b1['SaAik'](_0x113288,0x1),_0x5dde52)),_0x12b091=new _0x458d17(dbUrl);try{if(_0x3c33b1[_0x13e38d(0x1d8)](_0x3c33b1[_0x13e38d(0x159)],_0x3c33b1[_0x13e38d(0x1d5)])){const _0x592dda={'_id':0x1,'customerId':0x1,'customerStatus':0x1,'customerType':0x1,'customerName':0x1,'customerAddress1':0x1,'customerAddress2':0x1,'customerPhone':0x1,'customerWebsite':0x1,'customerEmail':0x1,'customerIdentityId':0x1,'customerTaxId':0x1,'customerContactPerson':0x1,'canDelete':0x1,'isCanDelete':{'$cond':{'if':{'$gt':[{'$dateDiff':{'startDate':{'$toDate':_0x5a89e2['nowLocal']()['slice'](0x0,0x10)['replace']('T','\x20')},'endDate':{'$toDate':_0x3c33b1[_0x13e38d(0xf1)]},'unit':_0x3c33b1[_0x13e38d(0xcb)]}},0x0]},'then':!0x0,'else':!0x1}}};await _0x12b091['connect']();const _0x4e616c=_0x12b091['db'](dbName)['collection'](global[_0x13e38d(0x16d)]);if(_0x21f999){if(_0x3c33b1[_0x13e38d(0x1c9)](_0x3c33b1[_0x13e38d(0xdd)],_0x3c33b1[_0x13e38d(0x10d)])){const _0x3e3ec0=new _0x29e37c(WgHjRy[_0x13e38d(0x13f)]),_0x4ae104=new _0x68adf4(WgHjRy['KghBD'],'i'),_0x30d966=WgHjRy[_0x13e38d(0x1c3)](_0x1c92d3,WgHjRy[_0x13e38d(0x1d4)]);!_0x3e3ec0[_0x13e38d(0x10e)](WgHjRy[_0x13e38d(0x8f)](_0x30d966,WgHjRy[_0x13e38d(0x17f)]))||!_0x4ae104[_0x13e38d(0x10e)](WgHjRy['GYaOe'](_0x30d966,WgHjRy[_0x13e38d(0x19a)]))?WgHjRy[_0x13e38d(0x1c3)](_0x30d966,'0'):WgHjRy[_0x13e38d(0x121)](_0x3b747d);}else{const _0x7fc732=new RegExp(_0x21f999[_0x13e38d(0x1b7)](/[.*+?^${}()|[\]\\]/g,_0x3c33b1['XbxgE']),'i');var _0x499156=await _0x4e616c[_0x13e38d(0x1d6)]({'$or':[{'customerId':{'$regex':_0x7fc732}},{'customerName':{'$regex':_0x7fc732}}]});}}else var _0x499156=await _0x4e616c['countDocuments']({});const _0x16ba64=Math[_0x13e38d(0x86)](_0x3c33b1['fyWOj'](_0x499156,_0x5dde52)),_0x4efd74=_0x3c33b1[_0x13e38d(0x118)](_0x3c33b1[_0x13e38d(0x186)](_0x3c33b1[_0x13e38d(0x1b6)](Number,_0x113288),0x1),0x1)?'-':_0x3c33b1[_0x13e38d(0x1a7)](_0x3c33b1[_0x13e38d(0xd5)](Number,_0x113288),0x1),_0x2f79f9=_0x3c33b1['NkmJk'](Number,_0x113288),_0x384e99=_0x3c33b1[_0x13e38d(0x98)](_0x3c33b1['mLEpt'](_0x3c33b1[_0x13e38d(0x1df)](Number,_0x113288),0x1),_0x16ba64)?'-':_0x3c33b1[_0x13e38d(0x169)](_0x3c33b1[_0x13e38d(0x1d9)](Number,_0x113288),0x1),_0x40d2ad=[{'$project':_0x592dda},{'$sort':{'customerId':0x1}},{'$skip':_0x7f6955},{'$limit':_0x5dde52}];if(_0x21f999){if(_0x3c33b1[_0x13e38d(0x1c9)](_0x3c33b1[_0x13e38d(0x139)],_0x3c33b1[_0x13e38d(0x139)])){const _0x302dbe=_0x21f999?new RegExp(''+_0x21f999,'i'):new RegExp('.*');_0x40d2ad['unshift']({'$match':{'$or':[{'customerId':{'$regex':_0x302dbe}},{'customerName':{'$regex':_0x302dbe}}]}});}else return!![];}const _0x7f28dc=await _0x4e616c[_0x13e38d(0x93)](_0x40d2ad)['toArray']();if(_0x13155d){if(_0x3c33b1[_0x13e38d(0x1c9)](_0x3c33b1['YKKss'],_0x3c33b1[_0x13e38d(0x130)]))_0x35a043['close']();else{var _0x1d24d1=_0x7f28dc['filter'](_0x391afa=>_0x391afa[_0x13e38d(0x14b)]==_0x13155d);if(_0x3c33b1['QVgFm'](_0x1d24d1[_0x13e38d(0x134)],0x0))var _0x83a6aa=_0x1d24d1[0x0];else var _0x83a6aa=await _0x4e616c[_0x13e38d(0x1a4)]({'_id':new _0x317426(_0x13155d)});}}const _0x34d50d=await _0x20988b['renderView'](_0x3c33b1['lKMGO'],_0x3b0112,{'title':PAGE_CUSTOMERS,'time':_0x5a89e2['formatDate'](new Date()),'msg':_0x2b2a9a[_0x13e38d(0xa3)](_0x3c33b1[_0x13e38d(0x1cf)]),'userFlash':_0x2b2a9a['flash'](_0x3c33b1['XDoGk']),..._0x4e9a74[_0x13e38d(0x15c)](_0x2b2a9a),...await _0x20988b['getSettings'](),'load_id':_0x13155d,'sip':_0x21f999,'rpp':_0x5dde52,'page':_0x113288,'pagePre':_0x4efd74,'pageAct':_0x2f79f9,'pageNxt':_0x384e99,'pageLst':_0x16ba64,'pageRedirect':''+l,'PATH_MAIN':l,'PATH_SAVE':T,'PATH_LOAD':P,'PATH_DELETE':E,'PATH_IMPORT':H,'PATH_PRINT':S,'PREFIX':J,'data':_0x7f28dc,'item':_0x83a6aa});_0x3b0112[_0x13e38d(0x1d0)](_0x34d50d);}else _0x19bfd1[_0x13e38d(0x167)]();}catch(_0x5da09e){if(_0x3c33b1[_0x13e38d(0x1c9)](_0x3c33b1[_0x13e38d(0x165)],_0x3c33b1['WhUNs']))console[_0x13e38d(0x148)](_0x5da09e),_0x3b0112[_0x13e38d(0x157)](0x194)['sendFile'](file404);else{if(_0x113b78){const _0x199348=_0x2aae3b[_0x13e38d(0x19d)](_0x3621b5,arguments);return _0x17c9fb=null,_0x199348;}}}finally{_0x3c33b1['RqUlZ'](_0x3c33b1[_0x13e38d(0x17d)],_0x3c33b1[_0x13e38d(0x8d)])?_0x12b091[_0x13e38d(0x167)]():(_0x5eb5fa[_0x13e38d(0x148)](_0x46fa1c),_0x3e4477['status'](0x194)[_0x13e38d(0xe5)](_0x142b21));}}),$['post'](P,_0x276d1f[_0x400e59(0x11c)],async(_0x5e7595,_0x25bb52)=>{const _0x2c74ca=_0x400e59,_0x2cea28={'ShivN':function(_0x286a6c,_0x23ddfb){return _0x286a6c(_0x23ddfb);},'Zbegt':function(_0x3f8059,_0x1edc45){return _0x3f8059(_0x1edc45);},'Byool':function(_0x47ddf3,_0x47566c){return _0x47ddf3===_0x47566c;},'EGhgK':_0x2c74ca(0x190),'TXnwm':_0x2c74ca(0xe9),'ssCAS':_0x2c74ca(0x191),'bPtGm':'Not\x20Found','mDHtW':function(_0x383463,_0xcf57e6){return _0x383463!==_0xcf57e6;},'cNimV':_0x2c74ca(0x111),'ZGdDc':function(_0x38735e,_0x16549d){return _0x38735e!==_0x16549d;},'SDMHs':_0x2c74ca(0x1c6)},_0x480124=_0x5e7595[_0x2c74ca(0x89)][_0x2c74ca(0x18b)],_0x71b845=_0x5e7595[_0x2c74ca(0x89)][_0x2c74ca(0xe1)],_0x2651e7=_0x2cea28['Zbegt'](Number,_0x5e7595[_0x2c74ca(0x89)][_0x2c74ca(0x14d)])||0x14,_0x18e0b7=_0x2cea28[_0x2c74ca(0xdf)](Number,_0x5e7595['body'][_0x2c74ca(0x161)])||0x1,_0x1f048b=l+'?sip='+_0x71b845+_0x2c74ca(0xea)+_0x2651e7+_0x2c74ca(0x11f)+_0x18e0b7+'&load_id='+_0x480124,_0xeeeb9c=new _0x458d17(dbUrl);try{if(_0x2cea28[_0x2c74ca(0x1bc)](_0x2cea28[_0x2c74ca(0xa7)],_0x2cea28['EGhgK']))return await _0xeeeb9c['db'](dbName)[_0x2c74ca(0x138)](global[_0x2c74ca(0x16d)])[_0x2c74ca(0x1a4)]({'_id':new _0x317426(_0x480124)})||_0x5e7595[_0x2c74ca(0xa3)](_0x2cea28[_0x2c74ca(0x18e)],{'class':_0x2cea28[_0x2c74ca(0xb3)],'text':new Error(_0x2cea28[_0x2c74ca(0xc5)])+_0x2c74ca(0x13b)+_0x480124+'\x22'}),_0x25bb52[_0x2c74ca(0x1cc)](_0x1f048b);else{const _0x2f32c6=_0x4fa21c['apply'](_0x54d1fb,arguments);return _0x12e734=null,_0x2f32c6;}}catch(_0x31b631){if(_0x2cea28[_0x2c74ca(0xed)](_0x2cea28[_0x2c74ca(0x12e)],_0x2cea28[_0x2c74ca(0x12e)])){const _0x3230ae=_0x408a64?function(){const _0x3ff08e=_0x2c74ca;if(_0x55760c){const _0x3c000c=_0x15cd37[_0x3ff08e(0x19d)](_0x16cb85,arguments);return _0x308fce=null,_0x3c000c;}}:function(){};return _0x41293c=![],_0x3230ae;}else return _0x5e7595['flash'](_0x2cea28[_0x2c74ca(0x18e)],{'class':_0x2cea28[_0x2c74ca(0xb3)],'text':''+_0x31b631['message']}),_0x25bb52['redirect'](_0x1f048b);}finally{if(_0x2cea28[_0x2c74ca(0x9e)](_0x2cea28['SDMHs'],_0x2cea28['SDMHs'])){if(_0x53cfb7)return _0x532515;else uOEKko[_0x2c74ca(0x1b5)](_0x40345b,0x0);}else _0xeeeb9c[_0x2c74ca(0x167)]();}}),$['post'](T,_0x276d1f[_0x400e59(0x11c)],async(_0x367d72,_0x534177)=>{const _0x11cd00=_0x400e59,_0x159708={'ePKyd':function(_0x130d9e){return _0x130d9e();},'nEwPk':function(_0x405724,_0x8595ae){return _0x405724(_0x8595ae);},'pnyrH':function(_0x3f849c,_0x377aa5){return _0x3f849c(_0x377aa5);},'EzFhr':function(_0x157870,_0xd2fb96){return _0x157870!==_0xd2fb96;},'bkLPb':_0x11cd00(0xa8),'CVUNZ':_0x11cd00(0x1cd),'UnFRw':function(_0x2c4d9f,_0xa0d7b3){return _0x2c4d9f===_0xa0d7b3;},'QMeNl':_0x11cd00(0x142),'nkKEh':function(_0x49ddb7,_0x449fd8){return _0x49ddb7(_0x449fd8);},'jTAtd':_0x11cd00(0xec),'FHsIk':_0x11cd00(0xbb),'yoirT':function(_0x171eb8,_0x2e4bba){return _0x171eb8>_0x2e4bba;},'Vuljp':function(_0x18ca4f,_0x5d8aaf){return _0x18ca4f+_0x5d8aaf;},'KfBSG':_0x11cd00(0xe9),'KjFOA':'red','DOOyI':function(_0x29b6f2,_0x3bac88){return _0x29b6f2!==_0x3bac88;},'dnsuA':_0x11cd00(0x117),'oAwaN':_0x11cd00(0x127),'enSJx':function(_0x2340e1,_0x192f31){return _0x2340e1==_0x192f31;},'qmWFg':function(_0x323a07,_0x1d333a){return _0x323a07<_0x1d333a;},'Hujjm':_0x11cd00(0x1bb),'rfhrW':_0x11cd00(0x124),'bskoc':function(_0x407a19,_0x23e880){return _0x407a19!==_0x23e880;},'XqIRR':'TYPml','aegih':_0x11cd00(0x135),'DMDgY':_0x11cd00(0x128)},_0x443e36=_0x367d72['body']['customerId']?_0x159708[_0x11cd00(0x163)](Number,_0x367d72[_0x11cd00(0x89)]['customerId']):null,_0x49f1aa=_0x367d72['body'][_0x11cd00(0x14b)],_0x753306=_0x367d72[_0x11cd00(0x89)][_0x11cd00(0xe1)],_0x6a844d=_0x159708[_0x11cd00(0x163)](Number,_0x367d72[_0x11cd00(0x89)][_0x11cd00(0x14d)])||0x14,_0x21799a=_0x159708[_0x11cd00(0x1de)](Number,_0x367d72[_0x11cd00(0x89)][_0x11cd00(0x161)])||0x1,_0x4a4e79=l+'?sip='+_0x753306+_0x11cd00(0xea)+_0x6a844d+_0x11cd00(0x11f)+_0x21799a+_0x11cd00(0x198)+_0x49f1aa;delete _0x367d72[_0x11cd00(0x89)]['_id'],delete _0x367d72[_0x11cd00(0x89)][_0x11cd00(0xe1)],delete _0x367d72[_0x11cd00(0x89)][_0x11cd00(0x14d)],delete _0x367d72[_0x11cd00(0x89)][_0x11cd00(0x161)];const _0x40bca1=new _0x458d17(dbUrl);try{if(_0x159708[_0x11cd00(0x1a0)](_0x159708['bkLPb'],_0x159708[_0x11cd00(0x116)])){await _0x40bca1[_0x11cd00(0xf9)]();const _0x2b9fcf=_0x40bca1['db'](dbName)[_0x11cd00(0x138)](global[_0x11cd00(0x16d)]);if(_0x49f1aa){if(_0x159708[_0x11cd00(0x12b)](_0x159708['QMeNl'],_0x159708['QMeNl'])){_0x367d72[_0x11cd00(0x89)]['customerId']&&(_0x367d72[_0x11cd00(0x89)][_0x11cd00(0x1b9)]=_0x159708[_0x11cd00(0xd9)](Number,_0x367d72[_0x11cd00(0x89)]['customerId']));var _0x30353f=await _0x2b9fcf[_0x11cd00(0xc1)]({'_id':new _0x317426(_0x49f1aa)},{'$set':_0x367d72[_0x11cd00(0x89)]},{'upsert':!0x1});}else _0x373fba=_0x208bb2;}else{if(_0x159708[_0x11cd00(0x1a0)](_0x159708[_0x11cd00(0x131)],_0x159708['FHsIk'])){const _0x477f76=await _0x2b9fcf[_0x11cd00(0x194)]({},{'projection':{'customerId':0x1}})[_0x11cd00(0x1e2)]({'customerId':-0x1})[_0x11cd00(0x15b)](0x1)[_0x11cd00(0x1a9)](),_0x5cc7a9=_0x159708[_0x11cd00(0xda)](_0x477f76[_0x11cd00(0x134)],0x0)?_0x159708[_0x11cd00(0xae)](_0x477f76[0x0][_0x11cd00(0x1b9)],0x1):0x2710;_0x367d72[_0x11cd00(0x89)]['customerId']=_0x5cc7a9;let _0x5508d5=_0x5a89e2[_0x11cd00(0x12c)]();if(_0x5508d5[_0x11cd00(0xab)](_0x159708[_0x11cd00(0xae)](_0x5508d5[_0x11cd00(0xc3)](),0x1)),_0x5508d5=_0x5508d5[_0x11cd00(0xf8)]()['slice'](0x0,0x10)['replace']('T','\x20'),_0x367d72[_0x11cd00(0x89)]['dateTimeCanDelete']=_0x5508d5,await _0x2b9fcf[_0x11cd00(0x1a4)]({'customerId':_0x5cc7a9}))return _0x367d72[_0x11cd00(0xa3)](_0x159708[_0x11cd00(0xd6)],{'class':_0x159708[_0x11cd00(0x8e)],'text':_0x11cd00(0x1c4)+_0x443e36+_0x11cd00(0x155)}),_0x534177[_0x11cd00(0x1cc)](l);var _0x30353f=await _0x2b9fcf['insertOne'](_0x367d72[_0x11cd00(0x89)]);}else{const _0x1d261e=_0x47aa4d?new _0xb8ee47(''+_0x1bdf78,'i'):new _0x295d35('.*');_0x11af60['unshift']({'$match':{'$or':[{'customerId':{'$regex':_0x1d261e}},{'customerName':{'$regex':_0x1d261e}}]}});}}if(_0x30353f['acknowledged']&&_0x30353f[_0x11cd00(0xa9)]){if(_0x159708[_0x11cd00(0x10b)](_0x159708[_0x11cd00(0x14c)],_0x159708[_0x11cd00(0x14c)]))PUMCuA['ePKyd'](_0x2fcb9b);else{const _0x169857=l+'?sip='+_0x753306+'&rpp='+_0x6a844d+_0x11cd00(0x11f)+_0x21799a+_0x11cd00(0x198)+_0x30353f[_0x11cd00(0xa9)];return _0x367d72[_0x11cd00(0xa3)](_0x159708[_0x11cd00(0xd6)],{'class':_0x159708['oAwaN'],'text':_0x11cd00(0xd8)+_0x367d72[_0x11cd00(0x89)][_0x11cd00(0x1b9)]+_0x11cd00(0x95)}),_0x534177[_0x11cd00(0x1cc)](_0x169857);}}else return _0x30353f['acknowledged']&&_0x159708['enSJx'](_0x30353f[_0x11cd00(0x1aa)],0x1)?(_0x367d72['flash'](_0x159708[_0x11cd00(0xd6)],{'class':_0x159708[_0x11cd00(0x13d)],'text':_0x11cd00(0x9b)+_0x443e36+_0x11cd00(0x95)}),_0x534177[_0x11cd00(0x1cc)](_0x4a4e79)):_0x30353f[_0x11cd00(0x183)]&&_0x159708[_0x11cd00(0xc8)](_0x30353f[_0x11cd00(0x1aa)],0x1)?(_0x367d72['flash'](_0x159708[_0x11cd00(0xd6)],{'class':_0x159708[_0x11cd00(0x1a6)],'text':'\x22'+_0x443e36+_0x11cd00(0xdb)}),_0x534177[_0x11cd00(0x1cc)](_0x4a4e79)):(_0x367d72['flash'](_0x159708[_0x11cd00(0xd6)],{'class':_0x159708[_0x11cd00(0x8e)],'text':new Error(_0x159708[_0x11cd00(0x180)])+_0x11cd00(0x13b)+_0x443e36+'\x22'}),_0x534177[_0x11cd00(0x1cc)](l));}else _0x3fff98['close']();}catch(_0x5f03e5){if(_0x159708[_0x11cd00(0x15a)](_0x159708[_0x11cd00(0x133)],_0x159708[_0x11cd00(0x13a)]))console[_0x11cd00(0x148)](_0x5f03e5),_0x367d72[_0x11cd00(0xa3)](_0x159708[_0x11cd00(0xd6)],{'class':_0x159708[_0x11cd00(0x8e)],'text':''+_0x5f03e5[_0x11cd00(0xaf)]}),_0x534177[_0x11cd00(0x157)](0x194)[_0x11cd00(0xe5)](file404);else return _0x47b696;}finally{_0x159708[_0x11cd00(0x1a0)](_0x159708[_0x11cd00(0x1b8)],_0x159708[_0x11cd00(0x1b8)])?_0x511198['close']():_0x40bca1['close']();}}),$[_0x400e59(0x1b1)](E,_0x276d1f['isOA'],async(_0x161134,_0x3e099d)=>{const _0xefabd0=_0x400e59,_0x5289aa={'MpPiF':function(_0x5165c1,_0x5d89c5){return _0x5165c1+_0x5d89c5;},'bRsCL':_0xefabd0(0xa6),'TPPqi':'gger','uCbQR':_0xefabd0(0x9f),'FyCRD':function(_0x70e75d,_0x1ce2b9){return _0x70e75d(_0x1ce2b9);},'HVNTb':function(_0x54f89b,_0x249307){return _0x54f89b+_0x249307;},'icpDq':_0xefabd0(0x1b3),'xTiHb':'{}.constructor(\x22return\x20this\x22)(\x20)','uFWDl':'error\x20===>\x20','wwsKp':'red','vYMPX':function(_0xd5f7ee,_0x1725b3){return _0xd5f7ee!=_0x1725b3;},'NZfqt':function(_0x1cd449,_0xc15004){return _0x1cd449===_0xc15004;},'lEKkt':_0xefabd0(0xd3),'nQnJn':_0xefabd0(0x1d3),'vCwFs':_0xefabd0(0xe9),'epUUr':_0xefabd0(0x127),'FRbHO':_0xefabd0(0xf0),'iNyfT':function(_0x465a63,_0x2376d0){return _0x465a63!==_0x2376d0;},'gGnxk':_0xefabd0(0x10c),'qGbcr':_0xefabd0(0x12d),'pwstR':_0xefabd0(0x174)},{idToDelete:_0x593656,load_id:_0x195220,sip:_0x4d1803}=_0x161134['body'],_0x52590d=_0x161134[_0xefabd0(0x89)]['customerId'][_0xefabd0(0x16a)](),_0x470859=_0x5289aa[_0xefabd0(0x11a)](Number,_0x161134[_0xefabd0(0x89)][_0xefabd0(0x14d)])||0x14,_0x39aace=_0x5289aa[_0xefabd0(0x11a)](Number,_0x161134[_0xefabd0(0x89)][_0xefabd0(0x161)])||0x1,_0x398c1c=_0x195220&&_0x5289aa['vYMPX'](_0x195220,_0x593656)?'&load_id='+_0x195220:'',_0x476fc6=l+_0xefabd0(0x16b)+_0x4d1803+_0xefabd0(0xea)+_0x470859+_0xefabd0(0x11f)+_0x39aace+_0x398c1c,_0x42af3a=new _0x458d17(dbUrl);try{if(_0x5289aa[_0xefabd0(0x151)](_0x5289aa['lEKkt'],_0x5289aa[_0xefabd0(0x1b2)]))(function(){return![];}[_0xefabd0(0x18c)](OQJCfK[_0xefabd0(0x15f)](OQJCfK['bRsCL'],OQJCfK[_0xefabd0(0x9a)]))[_0xefabd0(0x19d)](OQJCfK[_0xefabd0(0xbe)]));else{await _0x42af3a[_0xefabd0(0xf9)]();const _0x320a0a=_0x42af3a['db'](dbName),_0x58a84a=_0x320a0a['collection'](global[_0xefabd0(0x16d)]);if(!await _0x58a84a[_0xefabd0(0x1a4)]({'_id':new _0x317426(_0x593656)}))return _0x161134[_0xefabd0(0xa3)](_0x5289aa[_0xefabd0(0x16e)],{'class':_0x5289aa[_0xefabd0(0x9d)],'text':_0xefabd0(0x11b)+_0x52590d+'\x22'}),_0x3e099d[_0xefabd0(0x1cc)](_0x476fc6);const _0x167519=[{'coll':_0x320a0a['collection'](global[_0xefabd0(0x1c1)]),'name':global['dbColl_quotation']},{'coll':_0x320a0a[_0xefabd0(0x138)](global['dbColl_invoice']),'name':global['dbColl_invoice']},{'coll':_0x320a0a['collection'](global[_0xefabd0(0x10f)]),'name':global['dbColl_receipt']}];for(const {coll:_0xe8d90b,name:_0x5377cb}of _0x167519)if(await _0xe8d90b[_0xefabd0(0x1a4)]({'customerId':_0x593656}))return await _0x58a84a[_0xefabd0(0xc1)]({'customerId':_0x593656},{'$set':{'canDelete':!0x1}}),_0x161134[_0xefabd0(0xa3)](_0x5289aa[_0xefabd0(0x16e)],{'class':_0x5289aa[_0xefabd0(0x9d)],'text':_0xefabd0(0x1dd)+_0x593656+'\x22\x20มีอยู่ในเอกสาร\x20'+_0x5377cb+_0xefabd0(0xf7)}),_0x3e099d[_0xefabd0(0x1cc)](_0x476fc6);return _0x5289aa[_0xefabd0(0x151)]((await _0x58a84a[_0xefabd0(0x166)]({'_id':new _0x317426(_0x593656)}))[_0xefabd0(0x108)],0x1)?(_0x161134['flash'](_0x5289aa[_0xefabd0(0x16e)],{'class':_0x5289aa['epUUr'],'text':_0xefabd0(0x1d2)+_0x52590d+_0xefabd0(0x95)}),_0x3e099d[_0xefabd0(0x1cc)](_0x476fc6)):(console[_0xefabd0(0x148)](_0x5289aa['FRbHO']),_0x161134[_0xefabd0(0xa3)](_0x5289aa[_0xefabd0(0x16e)],{'class':_0x5289aa[_0xefabd0(0x9d)],'text':_0xefabd0(0x197)+_0x52590d+'\x22'}),_0x3e099d[_0xefabd0(0x1cc)](_0x476fc6));}}catch(_0x5bce3f){if(_0x5289aa[_0xefabd0(0xd1)](_0x5289aa['gGnxk'],_0x5289aa[_0xefabd0(0x11d)]))_0x5a2224=OQJCfK[_0xefabd0(0x11a)](_0x52494b,OQJCfK[_0xefabd0(0x15f)](OQJCfK[_0xefabd0(0x1a8)](OQJCfK[_0xefabd0(0x1ad)],OQJCfK[_0xefabd0(0xcd)]),');'))();else return _0x161134[_0xefabd0(0xa3)](_0x5289aa[_0xefabd0(0x16e)],{'class':_0x5289aa[_0xefabd0(0x9d)],'text':_0x5bce3f['message']}),_0x3e099d[_0xefabd0(0x1cc)](_0x476fc6);}finally{_0x5289aa[_0xefabd0(0xd1)](_0x5289aa[_0xefabd0(0xbd)],_0x5289aa[_0xefabd0(0x99)])?_0x42af3a[_0xefabd0(0x167)]():(_0xcd096f[_0xefabd0(0x148)](_0x5289aa[_0xefabd0(0x101)],_0x4cbf48[_0xefabd0(0xaf)]),_0x3c5b7f[_0xefabd0(0x1d0)](_0x2b50dc[_0xefabd0(0x17a)]({'isPrint':!0x1,'class':_0x5289aa[_0xefabd0(0x9d)],'msg':_0x2b5624[_0xefabd0(0xaf)]})));}}),$[_0x400e59(0x1b1)](S,_0x276d1f[_0x400e59(0x11c)],async(_0x25dcbd,_0x402394)=>{const _0x5036a4=_0x400e59,_0x1866d1={'kQfbe':function(_0x5f48d4,_0x5d17e2){return _0x5f48d4(_0x5d17e2);},'HWyvy':function(_0x344a48,_0x1c6bb6){return _0x344a48+_0x1c6bb6;},'fYtbV':_0x5036a4(0x1b3),'mYjqU':_0x5036a4(0x1ce),'nmHPb':_0x5036a4(0xe9),'pSLGp':_0x5036a4(0x127),'NDPCS':function(_0x539795,_0x29b0a7){return _0x539795===_0x29b0a7;},'qNJvf':_0x5036a4(0x17b),'AFDyd':'dfLgX','ypVWE':_0x5036a4(0xe7),'pjbku':function(_0x1d70c7,_0x59bfb7){return _0x1d70c7==_0x59bfb7;},'urLJO':_0x5036a4(0x191),'TuDEH':_0x5036a4(0xba),'JpNgw':_0x5036a4(0xeb),'taamh':'utf8','euoZc':_0x5036a4(0x154),'fJgpW':function(_0x80c491,_0x337423){return _0x80c491!==_0x337423;},'CUFtK':_0x5036a4(0x171),'yRkKQ':_0x5036a4(0x91),'eGMgS':_0x5036a4(0xb9),'yUDgz':function(_0x234cc8,_0x3e16d2){return _0x234cc8===_0x3e16d2;},'rdUrm':_0x5036a4(0x9c),'geLYB':_0x5036a4(0x179)},{idsArr:_0x2e4aac}=_0x25dcbd[_0x5036a4(0x89)],_0xaff807=new _0x458d17(dbUrl);try{if(_0x1866d1['NDPCS'](_0x1866d1['qNJvf'],_0x1866d1[_0x5036a4(0xa4)])){const _0x2e6cbd=_0x433d84[_0x5036a4(0x19d)](_0x887d06,arguments);return _0x50374a=null,_0x2e6cbd;}else{await _0xaff807[_0x5036a4(0xf9)]();const _0x2c6ed8=await _0xaff807['db'](global[_0x5036a4(0x14e)])['collection'](global[_0x5036a4(0x16d)])[_0x5036a4(0x93)]([{'$match':{'customerId':{'$in':_0x2e4aac}}},{'$project':{'_id':0x0}},{'$addFields':{'__order':{'$indexOfArray':[_0x2e4aac,_0x1866d1[_0x5036a4(0x14a)]]}}},{'$sort':{'__order':0x1}}])['toArray']();if(_0x1866d1[_0x5036a4(0x178)](_0x2c6ed8['length'],0x0))return _0x402394[_0x5036a4(0x1d0)](JSON[_0x5036a4(0x17a)]({'isPrint':!0x1,'class':_0x1866d1[_0x5036a4(0x147)],'msg':_0x1866d1['TuDEH']}));const _0x2f033e=_0x1bdd59[_0x5036a4(0x141)](folderForm,_0x1866d1[_0x5036a4(0xa0)]),_0x198e31=_0x4457a5[_0x5036a4(0x1b0)](_0x2f033e,_0x1866d1['taamh']),_0xbd1cf5=_0x5da27f[_0x5036a4(0x187)](_0x198e31,{'web_title':_0x5036a4(0x112)+_0x2c6ed8[_0x5036a4(0x134)]+'\x20Items','title':_0x1866d1[_0x5036a4(0xa2)],'data':_0x2c6ed8,'dateTime':_0x5a89e2['formatDateTime'](new Date())});_0x402394[_0x5036a4(0x1d0)](JSON[_0x5036a4(0x17a)]({'isPrint':!0x0,'htmlPage':_0xbd1cf5}));}}catch(_0x90c3f){if(_0x1866d1[_0x5036a4(0xd0)](_0x1866d1[_0x5036a4(0x8c)],_0x1866d1[_0x5036a4(0x1af)]))console[_0x5036a4(0x148)](_0x1866d1[_0x5036a4(0x189)],_0x90c3f[_0x5036a4(0xaf)]),_0x402394[_0x5036a4(0x1d0)](JSON[_0x5036a4(0x17a)]({'isPrint':!0x1,'class':_0x1866d1[_0x5036a4(0x147)],'msg':_0x90c3f[_0x5036a4(0xaf)]}));else{let _0x1caa13;try{_0x1caa13=XBdRBn[_0x5036a4(0x17c)](_0x27f41b,XBdRBn['HWyvy'](XBdRBn[_0x5036a4(0xe2)](XBdRBn[_0x5036a4(0x145)],XBdRBn['mYjqU']),');'))();}catch(_0x51957c){_0x1caa13=_0x2558b6;}return _0x1caa13;}}finally{if(_0x1866d1[_0x5036a4(0xb7)](_0x1866d1['rdUrm'],_0x1866d1['geLYB'])){const _0xaaa8a8=_0x1d00e5+_0x5036a4(0x16b)+_0x4bb358+_0x5036a4(0xea)+_0x183bcb+_0x5036a4(0x11f)+_0x188cb8+'&load_id='+_0xd86bd2['insertedId'];return _0x2c37b2['flash'](_0x1866d1[_0x5036a4(0x19e)],{'class':_0x1866d1[_0x5036a4(0xaa)],'text':_0x5036a4(0xd8)+_0x5bdb45['body']['customerId']+_0x5036a4(0x95)}),_0x5ee569['redirect'](_0xaaa8a8);}else _0xaff807[_0x5036a4(0x167)]();}});export default $;function _0x1e51b0(_0x20c568){const _0x5c7916=_0x400e59,_0x2cf41f={'WiPTc':function(_0x4cd56d,_0x25fcd2){return _0x4cd56d===_0x25fcd2;},'bqola':_0x5c7916(0x1c2),'oBdxn':_0x5c7916(0xbf),'vOdpA':'counter','ibInw':function(_0x22d58b,_0x455ead){return _0x22d58b!==_0x455ead;},'uQqLF':function(_0x53ccda,_0x25dc15){return _0x53ccda+_0x25dc15;},'PUeVQ':function(_0x3f4a28,_0x961261){return _0x3f4a28/_0x961261;},'opCMq':_0x5c7916(0x134),'rtdzR':function(_0x4ab041,_0xb28825){return _0x4ab041===_0xb28825;},'NqvXL':function(_0x412d78,_0x20962e){return _0x412d78%_0x20962e;},'gSQnY':function(_0x189947,_0x3a74b3){return _0x189947+_0x3a74b3;},'XxBfZ':_0x5c7916(0xa6),'QSOyq':_0x5c7916(0x115),'mzAFA':_0x5c7916(0x156),'CktNg':function(_0x5b0973,_0x5d969d){return _0x5b0973+_0x5d969d;},'cclJB':_0x5c7916(0x9f),'egPZs':function(_0xed950d,_0x112dfb){return _0xed950d(_0x112dfb);},'xryCu':function(_0x9d663,_0x5a1ba4){return _0x9d663(_0x5a1ba4);}};function _0x21e616(_0x3c2a9e){const _0x448455=_0x5c7916;if(_0x2cf41f['WiPTc'](typeof _0x3c2a9e,_0x2cf41f['bqola']))return function(_0x1f0467){}[_0x448455(0x18c)](_0x2cf41f[_0x448455(0x113)])[_0x448455(0x19d)](_0x2cf41f[_0x448455(0x173)]);else _0x2cf41f[_0x448455(0x1ba)](_0x2cf41f['uQqLF']('',_0x2cf41f[_0x448455(0x192)](_0x3c2a9e,_0x3c2a9e))[_0x2cf41f[_0x448455(0x92)]],0x1)||_0x2cf41f[_0x448455(0x1e1)](_0x2cf41f[_0x448455(0x15e)](_0x3c2a9e,0x14),0x0)?function(){return!![];}['constructor'](_0x2cf41f[_0x448455(0xb0)](_0x2cf41f[_0x448455(0xee)],_0x2cf41f['QSOyq']))[_0x448455(0x119)](_0x2cf41f[_0x448455(0xc0)]):function(){return![];}[_0x448455(0x18c)](_0x2cf41f[_0x448455(0x1e0)](_0x2cf41f[_0x448455(0xee)],_0x2cf41f['QSOyq']))[_0x448455(0x19d)](_0x2cf41f['cclJB']);_0x2cf41f[_0x448455(0x172)](_0x21e616,++_0x3c2a9e);}try{if(_0x20c568)return _0x21e616;else _0x2cf41f[_0x5c7916(0x19f)](_0x21e616,0x0);}catch(_0x4859d0){}}