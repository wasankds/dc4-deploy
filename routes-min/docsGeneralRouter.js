const _0x146f01=_0x5699;function _0x5699(_0x575c8a,_0x3f0782){const _0x223088=_0xcf59();return _0x5699=function(_0x2d75e0,_0x6a4db1){_0x2d75e0=_0x2d75e0-0xcc;let _0x3ba37=_0x223088[_0x2d75e0];return _0x3ba37;},_0x5699(_0x575c8a,_0x3f0782);}(function(_0x30630d,_0x1e93b6){const _0x3b90b8=_0x5699,_0x548ed1=_0x30630d();while(!![]){try{const _0x229167=-parseInt(_0x3b90b8(0xd5))/0x1*(parseInt(_0x3b90b8(0x209))/0x2)+-parseInt(_0x3b90b8(0xe6))/0x3*(parseInt(_0x3b90b8(0x240))/0x4)+-parseInt(_0x3b90b8(0x20f))/0x5*(parseInt(_0x3b90b8(0xdc))/0x6)+-parseInt(_0x3b90b8(0x1ef))/0x7+parseInt(_0x3b90b8(0x23b))/0x8+-parseInt(_0x3b90b8(0xce))/0x9+parseInt(_0x3b90b8(0x246))/0xa*(parseInt(_0x3b90b8(0x234))/0xb);if(_0x229167===_0x1e93b6)break;else _0x548ed1['push'](_0x548ed1['shift']());}catch(_0x21da64){_0x548ed1['push'](_0x548ed1['shift']());}}}(_0xcf59,0xf1337));const _0xa38b95=(function(){const _0x310822=_0x5699,_0x59aa02={'xALSs':_0x310822(0x14a),'wKtsk':_0x310822(0x172),'htXVk':function(_0x571ecb,_0x1620e4){return _0x571ecb===_0x1620e4;},'bnyXN':_0x310822(0x176),'glUkm':'ZEzUw','BfqIY':function(_0x54e0b2,_0x5e857a){return _0x54e0b2===_0x5e857a;},'vuySf':'rzRXP','yGIJV':function(_0x27b517,_0xa8289f){return _0x27b517+_0xa8289f;},'gkeef':_0x310822(0x24a),'luaIK':'gger','aqcFS':'stateObject','rAiIV':function(_0x4a1f5e,_0x117145){return _0x4a1f5e!==_0x117145;},'qcVWc':_0x310822(0x1c0)};let _0x4d4a76=!![];return function(_0x556630,_0x4b537f){const _0x3e6af6=_0x310822,_0x20028f={'btOIR':function(_0x22d3bb,_0x345863){const _0x36d035=_0x5699;return _0x59aa02[_0x36d035(0x1fe)](_0x22d3bb,_0x345863);},'uNdYS':_0x59aa02['gkeef'],'qXxwp':_0x59aa02[_0x3e6af6(0x243)],'hCNSr':_0x59aa02[_0x3e6af6(0x124)],'Dujes':_0x59aa02[_0x3e6af6(0x21f)]};if(_0x59aa02[_0x3e6af6(0x145)](_0x59aa02['qcVWc'],_0x59aa02[_0x3e6af6(0x24c)]))_0xe3fecb[_0x3e6af6(0x1fd)](_0x59aa02['xALSs'],_0x11af9f),_0xf2ce37['send'](_0x5b7995[_0x3e6af6(0xdf)]({'isPrint':!0x1,'class':_0x59aa02[_0x3e6af6(0x21f)],'msg':_0xa124b6['message']}));else{const _0x1e200d=_0x4d4a76?function(){const _0x2beaa4=_0x3e6af6;if(_0x59aa02[_0x2beaa4(0x197)](_0x59aa02[_0x2beaa4(0x1be)],_0x59aa02['glUkm']))(function(){return![];}['constructor'](_0x20028f[_0x2beaa4(0x161)](_0x20028f[_0x2beaa4(0x217)],_0x20028f['qXxwp']))[_0x2beaa4(0x1ec)](_0x20028f[_0x2beaa4(0x114)]));else{if(_0x4b537f){if(_0x59aa02[_0x2beaa4(0x21c)](_0x59aa02[_0x2beaa4(0xff)],_0x59aa02[_0x2beaa4(0xff)])){const _0x490471=_0x4b537f[_0x2beaa4(0x1ec)](_0x556630,arguments);return _0x4b537f=null,_0x490471;}else return _0x5eafc5[_0x2beaa4(0x1fd)](_0x2bd9de),_0x1e8a3d['send'](_0x53219f[_0x2beaa4(0xdf)]({'isSearch':!0x1,'class':_0x20028f[_0x2beaa4(0x152)],'msg':_0x4357ba['message']}));}}}:function(){};return _0x4d4a76=![],_0x1e200d;}};}());function _0xcf59(){const _0x2355f8=['mXHLV','sunIe','AqfcN','gYUxY','proposerId','/myDateTime.js','โหลดลายเซ็น\x20\x22','pdf','SYKDK','MOrTD','AYpWl','yaGDj','LpnaW','rAiIV','jRivk','PAGE_RECEIPT','vZaZr','kAxfy','error\x20===>\x20','/receipt','plFLa','pIDdv','stateObject','quotation_print.ejs','collection','{}.constructor(\x22return\x20this\x22)(\x20)','Dujes','zrGvA','application/pdf','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','UqUvy','bind','dbUrl','kcwCz','MxAaU','RPouU','/load','MwbSi','wUuwc','screenshot','sLEBv','btOIR','SLdFR','ohaAQ','gMdkU','while\x20(true)\x20{}','DaAxc','dbColl_settings_Receipt','xXgvp','join','vwSxO','ppNyc','VIrjS','zrYuj','map','CDGnj','-----------------','xrQCy','red','eCszG','/print','receipt_print.ejs','nJPyD','sXsVo','attachment;\x20filename=quotation-','zehQW','ejzjn','ujpMD','console','ZSlfN','DMwpP','docId','yYFtk','RkfkW','neRFM','uNaAv','call','prototype','/myDocs.js','hTRSk','__proto__','PbEBZ','RpqmB','HNRVk','getUser_sign','zsHsG','dbColl_quotation','xeDBZ','SIFxq','aCUtD','rWgtU','LGLUu','oYTsR','send','iwqQu','htXVk','zSXin','mWwua','XyJFx','close','cWQud','counter','pRYWN','Mfuqt','efiUU','eqyrJ','VeRTJ','dbColl_settings_Bill','tfnFX','IJiIP','getSettingsByCollection','yellow','userImageSignature_Src','maneK','fHfmn','rXLqy','cSbdN','LOGO_INVOICE_FILENAME','iRVfC','fVyFJ','jpeg','LPXNj','HykNd','ymwqR','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','image/jpeg','cSsCM','FJJKp','green','wbPAW','toString','proposerImageSign','/bill','XXjos','bnyXN','ixsGY','KDzKB','dbColl_bill','init','OuXMA','NqqmU','originalUrl','../','RccQE','uTEqe','cstLj','VgGpx','body','aHAFt','/invoice','MOzBR','yzQzB','gFJXR','wNYVF','/user/signature','tprTh','OjYJF','XQKmU','uKuoY','lZQvI','length','getItems_for_Modal','Lnuqq','AVmPd','post','tlUoX','vOZfB','getDate','VvFbx','ForLX','dbColl_invoice','dbColl_receipt','hqSKJ','gtXXe','NRyup','GupuO','findOne','function\x20*\x5c(\x20*\x5c)','getSessionData','GpRIl','apply','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','xHMAK','298417TjkEuu','vGIZf','SzZSw','get','peAZo','wpfcT','path','getCustomers_for_Modal','req.body\x20===>\x20','YlEIa','XMzNs','wHQjt','bWaFv','rRrJS','log','yGIJV','SJlFG','YrJGv','niXak','rzKms','puppeteer','gRuws','QPzQf','Tuabz','GDHOS','/myModule.js','6sLefUd','mhSpF','mnkgo','modifiedCount','PUpqv','fPrNy','67350inqqNs','.jpeg','acknowledged','epmZn','zRrmk','gger','rwhKD','tAQwi','uNdYS','mjKil','Uwnen','DWPLw','InmCy','BfqIY','XFheC','RaVPn','wKtsk','edKEj','ARykN','DicQl','wDkCk','Hbbau','\x22\x20เรียบร้อยแล้ว','connect','dbColl_settings_Invoice','KHZAn','FesBF','ไม่พบประวัติการเปลี่ยนแปลง','push','BVBdd','networkidle0','writeHead','cVmFb','EPQSo','return\x20(function()\x20','bXbZb','NWDEc','2398eFRIft','uUBcF','XVrDP','kVAhe','mqJop','EsJzW','PLAQZ','2134528bUPxBr','launch','DdWMQ','getSessionData_sign','KBccj','1460NWOHAP','/myUsers.js','Jfoal','luaIK','BQOAD','VNasI','268630JuQzJB','EyEgS','YzpKe','input','debu','/changes','qcVWc','uQFYr','KzVmD','14249898vSPgGV','ZOxcC','zplbm','cmoNL','Jcfyy','jMAku','vjLer','417066OoMALD','test','SpqhO','wCEoh','action','LOGO_BILL_FILENAME','updateOne','822ofWvYi','FMWAK','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','stringify','tGKln','AXLMW','exception','Rwplb','toArray','KhvfU','3390njHJfm','XuSZP','EPzWS','end','message','TbSEN','jKbKE','xTXDR','kWVHi','newPage','ไม่พบชื่อคอเล็กชั่น','xXmoa','renderView','juYcf','ไม่พบเอกสารเลขที่\x20\x22','finish','LAenR','CcmCu','Ueshz','FvnJk','hIWLu','isAuth','kpmRH','MhOUn','xJage','vuySf','dbName','replace','/fetch/modal','sOaMn','CeiNd','itWZH','SPhhA','/status','QsMCR','UbrwR','GSPzP','lxrcn','floor','bSXDC','PAGE_BILL','yUbfd','print','bnNcs','bSdpr','RFFRD','hCNSr','QTpYM','njYke','IhiXN','odUgy','RPzbC','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','iKgMD','jFIRK','GsXTa','dbColl_settings_Quotation','brjce','yKiKL','qHmzs','VcsyL','KkTPL','aqcFS','LOGO_RECEIPT_FILENAME','\x22ไม่สามารถเขียนข้อมูลลง\x20','Jkehw','split','getLogoBase64Src','PAGE_INVOICE','eatbN','Psssc','constructor','RYrkV','bill_print.ejs','พบ\x20\x22','lkVsf','dIzUW','includes','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','eHuao','Qbete','LMIIM'];_0xcf59=function(){return _0x2355f8;};return _0xcf59();}(function(){const _0x2437b2=_0x5699,_0x7931a4={'OuXMA':function(_0x4dd8d4,_0x187300){return _0x4dd8d4(_0x187300);},'cstLj':function(_0x1fb0b4,_0x479bc5){return _0x1fb0b4!==_0x479bc5;},'vwSxO':_0x2437b2(0x1ac),'ZSlfN':_0x2437b2(0xdd),'ScebA':'function\x20*\x5c(\x20*\x5c)','hqSKJ':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','sunIe':_0x2437b2(0x1c2),'Psssc':function(_0x2ab0b5,_0x580574){return _0x2ab0b5+_0x580574;},'bnNcs':'chain','LrzgB':function(_0xb7f727,_0x5e078){return _0xb7f727+_0x5e078;},'NBizR':_0x2437b2(0x249),'ffVXa':function(_0x597472,_0x1de532){return _0x597472!==_0x1de532;},'dIzUW':_0x2437b2(0x123),'YzpKe':function(_0x42fe1b,_0x1f876d){return _0x42fe1b(_0x1f876d);},'eHuao':_0x2437b2(0x238),'OKyPQ':_0x2437b2(0x228),'sZkZc':function(_0x36131c){return _0x36131c();},'Jcfyy':function(_0x2f7709,_0x26be92,_0x21b011){return _0x2f7709(_0x26be92,_0x21b011);}};_0x7931a4[_0x2437b2(0xd2)](_0xa38b95,this,function(){const _0xe91b12=_0x2437b2,_0x1e921c={'InmCy':function(_0xdc6bb5,_0x2b2b1c){const _0x5ad2c9=_0x5699;return _0x7931a4[_0x5ad2c9(0x1c3)](_0xdc6bb5,_0x2b2b1c);}};if(_0x7931a4[_0xe91b12(0x1c9)](_0x7931a4[_0xe91b12(0x16a)],_0x7931a4[_0xe91b12(0x17d)])){const _0x2aedf1=new RegExp(_0x7931a4['ScebA']),_0x12b800=new RegExp(_0x7931a4[_0xe91b12(0x1e4)],'i'),_0xc8dd5b=_0x7931a4[_0xe91b12(0x1c3)](_0x571102,_0x7931a4[_0xe91b12(0x139)]);if(!_0x2aedf1[_0xe91b12(0xd6)](_0x7931a4[_0xe91b12(0x12c)](_0xc8dd5b,_0x7931a4[_0xe91b12(0x111)]))||!_0x12b800[_0xe91b12(0xd6)](_0x7931a4['LrzgB'](_0xc8dd5b,_0x7931a4['NBizR']))){if(_0x7931a4['ffVXa'](_0x7931a4[_0xe91b12(0x132)],_0x7931a4[_0xe91b12(0x132)])){const _0x1b7c07=_0x21145b?function(){const _0x21692b=_0xe91b12;if(_0x3be021){const _0x1fe13d=_0x1fa00d[_0x21692b(0x1ec)](_0x448990,arguments);return _0x5d0d09=null,_0x1fe13d;}}:function(){};return _0x24b3ed=![],_0x1b7c07;}else _0x7931a4[_0xe91b12(0x248)](_0xc8dd5b,'0');}else{if(_0x7931a4['cstLj'](_0x7931a4[_0xe91b12(0x135)],_0x7931a4['OKyPQ']))_0x7931a4['sZkZc'](_0x571102);else return!![];}}else _0x1e921c[_0xe91b12(0x21b)](_0x1947ad,'0');})();}());const _0x6a4db1=(function(){const _0x5b5c68=_0x5699,_0x17bb6f={'cmoNL':_0x5b5c68(0x1e9),'mjKil':_0x5b5c68(0x1ed),'zplbm':function(_0x2fe566,_0x262837){return _0x2fe566(_0x262837);},'vGIZf':_0x5b5c68(0x1c2),'cVmFb':function(_0x29de75,_0x5cb5ca){return _0x29de75+_0x5cb5ca;},'iwqQu':'chain','YrJGv':_0x5b5c68(0x249),'FJJKp':function(_0x5046c){return _0x5046c();},'xrQCy':function(_0x246e46,_0x1866d1){return _0x246e46+_0x1866d1;},'mHQuS':function(_0x3e74c9,_0x5be6ca){return _0x3e74c9(_0x5be6ca);},'GkTlN':function(_0x38a454,_0xf1f1c9,_0x376340){return _0x38a454(_0xf1f1c9,_0x376340);},'yKytK':function(_0x1c1cc4,_0xcfe89f){return _0x1c1cc4!==_0xcfe89f;},'LMIIM':_0x5b5c68(0x1e0),'GupuO':_0x5b5c68(0x18b),'gFJXR':function(_0x570002,_0x18873d){return _0x570002===_0x18873d;},'XuSZP':_0x5b5c68(0xfc),'yfnYX':_0x5b5c68(0xe8),'juYcf':'Mqrba'};let _0xce51fe=!![];return function(_0x49af35,_0x16bfe6){const _0x3096e5=_0x5b5c68,_0x157461={'MOzBR':_0x17bb6f[_0x3096e5(0xd1)],'AqfcN':_0x17bb6f[_0x3096e5(0x218)],'SpqhO':function(_0x47d378,_0x306aa9){return _0x17bb6f['zplbm'](_0x47d378,_0x306aa9);},'vjLer':_0x17bb6f[_0x3096e5(0x1f0)],'kwNDM':function(_0x57a02f,_0x4a5360){const _0x3d7560=_0x3096e5;return _0x17bb6f[_0x3d7560(0x171)](_0x57a02f,_0x4a5360);},'RaVPn':_0x17bb6f[_0x3096e5(0x196)],'tGKln':function(_0x28b205,_0x83e8ff){const _0x3a2a02=_0x3096e5;return _0x17bb6f[_0x3a2a02(0x22f)](_0x28b205,_0x83e8ff);},'PUpqv':_0x17bb6f[_0x3096e5(0x200)],'yYFtk':function(_0x58ded2,_0x46bd14){return _0x17bb6f['mHQuS'](_0x58ded2,_0x46bd14);},'XVrDP':function(_0x489064){return _0x17bb6f['FJJKp'](_0x489064);},'SPhhA':function(_0x54c60e,_0x11baf5,_0x59e227){return _0x17bb6f['GkTlN'](_0x54c60e,_0x11baf5,_0x59e227);},'lxrcn':function(_0x513f89,_0x2e9c4f){return _0x17bb6f['yKytK'](_0x513f89,_0x2e9c4f);},'ujpMD':_0x17bb6f[_0x3096e5(0x137)],'jRivk':_0x17bb6f[_0x3096e5(0x1e7)],'cSsCM':function(_0x81d94f,_0x302cc1){const _0x38c462=_0x3096e5;return _0x17bb6f[_0x38c462(0x1d0)](_0x81d94f,_0x302cc1);},'TbSEN':_0x17bb6f[_0x3096e5(0xe7)]};if(_0x17bb6f[_0x3096e5(0x1d0)](_0x17bb6f['yfnYX'],_0x17bb6f[_0x3096e5(0xf3)])){const _0x516712=new _0x2a6c1d(_0x17bb6f['cmoNL']),_0x3ba2b0=new _0xa0e9f4(_0x17bb6f[_0x3096e5(0x218)],'i'),_0x3fa72d=_0x17bb6f['zplbm'](_0x187fef,_0x17bb6f['vGIZf']);!_0x516712[_0x3096e5(0xd6)](_0x17bb6f['cVmFb'](_0x3fa72d,_0x17bb6f['iwqQu']))||!_0x3ba2b0['test'](_0x17bb6f[_0x3096e5(0x22f)](_0x3fa72d,_0x17bb6f[_0x3096e5(0x200)]))?_0x17bb6f[_0x3096e5(0xd0)](_0x3fa72d,'0'):_0x17bb6f[_0x3096e5(0x1b7)](_0x1afde5);}else{const _0x17de89=_0xce51fe?function(){const _0x310084=_0x3096e5,_0x2b5537={'Rwplb':_0x157461[_0x310084(0x1ce)],'yUbfd':_0x157461[_0x310084(0x13a)],'QYYsK':function(_0xb8167b,_0x421511){const _0x1892bf=_0x310084;return _0x157461[_0x1892bf(0xd7)](_0xb8167b,_0x421511);},'Hbbau':_0x157461[_0x310084(0xd4)],'Mfuqt':function(_0x4a7fae,_0x359618){return _0x157461['kwNDM'](_0x4a7fae,_0x359618);},'kiSBZ':_0x157461[_0x310084(0x21e)],'efiUU':function(_0x5d0915,_0x45bbd7){const _0x1eb00c=_0x310084;return _0x157461[_0x1eb00c(0xe0)](_0x5d0915,_0x45bbd7);},'CDGnj':_0x157461[_0x310084(0x20d)],'RpqmB':function(_0x560e21,_0x2d9e34){const _0x21d7b7=_0x310084;return _0x157461[_0x21d7b7(0x180)](_0x560e21,_0x2d9e34);},'IJiIP':function(_0x48ccb3){const _0x3834ed=_0x310084;return _0x157461[_0x3834ed(0x236)](_0x48ccb3);},'ieWmt':function(_0x1a17bb,_0x3bf86a,_0x1fa251){const _0xf8058a=_0x310084;return _0x157461[_0xf8058a(0x106)](_0x1a17bb,_0x3bf86a,_0x1fa251);}};if(_0x157461[_0x310084(0x10b)](_0x157461[_0x310084(0x17b)],_0x157461[_0x310084(0x146)])){if(_0x16bfe6){if(_0x157461[_0x310084(0x1b6)](_0x157461[_0x310084(0xeb)],_0x157461['TbSEN'])){const _0x49de57=_0x16bfe6[_0x310084(0x1ec)](_0x49af35,arguments);return _0x16bfe6=null,_0x49de57;}else{const _0x330666={'DWPLw':_0x2b5537[_0x310084(0xe3)],'pIDdv':_0x2b5537[_0x310084(0x10f)],'jMAku':function(_0xe96da1,_0x219e67){return _0x2b5537['QYYsK'](_0xe96da1,_0x219e67);},'Qbete':_0x2b5537[_0x310084(0x224)],'UydKk':function(_0x54e05d,_0x340433){const _0x26ce7b=_0x310084;return _0x2b5537[_0x26ce7b(0x19f)](_0x54e05d,_0x340433);},'wUuwc':_0x2b5537['kiSBZ'],'vOZfB':function(_0x28032d,_0x34f62e){const _0x448f70=_0x310084;return _0x2b5537[_0x448f70(0x1a0)](_0x28032d,_0x34f62e);},'zrGvA':_0x2b5537[_0x310084(0x16f)],'rRrJS':function(_0x57e23f,_0x2cc923){const _0xc90c63=_0x310084;return _0x2b5537[_0xc90c63(0x18a)](_0x57e23f,_0x2cc923);},'eCszG':function(_0x5a465c){const _0x255ab6=_0x310084;return _0x2b5537[_0x255ab6(0x1a5)](_0x5a465c);}};_0x2b5537['ieWmt'](_0x5060ca,this,function(){const _0x1cd4b1=_0x310084,_0x4a98e2=new _0x579833(_0x330666[_0x1cd4b1(0x21a)]),_0x2a0140=new _0x265db1(_0x330666[_0x1cd4b1(0x14d)],'i'),_0x580101=_0x330666[_0x1cd4b1(0xd3)](_0x4dec57,_0x330666[_0x1cd4b1(0x136)]);!_0x4a98e2['test'](_0x330666['UydKk'](_0x580101,_0x330666[_0x1cd4b1(0x15e)]))||!_0x2a0140[_0x1cd4b1(0xd6)](_0x330666[_0x1cd4b1(0x1de)](_0x580101,_0x330666[_0x1cd4b1(0x153)]))?_0x330666[_0x1cd4b1(0x1fc)](_0x580101,'0'):_0x330666[_0x1cd4b1(0x173)](_0x15f47c);})();}}}else _0x27d524['close']();}:function(){};return _0xce51fe=![],_0x17de89;}};}()),_0x2d75e0=_0x6a4db1(this,function(){const _0x4146ba=_0x5699,_0x3f6b2f={'iRVfC':function(_0x33b631,_0x30fe47){return _0x33b631(_0x30fe47);},'mhSpF':function(_0x26d0a5,_0x10a6e4){return _0x26d0a5+_0x10a6e4;},'PbEBZ':'return\x20(function()\x20','njYke':_0x4146ba(0x151),'bSdpr':function(_0x11b092){return _0x11b092();},'MOrTD':_0x4146ba(0x1fd),'rwhKD':'warn','mWwua':'info','ppNyc':'error','Uwnen':_0x4146ba(0xe2),'gRuws':'table','uQFYr':'trace','xeDBZ':function(_0x4f4f6f,_0x428b9b){return _0x4f4f6f<_0x428b9b;},'ARykN':function(_0x4b9667,_0x3f8f52){return _0x4b9667(_0x3f8f52);},'plFLa':function(_0x5032ff,_0x24089c){return _0x5032ff(_0x24089c);},'bWaFv':function(_0x2b86b9,_0x5565b4){return _0x2b86b9!==_0x5565b4;},'EPQSo':_0x4146ba(0x1af),'maneK':function(_0x4139e8,_0x5cb045){return _0x4139e8(_0x5cb045);},'bzixh':function(_0x2a3f95,_0x4279c2){return _0x2a3f95+_0x4279c2;},'krwXO':function(_0x431342,_0xea9016){return _0x431342+_0xea9016;},'nnlbO':function(_0x2b3f12){return _0x2b3f12();},'OjYJF':_0x4146ba(0x18d),'brjce':_0x4146ba(0xcf),'KzVmD':function(_0x418676,_0x3524ae){return _0x418676<_0x3524ae;},'neRFM':_0x4146ba(0x149)};let _0x3868cd;try{if(_0x3f6b2f[_0x4146ba(0x1fb)](_0x3f6b2f[_0x4146ba(0x230)],_0x3f6b2f[_0x4146ba(0x230)])){let _0xab7add;try{const _0x2010fa=_0x3f6b2f[_0x4146ba(0x1ae)](_0x1b2896,_0x3f6b2f[_0x4146ba(0x20a)](_0x3f6b2f[_0x4146ba(0x20a)](_0x3f6b2f['PbEBZ'],_0x3f6b2f['njYke']),');'));_0xab7add=_0x3f6b2f[_0x4146ba(0x112)](_0x2010fa);}catch(_0x167481){_0xab7add=_0x14a1f7;}const _0x400613=_0xab7add['console']=_0xab7add[_0x4146ba(0x17c)]||{},_0x523edf=[_0x3f6b2f[_0x4146ba(0x141)],_0x3f6b2f['rwhKD'],_0x3f6b2f[_0x4146ba(0x199)],_0x3f6b2f[_0x4146ba(0x16b)],_0x3f6b2f[_0x4146ba(0x219)],_0x3f6b2f[_0x4146ba(0x204)],_0x3f6b2f[_0x4146ba(0xcc)]];for(let _0x474d8a=0x0;_0x3f6b2f[_0x4146ba(0x18f)](_0x474d8a,_0x523edf[_0x4146ba(0x1d8)]);_0x474d8a++){const _0x4e1389=_0xdcc5de['constructor'][_0x4146ba(0x185)][_0x4146ba(0x157)](_0x2c8329),_0x22e4d2=_0x523edf[_0x474d8a],_0x28ace2=_0x400613[_0x22e4d2]||_0x4e1389;_0x4e1389[_0x4146ba(0x188)]=_0xb24d5e[_0x4146ba(0x157)](_0x3364d7),_0x4e1389[_0x4146ba(0x1ba)]=_0x28ace2[_0x4146ba(0x1ba)]['bind'](_0x28ace2),_0x400613[_0x22e4d2]=_0x4e1389;}}else{const _0x44af2b=_0x3f6b2f[_0x4146ba(0x1a9)](Function,_0x3f6b2f['bzixh'](_0x3f6b2f['krwXO'](_0x3f6b2f[_0x4146ba(0x189)],_0x3f6b2f[_0x4146ba(0x116)]),');'));_0x3868cd=_0x3f6b2f['nnlbO'](_0x44af2b);}}catch(_0x1d2e21){if(_0x3f6b2f[_0x4146ba(0x1fb)](_0x3f6b2f[_0x4146ba(0x1d4)],_0x3f6b2f[_0x4146ba(0x11f)]))_0x3868cd=window;else{if(_0x14b66e)return _0x2156b8;else _0x3f6b2f[_0x4146ba(0x221)](_0x48e588,0x0);}}const _0x568915=_0x3868cd['console']=_0x3868cd['console']||{},_0x56daf2=[_0x3f6b2f['MOrTD'],_0x3f6b2f[_0x4146ba(0x215)],_0x3f6b2f[_0x4146ba(0x199)],_0x3f6b2f[_0x4146ba(0x16b)],_0x3f6b2f['Uwnen'],_0x3f6b2f['gRuws'],_0x3f6b2f[_0x4146ba(0xcc)]];for(let _0x4703f6=0x0;_0x3f6b2f[_0x4146ba(0xcd)](_0x4703f6,_0x56daf2[_0x4146ba(0x1d8)]);_0x4703f6++){if(_0x3f6b2f[_0x4146ba(0x1fb)](_0x3f6b2f[_0x4146ba(0x182)],_0x3f6b2f[_0x4146ba(0x182)]))_0x3f6b2f[_0x4146ba(0x14c)](_0x45c48b,0x0);else{const _0x1a188a=_0x6a4db1[_0x4146ba(0x12d)][_0x4146ba(0x185)]['bind'](_0x6a4db1),_0x55fdc8=_0x56daf2[_0x4703f6],_0x5e6e12=_0x568915[_0x55fdc8]||_0x1a188a;_0x1a188a['__proto__']=_0x6a4db1[_0x4146ba(0x157)](_0x6a4db1),_0x1a188a[_0x4146ba(0x1ba)]=_0x5e6e12[_0x4146ba(0x1ba)]['bind'](_0x5e6e12),_0x568915[_0x55fdc8]=_0x1a188a;}}});_0x2d75e0();import _0x53e590 from'express';const u=_0x53e590['Router']();import _0x1ac647 from'path';import{MongoClient as _0x441298}from'mongodb';import _0x4bd190 from'../middleware/mainAuth.js';import'luxon';const d=await import(_0x146f01(0x1c6)+mymoduleFolder+_0x146f01(0x208)),E=await import(_0x146f01(0x1c6)+mymoduleFolder+_0x146f01(0x13d)),f=await import(_0x146f01(0x1c6)+mymoduleFolder+_0x146f01(0x241)),C=await import(_0x146f01(0x1c6)+mymoduleFolder+_0x146f01(0x186)),j='/quotation',B=_0x146f01(0x1cd),M=_0x146f01(0x14b),G=_0x146f01(0x1bc),N=[j,B,M,G],w=N[_0x146f01(0x16e)](_0x11743e=>_0x11743e+_0x146f01(0x24b)),I=N[_0x146f01(0x16e)](_0x3dc9ed=>_0x3dc9ed+_0x146f01(0x174)),A=N[_0x146f01(0x16e)](_0x4d8850=>_0x4d8850+_0x146f01(0x107)),x=N[_0x146f01(0x16e)](_0x4786ba=>_0x4786ba+'/search'),V=N[_0x146f01(0x16e)](_0x5eb1eb=>_0x5eb1eb+_0x146f01(0x15c)),k=_0x146f01(0x102),F=_0x146f01(0x1d2);u['post'](x,_0x4bd190['isAuth'],async(_0x46557d,_0x1ea02f)=>{const _0x4758a5=_0x146f01,_0x460523={'DdWMQ':function(_0x518ed4,_0x4066b4){return _0x518ed4(_0x4066b4);},'aHAFt':_0x4758a5(0x1b8),'SzZSw':_0x4758a5(0x172),'RccQE':function(_0x2f9f82,_0x5c021f){return _0x2f9f82!==_0x5c021f;},'uTEqe':'TDJMA','CcmCu':function(_0x4940e8,_0x374dc9){return _0x4940e8===_0x374dc9;},'RXfqi':'jnJJN','hTRSk':'yqFiU','tlUoX':_0x4758a5(0x155),'yRyff':_0x4758a5(0x1b3),'xJage':_0x4758a5(0x1a1),'mnkgo':function(_0x541e43,_0x1f4300){return _0x541e43!==_0x1f4300;},'NqqmU':_0x4758a5(0x198)};let {sip:_0x2c21e1,statusNumberFilter:_0x1d1256,collName:_0x267778}=_0x46557d['body'];_0x2c21e1=_0x2c21e1[_0x4758a5(0x101)](/[!@#$%^&*<>]/g,'')??null,_0x1d1256&&(_0x1d1256=_0x1d1256[_0x4758a5(0x128)](',')[_0x4758a5(0x16e)](_0x5ddab8=>Number(_0x5ddab8)));let {userId:_0x2aa2ca,userAuthority:_0x12d78c}=f['getSessionData'](_0x46557d);_0x2aa2ca=_0x2aa2ca&&_0x460523['DdWMQ'](Number,_0x2aa2ca);const _0x5278a1=new _0x441298(global[_0x4758a5(0x158)]);try{if(_0x460523[_0x4758a5(0x1c7)](_0x460523['uTEqe'],_0x460523[_0x4758a5(0x1c8)])){let {userId:_0x35dc11}=_0x245da7['getSessionData'](_0x3638ac);_0x35dc11=_0x35dc11&&_0x460523[_0x4758a5(0x23d)](_0x1b6933,_0x35dc11);const _0x3d10e2=new _0x54cd19(_0x4b752d[_0x4758a5(0x158)]);try{const _0x37aeaf=_0x5c936a[_0x4758a5(0x23e)](_0x268ce5);return _0x5ee63d['send'](_0x35e01a[_0x4758a5(0xdf)]({..._0x37aeaf,'isLoad':!0x0,'class':_0x460523[_0x4758a5(0x1cc)],'msg':_0x4758a5(0x13e)+_0x35dc11+_0x4758a5(0x225)}));}catch(_0x374ae7){return _0x9f9bed[_0x4758a5(0x1fd)](_0x374ae7),_0x15af54[_0x4758a5(0x195)](_0x37c04a[_0x4758a5(0xdf)]({'isLoad':!0x1,'class':_0x460523['SzZSw'],'msg':_0x374ae7[_0x4758a5(0xea)]}));}finally{_0x3d10e2[_0x4758a5(0x19b)]();}}else{await _0x5278a1['connect']();const _0x5c6267=_0x5278a1['db'](global[_0x4758a5(0x100)])[_0x4758a5(0x150)](_0x267778);if(_0x2c21e1){if(_0x460523[_0x4758a5(0xf7)](_0x460523['RXfqi'],_0x460523[_0x4758a5(0x187)]))_0x37b5f2[_0x4758a5(0x1fd)](_0x54f707),_0x1a0d28[_0x4758a5(0x195)](_0x4cd99e[_0x4758a5(0xdf)]({'isStatus':!0x1,'class':_0x460523['SzZSw'],'msg':_0x495dcd[_0x4758a5(0xea)]}));else{var _0x13caf7=[{'$or':[{'docId':{'$regex':_0x2c21e1,'$options':'i'}},{'docDate':{'$regex':_0x2c21e1,'$options':'i'}},{'customerName':{'$regex':_0x2c21e1,'$options':'i'}}]}];['O','A']['includes'](_0x12d78c)||_0x13caf7[_0x4758a5(0x22b)]({'proposerId':_0x2aa2ca}),_0x1d1256&&_0x13caf7[_0x4758a5(0x22b)]({'docStatusNumber':{'$in':_0x1d1256}});var _0x2b16a8=await _0x5c6267['aggregate']([{'$match':{'$and':_0x13caf7}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])[_0x4758a5(0xe4)]();}}else var _0x2b16a8=[];let _0x3d8d63=_0x4758a5(0x130)+_0x2b16a8[_0x4758a5(0x1d8)]+'\x22\x20เอกสาร';return['O','A'][_0x4758a5(0x133)](_0x12d78c)||(_0x3d8d63+=_0x460523[_0x4758a5(0x1dd)]),_0x1ea02f[_0x4758a5(0x195)](JSON[_0x4758a5(0xdf)]({'searchFound':_0x2b16a8,'isSearch':!0x0,'class':_0x460523['aHAFt'],'msg':_0x3d8d63}));}}catch(_0x25ebeb){if(_0x460523[_0x4758a5(0x1c7)](_0x460523['yRyff'],_0x460523[_0x4758a5(0xfe)]))return console[_0x4758a5(0x1fd)](_0x25ebeb),_0x1ea02f['send'](JSON['stringify']({'isSearch':!0x1,'class':_0x460523[_0x4758a5(0x1f1)],'msg':_0x25ebeb['message']}));else{const _0x5b2e3e=_0x5daf8c['apply'](_0x171ba9,arguments);return _0x2a2f79=null,_0x5b2e3e;}}finally{if(_0x460523[_0x4758a5(0x20b)](_0x460523[_0x4758a5(0x1c4)],_0x460523[_0x4758a5(0x1c4)])){if(_0x59c83d){const _0x53a7d3=_0x33fbca['apply'](_0x5a14e4,arguments);return _0x1c0453=null,_0x53a7d3;}}else _0x5278a1['close']();}}),u[_0x146f01(0x1dc)](V,_0x4bd190[_0x146f01(0xfb)],async(_0x249ad3,_0x4bb27c)=>{const _0x48cdb4=_0x146f01,_0x17a171={'sOaMn':_0x48cdb4(0x172),'KGPRa':_0x48cdb4(0xf0),'KhvfU':function(_0x538719,_0x5d2fda){return _0x538719(_0x5d2fda);},'jKbKE':function(_0x141aee,_0x89e24a){return _0x141aee===_0x89e24a;},'DuUCN':_0x48cdb4(0x242),'STmhC':_0x48cdb4(0x223),'AYpWl':'green','YAEzp':function(_0x1a184f,_0x3058d0){return _0x1a184f!==_0x3058d0;},'UqUvy':_0x48cdb4(0x193),'wpfcT':_0x48cdb4(0x140)};let {docId:_0x1f4358,docTitle:_0x4be692,collName:_0x292cd8}=_0x249ad3[_0x48cdb4(0x1cb)];if(_0x292cd8||(_0x292cd8=C['getCollName_by_DocTitle'](_0x4be692)),!_0x292cd8)return _0x4bb27c[_0x48cdb4(0x195)](JSON[_0x48cdb4(0xdf)]({'isStatus':!0x1,'class':_0x17a171[_0x48cdb4(0x103)],'msg':_0x17a171['KGPRa']}));let {userId:_0x479ee3,userAuthority:_0x52dbaf}=f['getSessionData'](_0x249ad3);_0x479ee3=_0x479ee3&&_0x17a171[_0x48cdb4(0xe5)](Number,_0x479ee3);const _0x5814d2=new _0x441298(global[_0x48cdb4(0x158)]);try{if(_0x17a171[_0x48cdb4(0xec)](_0x17a171['DuUCN'],_0x17a171['STmhC']))return _0x3db29c[_0x48cdb4(0x1fd)](_0x51636a),_0x27e961['send'](_0x47cf77['stringify']({'isFetch':!0x1,'class':_0x17a171['sOaMn'],'msg':_0x2d6083['message']}));else{await _0x5814d2[_0x48cdb4(0x226)]();const _0x1d0fc3=_0x5814d2['db'](global[_0x48cdb4(0x100)])[_0x48cdb4(0x150)](_0x292cd8);let _0xa7249e={'docId':_0x1f4358};['O','A'][_0x48cdb4(0x133)](_0x52dbaf)||(_0xa7249e[_0x48cdb4(0x13c)]=_0x479ee3);var _0x432e41=await _0x1d0fc3[_0x48cdb4(0x1e8)](_0xa7249e,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x432e41?(_0x432e41[_0x48cdb4(0x1a8)]=f['getUser_sign'](_0x432e41['proposerId']),_0x4bb27c[_0x48cdb4(0x195)](JSON[_0x48cdb4(0xdf)]({'doc':_0x432e41,'isLoad':!0x0,'class':_0x17a171[_0x48cdb4(0x142)],'msg':'โหลดเอกสารเลขที่\x20\x22'+_0x1f4358+_0x48cdb4(0x225)}))):_0x4bb27c['send'](JSON[_0x48cdb4(0xdf)]({'isLoad':!0x1,'class':_0x17a171[_0x48cdb4(0x103)],'msg':_0x48cdb4(0xf4)+_0x1f4358+'\x22'}));}}catch(_0x59ac77){if(_0x17a171['YAEzp'](_0x17a171[_0x48cdb4(0x156)],_0x17a171[_0x48cdb4(0x156)])){const _0x58b9b0=_0x1c8267['apply'](_0x5bb9d8,arguments);return _0x4827a3=null,_0x58b9b0;}else return console[_0x48cdb4(0x1fd)](_0x59ac77),_0x4bb27c[_0x48cdb4(0x195)](JSON[_0x48cdb4(0xdf)]({'isLoad':!0x1,'class':_0x17a171[_0x48cdb4(0x103)],'msg':_0x59ac77['message']}));}finally{if(_0x17a171[_0x48cdb4(0xec)](_0x17a171['wpfcT'],_0x17a171[_0x48cdb4(0x1f4)]))_0x5814d2[_0x48cdb4(0x19b)]();else return _0x9753bd[_0x48cdb4(0x1fd)](_0x41ced0),_0x366ef3['send'](_0x5bc686['stringify']({'isLoad':!0x1,'class':_0x17a171[_0x48cdb4(0x103)],'msg':_0x2f0112[_0x48cdb4(0xea)]}));}}),u['get'](k,_0x4bd190['isAuth'],async(_0x47cdd6,_0x37a44a)=>{const _0x5d65f1=_0x146f01,_0x488d25={'fvTzq':function(_0x4a9164){return _0x4a9164();},'RkfkW':function(_0x3ff54b,_0x26dd14){return _0x3ff54b!==_0x26dd14;},'cWQud':_0x5d65f1(0x1f9),'NRyup':_0x5d65f1(0x1b8),'LAenR':_0x5d65f1(0x1b4),'FesBF':_0x5d65f1(0x1f8),'dogwp':'red'};try{if(_0x488d25['RkfkW'](_0x488d25[_0x5d65f1(0x19c)],_0x488d25[_0x5d65f1(0x19c)]))_0x59fbf3[_0x5d65f1(0x19b)]();else{const _0x5c6f24=await C[_0x5d65f1(0x1f6)](),_0x19380e=await C[_0x5d65f1(0x1d9)]();return _0x37a44a[_0x5d65f1(0x195)](JSON[_0x5d65f1(0xdf)]({'DATA_CUSTOMERS':_0x5c6f24,'DATA_ITEMS':_0x19380e,'isFetch':!0x0,'class':_0x488d25[_0x5d65f1(0x1e6)],'msg':_0x488d25[_0x5d65f1(0xf6)]}));}}catch(_0x4afa1){if(_0x488d25[_0x5d65f1(0x181)](_0x488d25[_0x5d65f1(0x229)],_0x488d25['FesBF']))BOwlPa['fvTzq'](_0x5ad066);else return console[_0x5d65f1(0x1fd)](_0x4afa1),_0x37a44a['send'](JSON['stringify']({'isFetch':!0x1,'class':_0x488d25['dogwp'],'msg':_0x4afa1['message']}));}}),u['post'](I,_0x4bd190[_0x146f01(0xfb)],async(_0x7fbe4b,_0x2ed781)=>{const _0x49e35c=_0x146f01,_0x158c3c={'sLEBv':_0x49e35c(0x14a),'rWgtU':_0x49e35c(0x172),'WSqBD':_0x49e35c(0x165),'tprTh':_0x49e35c(0x19d),'kWVHi':function(_0x248155,_0x2729b2){return _0x248155(_0x2729b2);},'ejzjn':function(_0x2e435e,_0x3fb909){return _0x2e435e+_0x3fb909;},'ohaAQ':_0x49e35c(0x231),'epmZn':_0x49e35c(0x151),'bFFUA':function(_0x268c73){return _0x268c73();},'bXbZb':_0x49e35c(0x1f7),'gYUxY':function(_0x60d24c,_0x550446){return _0x60d24c!==_0x550446;},'LPXNj':_0x49e35c(0x122),'hIWLu':function(_0x3572ab,_0x58802e){return _0x3572ab===_0x58802e;},'TGZbB':_0x49e35c(0x14f),'wNYVF':function(_0x265d7f,_0x3af8cf){return _0x265d7f===_0x3af8cf;},'RPouU':'invoice_print.ejs','PLAQZ':_0x49e35c(0x175),'jFIRK':function(_0x442d1d,_0x578828){return _0x442d1d===_0x578828;},'TPwaa':_0x49e35c(0x12f),'odUgy':function(_0xef4500,_0x2fc99f){return _0xef4500==_0x2fc99f;},'XXjos':_0x49e35c(0x110),'VmOEO':_0x49e35c(0x1b8),'niXak':function(_0x2c7094,_0x42b44f){return _0x2c7094==_0x42b44f;},'pRYWN':'image','lkVsf':'tsPls','XyJFx':_0x49e35c(0x203),'mXHLV':_0x49e35c(0x22d),'oYTsR':function(_0x1455c9,_0x526219){return _0x1455c9/_0x526219;},'MhOUn':function(_0x1cf06b,_0x46ec66){return _0x1cf06b*_0x46ec66;},'iBbJV':_0x49e35c(0x1b0),'iKgMD':_0x49e35c(0x1b5),'ixsGY':'pdf','kVAhe':'TjPsB','bSXDC':_0x49e35c(0x154),'peAZo':_0x49e35c(0x1d5),'TkhCA':_0x49e35c(0x144),'VAApz':_0x49e35c(0x148)};console[_0x49e35c(0x1fd)](_0x49e35c(0x170)+_0x7fbe4b[_0x49e35c(0x1c5)]+'------------------'),console[_0x49e35c(0x1fd)](_0x158c3c[_0x49e35c(0x232)],_0x7fbe4b[_0x49e35c(0x1cb)]);const {docId:_0x3cf922,action:_0x51ff16}=_0x7fbe4b['body'],_0x1369c3=new _0x441298(global[_0x49e35c(0x158)]);try{if(_0x158c3c[_0x49e35c(0x13b)](_0x158c3c[_0x49e35c(0x1b1)],_0x158c3c[_0x49e35c(0x1b1)]))_0x26d093['log'](_0x158c3c[_0x49e35c(0x160)],_0x4eb08f),_0x57a5b3[_0x49e35c(0x195)](_0x752ffa[_0x49e35c(0xdf)]({'isPrint':!0x1,'class':_0x158c3c[_0x49e35c(0x192)],'msg':_0x2700b0[_0x49e35c(0xea)]}));else{if(_0x158c3c[_0x49e35c(0xfa)](_0x7fbe4b[_0x49e35c(0x1f5)],I[0x0]))var _0x12d685=global['dbColl_quotation'],_0x5e965e=_0x158c3c['TGZbB'],_0x48c384=d[_0x49e35c(0x129)](global['LOGO_QUOTATION_FILENAME']),_0x402817=await d[_0x49e35c(0x1a6)](global[_0x49e35c(0x11e)]),_0x25b9db=global['PAGE_QUOTATION'];else{if(_0x158c3c[_0x49e35c(0x1d1)](_0x7fbe4b[_0x49e35c(0x1f5)],I[0x1]))var _0x12d685=global['dbColl_invoice'],_0x5e965e=_0x158c3c[_0x49e35c(0x15b)],_0x48c384=d[_0x49e35c(0x129)](global[_0x49e35c(0x1ad)]),_0x402817=await d[_0x49e35c(0x1a6)](global[_0x49e35c(0x227)]),_0x25b9db=global[_0x49e35c(0x12a)];else{if(_0x158c3c[_0x49e35c(0x1d1)](_0x7fbe4b['path'],I[0x2]))var _0x12d685=global[_0x49e35c(0x1e3)],_0x5e965e=_0x158c3c[_0x49e35c(0x23a)],_0x48c384=d[_0x49e35c(0x129)](global[_0x49e35c(0x125)]),_0x402817=await d[_0x49e35c(0x1a6)](global[_0x49e35c(0x167)]),_0x25b9db=global[_0x49e35c(0x147)];else{if(_0x158c3c[_0x49e35c(0x11c)](_0x7fbe4b[_0x49e35c(0x1f5)],I[0x3]))var _0x12d685=global[_0x49e35c(0x1c1)],_0x5e965e=_0x158c3c['TPwaa'],_0x48c384=d['getLogoBase64Src'](global[_0x49e35c(0xda)]),_0x402817=await d[_0x49e35c(0x1a6)](global[_0x49e35c(0x1a3)]),_0x25b9db=global[_0x49e35c(0x10e)];}}}await _0x1369c3[_0x49e35c(0x226)]();var _0x35c520=await _0x1369c3['db'](global['dbName'])['collection'](_0x12d685)[_0x49e35c(0x1e8)]({'docId':_0x3cf922});if(!_0x35c520)return _0x2ed781['send'](JSON[_0x49e35c(0xdf)]({'isLoad':!0x1,'class':_0x158c3c[_0x49e35c(0x192)],'msg':_0x49e35c(0xf4)+_0x3cf922+'\x22'}));_0x35c520[_0x49e35c(0x13c)]&&(_0x35c520[_0x49e35c(0x1bb)]=f[_0x49e35c(0x18c)](_0x35c520['proposerId']));const _0x1c03b4=f[_0x49e35c(0x1ea)](_0x7fbe4b),_0x55a250=C['convert_DocPrint'](_0x35c520),_0x417495=_0x1ac647['join'](folderViews,_0x5e965e),_0x11d37e=await d[_0x49e35c(0xf2)](_0x417495,_0x2ed781,{'title':_0x25b9db,'time':E[_0x49e35c(0x1df)](),..._0x1c03b4,'logoSrc_base64':_0x48c384,..._0x402817,'action':_0x51ff16,'doc':_0x55a250});if(_0x158c3c[_0x49e35c(0x118)](_0x51ff16,_0x158c3c[_0x49e35c(0x1bd)]))_0x2ed781[_0x49e35c(0x195)](JSON[_0x49e35c(0xdf)]({'isPrint':!0x0,'class':_0x158c3c['VmOEO'],'htmlPage':_0x11d37e}));else{if(_0x158c3c['niXak'](_0x51ff16,_0x158c3c[_0x49e35c(0x19e)])){if(_0x158c3c[_0x49e35c(0xfa)](_0x158c3c['lkVsf'],_0x158c3c[_0x49e35c(0x131)])){const _0x1516cf=await(await import(_0x158c3c[_0x49e35c(0x19a)]))[_0x49e35c(0x23c)](),_0x28519c=await _0x1516cf['newPage']();await _0x28519c['setContent'](_0x11d37e,{'waitUntil':_0x158c3c['mXHLV'],'timeout':0x2710}),await new Promise(_0x44e524=>setTimeout(_0x44e524,0x3e8));const _0x136f52=_0x158c3c[_0x49e35c(0x194)](29.7,2.54),_0x18c035=Math[_0x49e35c(0x10c)](_0x158c3c[_0x49e35c(0xfd)](_0x136f52,0x60));await _0x28519c['setViewport']({'width':0x320,'height':_0x18c035,'deviceScaleFactor':0x1});const _0x4c1295=await _0x28519c[_0x49e35c(0x15f)]({'type':_0x158c3c['iBbJV'],'fullPage':!0x0,'omitBackground':!0x1});await _0x1516cf[_0x49e35c(0x19b)]();const _0x289224=_0x35c520[_0x49e35c(0x17f)]['replace'](/\//g,'');_0x2ed781[_0x49e35c(0x22e)](0xc8,{'Content-Type':_0x158c3c[_0x49e35c(0x11b)],'Content-Disposition':_0x49e35c(0x178)+_0x289224+_0x49e35c(0x210),'Content-Length':_0x4c1295['length']}),_0x2ed781[_0x49e35c(0xe9)](_0x4c1295);}else return function(_0x3dff4e){}[_0x49e35c(0x12d)](xEzraE['WSqBD'])[_0x49e35c(0x1ec)](xEzraE[_0x49e35c(0x1d3)]);}else{if(_0x158c3c[_0x49e35c(0x201)](_0x51ff16,_0x158c3c[_0x49e35c(0x1bf)])){if(_0x158c3c[_0x49e35c(0x13b)](_0x158c3c[_0x49e35c(0x237)],_0x158c3c[_0x49e35c(0x237)])){if(_0x5d45a8){const _0x235cef=_0x1ec474[_0x49e35c(0x1ec)](_0x54e886,arguments);return _0x2f1b68=null,_0x235cef;}}else{const _0x3e9f40=await(await import(_0x158c3c['XyJFx']))['launch'](),_0x1cd697=await _0x3e9f40[_0x49e35c(0xef)]();await _0x1cd697['setContent'](_0x11d37e,{'waitUntil':_0x158c3c[_0x49e35c(0x138)],'timeout':0x2710}),await new Promise(_0xc4111e=>setTimeout(_0xc4111e,0x3e8));const _0x559350=await _0x1cd697[_0x49e35c(0x13f)]({'format':'A4','printBackground':!0x0});await _0x3e9f40[_0x49e35c(0x19b)]();const _0x229ead=_0x35c520['docId'][_0x49e35c(0x101)](/\//g,'');_0x2ed781[_0x49e35c(0x22e)](0xc8,{'Content-Type':_0x158c3c[_0x49e35c(0x10d)],'Content-Disposition':_0x49e35c(0x178)+_0x229ead+'.pdf','Content-Length':_0x559350[_0x49e35c(0x1d8)]}),_0x2ed781[_0x49e35c(0xe9)](_0x559350);}}}}}}catch(_0xcb8dc6){_0x158c3c[_0x49e35c(0x13b)](_0x158c3c[_0x49e35c(0x1f3)],_0x158c3c['TkhCA'])?(console['log'](_0x158c3c[_0x49e35c(0x160)],_0xcb8dc6),_0x2ed781[_0x49e35c(0x195)](JSON[_0x49e35c(0xdf)]({'isPrint':!0x1,'class':_0x158c3c[_0x49e35c(0x192)],'msg':_0xcb8dc6['message']}))):_0x399440[_0x49e35c(0x19b)]();}finally{if(_0x158c3c[_0x49e35c(0x13b)](_0x158c3c['VAApz'],_0x158c3c['VAApz'])){const _0xbb8a97=xEzraE[_0x49e35c(0xee)](_0x4fa3c5,xEzraE[_0x49e35c(0x17a)](xEzraE[_0x49e35c(0x17a)](xEzraE[_0x49e35c(0x163)],xEzraE[_0x49e35c(0x212)]),');'));_0x36a1cb=xEzraE['bFFUA'](_0xbb8a97);}else _0x1369c3['close']();}}),u['post'](w,_0x4bd190[_0x146f01(0xfb)],async(_0x5e77e3,_0x378761)=>{const _0x5b1ac4=_0x146f01,_0x7b821b={'KBoTP':_0x5b1ac4(0x1b8),'BQOAD':function(_0x5603b6,_0x48f494){return _0x5603b6===_0x48f494;},'VNasI':function(_0x59c3c2,_0xd64d8d){return _0x59c3c2===_0xd64d8d;},'uUBcF':function(_0x3a29cf,_0xac2f9){return _0x3a29cf===_0xac2f9;},'rzKms':function(_0x2b4f6b,_0xef2c69){return _0x2b4f6b!==_0xef2c69;},'VIrjS':_0x5b1ac4(0x109),'fHfmn':_0x5b1ac4(0x172),'wbPAW':function(_0x1fc38a,_0x3180c5){return _0x1fc38a<_0x3180c5;},'uNPat':'yellow','xXgvp':_0x5b1ac4(0x22a),'RYrkV':'doc_changes.ejs','aCUtD':_0x5b1ac4(0x17e),'zehQW':_0x5b1ac4(0x20e),'eatbN':'error\x20===>\x20','sXsVo':function(_0x2a7053,_0x134c52){return _0x2a7053!==_0x134c52;},'KBccj':_0x5b1ac4(0x1d6)},{docId:_0x3b6152}=_0x5e77e3[_0x5b1ac4(0x1cb)];if(_0x7b821b[_0x5b1ac4(0x244)](_0x5e77e3['path'],w[0x0]))var _0x53adae=global[_0x5b1ac4(0x18e)];else{if(_0x7b821b[_0x5b1ac4(0x245)](_0x5e77e3['path'],w[0x1]))var _0x53adae=global[_0x5b1ac4(0x1e2)];else{if(_0x7b821b[_0x5b1ac4(0x235)](_0x5e77e3['path'],w[0x2]))var _0x53adae=global[_0x5b1ac4(0x1e3)];else{if(_0x7b821b[_0x5b1ac4(0x244)](_0x5e77e3[_0x5b1ac4(0x1f5)],w[0x3]))var _0x53adae=global[_0x5b1ac4(0x1c1)];}}}const _0x25c897=new _0x441298(global[_0x5b1ac4(0x158)]);try{if(_0x7b821b[_0x5b1ac4(0x202)](_0x7b821b['VIrjS'],_0x7b821b[_0x5b1ac4(0x16c)]))return _0x3b66d2;else{await _0x25c897['connect']();var _0x5c574e=await _0x25c897['db'](global[_0x5b1ac4(0x100)])[_0x5b1ac4(0x150)](_0x53adae)[_0x5b1ac4(0x1e8)]({'docId':_0x3b6152});if(!_0x5c574e)return _0x378761[_0x5b1ac4(0x195)](JSON['stringify']({'isPrint':!0x1,'class':_0x7b821b[_0x5b1ac4(0x1aa)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x3b6152+'\x22'}));const _0x16a271=_0x5c574e['changesHistory']||[];if(_0x7b821b[_0x5b1ac4(0x1b9)](_0x16a271[_0x5b1ac4(0x1d8)],0x1))return _0x378761[_0x5b1ac4(0x195)](JSON['stringify']({'isPrint':!0x1,'class':_0x7b821b['uNPat'],'msg':_0x7b821b[_0x5b1ac4(0x168)]}));const _0x380a37=_0x1ac647[_0x5b1ac4(0x169)](folderViews,_0x7b821b[_0x5b1ac4(0x12e)]),_0x2298e5=await d[_0x5b1ac4(0xf2)](_0x380a37,_0x378761,{'title':_0x5c574e[_0x5b1ac4(0x17f)],'time':E[_0x5b1ac4(0x1df)](),'changesHistory':_0x16a271});_0x378761[_0x5b1ac4(0x195)](JSON[_0x5b1ac4(0xdf)]({'isPrint':!0x0,'class':_0x7b821b['KBoTP'],'htmlPage':_0x2298e5}));}}catch(_0x13be8e){if(_0x7b821b[_0x5b1ac4(0x244)](_0x7b821b[_0x5b1ac4(0x191)],_0x7b821b[_0x5b1ac4(0x179)])){const _0x40ae44=_0x34ceca['getSessionData_sign'](_0x4ab504);return _0x3db9a8[_0x5b1ac4(0x195)](_0x471a3a[_0x5b1ac4(0xdf)]({..._0x40ae44,'isLoad':!0x0,'class':_0x7b821b['KBoTP'],'msg':_0x5b1ac4(0x13e)+_0x200c1e+'\x22\x20เรียบร้อยแล้ว'}));}else console['log'](_0x7b821b[_0x5b1ac4(0x12b)],_0x13be8e),_0x378761[_0x5b1ac4(0x195)](JSON['stringify']({'isPrint':!0x1,'class':_0x7b821b[_0x5b1ac4(0x1aa)],'msg':_0x13be8e[_0x5b1ac4(0xea)]}));}finally{if(_0x7b821b[_0x5b1ac4(0x177)](_0x7b821b['KBccj'],_0x7b821b[_0x5b1ac4(0x23f)])){const _0x230efc=_0x4254e8[_0x5b1ac4(0x12d)][_0x5b1ac4(0x185)]['bind'](_0x30b115),_0x366676=_0x4b9726[_0x26c573],_0x5c768f=_0x141abc[_0x366676]||_0x230efc;_0x230efc['__proto__']=_0x27b540[_0x5b1ac4(0x157)](_0x4427a5),_0x230efc['toString']=_0x5c768f[_0x5b1ac4(0x1ba)]['bind'](_0x5c768f),_0x1c91a8[_0x366676]=_0x230efc;}else _0x25c897['close']();}}),u[_0x146f01(0x1f2)](F,_0x4bd190['isAuth'],async(_0x54a605,_0x47b9db)=>{const _0x1213fa=_0x146f01,_0x1fdef7={'QsMCR':function(_0x2c09dd,_0xd7e2b1){return _0x2c09dd(_0xd7e2b1);},'NWDEc':function(_0x1c0256,_0xdd6160){return _0x1c0256!==_0xdd6160;},'MwbSi':_0x1213fa(0xed),'zrYuj':_0x1213fa(0x159),'EyEgS':_0x1213fa(0x1b8),'DicQl':function(_0xfe9b15,_0x2d288d){return _0xfe9b15!==_0x2d288d;},'xXmoa':_0x1213fa(0x10a),'SLdFR':_0x1213fa(0x172),'wCEoh':_0x1213fa(0x1ca)};let {userId:_0x16b6a8}=f[_0x1213fa(0x1ea)](_0x54a605);_0x16b6a8=_0x16b6a8&&_0x1fdef7[_0x1213fa(0x108)](Number,_0x16b6a8);const _0x5b8a29=new _0x441298(global[_0x1213fa(0x158)]);try{if(_0x1fdef7[_0x1213fa(0x233)](_0x1fdef7[_0x1213fa(0x15d)],_0x1fdef7[_0x1213fa(0x16d)])){const _0x5bd09c=f['getSessionData_sign'](_0x54a605);return _0x47b9db[_0x1213fa(0x195)](JSON['stringify']({..._0x5bd09c,'isLoad':!0x0,'class':_0x1fdef7[_0x1213fa(0x247)],'msg':_0x1213fa(0x13e)+_0x16b6a8+_0x1213fa(0x225)}));}else _0x446f2b=_0x1d0e1a;}catch(_0x3f560a){return _0x1fdef7[_0x1213fa(0x222)](_0x1fdef7[_0x1213fa(0xf1)],_0x1fdef7[_0x1213fa(0xf1)])?![]:(console['log'](_0x3f560a),_0x47b9db[_0x1213fa(0x195)](JSON['stringify']({'isLoad':!0x1,'class':_0x1fdef7[_0x1213fa(0x162)],'msg':_0x3f560a[_0x1213fa(0xea)]})));}finally{if(_0x1fdef7[_0x1213fa(0x233)](_0x1fdef7[_0x1213fa(0xd8)],_0x1fdef7[_0x1213fa(0xd8)])){const _0xa54e7b=_0x500451?function(){if(_0x2690fa){const _0x554122=_0x4ec934['apply'](_0xcb4fb5,arguments);return _0x5ad78f=null,_0x554122;}}:function(){};return _0x5d6e8b=![],_0xa54e7b;}else _0x5b8a29[_0x1213fa(0x19b)]();}}),u[_0x146f01(0x1dc)](A,_0x4bd190[_0x146f01(0xfb)],async(_0x56237b,_0x2e0861)=>{const _0xd33e5f=_0x146f01,_0x41848b={'RPzbC':_0xd33e5f(0x172),'QPzQf':function(_0x2c71d0,_0x169541){return _0x2c71d0+_0x169541;},'tfnFX':'debu','QTpYM':_0xd33e5f(0x214),'zRrmk':_0xd33e5f(0xd9),'HykNd':function(_0x55eefe,_0x59f8cd){return _0x55eefe!==_0x59f8cd;},'edKEj':_0xd33e5f(0x117),'yKiKL':function(_0x40e5cb,_0x1bfa02){return _0x40e5cb===_0x1bfa02;},'VeRTJ':function(_0x4c8cf6,_0x1cf15d){return _0x4c8cf6===_0x1cf15d;},'Ueshz':_0xd33e5f(0xf5),'Lnuqq':'cancel','EsJzW':_0xd33e5f(0x134),'ForLX':function(_0x405907,_0x9d0170){return _0x405907(_0x9d0170);},'Jkehw':function(_0x380a31,_0x6f9993){return _0x380a31(_0x6f9993);},'lZQvI':function(_0x4e84ba,_0x48941a){return _0x4e84ba==_0x48941a;},'gMdkU':_0xd33e5f(0x11a),'QGLyg':function(_0x29fac1,_0x274a50){return _0x29fac1==_0x274a50;},'AKSEo':function(_0x50a01e,_0x31dd9b){return _0x50a01e!==_0x31dd9b;},'wHQjt':_0xd33e5f(0xde),'gtsUj':function(_0x5e82f4,_0x360d02){return _0x5e82f4>_0x360d02;},'gtXXe':_0xd33e5f(0x1b8),'Ncxko':function(_0x24b532,_0xd39e24){return _0x24b532<_0xd39e24;},'itWZH':_0xd33e5f(0x1a7),'CeiNd':_0xd33e5f(0x1cf),'FvnJk':function(_0x416158,_0x5e279c){return _0x416158===_0x5e279c;},'Tuabz':_0xd33e5f(0x1db),'BUySS':'ScuoJ'},_0x4b865d=new _0x441298(global[_0xd33e5f(0x158)]);try{if(_0x41848b[_0xd33e5f(0x1b2)](_0x41848b[_0xd33e5f(0x220)],_0x41848b[_0xd33e5f(0x220)]))return _0x10964e[_0xd33e5f(0x1fd)](_0xb43903),_0x13ce9e[_0xd33e5f(0x195)](_0x52e104['stringify']({'isLoad':!0x1,'class':_0x41848b[_0xd33e5f(0x119)],'msg':_0x5b4e42['message']}));else{if(_0x41848b[_0xd33e5f(0x120)](_0x56237b[_0xd33e5f(0x1f5)],A[0x0]))var _0x55e0c5=global[_0xd33e5f(0x18e)];else{if(_0x41848b[_0xd33e5f(0x1a2)](_0x56237b[_0xd33e5f(0x1f5)],A[0x1]))var _0x55e0c5=global[_0xd33e5f(0x1e2)];else{if(_0x41848b['VeRTJ'](_0x56237b[_0xd33e5f(0x1f5)],A[0x2]))var _0x55e0c5=global[_0xd33e5f(0x1e3)];else{if(_0x41848b[_0xd33e5f(0x120)](_0x56237b[_0xd33e5f(0x1f5)],A[0x3]))var _0x55e0c5=global[_0xd33e5f(0x1c1)];}}}let {docStatusNumber:_0x433b8d,docId:_0x62551,action:_0x3749b8,text:_0x39036a}=_0x56237b[_0xd33e5f(0x1cb)];if(!_0x62551||![_0x41848b[_0xd33e5f(0xf8)],_0x41848b[_0xd33e5f(0x1da)]][_0xd33e5f(0x133)](_0x3749b8))return _0x2e0861[_0xd33e5f(0x195)](JSON[_0xd33e5f(0xdf)]({'isStatus':!0x1,'class':_0x41848b[_0xd33e5f(0x119)],'msg':_0x41848b[_0xd33e5f(0x239)]}));_0x433b8d=_0x433b8d&&_0x41848b[_0xd33e5f(0x1e1)](Number,_0x433b8d);let {userId:_0x3a74bf}=f[_0xd33e5f(0x1ea)](_0x56237b);if(_0x3a74bf=_0x3a74bf&&_0x41848b[_0xd33e5f(0x127)](Number,_0x3a74bf),_0x41848b[_0xd33e5f(0x1d7)](_0x3749b8,_0x41848b['Lnuqq'])&&['1','2',0x1,0x2][_0xd33e5f(0x133)](_0x433b8d))return _0x2e0861['send'](JSON[_0xd33e5f(0xdf)]({'isStatus':!0x1,'class':_0x41848b[_0xd33e5f(0x119)],'msg':_0x41848b[_0xd33e5f(0x164)]}));if(_0x41848b['QGLyg'](_0x3749b8,_0x41848b['Ueshz'])&&_0x41848b['AKSEo'](_0x433b8d,0x1))return _0x2e0861[_0xd33e5f(0x195)](JSON['stringify']({'isStatus':!0x1,'class':_0x41848b['RPzbC'],'msg':_0x41848b[_0xd33e5f(0x1fa)]}));const _0x52a415=_0x4b865d['db'](global[_0xd33e5f(0x100)])['collection'](_0x55e0c5);if(!await _0x52a415[_0xd33e5f(0x1e8)]({'docId':_0x62551,'proposerId':_0x3a74bf}))return _0x2e0861['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x41848b[_0xd33e5f(0x119)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x62551+'\x22'}));const _0x1df393=_0x41848b['lZQvI'](_0x3749b8,_0x41848b[_0xd33e5f(0xf8)])?0x2:0xa,_0x5e8e79=await _0x52a415[_0xd33e5f(0xdb)]({'docId':_0x62551,'proposerId':_0x3a74bf},{'$set':{'docStatusNumber':_0x1df393}});if(_0x41848b['gtsUj'](_0x5e8e79[_0xd33e5f(0x20c)],0x0))return _0x2e0861[_0xd33e5f(0x195)](JSON['stringify']({'isStatus':!0x0,'docId':_0x62551,'docStatusNumber':_0x1df393,'class':_0x41848b[_0xd33e5f(0x1e5)],'msg':_0x39036a+'\x20\x22'+_0x62551+_0xd33e5f(0x225)}));if(_0x5e8e79[_0xd33e5f(0x211)]&&_0x41848b['Ncxko'](_0x5e8e79[_0xd33e5f(0x20c)],0x1))return _0x2e0861[_0xd33e5f(0x195)](JSON[_0xd33e5f(0xdf)]({'isStatus':!0x1,'docId':_0x62551,'docStatusNumber':_0x433b8d,'class':_0x41848b[_0xd33e5f(0x105)],'msg':_0xd33e5f(0x126)+_0x62551+'\x22'}));}}catch(_0x45d0a8){_0x41848b['HykNd'](_0x41848b[_0xd33e5f(0x104)],_0x41848b[_0xd33e5f(0x104)])?_0x59ca99['close']():(console[_0xd33e5f(0x1fd)](_0x45d0a8),_0x2e0861[_0xd33e5f(0x195)](JSON[_0xd33e5f(0xdf)]({'isStatus':!0x1,'class':_0x41848b[_0xd33e5f(0x119)],'msg':_0x45d0a8['message']})));}finally{_0x41848b[_0xd33e5f(0xf9)](_0x41848b[_0xd33e5f(0x206)],_0x41848b['BUySS'])?function(){return!![];}['constructor'](rRJCSY[_0xd33e5f(0x205)](rRJCSY[_0xd33e5f(0x1a4)],rRJCSY[_0xd33e5f(0x115)]))[_0xd33e5f(0x184)](rRJCSY[_0xd33e5f(0x213)]):_0x4b865d['close']();}});export default u;function _0x571102(_0x2e7ee3){const _0x37b40f=_0x146f01,_0x5b93e2={'SJlFG':function(_0x400ce8,_0x139604){return _0x400ce8!==_0x139604;},'gitPy':_0x37b40f(0x183),'DaAxc':function(_0x37506d,_0x3a00aa){return _0x37506d===_0x3a00aa;},'yaGDj':'string','AXLMW':'cXnlH','uRIbu':_0x37b40f(0x207),'SIFxq':_0x37b40f(0x165),'BVBdd':'counter','tAQwi':function(_0x550d55,_0x2cea76){return _0x550d55!==_0x2cea76;},'oqGqm':function(_0x17371e,_0x53001d){return _0x17371e+_0x53001d;},'MxAaU':function(_0x30faf8,_0x496083){return _0x30faf8/_0x496083;},'dMkWN':'length','BRhzM':function(_0x13ce9b,_0xf40a21){return _0x13ce9b===_0xf40a21;},'GpRIl':function(_0x4f5f86,_0xf3f4f6){return _0x4f5f86%_0xf3f4f6;},'xHMAK':function(_0x25f80d,_0x591d8f){return _0x25f80d+_0x591d8f;},'RFFRD':_0x37b40f(0x24a),'XFheC':_0x37b40f(0x214),'tRzpI':'action','rXLqy':_0x37b40f(0x14e),'GsXTa':function(_0x2ff293,_0x1b7af2){return _0x2ff293(_0x1b7af2);}};function _0x38dec3(_0x3e61b2){const _0x7e7322=_0x37b40f,_0x18773e={'BzdkE':function(_0x47918e,_0x5a79ca){const _0x57f28e=_0x5699;return _0x5b93e2[_0x57f28e(0x1ff)](_0x47918e,_0x5a79ca);},'qHmzs':_0x5b93e2['gitPy']};if(_0x5b93e2[_0x7e7322(0x166)](typeof _0x3e61b2,_0x5b93e2[_0x7e7322(0x143)])){if(_0x5b93e2['DaAxc'](_0x5b93e2[_0x7e7322(0xe1)],_0x5b93e2['uRIbu']))_0xf2d178[_0x7e7322(0x19b)]();else return function(_0x2ff21b){}['constructor'](_0x5b93e2[_0x7e7322(0x190)])[_0x7e7322(0x1ec)](_0x5b93e2[_0x7e7322(0x22c)]);}else _0x5b93e2[_0x7e7322(0x216)](_0x5b93e2['oqGqm']('',_0x5b93e2[_0x7e7322(0x15a)](_0x3e61b2,_0x3e61b2))[_0x5b93e2['dMkWN']],0x1)||_0x5b93e2['BRhzM'](_0x5b93e2[_0x7e7322(0x1eb)](_0x3e61b2,0x14),0x0)?function(){const _0xb5e78b=_0x7e7322;if(_0x18773e['BzdkE'](_0x18773e[_0xb5e78b(0x121)],_0x18773e[_0xb5e78b(0x121)]))_0x30e1ac['close']();else return!![];}[_0x7e7322(0x12d)](_0x5b93e2[_0x7e7322(0x1ee)](_0x5b93e2['RFFRD'],_0x5b93e2[_0x7e7322(0x21d)]))[_0x7e7322(0x184)](_0x5b93e2['tRzpI']):function(){return![];}[_0x7e7322(0x12d)](_0x5b93e2[_0x7e7322(0x1ee)](_0x5b93e2[_0x7e7322(0x113)],_0x5b93e2['XFheC']))[_0x7e7322(0x1ec)](_0x5b93e2[_0x7e7322(0x1ab)]);_0x5b93e2[_0x7e7322(0x11d)](_0x38dec3,++_0x3e61b2);}try{if(_0x2e7ee3)return _0x38dec3;else _0x5b93e2[_0x37b40f(0x11d)](_0x38dec3,0x0);}catch(_0x43dfd3){}}