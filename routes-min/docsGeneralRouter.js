const _0x36f968=_0x561d;(function(_0x3e8a32,_0x5907ed){const _0x2fd7d1=_0x561d,_0x3ced06=_0x3e8a32();while(!![]){try{const _0x4ef1f1=-parseInt(_0x2fd7d1(0x112))/0x1*(parseInt(_0x2fd7d1(0xd8))/0x2)+-parseInt(_0x2fd7d1(0x1ac))/0x3+parseInt(_0x2fd7d1(0x19d))/0x4+parseInt(_0x2fd7d1(0x72))/0x5*(parseInt(_0x2fd7d1(0x16d))/0x6)+-parseInt(_0x2fd7d1(0x196))/0x7+-parseInt(_0x2fd7d1(0x8d))/0x8+-parseInt(_0x2fd7d1(0xc8))/0x9*(-parseInt(_0x2fd7d1(0x143))/0xa);if(_0x4ef1f1===_0x5907ed)break;else _0x3ced06['push'](_0x3ced06['shift']());}catch(_0x5cfbe4){_0x3ced06['push'](_0x3ced06['shift']());}}}(_0x32ac,0x8df4d));function _0x32ac(){const _0x3bc1f2=['GLWqa','nskVq','stateObject','XhSAn','getUser_sign','acknowledged','JFsCo','yXgSK','OjKYa','wbFZd','bind','qDnLa','debu','getItems_for_Modal','CuLnL','post','test','QPKSc','finish','UgoQM','GfOtF','tLNyQ','GoBJY','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','MgeUX','416705OBUHjC','lupsk','MXcSI','ridCJ','chVpv','qfIbl','yRMCL','dbColl_bill','get','dbUrl','getLogoBase64Src','VlhSI','Ghzsj','โหลดลายเซ็น\x20\x22','BqNEU','dbColl_settings_Receipt','LOGO_INVOICE_FILENAME','ffmtI','\x22\x20เรียบร้อยแล้ว','wtNKd','Router','------------------','JVluV','OWkYc','TMVwB','split','duNFI','4881056piJudY','MLzBQ','constructor','gdclR','{}.constructor(\x22return\x20this\x22)(\x20)','KVXcI','dbColl_settings_Bill','red','exception','eXycZ','counter','LCNKX','stringify','application/pdf','zDcYO','input','LzPdg','OHjKj','UrPmE','IPIQG','PAGE_QUOTATION','aggregate','ZksJJ','req.body\x20===>\x20','ICWEC','zhuOt','โหลดเอกสารเลขที่\x20\x22','/myUsers.js','isAuth','EkGSO','dOMnw','hMSDb','puppeteer','kcHIy','WUmBf','igrdV','/myModule.js','QzGsV','KLJFw','dTYqT','kdHGO','image/jpeg','yOOnt','invoice_print.ejs','YOaAn','FZDfB','print','TXLUo','fULLH','ไม่พบชื่อคอเล็กชั่น','LOGO_QUOTATION_FILENAME','jpeg','includes','map','/changes','qCrwv','/print','laaZf','yellow','279kWxlWa','fUCsR','bRwSN','nvtBH','DDkIn','EWMIp','RIlnn','jZDjY','findOne','พบ\x20\x22','collection','ABuRv','bill_print.ejs','ไม่พบเอกสารเลขที่\x20\x22','QRQtL','bLyFq','1338KYoLrY','yntYx','mpGQI','/myDateTime.js','DeCcH','IDCGz','HrMKM','xUMbj','LOGO_BILL_FILENAME','hBFYD','XZAov','xqyQs','join','EGgzg','YGkye','AMbyz','toString','dbColl_settings_Quotation','CAvYx','/load','console','aOjwd','return\x20(function()\x20','MnqyP','xkXZe','eRQRL','mFJCi','bOjOh','EaqKR','Niwoo','ZnpJD','MQSuF','GphqD','gger','jSUdU','HNTpp','BfKUV','kvYeK','newPage','lOhTd','tgbxU','dbColl_settings_Invoice','HAKpP','/search','aRrHb','getSessionData','PWhtS','dbColl_quotation','BaxOU','setContent','/quotation','proposerImageSign','YNOBF','screenshot','hoGxC','bKJzO','bkydx','IXgLu','1681RielyK','proposerId','FWndw','EESmz','originalUrl','BDfKC','ไม่พบประวัติการเปลี่ยนแปลง','orSbN','getSessionData_sign','beiSb','yGish','vuniW','aXxHi','push','okdsn','trewa','trace','message','SIvcE','hEaLB','zIPpA','../','MQTdk','FdDkg','BpnrN','JDkMM','wcAar','uCSsB','vAIeC','hnXYz','rpyFj','kWIzI','ไม่พบเอกสาร\x20\x22','writeHead','XEtIH','ZBgca','YtjFc','JwAqh','jTZEn','renderView','YWpYL','cUYMr','floor','vmZzC','FtjiU','hEppQ','vmOEe','nRYqx','ZoXIq','925360bpmMCR','LOGO_RECEIPT_FILENAME','kfcJS','KQRjr','aySus','ETxlh','jFiGi','dPCgV','tPevG','NZEKr','.pdf','AWUNF','vVTzg','uRNIB','EFENf','KuMhk','Pxdbu','-----------------','qRtGf','hCiyX','uFiPb','wMAGp','RWgXc','peDkB','PAGE_INVOICE','ahTUf','QeTjz','PuivP','hwFUp','TljfQ','YXaiN','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','UdJXF','call','mYfXl','cvcdr','hXqCl','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','pJhWC','hnBqB','sABjq','BpZMx','36CflWuU','error\x20===>\x20','getSettingsByCollection','action','toArray','attachment;\x20filename=quotation-','zCDjg','dbColl_receipt','mFeSB','NKBaJ','green','connect','rTXMe','/fetch/modal','RoZmD','bDYQj','docId','while\x20(true)\x20{}','getDate','cuWcq','RtaXC','\x22ไม่สามารถเขียนข้อมูลลง\x20','GOnMw','woxIe','odGso','OlZdK','close','fgRWH','awEpU','XsUYT','replace','mQXis','vPGpO','lBSEV','chain','convert_DocPrint','XDDod','path','KDQzh','modifiedCount','/bill','6710844oSpvgN','send','nkoSl','ARbNj','pdf','table','vPAAk','4037300KxUsyH','aqHfX','VBFrg','setViewport','LzdaK','MtMZH','nAdEs','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','JbULb','bRVkN','zooFt','uXFtD','__proto__','dbName','/user/signature','3309363QIsAWq','info','rzfRu','apply','wqmbc','length','hdGWr','log','xEipp','xOAuH','rmGOZ','end','qAsOV','updateOne','function\x20*\x5c(\x20*\x5c)','MYvwX','body','EShhr','fDXwe','IPRQF','string','init','/invoice','FeXZZ','qCCGD','prototype','gEFCn','BvrYb','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','OVKRS','cwueH','QnHds','NbeEU','.jpeg','XzgiJ','dbColl_invoice','NbKzX','MJpbR','\x22\x20เอกสาร','TCeis','iIRIt','dSIAq','JipCy'];_0x32ac=function(){return _0x3bc1f2;};return _0x32ac();}const _0x485b4d=(function(){const _0x1b7e54=_0x561d,_0x413fcb={'fgRWH':_0x1b7e54(0x17e),'EGgzg':_0x1b7e54(0x97),'LzdaK':function(_0x2fd4bf,_0x3d337a){return _0x2fd4bf(_0x3d337a);},'QRQtL':_0x1b7e54(0x177),'XBoKE':_0x1b7e54(0x94),'MLZTZ':function(_0x50d17f,_0x45dbd7){return _0x50d17f===_0x45dbd7;},'BpZMx':_0x1b7e54(0x12c),'chVpv':_0x1b7e54(0x115),'wbFZd':function(_0x566589,_0x13e4dd){return _0x566589!==_0x13e4dd;},'HAKpP':_0x1b7e54(0x165),'JKBVv':function(_0x116c88,_0x1e6e07){return _0x116c88!==_0x1e6e07;},'gdclR':'yoFJr'};let _0x4a37d8=!![];return function(_0x2a92c8,_0x2f7f70){const _0x248f9e=_0x1b7e54,_0x195e89={'KQRjr':function(_0x11ea6b,_0x4c9416){const _0x3e91b7=_0x561d;return _0x413fcb[_0x3e91b7(0x1a1)](_0x11ea6b,_0x4c9416);},'HINJX':_0x413fcb[_0x248f9e(0xd6)],'GOnMw':_0x413fcb['XBoKE'],'MZpHj':function(_0x3a57b6,_0xb263a1){return _0x413fcb['MLZTZ'](_0x3a57b6,_0xb263a1);},'ntdHN':_0x413fcb[_0x248f9e(0x16c)],'fUCsR':_0x413fcb[_0x248f9e(0x76)],'nRYqx':function(_0x37ba39,_0x303265){const _0x11521c=_0x248f9e;return _0x413fcb[_0x11521c(0x1e0)](_0x37ba39,_0x303265);},'LzPdg':_0x413fcb[_0x248f9e(0x102)]};if(_0x413fcb['JKBVv'](_0x413fcb[_0x248f9e(0x90)],_0x413fcb[_0x248f9e(0x90)]))return function(_0x407f12){}['constructor'](_0x413fcb[_0x248f9e(0x188)])[_0x248f9e(0x1af)](_0x413fcb[_0x248f9e(0xe5)]);else{const _0xc3a3fd=_0x4a37d8?function(){const _0x37e5e7=_0x248f9e,_0x298dd6={'wqmbc':function(_0xdbf5ca,_0x4ab54a){const _0x4da816=_0x561d;return _0x195e89[_0x4da816(0x146)](_0xdbf5ca,_0x4ab54a);},'bKJzO':_0x195e89['HINJX'],'hEppQ':_0x195e89[_0x37e5e7(0x183)]};if(_0x195e89['MZpHj'](_0x195e89['ntdHN'],_0x195e89[_0x37e5e7(0xc9)]))_0x195e89[_0x37e5e7(0x146)](_0x554d11,0x0);else{if(_0x2f7f70){if(_0x195e89[_0x37e5e7(0x141)](_0x195e89[_0x37e5e7(0x9d)],_0x195e89[_0x37e5e7(0x9d)])){let {userId:_0x32dfe2}=_0x5b47b0[_0x37e5e7(0x105)](_0x5ab8cc);_0x32dfe2=_0x32dfe2&&_0x298dd6[_0x37e5e7(0x1b0)](_0x515b90,_0x32dfe2);const _0x625668=new _0x3dde0a(_0x31b962[_0x37e5e7(0x7b)]);try{const _0x45e265=_0x16b6ab['getSessionData_sign'](_0x34db59);return _0x12fb8f[_0x37e5e7(0x197)](_0x535bcd[_0x37e5e7(0x99)]({..._0x45e265,'isLoad':!0x0,'class':_0x298dd6[_0x37e5e7(0x10f)],'msg':_0x37e5e7(0x7f)+_0x32dfe2+_0x37e5e7(0x84)}));}catch(_0x4576d3){return _0x1a0e30[_0x37e5e7(0x1b3)](_0x4576d3),_0x176536['send'](_0x355b07['stringify']({'isLoad':!0x1,'class':_0x298dd6[_0x37e5e7(0x13f)],'msg':_0x4576d3[_0x37e5e7(0x123)]}));}finally{_0x625668[_0x37e5e7(0x187)]();}}else{const _0x5e8b18=_0x2f7f70[_0x37e5e7(0x1af)](_0x2a92c8,arguments);return _0x2f7f70=null,_0x5e8b18;}}}}:function(){};return _0x4a37d8=![],_0xc3a3fd;}};}());(function(){const _0x200903=_0x561d,_0x4333a0={'nkoSl':_0x200903(0x94),'rpyFj':function(_0x4238cc,_0x2c58b3){return _0x4238cc===_0x2c58b3;},'tgbxU':_0x200903(0xf1),'KVXcI':_0x200903(0x6e),'nvtBH':_0x200903(0x1ba),'GoBJY':_0x200903(0x162),'aqHfX':function(_0x1322b1,_0x53f688){return _0x1322b1(_0x53f688);},'Ghzsj':_0x200903(0x1c1),'GMmhk':function(_0x123342,_0x27da76){return _0x123342+_0x27da76;},'IDCGz':_0x200903(0x18f),'mFJCi':_0x200903(0x9c),'MgeUX':function(_0x2b0a64,_0x59a6ab){return _0x2b0a64===_0x59a6ab;},'dOMnw':_0x200903(0xfb),'JwAqh':function(_0x52d9f6,_0x1e0aa3){return _0x52d9f6(_0x1e0aa3);},'dTYqT':_0x200903(0x19c),'XzgiJ':function(_0x4bee0e){return _0x4bee0e();},'KDQzh':function(_0x2df5c0,_0x14a211,_0x82a70a){return _0x2df5c0(_0x14a211,_0x82a70a);}};_0x4333a0[_0x200903(0x193)](_0x485b4d,this,function(){const _0x39709f=_0x200903,_0x40c172={'peDkB':_0x4333a0[_0x39709f(0x198)]};if(_0x4333a0[_0x39709f(0x130)](_0x4333a0[_0x39709f(0x100)],_0x4333a0[_0x39709f(0x92)]))_0x47b313[_0x39709f(0x187)]();else{const _0x455716=new RegExp(_0x4333a0[_0x39709f(0xcb)]),_0x495bbe=new RegExp(_0x4333a0[_0x39709f(0x6f)],'i'),_0x23c268=_0x4333a0[_0x39709f(0x19e)](_0x2dd899,_0x4333a0[_0x39709f(0x7e)]);if(!_0x455716[_0x39709f(0x69)](_0x4333a0['GMmhk'](_0x23c268,_0x4333a0[_0x39709f(0xdd)]))||!_0x495bbe[_0x39709f(0x69)](_0x4333a0['GMmhk'](_0x23c268,_0x4333a0[_0x39709f(0xf2)])))_0x4333a0[_0x39709f(0x71)](_0x4333a0[_0x39709f(0xab)],_0x4333a0[_0x39709f(0xab)])?_0x4333a0[_0x39709f(0x137)](_0x23c268,'0'):_0x15a49d[_0x39709f(0x187)]();else{if(_0x4333a0[_0x39709f(0x130)](_0x4333a0[_0x39709f(0xb4)],_0x4333a0[_0x39709f(0xb4)]))_0x4333a0[_0x39709f(0x1ce)](_0x2dd899);else return _0x9bce48[_0x39709f(0x1b3)](_0x1c0006),_0xbec3f5[_0x39709f(0x197)](_0x27e197[_0x39709f(0x99)]({'isFetch':!0x1,'class':_0x40c172[_0x39709f(0x15a)],'msg':_0x2eabb6[_0x39709f(0x123)]}));}}})();}());const _0x48ca82=(function(){const _0x25defc=_0x561d,_0x203889={'fxCcG':function(_0x5fa1de,_0x383a0e){return _0x5fa1de===_0x383a0e;},'NbeEU':_0x25defc(0xb5),'hMSDb':'NSZVa','GLWqa':_0x25defc(0x104),'riQPm':'AAENt','aNxYP':function(_0x4155af,_0xa19457){return _0x4155af!==_0xa19457;},'cvcdr':_0x25defc(0x159)};let _0x1322dd=!![];return function(_0x332ced,_0x1b2ffe){const _0x90cbcc=_0x25defc;if(_0x203889['aNxYP'](_0x203889[_0x90cbcc(0x166)],_0x203889[_0x90cbcc(0x166)])){const _0x181491=_0x23a0b0[_0x90cbcc(0x1af)](_0x8639de,arguments);return _0x120508=null,_0x181491;}else{const _0x1c08fc=_0x1322dd?function(){const _0x1a066d=_0x90cbcc;if(_0x203889['fxCcG'](_0x203889[_0x1a066d(0x1cc)],_0x203889[_0x1a066d(0xac)]))_0xc40cb1['close']();else{if(_0x1b2ffe){if(_0x203889['fxCcG'](_0x203889[_0x1a066d(0x1d7)],_0x203889['riQPm']))return _0x4d1c71;else{const _0x542762=_0x1b2ffe[_0x1a066d(0x1af)](_0x332ced,arguments);return _0x1b2ffe=null,_0x542762;}}}}:function(){};return _0x1322dd=![],_0x1c08fc;}};}()),_0x2f4919=_0x48ca82(this,function(){const _0x442310=_0x561d,_0x2cf052={'yOOnt':function(_0x289790,_0x49b5e3){return _0x289790(_0x49b5e3);},'rPyFj':'red','MYvwX':function(_0x33de5d,_0x552596){return _0x33de5d!==_0x552596;},'yGish':'CuSdL','lupsk':function(_0x341b89,_0x3d232a){return _0x341b89===_0x3d232a;},'PNYXf':'ewMRr','rTXMe':function(_0x272a1b,_0x5d113e){return _0x272a1b+_0x5d113e;},'YGkye':function(_0x3e5003,_0xcf0600){return _0x3e5003+_0xcf0600;},'mpGQI':_0x442310(0xee),'JbULb':_0x442310(0x91),'vJiPC':_0x442310(0xf0),'zIPpA':function(_0x52bc29){return _0x52bc29();},'uXFtD':'log','qCCGD':'warn','rEsHd':_0x442310(0x1ad),'jloxu':'error','odGso':_0x442310(0x95),'gEFCn':_0x442310(0x19b),'xEipp':_0x442310(0x122),'KJbQN':function(_0x46f0ae,_0x465b91){return _0x46f0ae<_0x465b91;},'ahTUf':_0x442310(0xcc),'jSUdU':_0x442310(0x106)},_0x24f007=function(){const _0x4c8708=_0x442310,_0x76901c={'JVluV':_0x2cf052['rPyFj']};if(_0x2cf052[_0x4c8708(0x1bb)](_0x2cf052[_0x4c8708(0x11c)],_0x2cf052['yGish'])){if(_0x459dc0)return _0xc6024a;else _0x2cf052[_0x4c8708(0xb7)](_0x3d0ca8,0x0);}else{let _0x4cc904;try{if(_0x2cf052[_0x4c8708(0x73)](_0x2cf052['PNYXf'],_0x2cf052['PNYXf']))_0x4cc904=_0x2cf052[_0x4c8708(0xb7)](Function,_0x2cf052[_0x4c8708(0x179)](_0x2cf052[_0x4c8708(0xe6)](_0x2cf052[_0x4c8708(0xda)],_0x2cf052[_0x4c8708(0x1a5)]),');'))();else return _0x493ae0[_0x4c8708(0x1b3)](_0x4410fc),_0x279d46[_0x4c8708(0x197)](_0xed9e5d[_0x4c8708(0x99)]({'isSearch':!0x1,'class':_0x76901c[_0x4c8708(0x88)],'msg':_0x78e9be[_0x4c8708(0x123)]}));}catch(_0x379117){if(_0x2cf052[_0x4c8708(0x1bb)](_0x2cf052['vJiPC'],_0x2cf052['vJiPC'])){const _0x33dfd6=_0x16c52c[_0x4c8708(0x1af)](_0x1649f3,arguments);return _0x564d76=null,_0x33dfd6;}else _0x4cc904=window;}return _0x4cc904;}},_0x25073e=_0x2cf052[_0x442310(0x126)](_0x24f007),_0x353f85=_0x25073e['console']=_0x25073e[_0x442310(0xec)]||{},_0x150f17=[_0x2cf052[_0x442310(0x1a8)],_0x2cf052[_0x442310(0x1c4)],_0x2cf052['rEsHd'],_0x2cf052['jloxu'],_0x2cf052[_0x442310(0x185)],_0x2cf052[_0x442310(0x1c6)],_0x2cf052[_0x442310(0x1b4)]];for(let _0x27f9e4=0x0;_0x2cf052['KJbQN'](_0x27f9e4,_0x150f17[_0x442310(0x1b1)]);_0x27f9e4++){if(_0x2cf052[_0x442310(0x73)](_0x2cf052[_0x442310(0x15c)],_0x2cf052[_0x442310(0xfa)]))return!![];else{const _0x441cd6=_0x48ca82[_0x442310(0x8f)][_0x442310(0x1c5)][_0x442310(0x1e1)](_0x48ca82),_0x2d8467=_0x150f17[_0x27f9e4],_0x3ba17f=_0x353f85[_0x2d8467]||_0x441cd6;_0x441cd6[_0x442310(0x1a9)]=_0x48ca82[_0x442310(0x1e1)](_0x48ca82),_0x441cd6[_0x442310(0xe8)]=_0x3ba17f['toString']['bind'](_0x3ba17f),_0x353f85[_0x2d8467]=_0x441cd6;}}});_0x2f4919();import _0x55c3d9 from'express';const u=_0x55c3d9[_0x36f968(0x86)]();import _0x8dd9c from'path';import{MongoClient as _0xecdad4}from'mongodb';import _0x47e8ba from'../middleware/mainAuth.js';import'luxon';const d=await import(_0x36f968(0x127)+mymoduleFolder+_0x36f968(0xb1)),E=await import(_0x36f968(0x127)+mymoduleFolder+_0x36f968(0xdb)),f=await import('../'+mymoduleFolder+_0x36f968(0xa8)),C=await import(_0x36f968(0x127)+mymoduleFolder+'/myDocs.js'),j=_0x36f968(0x10a),B=_0x36f968(0x1c2),M='/receipt',G=_0x36f968(0x195),N=[j,B,M,G],w=N[_0x36f968(0xc2)](_0xf901aa=>_0xf901aa+_0x36f968(0xc3)),I=N[_0x36f968(0xc2)](_0x223fc2=>_0x223fc2+_0x36f968(0xc5)),A=N['map'](_0x5c74f4=>_0x5c74f4+'/status'),x=N[_0x36f968(0xc2)](_0x2ac5bf=>_0x2ac5bf+_0x36f968(0x103)),V=N[_0x36f968(0xc2)](_0x1e9ae3=>_0x1e9ae3+_0x36f968(0xeb)),k=_0x36f968(0x17a),F=_0x36f968(0x1ab);u['post'](x,_0x47e8ba[_0x36f968(0xa9)],async(_0x10dc62,_0x1e8541)=>{const _0x16fe28=_0x36f968,_0x17e13e={'pJhWC':function(_0x3500c6,_0x225811){return _0x3500c6(_0x225811);},'vmZzC':function(_0x5d2282,_0x2fb3fa){return _0x5d2282+_0x2fb3fa;},'QLVtb':function(_0x263441,_0x9ae56e){return _0x263441+_0x9ae56e;},'bDYQj':_0x16fe28(0xee),'MtMZH':_0x16fe28(0x91),'nAdEs':function(_0x4bd027,_0x373e65){return _0x4bd027(_0x373e65);},'FZDfB':function(_0x4a4576,_0xe3abb3){return _0x4a4576+_0xe3abb3;},'vuniW':function(_0x15ee3e,_0x5400eb){return _0x15ee3e!==_0x5400eb;},'igrdV':'YOXWg','bkydx':_0x16fe28(0x1b8),'mFeSB':_0x16fe28(0x135),'Niwoo':_0x16fe28(0x18a),'ARbNj':_0x16fe28(0x1c8),'RtaXC':_0x16fe28(0x177),'okdsn':function(_0x352b2a,_0x3f20ca){return _0x352b2a===_0x3f20ca;},'zDcYO':_0x16fe28(0x11b),'aOjwd':_0x16fe28(0x94),'GdyMe':_0x16fe28(0xbd),'MXcSI':'VWUKb'};let {sip:_0x97cbcd,statusNumberFilter:_0x4153d9,collName:_0x1b5a13}=_0x10dc62[_0x16fe28(0x1bc)];_0x97cbcd=_0x97cbcd[_0x16fe28(0x18b)](/[!@#$%^&*<>]/g,'')??null,_0x4153d9&&(_0x4153d9=_0x4153d9[_0x16fe28(0x8b)](',')[_0x16fe28(0xc2)](_0x1462a3=>Number(_0x1462a3)));let {userId:_0x42d2c2,userAuthority:_0x5aa922}=f[_0x16fe28(0x105)](_0x10dc62);_0x42d2c2=_0x42d2c2&&_0x17e13e[_0x16fe28(0x169)](Number,_0x42d2c2);const _0x2cf7a4=new _0xecdad4(global['dbUrl']);try{if(_0x17e13e[_0x16fe28(0x11d)](_0x17e13e[_0x16fe28(0xb0)],_0x17e13e[_0x16fe28(0x110)])){await _0x2cf7a4[_0x16fe28(0x178)]();const _0x2a0085=_0x2cf7a4['db'](global[_0x16fe28(0x1aa)])['collection'](_0x1b5a13);if(_0x97cbcd){if(_0x17e13e['vuniW'](_0x17e13e[_0x16fe28(0x175)],_0x17e13e[_0x16fe28(0xf5)])){var _0x3ae9e5=[{'$or':[{'docId':{'$regex':_0x97cbcd,'$options':'i'}},{'docDate':{'$regex':_0x97cbcd,'$options':'i'}},{'customerName':{'$regex':_0x97cbcd,'$options':'i'}}]}];['O','A'][_0x16fe28(0xc1)](_0x5aa922)||_0x3ae9e5[_0x16fe28(0x11f)]({'proposerId':_0x42d2c2}),_0x4153d9&&_0x3ae9e5[_0x16fe28(0x11f)]({'docStatusNumber':{'$in':_0x4153d9}});var _0xebe51f=await _0x2a0085[_0x16fe28(0xa2)]([{'$match':{'$and':_0x3ae9e5}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])[_0x16fe28(0x171)]();}else _0x25c582[_0x16fe28(0x187)]();}else var _0xebe51f=[];let _0x1028ec=_0x16fe28(0xd1)+_0xebe51f[_0x16fe28(0x1b1)]+_0x16fe28(0x1d2);return['O','A'][_0x16fe28(0xc1)](_0x5aa922)||(_0x1028ec+=_0x17e13e[_0x16fe28(0x199)]),_0x1e8541[_0x16fe28(0x197)](JSON[_0x16fe28(0x99)]({'searchFound':_0xebe51f,'isSearch':!0x0,'class':_0x17e13e[_0x16fe28(0x181)],'msg':_0x1028ec}));}else{let _0x2fcaa7;try{_0x2fcaa7=TfjMCH[_0x16fe28(0x169)](_0x2f60a9,TfjMCH[_0x16fe28(0x13d)](TfjMCH['QLVtb'](TfjMCH[_0x16fe28(0x17c)],TfjMCH[_0x16fe28(0x1a2)]),');'))();}catch(_0x57baae){_0x2fcaa7=_0x477308;}return _0x2fcaa7;}}catch(_0x39d350){if(_0x17e13e[_0x16fe28(0x120)](_0x17e13e[_0x16fe28(0x9b)],_0x17e13e[_0x16fe28(0x9b)]))return console['log'](_0x39d350),_0x1e8541[_0x16fe28(0x197)](JSON[_0x16fe28(0x99)]({'isSearch':!0x1,'class':_0x17e13e[_0x16fe28(0xed)],'msg':_0x39d350[_0x16fe28(0x123)]}));else _0x5b22f7=TfjMCH[_0x16fe28(0x1a3)](_0x4ce238,TfjMCH[_0x16fe28(0x13d)](TfjMCH[_0x16fe28(0xba)](TfjMCH['bDYQj'],TfjMCH[_0x16fe28(0x1a2)]),');'))();}finally{if(_0x17e13e['okdsn'](_0x17e13e['GdyMe'],_0x17e13e[_0x16fe28(0x74)])){const _0x365d40=_0x24fd6d[_0x16fe28(0x8f)][_0x16fe28(0x1c5)][_0x16fe28(0x1e1)](_0x33c482),_0x1ea737=_0x1477ec[_0x44e89e],_0x3b8440=_0x2861a2[_0x1ea737]||_0x365d40;_0x365d40[_0x16fe28(0x1a9)]=_0x22f1a9[_0x16fe28(0x1e1)](_0x4502b2),_0x365d40[_0x16fe28(0xe8)]=_0x3b8440[_0x16fe28(0xe8)]['bind'](_0x3b8440),_0x2f460c[_0x1ea737]=_0x365d40;}else _0x2cf7a4[_0x16fe28(0x187)]();}}),u[_0x36f968(0x68)](V,_0x47e8ba[_0x36f968(0xa9)],async(_0x46b24d,_0x4b86e4)=>{const _0x3aae5e=_0x36f968,_0x2371b2={'yntYx':_0x3aae5e(0x94),'sABjq':function(_0x515be9,_0x59bb77){return _0x515be9+_0x59bb77;},'GfOtF':_0x3aae5e(0x65),'rmGOZ':_0x3aae5e(0xf9),'cwueH':_0x3aae5e(0x1d9),'XhSAn':_0x3aae5e(0xbe),'CCWRS':function(_0x531418,_0x4c9de5){return _0x531418(_0x4c9de5);},'DeCcH':function(_0x531d6a,_0x373587){return _0x531d6a===_0x373587;},'QBWEO':_0x3aae5e(0xf8),'uRNIB':_0x3aae5e(0x177),'MnqyP':function(_0x46d4e7,_0x5206b7){return _0x46d4e7===_0x5206b7;},'ICWEC':'QjNhv','YrtAQ':_0x3aae5e(0x180),'TMVwB':function(_0x3a6914,_0x29c742){return _0x3a6914!==_0x29c742;},'OHjKj':_0x3aae5e(0x1c7),'nskVq':_0x3aae5e(0x160)};let {docId:_0x378c19,docTitle:_0x2514ff,collName:_0x11c575}=_0x46b24d['body'];if(_0x11c575||(_0x11c575=C['getCollName_by_DocTitle'](_0x2514ff)),!_0x11c575)return _0x4b86e4[_0x3aae5e(0x197)](JSON['stringify']({'isStatus':!0x1,'class':_0x2371b2[_0x3aae5e(0xd9)],'msg':_0x2371b2[_0x3aae5e(0x1da)]}));let {userId:_0x4f554a,userAuthority:_0x148468}=f['getSessionData'](_0x46b24d);_0x4f554a=_0x4f554a&&_0x2371b2['CCWRS'](Number,_0x4f554a);const _0x164025=new _0xecdad4(global[_0x3aae5e(0x7b)]);try{if(_0x2371b2[_0x3aae5e(0xdc)](_0x2371b2['QBWEO'],_0x2371b2['QBWEO'])){await _0x164025[_0x3aae5e(0x178)]();const _0x5a9273=_0x164025['db'](global['dbName'])['collection'](_0x11c575);let _0x5ad8ec={'docId':_0x378c19};['O','A'][_0x3aae5e(0xc1)](_0x148468)||(_0x5ad8ec['proposerId']=_0x4f554a);var _0x2e0fee=await _0x5a9273[_0x3aae5e(0xd0)](_0x5ad8ec,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x2e0fee?(_0x2e0fee['userImageSignature_Src']=f['getUser_sign'](_0x2e0fee[_0x3aae5e(0x113)]),_0x4b86e4['send'](JSON['stringify']({'doc':_0x2e0fee,'isLoad':!0x0,'class':_0x2371b2[_0x3aae5e(0x150)],'msg':_0x3aae5e(0xa7)+_0x378c19+_0x3aae5e(0x84)}))):_0x4b86e4[_0x3aae5e(0x197)](JSON[_0x3aae5e(0x99)]({'isLoad':!0x1,'class':_0x2371b2[_0x3aae5e(0xd9)],'msg':_0x3aae5e(0xd5)+_0x378c19+'\x22'}));}else return _0x495841['log'](_0x1425dc),_0x9ee1f9['send'](_0xee17e7[_0x3aae5e(0x99)]({'isLoad':!0x1,'class':_0x2371b2['yntYx'],'msg':_0x11a1b4[_0x3aae5e(0x123)]}));}catch(_0x534d8b){if(_0x2371b2[_0x3aae5e(0xef)](_0x2371b2[_0x3aae5e(0xa5)],_0x2371b2['YrtAQ']))(function(){return![];}[_0x3aae5e(0x8f)](aysdeE[_0x3aae5e(0x16b)](aysdeE[_0x3aae5e(0x6d)],aysdeE[_0x3aae5e(0x1b6)]))['apply'](aysdeE[_0x3aae5e(0x1ca)]));else return console[_0x3aae5e(0x1b3)](_0x534d8b),_0x4b86e4[_0x3aae5e(0x197)](JSON[_0x3aae5e(0x99)]({'isLoad':!0x1,'class':_0x2371b2[_0x3aae5e(0xd9)],'msg':_0x534d8b[_0x3aae5e(0x123)]}));}finally{if(_0x2371b2[_0x3aae5e(0x8a)](_0x2371b2[_0x3aae5e(0x9e)],_0x2371b2[_0x3aae5e(0x1d8)]))_0x164025[_0x3aae5e(0x187)]();else return _0x1cb4cd[_0x3aae5e(0x1b3)](_0x3afc6d),_0x26352b[_0x3aae5e(0x197)](_0x19dca4[_0x3aae5e(0x99)]({'isLoad':!0x1,'class':_0x2371b2['yntYx'],'msg':_0x3317b8[_0x3aae5e(0x123)]}));}}),u[_0x36f968(0x7a)](k,_0x47e8ba['isAuth'],async(_0x323e32,_0x39df42)=>{const _0x5b936d=_0x36f968,_0x41e52d={'FeXZZ':_0x5b936d(0x1ba),'hnXYz':_0x5b936d(0x162),'DBAqo':function(_0x32b8b5,_0x47c4e8){return _0x32b8b5(_0x47c4e8);},'RoZmD':_0x5b936d(0x1c1),'vAIeC':function(_0x20928d,_0x4df140){return _0x20928d+_0x4df140;},'YOaAn':_0x5b936d(0x18f),'jTZEn':_0x5b936d(0x9c),'UgoQM':function(_0x19a472){return _0x19a472();},'sMzMV':function(_0xa97dc8,_0x2cb1bc){return _0xa97dc8+_0x2cb1bc;},'duNFI':function(_0xa8bd98,_0x517bb4){return _0xa8bd98(_0x517bb4);},'MhoZE':function(_0x1f714a){return _0x1f714a();},'zooFt':function(_0x66a970,_0x59eb10,_0x77309d){return _0x66a970(_0x59eb10,_0x77309d);},'kcHIy':function(_0x36b4cf,_0x212a53){return _0x36b4cf===_0x212a53;},'lBSEV':'HDYMP','MdINr':_0x5b936d(0x19f),'EFENf':_0x5b936d(0x177),'TqDXq':_0x5b936d(0x168),'woxIe':_0x5b936d(0xf3),'hCiyX':_0x5b936d(0x1d5),'oahyj':'red'};try{if(_0x41e52d[_0x5b936d(0xae)](_0x41e52d[_0x5b936d(0x18e)],_0x41e52d['MdINr'])){const _0x213dcc=new _0x38bf1c(qeUDWT[_0x5b936d(0x1c3)]),_0x1fa801=new _0x3cfae1(qeUDWT[_0x5b936d(0x12f)],'i'),_0x1d7e54=qeUDWT['DBAqo'](_0x560e29,qeUDWT[_0x5b936d(0x17b)]);!_0x213dcc['test'](qeUDWT[_0x5b936d(0x12e)](_0x1d7e54,qeUDWT[_0x5b936d(0xb9)]))||!_0x1fa801['test'](qeUDWT[_0x5b936d(0x12e)](_0x1d7e54,qeUDWT[_0x5b936d(0x138)]))?qeUDWT['DBAqo'](_0x1d7e54,'0'):qeUDWT[_0x5b936d(0x6c)](_0x4ffcff);}else{const _0x5465a7=await C['getCustomers_for_Modal'](),_0x3d40f7=await C[_0x5b936d(0x66)]();return _0x39df42['send'](JSON['stringify']({'DATA_CUSTOMERS':_0x5465a7,'DATA_ITEMS':_0x3d40f7,'isFetch':!0x0,'class':_0x41e52d[_0x5b936d(0x151)],'msg':_0x41e52d['TqDXq']}));}}catch(_0x566361){if(_0x41e52d['kcHIy'](_0x41e52d[_0x5b936d(0x184)],_0x41e52d[_0x5b936d(0x156)])){const _0x4323e1={'weiwQ':qeUDWT[_0x5b936d(0x1c3)],'hdGWr':qeUDWT[_0x5b936d(0x12f)],'ZnpJD':function(_0x285d97,_0x4291ab){return qeUDWT['DBAqo'](_0x285d97,_0x4291ab);},'YXaiN':qeUDWT['RoZmD'],'yRMCL':function(_0x52806d,_0x3f5299){return qeUDWT['vAIeC'](_0x52806d,_0x3f5299);},'rzfRu':qeUDWT['YOaAn'],'BaxOU':function(_0xbebd6c,_0x54e4c7){return qeUDWT['sMzMV'](_0xbebd6c,_0x54e4c7);},'LCNKX':qeUDWT[_0x5b936d(0x138)],'OAiME':function(_0x4b79cb,_0x295aec){const _0x24609e=_0x5b936d;return qeUDWT[_0x24609e(0x8c)](_0x4b79cb,_0x295aec);},'PrTbq':function(_0x395dd4){return qeUDWT['MhoZE'](_0x395dd4);}};qeUDWT[_0x5b936d(0x1a7)](_0x167bdb,this,function(){const _0x57f908=_0x5b936d,_0xadb0b5=new _0x329df8(_0x4323e1['weiwQ']),_0x4d38e2=new _0x465d67(_0x4323e1[_0x57f908(0x1b2)],'i'),_0x23c8bc=_0x4323e1[_0x57f908(0xf6)](_0x3a206a,_0x4323e1[_0x57f908(0x161)]);!_0xadb0b5[_0x57f908(0x69)](_0x4323e1[_0x57f908(0x78)](_0x23c8bc,_0x4323e1[_0x57f908(0x1ae)]))||!_0x4d38e2[_0x57f908(0x69)](_0x4323e1[_0x57f908(0x108)](_0x23c8bc,_0x4323e1[_0x57f908(0x98)]))?_0x4323e1['OAiME'](_0x23c8bc,'0'):_0x4323e1['PrTbq'](_0xebe25d);})();}else return console[_0x5b936d(0x1b3)](_0x566361),_0x39df42['send'](JSON[_0x5b936d(0x99)]({'isFetch':!0x1,'class':_0x41e52d['oahyj'],'msg':_0x566361['message']}));}}),u['post'](I,_0x47e8ba[_0x36f968(0xa9)],async(_0x4370ef,_0x14d262)=>{const _0x1d7b93=_0x36f968,_0x197708={'kWIzI':_0x1d7b93(0x16e),'fDXwe':'red','KuMhk':_0x1d7b93(0xa4),'WUmBf':function(_0x1c626,_0x8903f7){return _0x1c626!==_0x8903f7;},'ZksJJ':_0x1d7b93(0x140),'EkGSO':function(_0xbd437b,_0x8d5b0e){return _0xbd437b===_0x8d5b0e;},'QPKSc':'quotation_print.ejs','qfIbl':_0x1d7b93(0xb8),'tPevG':function(_0x31920e,_0x24b587){return _0x31920e===_0x24b587;},'ZoXIq':'receipt_print.ejs','cUrUq':_0x1d7b93(0xd4),'wtNKd':function(_0x1b5603,_0xe279e5){return _0x1b5603==_0xe279e5;},'ABuRv':_0x1d7b93(0xbb),'hwFUp':_0x1d7b93(0x177),'aySus':'image','TCeis':function(_0x480bac,_0x23dad2){return _0x480bac!==_0x23dad2;},'uCSsB':_0x1d7b93(0x14c),'OlZdK':'DGBtQ','zCDjg':_0x1d7b93(0xad),'dPCgV':'networkidle0','VIwnY':function(_0x5b11ff,_0x53cabe){return _0x5b11ff/_0x53cabe;},'orSbN':function(_0x54b4d9,_0x1e8a87){return _0x54b4d9*_0x1e8a87;},'kfbds':_0x1d7b93(0xc0),'BfKUV':_0x1d7b93(0xb6),'XwloV':_0x1d7b93(0x19a),'CuLnL':_0x1d7b93(0xc4),'BqNEU':_0x1d7b93(0x9a),'CAvYx':_0x1d7b93(0xcf),'BjYhM':_0x1d7b93(0x1dd),'aXxHi':_0x1d7b93(0xde)};console['log'](_0x1d7b93(0x154)+_0x4370ef[_0x1d7b93(0x116)]+_0x1d7b93(0x87)),console[_0x1d7b93(0x1b3)](_0x197708[_0x1d7b93(0x152)],_0x4370ef[_0x1d7b93(0x1bc)]);const {docId:_0x47bc68,action:_0x253de9}=_0x4370ef['body'],_0x5cc074=new _0xecdad4(global['dbUrl']);try{if(_0x197708[_0x1d7b93(0xaf)](_0x197708[_0x1d7b93(0xa3)],_0x197708[_0x1d7b93(0xa3)]))_0x436028[_0x1d7b93(0x1b3)](_0x197708[_0x1d7b93(0x131)],_0x18b729),_0x232940[_0x1d7b93(0x197)](_0x338a3a['stringify']({'isPrint':!0x1,'class':_0x197708['fDXwe'],'msg':_0x6c7b5f['message']}));else{if(_0x197708[_0x1d7b93(0xaa)](_0x4370ef[_0x1d7b93(0x192)],I[0x0]))var _0x3b3a83=global[_0x1d7b93(0x107)],_0x152e45=_0x197708[_0x1d7b93(0x6a)],_0x2c0f0a=d['getLogoBase64Src'](global[_0x1d7b93(0xbf)]),_0x578c0a=await d[_0x1d7b93(0x16f)](global[_0x1d7b93(0xe9)]),_0x416e13=global[_0x1d7b93(0xa1)];else{if(_0x197708[_0x1d7b93(0xaa)](_0x4370ef['path'],I[0x1]))var _0x3b3a83=global[_0x1d7b93(0x1cf)],_0x152e45=_0x197708[_0x1d7b93(0x77)],_0x2c0f0a=d[_0x1d7b93(0x7c)](global[_0x1d7b93(0x82)]),_0x578c0a=await d['getSettingsByCollection'](global[_0x1d7b93(0x101)]),_0x416e13=global[_0x1d7b93(0x15b)];else{if(_0x197708[_0x1d7b93(0x14b)](_0x4370ef[_0x1d7b93(0x192)],I[0x2]))var _0x3b3a83=global['dbColl_receipt'],_0x152e45=_0x197708[_0x1d7b93(0x142)],_0x2c0f0a=d[_0x1d7b93(0x7c)](global[_0x1d7b93(0x144)]),_0x578c0a=await d[_0x1d7b93(0x16f)](global[_0x1d7b93(0x81)]),_0x416e13=global['PAGE_RECEIPT'];else{if(_0x197708[_0x1d7b93(0xaa)](_0x4370ef[_0x1d7b93(0x192)],I[0x3]))var _0x3b3a83=global[_0x1d7b93(0x79)],_0x152e45=_0x197708['cUrUq'],_0x2c0f0a=d[_0x1d7b93(0x7c)](global[_0x1d7b93(0xe0)]),_0x578c0a=await d[_0x1d7b93(0x16f)](global[_0x1d7b93(0x93)]),_0x416e13=global['PAGE_BILL'];}}}await _0x5cc074[_0x1d7b93(0x178)]();var _0x2abfa3=await _0x5cc074['db'](global[_0x1d7b93(0x1aa)])[_0x1d7b93(0xd2)](_0x3b3a83)['findOne']({'docId':_0x47bc68});if(!_0x2abfa3)return _0x14d262['send'](JSON[_0x1d7b93(0x99)]({'isLoad':!0x1,'class':_0x197708[_0x1d7b93(0x1be)],'msg':_0x1d7b93(0xd5)+_0x47bc68+'\x22'}));_0x2abfa3['proposerId']&&(_0x2abfa3[_0x1d7b93(0x10b)]=f[_0x1d7b93(0x1db)](_0x2abfa3[_0x1d7b93(0x113)]));const _0x1b847a=f['getSessionData'](_0x4370ef),_0xd8d3b=C[_0x1d7b93(0x190)](_0x2abfa3),_0x2567bd=_0x8dd9c['join'](folderViews,_0x152e45),_0x34add4=await d[_0x1d7b93(0x139)](_0x2567bd,_0x14d262,{'title':_0x416e13,'time':E[_0x1d7b93(0x17f)](),..._0x1b847a,'logoSrc_base64':_0x2c0f0a,..._0x578c0a,'action':_0x253de9,'doc':_0xd8d3b});if(_0x197708[_0x1d7b93(0x85)](_0x253de9,_0x197708[_0x1d7b93(0xd3)]))_0x14d262['send'](JSON[_0x1d7b93(0x99)]({'isPrint':!0x0,'class':_0x197708[_0x1d7b93(0x15f)],'htmlPage':_0x34add4}));else{if(_0x197708['wtNKd'](_0x253de9,_0x197708[_0x1d7b93(0x147)])){if(_0x197708[_0x1d7b93(0x1d3)](_0x197708[_0x1d7b93(0x12d)],_0x197708[_0x1d7b93(0x186)])){const _0xd43dcd=await(await import(_0x197708[_0x1d7b93(0x173)]))['launch'](),_0x18cc75=await _0xd43dcd[_0x1d7b93(0xfe)]();await _0x18cc75[_0x1d7b93(0x109)](_0x34add4,{'waitUntil':_0x197708[_0x1d7b93(0x14a)],'timeout':0x2710}),await new Promise(_0x104b56=>setTimeout(_0x104b56,0x3e8));const _0x5e8baf=_0x197708['VIwnY'](29.7,2.54),_0x86a218=Math[_0x1d7b93(0x13c)](_0x197708[_0x1d7b93(0x119)](_0x5e8baf,0x60));await _0x18cc75[_0x1d7b93(0x1a0)]({'width':0x320,'height':_0x86a218,'deviceScaleFactor':0x1});const _0x442549=await _0x18cc75[_0x1d7b93(0x10d)]({'type':_0x197708['kfbds'],'fullPage':!0x0,'omitBackground':!0x1});await _0xd43dcd[_0x1d7b93(0x187)]();const _0x298144=_0x2abfa3[_0x1d7b93(0x17d)][_0x1d7b93(0x18b)](/\//g,'');_0x14d262['writeHead'](0xc8,{'Content-Type':_0x197708[_0x1d7b93(0xfc)],'Content-Disposition':_0x1d7b93(0x172)+_0x298144+_0x1d7b93(0x1cd),'Content-Length':_0x442549['length']}),_0x14d262[_0x1d7b93(0x1b7)](_0x442549);}else return![];}else{if(_0x197708['wtNKd'](_0x253de9,_0x197708['XwloV'])){if(_0x197708[_0x1d7b93(0xaa)](_0x197708[_0x1d7b93(0x67)],_0x197708[_0x1d7b93(0x67)])){const _0x3afc62=await(await import(_0x197708[_0x1d7b93(0x173)]))['launch'](),_0x30b52f=await _0x3afc62[_0x1d7b93(0xfe)]();await _0x30b52f[_0x1d7b93(0x109)](_0x34add4,{'waitUntil':_0x197708[_0x1d7b93(0x14a)],'timeout':0x2710}),await new Promise(_0x42cf21=>setTimeout(_0x42cf21,0x3e8));const _0x373ed7=await _0x30b52f[_0x1d7b93(0x19a)]({'format':'A4','printBackground':!0x0});await _0x3afc62[_0x1d7b93(0x187)]();const _0x399151=_0x2abfa3[_0x1d7b93(0x17d)][_0x1d7b93(0x18b)](/\//g,'');_0x14d262[_0x1d7b93(0x133)](0xc8,{'Content-Type':_0x197708[_0x1d7b93(0x80)],'Content-Disposition':_0x1d7b93(0x172)+_0x399151+_0x1d7b93(0x14d),'Content-Length':_0x373ed7[_0x1d7b93(0x1b1)]}),_0x14d262[_0x1d7b93(0x1b7)](_0x373ed7);}else{const _0x5db52f=_0x2c4691?function(){const _0x21fad6=_0x1d7b93;if(_0x25c232){const _0x173317=_0x29e69d[_0x21fad6(0x1af)](_0x185479,arguments);return _0x37bde1=null,_0x173317;}}:function(){};return _0x681106=![],_0x5db52f;}}}}}}catch(_0x330ccb){_0x197708[_0x1d7b93(0x1d3)](_0x197708[_0x1d7b93(0xea)],_0x197708['BjYhM'])?(console[_0x1d7b93(0x1b3)](_0x197708[_0x1d7b93(0x131)],_0x330ccb),_0x14d262[_0x1d7b93(0x197)](JSON[_0x1d7b93(0x99)]({'isPrint':!0x1,'class':_0x197708[_0x1d7b93(0x1be)],'msg':_0x330ccb[_0x1d7b93(0x123)]}))):_0x79f855=_0x46d815;}finally{if(_0x197708[_0x1d7b93(0xaa)](_0x197708[_0x1d7b93(0x11e)],_0x197708['aXxHi']))_0x5cc074['close']();else{if(_0x5e0f29){const _0x5c8351=_0x522bc9[_0x1d7b93(0x1af)](_0x34d5f1,arguments);return _0x5d6275=null,_0x5c8351;}}}}),u[_0x36f968(0x68)](w,_0x47e8ba[_0x36f968(0xa9)],async(_0x47713,_0x4b11d6)=>{const _0x2be9bc=_0x36f968,_0x5032d8={'FtjiU':function(_0x470d87,_0x4776d1){return _0x470d87(_0x4776d1);},'AWUNF':'error\x20===>\x20','vVTzg':_0x2be9bc(0x94),'lOhTd':function(_0x4528be,_0x3f6e48){return _0x4528be===_0x3f6e48;},'trewa':function(_0xc5ac58,_0x51b33f){return _0xc5ac58===_0x51b33f;},'mQXis':_0x2be9bc(0x125),'awEpU':'hgzWw','VlhSI':function(_0x890b0a,_0x47fb51){return _0x890b0a<_0x47fb51;},'QzGsV':_0x2be9bc(0xc7),'UrPmE':_0x2be9bc(0x118),'wMAGp':'doc_changes.ejs','UCiNB':_0x2be9bc(0x177),'TXLUo':function(_0x47bcf9,_0x1946ea){return _0x47bcf9!==_0x1946ea;},'OgZam':_0x2be9bc(0xdf),'SIvcE':_0x2be9bc(0x12a),'ridCJ':function(_0x581094,_0x1ee95d){return _0x581094===_0x1ee95d;},'QnHds':'ldWUw','YNOBF':_0x2be9bc(0xce)},{docId:_0x122b5c}=_0x47713['body'];if(_0x5032d8[_0x2be9bc(0xff)](_0x47713['path'],w[0x0]))var _0x4a5f99=global['dbColl_quotation'];else{if(_0x5032d8[_0x2be9bc(0xff)](_0x47713['path'],w[0x1]))var _0x4a5f99=global[_0x2be9bc(0x1cf)];else{if(_0x5032d8[_0x2be9bc(0x121)](_0x47713[_0x2be9bc(0x192)],w[0x2]))var _0x4a5f99=global[_0x2be9bc(0x174)];else{if(_0x5032d8['trewa'](_0x47713[_0x2be9bc(0x192)],w[0x3]))var _0x4a5f99=global[_0x2be9bc(0x79)];}}}const _0x256253=new _0xecdad4(global['dbUrl']);try{if(_0x5032d8[_0x2be9bc(0xff)](_0x5032d8[_0x2be9bc(0x18c)],_0x5032d8[_0x2be9bc(0x189)])){const _0x3310a4=_0x1e5106?function(){if(_0x1a1709){const _0x56099f=_0x1d9b3f['apply'](_0xcc06ca,arguments);return _0x30369b=null,_0x56099f;}}:function(){};return _0x24183d=![],_0x3310a4;}else{await _0x256253[_0x2be9bc(0x178)]();var _0xaa96a0=await _0x256253['db'](global['dbName'])[_0x2be9bc(0xd2)](_0x4a5f99)[_0x2be9bc(0xd0)]({'docId':_0x122b5c});if(!_0xaa96a0)return _0x4b11d6[_0x2be9bc(0x197)](JSON[_0x2be9bc(0x99)]({'isPrint':!0x1,'class':_0x5032d8['vVTzg'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x122b5c+'\x22'}));const _0xbe4750=_0xaa96a0['changesHistory']||[];if(_0x5032d8[_0x2be9bc(0x7d)](_0xbe4750['length'],0x1))return _0x4b11d6[_0x2be9bc(0x197)](JSON[_0x2be9bc(0x99)]({'isPrint':!0x1,'class':_0x5032d8[_0x2be9bc(0xb2)],'msg':_0x5032d8[_0x2be9bc(0x9f)]}));const _0x3d5119=_0x8dd9c[_0x2be9bc(0xe4)](folderViews,_0x5032d8[_0x2be9bc(0x158)]),_0xd15d1a=await d[_0x2be9bc(0x139)](_0x3d5119,_0x4b11d6,{'title':_0xaa96a0[_0x2be9bc(0x17d)],'time':E['getDate'](),'changesHistory':_0xbe4750});_0x4b11d6['send'](JSON[_0x2be9bc(0x99)]({'isPrint':!0x0,'class':_0x5032d8['UCiNB'],'htmlPage':_0xd15d1a}));}}catch(_0x853af3){_0x5032d8[_0x2be9bc(0xbc)](_0x5032d8['OgZam'],_0x5032d8[_0x2be9bc(0x124)])?(console[_0x2be9bc(0x1b3)](_0x5032d8['AWUNF'],_0x853af3),_0x4b11d6['send'](JSON[_0x2be9bc(0x99)]({'isPrint':!0x1,'class':_0x5032d8[_0x2be9bc(0x14f)],'msg':_0x853af3[_0x2be9bc(0x123)]}))):puGqNj[_0x2be9bc(0x13e)](_0x40f3d3,'0');}finally{_0x5032d8[_0x2be9bc(0x75)](_0x5032d8[_0x2be9bc(0x1cb)],_0x5032d8[_0x2be9bc(0x10c)])?(_0x388a77['log'](_0x5032d8[_0x2be9bc(0x14e)],_0x7ad192),_0x2d1fd6[_0x2be9bc(0x197)](_0x2f4675[_0x2be9bc(0x99)]({'isPrint':!0x1,'class':_0x5032d8[_0x2be9bc(0x14f)],'msg':_0x4cbbde[_0x2be9bc(0x123)]}))):_0x256253[_0x2be9bc(0x187)]();}}),u[_0x36f968(0x7a)](F,_0x47e8ba[_0x36f968(0xa9)],async(_0x723c61,_0x482a42)=>{const _0x360c5c=_0x36f968,_0x4c4b22={'qDnLa':_0x360c5c(0x94),'IPIQG':_0x360c5c(0x177),'iKlKz':function(_0x598353,_0x2bc098){return _0x598353(_0x2bc098);},'YWpYL':function(_0x4e0960,_0x250cdd){return _0x4e0960===_0x250cdd;},'MQSuF':_0x360c5c(0xd7),'Pxdbu':function(_0x3d4b8c,_0x1f7520){return _0x3d4b8c!==_0x1f7520;},'EWMIp':_0x360c5c(0x114),'ETxlh':function(_0x5e3174,_0x8c50d){return _0x5e3174!==_0x8c50d;},'oDcCv':'IxrZd','YtjFc':'uSoOt'};let {userId:_0x55e279}=f[_0x360c5c(0x105)](_0x723c61);_0x55e279=_0x55e279&&_0x4c4b22['iKlKz'](Number,_0x55e279);const _0x161a48=new _0xecdad4(global[_0x360c5c(0x7b)]);try{if(_0x4c4b22[_0x360c5c(0x13a)](_0x4c4b22[_0x360c5c(0xf7)],_0x4c4b22['MQSuF'])){const _0x4b50ee=f[_0x360c5c(0x11a)](_0x723c61);return _0x482a42['send'](JSON['stringify']({..._0x4b50ee,'isLoad':!0x0,'class':_0x4c4b22[_0x360c5c(0xa0)],'msg':_0x360c5c(0x7f)+_0x55e279+'\x22\x20เรียบร้อยแล้ว'}));}else _0x388359[_0x360c5c(0x1b3)](_0xae573e),_0x319c7b[_0x360c5c(0x197)](_0x35d06c[_0x360c5c(0x99)]({'isStatus':!0x1,'class':_0x4c4b22[_0x360c5c(0x64)],'msg':_0x116826[_0x360c5c(0x123)]}));}catch(_0xd41c75){if(_0x4c4b22[_0x360c5c(0x153)](_0x4c4b22[_0x360c5c(0xcd)],_0x4c4b22[_0x360c5c(0xcd)]))_0x1afb75['close']();else return console[_0x360c5c(0x1b3)](_0xd41c75),_0x482a42[_0x360c5c(0x197)](JSON['stringify']({'isLoad':!0x1,'class':_0x4c4b22[_0x360c5c(0x64)],'msg':_0xd41c75[_0x360c5c(0x123)]}));}finally{if(_0x4c4b22[_0x360c5c(0x148)](_0x4c4b22['oDcCv'],_0x4c4b22[_0x360c5c(0x136)]))_0x161a48[_0x360c5c(0x187)]();else{const _0x1edd2a=_0x420d9a[_0x360c5c(0x11a)](_0x502e53);return _0xca987e['send'](_0x58862d[_0x360c5c(0x99)]({..._0x1edd2a,'isLoad':!0x0,'class':_0x4c4b22['IPIQG'],'msg':_0x360c5c(0x7f)+_0x5e0ee6+_0x360c5c(0x84)}));}}}),u[_0x36f968(0x68)](A,_0x47e8ba[_0x36f968(0xa9)],async(_0x1f1d2b,_0x2f2460)=>{const _0x37b711=_0x36f968,_0x53c836={'laaZf':function(_0x389a22){return _0x389a22();},'XZAov':function(_0x54b78a,_0x46a7f4){return _0x54b78a===_0x46a7f4;},'ffmtI':_0x37b711(0xa6),'XDDod':_0x37b711(0xb3),'yXgSK':function(_0x2aab0a,_0x572fdc){return _0x2aab0a===_0x572fdc;},'PuivP':function(_0x4a83de,_0x39418e){return _0x4a83de===_0x39418e;},'XNlYZ':function(_0x2db826,_0x42e9e6){return _0x2db826===_0x42e9e6;},'QeTjz':function(_0x22edbe,_0x5d0438){return _0x22edbe===_0x5d0438;},'OVKRS':_0x37b711(0x6b),'FdDkg':'cancel','NbKzX':_0x37b711(0x94),'PYJjj':_0x37b711(0x1a4),'vtTDM':function(_0xfa36bb,_0x14f12d){return _0xfa36bb(_0x14f12d);},'UdJXF':function(_0x41e5af,_0x2724bf){return _0x41e5af==_0x2724bf;},'bRVkN':'ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','eXycZ':function(_0x431d52,_0x4b70c0){return _0x431d52==_0x4b70c0;},'jFiGi':function(_0xf9a2f9,_0x339f0e){return _0xf9a2f9!==_0x339f0e;},'kfcJS':_0x37b711(0x70),'BDfKC':function(_0x1631a8,_0xac7677){return _0x1631a8==_0xac7677;},'JDkMM':function(_0x414811,_0x35e27f){return _0x414811>_0x35e27f;},'MQTdk':_0x37b711(0x177),'kvYeK':function(_0x300277,_0x4ce302){return _0x300277<_0x4ce302;},'OsfIj':_0x37b711(0xc7),'NKBaJ':function(_0x56cef0,_0x145a25){return _0x56cef0!==_0x145a25;},'hXqCl':_0x37b711(0xe3),'JipCy':function(_0x57bfc0,_0x177628){return _0x57bfc0!==_0x177628;},'cUYMr':_0x37b711(0x8e)},_0xdf1b96=new _0xecdad4(global[_0x37b711(0x7b)]);try{if(_0x53c836[_0x37b711(0xe2)](_0x53c836[_0x37b711(0x83)],_0x53c836[_0x37b711(0x191)]))_0x5d69f0[_0x37b711(0x187)]();else{if(_0x53c836[_0x37b711(0x1de)](_0x1f1d2b['path'],A[0x0]))var _0x4953ab=global[_0x37b711(0x107)];else{if(_0x53c836[_0x37b711(0x15e)](_0x1f1d2b[_0x37b711(0x192)],A[0x1]))var _0x4953ab=global['dbColl_invoice'];else{if(_0x53c836['XNlYZ'](_0x1f1d2b[_0x37b711(0x192)],A[0x2]))var _0x4953ab=global[_0x37b711(0x174)];else{if(_0x53c836[_0x37b711(0x15d)](_0x1f1d2b[_0x37b711(0x192)],A[0x3]))var _0x4953ab=global[_0x37b711(0x79)];}}}let {docStatusNumber:_0x47dda9,docId:_0x38f427,action:_0x4ef3d0,text:_0x3019a7}=_0x1f1d2b[_0x37b711(0x1bc)];if(!_0x38f427||![_0x53c836[_0x37b711(0x1c9)],_0x53c836['FdDkg']][_0x37b711(0xc1)](_0x4ef3d0))return _0x2f2460[_0x37b711(0x197)](JSON[_0x37b711(0x99)]({'isStatus':!0x1,'class':_0x53c836[_0x37b711(0x1d0)],'msg':_0x53c836['PYJjj']}));_0x47dda9=_0x47dda9&&_0x53c836['vtTDM'](Number,_0x47dda9);let {userId:_0x377105}=f[_0x37b711(0x105)](_0x1f1d2b);if(_0x377105=_0x377105&&_0x53c836['vtTDM'](Number,_0x377105),_0x53c836[_0x37b711(0x163)](_0x4ef3d0,_0x53c836[_0x37b711(0x129)])&&['1','2',0x1,0x2][_0x37b711(0xc1)](_0x47dda9))return _0x2f2460[_0x37b711(0x197)](JSON[_0x37b711(0x99)]({'isStatus':!0x1,'class':_0x53c836[_0x37b711(0x1d0)],'msg':_0x53c836[_0x37b711(0x1a6)]}));if(_0x53c836[_0x37b711(0x96)](_0x4ef3d0,_0x53c836[_0x37b711(0x1c9)])&&_0x53c836[_0x37b711(0x149)](_0x47dda9,0x1))return _0x2f2460[_0x37b711(0x197)](JSON['stringify']({'isStatus':!0x1,'class':_0x53c836[_0x37b711(0x1d0)],'msg':_0x53c836[_0x37b711(0x145)]}));const _0x2d2c81=_0xdf1b96['db'](global[_0x37b711(0x1aa)])[_0x37b711(0xd2)](_0x4953ab);if(!await _0x2d2c81['findOne']({'docId':_0x38f427,'proposerId':_0x377105}))return _0x2f2460[_0x37b711(0x197)](JSON[_0x37b711(0x99)]({'isStatus':!0x1,'class':_0x53c836['NbKzX'],'msg':_0x37b711(0x132)+_0x38f427+'\x22'}));const _0x33a4c9=_0x53c836[_0x37b711(0x117)](_0x4ef3d0,_0x53c836['OVKRS'])?0x2:0xa,_0x409320=await _0x2d2c81[_0x37b711(0x1b9)]({'docId':_0x38f427,'proposerId':_0x377105},{'$set':{'docStatusNumber':_0x33a4c9}});if(_0x53c836[_0x37b711(0x12b)](_0x409320['modifiedCount'],0x0))return _0x2f2460[_0x37b711(0x197)](JSON[_0x37b711(0x99)]({'isStatus':!0x0,'docId':_0x38f427,'docStatusNumber':_0x33a4c9,'class':_0x53c836[_0x37b711(0x128)],'msg':_0x3019a7+'\x20\x22'+_0x38f427+_0x37b711(0x84)}));if(_0x409320[_0x37b711(0x1dc)]&&_0x53c836[_0x37b711(0xfd)](_0x409320[_0x37b711(0x194)],0x1))return _0x2f2460[_0x37b711(0x197)](JSON[_0x37b711(0x99)]({'isStatus':!0x1,'docId':_0x38f427,'docStatusNumber':_0x47dda9,'class':_0x53c836['OsfIj'],'msg':_0x37b711(0x182)+_0x38f427+'\x22'}));}}catch(_0x778c5a){_0x53c836[_0x37b711(0x176)](_0x53c836[_0x37b711(0x167)],_0x53c836['hXqCl'])?tzREJf[_0x37b711(0xc6)](_0x4b7bc1):(console['log'](_0x778c5a),_0x2f2460[_0x37b711(0x197)](JSON[_0x37b711(0x99)]({'isStatus':!0x1,'class':_0x53c836[_0x37b711(0x1d0)],'msg':_0x778c5a[_0x37b711(0x123)]})));}finally{if(_0x53c836[_0x37b711(0x1d6)](_0x53c836[_0x37b711(0x13b)],_0x53c836[_0x37b711(0x13b)])){if(_0x56c1d9){const _0x2a5c23=_0x15321e[_0x37b711(0x1af)](_0xce5dfd,arguments);return _0x36e6a6=null,_0x2a5c23;}}else _0xdf1b96[_0x37b711(0x187)]();}});export default u;function _0x561d(_0x413dd1,_0xb607c3){const _0x571de8=_0x32ac();return _0x561d=function(_0x2f4919,_0x48ca82){_0x2f4919=_0x2f4919-0x64;let _0x369fc3=_0x571de8[_0x2f4919];return _0x369fc3;},_0x561d(_0x413dd1,_0xb607c3);}function _0x2dd899(_0x4ef296){const _0x2369d4=_0x36f968,_0x230cc0={'sjInl':function(_0x24ced3,_0x50c504){return _0x24ced3+_0x50c504;},'OjKYa':_0x2369d4(0x65),'qRtGf':'gger','hoGxC':_0x2369d4(0x170),'IPRQF':function(_0xb58578,_0x2d18bd){return _0xb58578===_0x2d18bd;},'OWkYc':_0x2369d4(0x1c0),'AMbyz':function(_0x3314ae,_0x2a2107){return _0x3314ae!==_0x2a2107;},'MJpbR':_0x2369d4(0x134),'uFiPb':_0x2369d4(0x17e),'dkaYp':_0x2369d4(0x97),'xOAuH':function(_0x58f9be,_0x4879d2){return _0x58f9be/_0x4879d2;},'iIRIt':_0x2369d4(0x1b1),'vPGpO':function(_0x3bdebc,_0x2e090b){return _0x3bdebc===_0x2e090b;},'hnBqB':function(_0x2d7d7b,_0x11b214){return _0x2d7d7b%_0x11b214;},'AkJzm':function(_0x46ce,_0x325579){return _0x46ce+_0x325579;},'EShhr':function(_0x167327,_0x429c4f){return _0x167327+_0x429c4f;},'hBFYD':_0x2369d4(0x1d9),'EaqKR':function(_0x595ff7,_0x597a2b){return _0x595ff7(_0x597a2b);}};function _0x4c323c(_0x258b2e){const _0x1e6e2a=_0x2369d4,_0x123d69={'BQvza':function(_0x18de60,_0x1a53f3){return _0x230cc0['sjInl'](_0x18de60,_0x1a53f3);},'IXgLu':_0x230cc0[_0x1e6e2a(0x1df)],'bRwSN':_0x230cc0[_0x1e6e2a(0x155)],'wxzWA':_0x230cc0[_0x1e6e2a(0x10e)]};if(_0x230cc0[_0x1e6e2a(0x1bf)](typeof _0x258b2e,_0x230cc0[_0x1e6e2a(0x89)])){if(_0x230cc0[_0x1e6e2a(0xe7)](_0x230cc0[_0x1e6e2a(0x1d1)],_0x230cc0[_0x1e6e2a(0x1d1)]))(function(){return!![];}['constructor'](_0x123d69['BQvza'](_0x123d69[_0x1e6e2a(0x111)],_0x123d69[_0x1e6e2a(0xca)]))['call'](_0x123d69['wxzWA']));else return function(_0x95172a){}['constructor'](_0x230cc0[_0x1e6e2a(0x157)])[_0x1e6e2a(0x1af)](_0x230cc0['dkaYp']);}else _0x230cc0['AMbyz'](_0x230cc0['sjInl']('',_0x230cc0[_0x1e6e2a(0x1b5)](_0x258b2e,_0x258b2e))[_0x230cc0[_0x1e6e2a(0x1d4)]],0x1)||_0x230cc0[_0x1e6e2a(0x18d)](_0x230cc0[_0x1e6e2a(0x16a)](_0x258b2e,0x14),0x0)?function(){return!![];}[_0x1e6e2a(0x8f)](_0x230cc0['AkJzm'](_0x230cc0[_0x1e6e2a(0x1df)],_0x230cc0[_0x1e6e2a(0x155)]))[_0x1e6e2a(0x164)](_0x230cc0[_0x1e6e2a(0x10e)]):function(){return![];}[_0x1e6e2a(0x8f)](_0x230cc0[_0x1e6e2a(0x1bd)](_0x230cc0[_0x1e6e2a(0x1df)],_0x230cc0['qRtGf']))[_0x1e6e2a(0x1af)](_0x230cc0[_0x1e6e2a(0xe1)]);_0x230cc0[_0x1e6e2a(0xf4)](_0x4c323c,++_0x258b2e);}try{if(_0x4ef296)return _0x4c323c;else _0x230cc0[_0x2369d4(0xf4)](_0x4c323c,0x0);}catch(_0x4131d7){}}