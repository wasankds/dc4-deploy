const _0x14d8f7=_0x2085;(function(_0x529988,_0x3adbe5){const _0xc74ce=_0x2085,_0x3f90ff=_0x529988();while(!![]){try{const _0x3d069f=-parseInt(_0xc74ce(0x206))/0x1+parseInt(_0xc74ce(0x17f))/0x2+parseInt(_0xc74ce(0x2c3))/0x3+parseInt(_0xc74ce(0x231))/0x4+-parseInt(_0xc74ce(0x22d))/0x5*(parseInt(_0xc74ce(0x224))/0x6)+parseInt(_0xc74ce(0x243))/0x7+-parseInt(_0xc74ce(0x18e))/0x8;if(_0x3d069f===_0x3adbe5)break;else _0x3f90ff['push'](_0x3f90ff['shift']());}catch(_0xf3664a){_0x3f90ff['push'](_0x3f90ff['shift']());}}}(_0x40d9,0x4789d));const _0x308e6c=(function(){const _0x3fc8ee=_0x2085,_0x426376={'KoHcl':function(_0x219504,_0x38499e){return _0x219504!==_0x38499e;},'HDnUX':_0x3fc8ee(0x2b1),'HWkBV':function(_0x1722fb,_0x45d0d7){return _0x1722fb===_0x45d0d7;},'NTNZq':'QaNgB','bKzLG':_0x3fc8ee(0x2bb),'WiZhA':function(_0x2e6802,_0x530bd2){return _0x2e6802(_0x530bd2);},'FkHZJ':_0x3fc8ee(0x21a),'uMUqS':'CMrDq'};let _0x375152=!![];return function(_0x51cca5,_0x5319bf){const _0x459b1d=_0x3fc8ee,_0x43c0f4={'TxjEw':_0x426376[_0x459b1d(0x1b5)]};if(_0x426376[_0x459b1d(0x1d5)](_0x426376[_0x459b1d(0x20e)],_0x426376[_0x459b1d(0x20e)])){const _0x25507d=_0x375152?function(){const _0x46d42a=_0x459b1d;if(_0x426376[_0x46d42a(0x1b4)](_0x426376[_0x46d42a(0x169)],_0x426376[_0x46d42a(0x169)]))_0x1964b8['close']();else{if(_0x5319bf){if(_0x426376[_0x46d42a(0x1d5)](_0x426376[_0x46d42a(0x1ed)],_0x426376['bKzLG']))return _0x4351ca[_0x46d42a(0x2bf)](_0x574b0a),_0x2760b[_0x46d42a(0x175)](_0x1b8fe2[_0x46d42a(0x29c)]({'isLoad':!0x1,'class':_0x43c0f4[_0x46d42a(0x1da)],'msg':_0x4541c4['message']}));else{const _0x25b2e3=_0x5319bf[_0x46d42a(0x26f)](_0x51cca5,arguments);return _0x5319bf=null,_0x25b2e3;}}}}:function(){};return _0x375152=![],_0x25507d;}else{if(_0x348d24)return _0x3c15b8;else _0x426376[_0x459b1d(0x1ea)](_0x1b9b2e,0x0);}};}());(function(){const _0x41e0f2=_0x2085,_0x40ad23={'swkIj':function(_0x14b41a,_0x34063d){return _0x14b41a+_0x34063d;},'DOEHP':_0x41e0f2(0x2ae),'ekmcK':_0x41e0f2(0x222),'tisYV':_0x41e0f2(0x176),'SMGEQ':_0x41e0f2(0x1ff),'fDPUv':'red','toPon':function(_0x26b970,_0x18e0d6){return _0x26b970!==_0x18e0d6;},'QbHJf':_0x41e0f2(0x289),'QuUrR':_0x41e0f2(0x1e0),'VZudd':'function\x20*\x5c(\x20*\x5c)','hWomG':_0x41e0f2(0x2a6),'CfbZQ':function(_0x1534ec,_0x27172b){return _0x1534ec(_0x27172b);},'wvAcK':'init','SATjO':function(_0x5cbfdc,_0x30660d){return _0x5cbfdc+_0x30660d;},'aVQbc':'chain','MZAJz':_0x41e0f2(0x151),'ioLUn':_0x41e0f2(0x245),'WFQMN':_0x41e0f2(0x24f),'vYLel':function(_0x526b14,_0xcb3a5c){return _0x526b14(_0xcb3a5c);},'cwrSy':_0x41e0f2(0x16a),'mKcSo':function(_0x46b52f){return _0x46b52f();},'HXFlS':function(_0x301d19,_0x446fc6,_0x1bc620){return _0x301d19(_0x446fc6,_0x1bc620);}};_0x40ad23[_0x41e0f2(0x149)](_0x308e6c,this,function(){const _0x1fa927=_0x41e0f2,_0x42151a={'VmvMG':_0x40ad23[_0x1fa927(0x274)],'aMpeH':_0x40ad23[_0x1fa927(0x2b4)]};if(_0x40ad23['toPon'](_0x40ad23[_0x1fa927(0x25d)],_0x40ad23[_0x1fa927(0x27b)])){const _0x13149a=new RegExp(_0x40ad23[_0x1fa927(0x254)]),_0x3b2eb0=new RegExp(_0x40ad23[_0x1fa927(0x27f)],'i'),_0x367f03=_0x40ad23[_0x1fa927(0x2c5)](_0x56b6d4,_0x40ad23[_0x1fa927(0x29f)]);!_0x13149a[_0x1fa927(0x1ba)](_0x40ad23[_0x1fa927(0x28b)](_0x367f03,_0x40ad23['aVQbc']))||!_0x3b2eb0[_0x1fa927(0x1ba)](_0x40ad23[_0x1fa927(0x159)](_0x367f03,_0x40ad23[_0x1fa927(0x1e3)]))?_0x40ad23[_0x1fa927(0x24c)](_0x40ad23[_0x1fa927(0x249)],_0x40ad23[_0x1fa927(0x204)])?_0x40ad23[_0x1fa927(0x1e7)](_0x367f03,'0'):(_0x3791c6[_0x1fa927(0x2bf)](_0x42151a['VmvMG'],_0x44a86f),_0x351b88[_0x1fa927(0x175)](_0x3f39ec[_0x1fa927(0x29c)]({'isPrint':!0x1,'class':_0x42151a[_0x1fa927(0x228)],'msg':_0x2e05f7[_0x1fa927(0x26b)]}))):_0x40ad23['toPon'](_0x40ad23[_0x1fa927(0x196)],_0x40ad23[_0x1fa927(0x196)])?function(){return![];}['constructor'](_0x40ad23[_0x1fa927(0x159)](_0x40ad23[_0x1fa927(0x2d2)],_0x40ad23['ekmcK']))[_0x1fa927(0x26f)](_0x40ad23[_0x1fa927(0x21c)]):_0x40ad23[_0x1fa927(0x171)](_0x56b6d4);}else{const _0x3f4a89=_0x2decef[_0x1fa927(0x1e8)]['prototype'][_0x1fa927(0x265)](_0x38fe35),_0x2d6403=_0x1ae109[_0x5709fa],_0x1de320=_0x407310[_0x2d6403]||_0x3f4a89;_0x3f4a89[_0x1fa927(0x2a5)]=_0x582f24[_0x1fa927(0x265)](_0xd303f1),_0x3f4a89[_0x1fa927(0x252)]=_0x1de320[_0x1fa927(0x252)][_0x1fa927(0x265)](_0x1de320),_0x15d01f[_0x2d6403]=_0x3f4a89;}})();}());const _0x3f455e=(function(){const _0x508c4a=_0x2085,_0x340242={'Qipfb':function(_0xcf7a03,_0x4110b1){return _0xcf7a03(_0x4110b1);},'auNQD':function(_0x262bf1,_0x58b266){return _0x262bf1+_0x58b266;},'xIuPQ':function(_0x25be60,_0x16eae6){return _0x25be60+_0x16eae6;},'kdhYg':_0x508c4a(0x28d),'FhwEP':_0x508c4a(0x2c8),'rQzJc':function(_0x3286ce,_0x293b86){return _0x3286ce!==_0x293b86;},'CoiHm':_0x508c4a(0x282),'UDRSK':_0x508c4a(0x1ee),'aFncf':function(_0x5d7634,_0x5e4a87){return _0x5d7634!==_0x5e4a87;},'xoZuq':_0x508c4a(0x1c4)};let _0x238e89=!![];return function(_0x3550ed,_0x178c48){const _0x43b138=_0x508c4a,_0x26c1d4={'WAPhz':function(_0x21a3e5,_0x1b03e6){return _0x340242['rQzJc'](_0x21a3e5,_0x1b03e6);},'AIECZ':_0x340242[_0x43b138(0x1de)],'oSEyz':function(_0x3c95d3,_0x5ddf47){const _0x37c850=_0x43b138;return _0x340242[_0x37c850(0x277)](_0x3c95d3,_0x5ddf47);},'pWsWt':_0x340242[_0x43b138(0x230)]};if(_0x340242[_0x43b138(0x18b)](_0x340242['xoZuq'],_0x340242[_0x43b138(0x1ef)])){let _0x37ebc2;try{_0x37ebc2=_0x340242[_0x43b138(0x273)](_0x106b11,_0x340242[_0x43b138(0x15f)](_0x340242[_0x43b138(0x193)](_0x340242[_0x43b138(0x16f)],_0x340242[_0x43b138(0x150)]),');'))();}catch(_0x5c5dc3){_0x37ebc2=_0x3f8ae8;}return _0x37ebc2;}else{const _0x3604c7=_0x238e89?function(){const _0xb404cf=_0x43b138;if(_0x26c1d4['WAPhz'](_0x26c1d4[_0xb404cf(0x27d)],_0x26c1d4[_0xb404cf(0x27d)]))_0x2b60ee[_0xb404cf(0x1db)]();else{if(_0x178c48){if(_0x26c1d4[_0xb404cf(0x19c)](_0x26c1d4[_0xb404cf(0x21b)],_0x26c1d4[_0xb404cf(0x21b)])){if(_0x505bd2){const _0xcde891=_0x42a1e3[_0xb404cf(0x26f)](_0x4976eb,arguments);return _0x3c9576=null,_0xcde891;}}else{const _0x3b23c3=_0x178c48[_0xb404cf(0x26f)](_0x3550ed,arguments);return _0x178c48=null,_0x3b23c3;}}}}:function(){};return _0x238e89=![],_0x3604c7;}};}()),_0x109b67=_0x3f455e(this,function(){const _0x4ed373=_0x2085,_0x428c7a={'lpzKX':function(_0xe2401c,_0x989095){return _0xe2401c(_0x989095);},'JozNw':_0x4ed373(0x2a8),'NxGvi':_0x4ed373(0x2a6),'WgOPq':function(_0x33cf47,_0x25fdaa){return _0x33cf47(_0x25fdaa);},'cObyQ':_0x4ed373(0x239),'SMZII':function(_0x556307,_0x442b55){return _0x556307+_0x442b55;},'kgsir':_0x4ed373(0x292),'NQqjg':'input','OxOxN':function(_0x5a24fe){return _0x5a24fe();},'Sgcvf':function(_0x43f460,_0x179c78,_0xd9b27c){return _0x43f460(_0x179c78,_0xd9b27c);},'NJXuH':function(_0x3aafc4,_0x4ecce3){return _0x3aafc4===_0x4ecce3;},'xNvqp':_0x4ed373(0x275),'MZFxN':function(_0x5e437d,_0x147284){return _0x5e437d!==_0x147284;},'fvfzm':_0x4ed373(0x17d),'DTSel':_0x4ed373(0x22e),'NHEiY':_0x4ed373(0x28d),'ZbfZu':_0x4ed373(0x2c8),'YQyoW':function(_0xfd69a0,_0x1b2f67){return _0xfd69a0===_0x1b2f67;},'jgdBT':_0x4ed373(0x2ba),'TpdYq':_0x4ed373(0x2bf),'Alfgh':_0x4ed373(0x1fe),'bQWPN':_0x4ed373(0x1d9),'dmXOr':_0x4ed373(0x261),'DBKjs':_0x4ed373(0x1ad),'CshZx':'table','TstBT':_0x4ed373(0x219),'RcLRV':function(_0x1045db,_0x52586f){return _0x1045db<_0x52586f;},'LJcUM':function(_0xe6b2d1,_0x17c5b0){return _0xe6b2d1!==_0x17c5b0;},'hxmsx':'xpUBz','FDhCW':_0x4ed373(0x29d)},_0x59f22e=function(){const _0x1b157a=_0x4ed373,_0x5b2dfb={'tPvMm':_0x428c7a[_0x1b157a(0x281)],'Wilrg':_0x428c7a[_0x1b157a(0x236)],'uouXE':function(_0x35ad33,_0x3939e3){const _0x36b38a=_0x1b157a;return _0x428c7a[_0x36b38a(0x251)](_0x35ad33,_0x3939e3);},'WArOu':_0x428c7a[_0x1b157a(0x2b2)],'JKyoJ':function(_0x66c04f,_0x6d2836){const _0x4a51cf=_0x1b157a;return _0x428c7a[_0x4a51cf(0x1c2)](_0x66c04f,_0x6d2836);},'TWzcV':_0x428c7a[_0x1b157a(0x247)],'ZFjRA':_0x428c7a[_0x1b157a(0x1df)],'hPTzg':function(_0x295399){const _0x27fed5=_0x1b157a;return _0x428c7a[_0x27fed5(0x1e6)](_0x295399);},'ZAVqN':function(_0x4162a1,_0x17554f,_0x263c20){const _0x4ade89=_0x1b157a;return _0x428c7a[_0x4ade89(0x184)](_0x4162a1,_0x17554f,_0x263c20);}};if(_0x428c7a['NJXuH'](_0x428c7a[_0x1b157a(0x1f8)],_0x428c7a['xNvqp'])){let _0x221dd6;try{if(_0x428c7a[_0x1b157a(0x192)](_0x428c7a[_0x1b157a(0x2a7)],_0x428c7a[_0x1b157a(0x1bc)]))_0x221dd6=_0x428c7a['WgOPq'](Function,_0x428c7a[_0x1b157a(0x1c2)](_0x428c7a[_0x1b157a(0x1c2)](_0x428c7a[_0x1b157a(0x1b8)],_0x428c7a[_0x1b157a(0x1ca)]),');'))();else{const _0xd75f60={'ZIgTY':_0x5b2dfb[_0x1b157a(0x278)],'mnhqw':_0x5b2dfb[_0x1b157a(0x19f)],'qUWrV':function(_0x345e2e,_0x3f0cac){return _0x5b2dfb['uouXE'](_0x345e2e,_0x3f0cac);},'GWYxe':_0x5b2dfb[_0x1b157a(0x164)],'BXUTR':function(_0x3928c7,_0xa32ccb){const _0x2f0186=_0x1b157a;return _0x5b2dfb[_0x2f0186(0x1bf)](_0x3928c7,_0xa32ccb);},'XSaCW':_0x5b2dfb[_0x1b157a(0x1a3)],'DzCeV':function(_0x294069,_0x2ad279){const _0x4bab63=_0x1b157a;return _0x5b2dfb[_0x4bab63(0x1bf)](_0x294069,_0x2ad279);},'AbCJQ':_0x5b2dfb['ZFjRA'],'HYHDF':function(_0x46e503){const _0x47bcd0=_0x1b157a;return _0x5b2dfb[_0x47bcd0(0x1dc)](_0x46e503);}};_0x5b2dfb['ZAVqN'](_0x16640b,this,function(){const _0x43e9ca=_0x1b157a,_0x51eddd=new _0xb63540(_0xd75f60[_0x43e9ca(0x2ad)]),_0x2ffc34=new _0x527355(_0xd75f60[_0x43e9ca(0x260)],'i'),_0x295d9b=_0xd75f60[_0x43e9ca(0x1e4)](_0x2c06db,_0xd75f60[_0x43e9ca(0x186)]);!_0x51eddd['test'](_0xd75f60[_0x43e9ca(0x18f)](_0x295d9b,_0xd75f60[_0x43e9ca(0x148)]))||!_0x2ffc34['test'](_0xd75f60['DzCeV'](_0x295d9b,_0xd75f60[_0x43e9ca(0x2c6)]))?_0xd75f60[_0x43e9ca(0x1e4)](_0x295d9b,'0'):_0xd75f60[_0x43e9ca(0x237)](_0x4230c3);})();}}catch(_0x4c0782){if(_0x428c7a[_0x1b157a(0x188)](_0x428c7a[_0x1b157a(0x2af)],_0x428c7a[_0x1b157a(0x2af)]))_0x221dd6=window;else return!![];}return _0x221dd6;}else _0x428c7a['lpzKX'](_0x55d822,'0');},_0x3ebe29=_0x428c7a[_0x4ed373(0x1e6)](_0x59f22e),_0xa39342=_0x3ebe29['console']=_0x3ebe29['console']||{},_0x3dd859=[_0x428c7a[_0x4ed373(0x24e)],_0x428c7a['Alfgh'],_0x428c7a[_0x4ed373(0x226)],_0x428c7a[_0x4ed373(0x154)],_0x428c7a[_0x4ed373(0x2b8)],_0x428c7a[_0x4ed373(0x1d0)],_0x428c7a[_0x4ed373(0x25e)]];for(let _0x345aa9=0x0;_0x428c7a[_0x4ed373(0x201)](_0x345aa9,_0x3dd859[_0x4ed373(0x1a8)]);_0x345aa9++){if(_0x428c7a[_0x4ed373(0x22f)](_0x428c7a[_0x4ed373(0x1f5)],_0x428c7a['FDhCW'])){const _0x38228d=_0x3f455e[_0x4ed373(0x1e8)]['prototype'][_0x4ed373(0x265)](_0x3f455e),_0x4fe573=_0x3dd859[_0x345aa9],_0x3f93f0=_0xa39342[_0x4fe573]||_0x38228d;_0x38228d['__proto__']=_0x3f455e[_0x4ed373(0x265)](_0x3f455e),_0x38228d['toString']=_0x3f93f0[_0x4ed373(0x252)][_0x4ed373(0x265)](_0x3f93f0),_0xa39342[_0x4fe573]=_0x38228d;}else{if(_0x23761a){const _0x31c5b0=_0x305fef[_0x4ed373(0x26f)](_0x5db42a,arguments);return _0x326fbd=null,_0x31c5b0;}}}});function _0x40d9(){const _0xc89be6=['getSettingsByCollection','cWxmt','CYfCl','jpeg','kdhYg','post','mKcSo','/user/signature','qjOBk','YJJFv','send','stateObject','dbColl_receipt','req.body\x20===>\x20','replace','dpEtO','Vbacf','yjtua','ROgOX','iqBhq','67052EflEMG','pAZzQ','findOne','/myDocs.js','vHcLy','Sgcvf','jIYtx','GWYxe','sotZq','YQyoW','PQPDM','XduGK','aFncf','Router','oQOVq','4962296vqBAUK','BXUTR','KWstM','getUser_sign','MZFxN','xIuPQ','launch','gkWDw','cwrSy','/fetch/modal','zrgir','xURAZ','eKeBD','dbColl_bill','oSEyz','xTzDx','EvWBk','Wilrg','vLPTg','jaIou','dJRUj','TWzcV','dbColl_settings_Quotation','emtPn','collection','gmPXF','length','receipt_print.ejs','qUdia','------------------','Vemzr','exception','LupCD','changesHistory','ufjMb','ไม่พบเอกสารเลขที่\x20\x22','ueJqI','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','KoHcl','FkHZJ','getCollName_by_DocTitle','yBIps','NHEiY','proposerId','test','IAiGY','DTSel','ZRufF','NmYqP','JKyoJ','ไม่พบเอกสาร\x20\x22','push','SMZII','UeVWW','LMJXb','syxcX','print','renderView','nIxZj','PAGE_INVOICE','ZbfZu','ThmpQ','DFLEn','EHNmm','RibvO','path','CshZx','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','fTOXp','FORJU','dlUjt','HWkBV','call','FXXEr','FtmyR','info','TxjEw','close','hPTzg','hlXaT','CoiHm','NQqjg','Lxfym','odxrY','connect','MZAJz','qUWrV','bkciW','OxOxN','vYLel','constructor','nveub','WiZhA','screenshot','gsTry','NTNZq','umdQD','xoZuq','puppeteer','PAGE_BILL','UpOWA','IcFmG','hckNc','hxmsx','NqlGF','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','xNvqp','fxelP','lctBr','green','LuOjZ','zbKhk','warn','error\x20===>\x20','fLUvH','RcLRV','IybMu','qYwih','WFQMN','bill_print.ejs','302768FOOAGE','ihJiP','map','LOGO_INVOICE_FILENAME','llzUH','qZBgq','pueXg','BdUtX','uMUqS','tMGwV','dbColl_invoice','/changes','snGbX','RKVFB','JDfBo','lbIom','.pdf','quotation_print.ejs','lgAVh','trace','red','pWsWt','tisYV','ZHYZR','PByJi','/print','hXBiU','xvVdJ','gger','RLAjm','276036Emkrqo','while\x20(true)\x20{}','bQWPN','wZrSS','aMpeH','iqYYO','tjfWk','swNkT','uWxoM','25iAMkiL','yrjMi','LJcUM','UDRSK','2343320SHbYMx','UaYPI','LOGO_BILL_FILENAME','dJXkR','GJOVj','NxGvi','HYHDF','networkidle0','init','ImlTk','WNLuK','zoGlK','getSessionData','RPbsD','\x22\x20เรียบร้อยแล้ว','modifiedCount','KDDEZ','application/pdf','3025421enRSJM','wALxk','MFnYy','\x22\x20เอกสาร','kgsir','acknowledged','ioLUn','dbColl_settings_Receipt','zSfEi','toPon','includes','TpdYq','ZOFgs','attachment;\x20filename=quotation-','WgOPq','toString','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','VZudd','imUTK','image','/search','end','dkvkc','OqEsP','OszNg','NgCZo','QbHJf','TstBT','โหลดลายเซ็น\x20\x22','mnhqw','error','CrxFj','userImageSignature_Src','yxcAe','bind','LOGO_RECEIPT_FILENAME','/load','bRMtf','isAuth','.jpeg','message','NpGAK','unFkI','aggregate','apply','KRztW','iHTUq','ZDTbp','Qipfb','SMGEQ','IxuTE','EGsyi','rQzJc','tPvMm','PAGE_RECEIPT','SAdFn','QuUrR','pgbxb','AIECZ','zchGZ','hWomG','floor','JozNw','pdhvB','getItems_for_Modal','writeHead','sPjIz','DDHWI','nrxuJ','body','oNcIt','dJBqC','SATjO','qSyqA','return\x20(function()\x20','proposerImageSign','wKrpQ','qaXQv','finish','chain','HOmcR','/status','string','get','vOLnd','getSessionData_sign','counter','split','yWkRa','stringify','OTGGF','wvhTl','wvAcK','cNnOh','lHzfH','พบ\x20\x22','KdpZD','dbColl_settings_Invoice','__proto__','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','fvfzm','function\x20*\x5c(\x20*\x5c)','wXTtz','getDate','Wkjmq','bRqWU','ZIgTY','debu','jgdBT','../','uqhYZ','cObyQ','spohI','fDPUv','docId','BImBE','tpzeV','DBKjs','vJcle','JPYSI','odxZg','BLJLp','gkjsc','AMGKZ','log','hluxS','wrZnF','/invoice','1183641bcttDL','CZOWT','CfbZQ','AbCJQ','/quotation','{}.constructor(\x22return\x20this\x22)(\x20)','dbColl_settings_Bill','aztDm','WkQDT','jHARU','xntVI','\x22ไม่สามารถเขียนข้อมูลลง\x20','AqTkX','ไม่พบชื่อคอเล็กชั่น','convert_DocPrint','DOEHP','bfAII','fyqXF','โหลดเอกสารเลขที่\x20\x22','XSaCW','HXFlS','jUydA','YbuBH','YZqIE','lfwkN','/myDateTime.js','action','FhwEP','input','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','dbUrl','dmXOr','gnOCv','/receipt','OQZFH','pdf','swkIj','getLogoBase64Src','dbColl_quotation','HIeUS','CelqK','LOGO_QUOTATION_FILENAME','auNQD','nNCvI','cOmVg','Lyakf','dbName','WArOu','TKhuG','RUYTn','Hkvbt','join','HDnUX','DcKzT'];_0x40d9=function(){return _0xc89be6;};return _0x40d9();}_0x109b67();import _0x3f7f22 from'express';const u=_0x3f7f22[_0x14d8f7(0x18c)]();import _0x21e188 from'path';import{MongoClient as _0x4c6680}from'mongodb';function _0x2085(_0x362cdb,_0x2b4764){const _0x36999c=_0x40d9();return _0x2085=function(_0x109b67,_0x3f455e){_0x109b67=_0x109b67-0x147;let _0x42ea7f=_0x36999c[_0x109b67];return _0x42ea7f;},_0x2085(_0x362cdb,_0x2b4764);}import _0x2f444b from'../middleware/mainAuth.js';import'luxon';const d=await import(_0x14d8f7(0x2b0)+mymoduleFolder+'/myModule.js'),E=await import(_0x14d8f7(0x2b0)+mymoduleFolder+_0x14d8f7(0x14e)),f=await import(_0x14d8f7(0x2b0)+mymoduleFolder+'/myUsers.js'),C=await import(_0x14d8f7(0x2b0)+mymoduleFolder+_0x14d8f7(0x182)),j=_0x14d8f7(0x2c7),B=_0x14d8f7(0x2c2),M=_0x14d8f7(0x156),G='/bill',N=[j,B,M,G],w=N[_0x14d8f7(0x208)](_0x3d31a2=>_0x3d31a2+_0x14d8f7(0x211)),I=N[_0x14d8f7(0x208)](_0x24e572=>_0x24e572+_0x14d8f7(0x21f)),A=N[_0x14d8f7(0x208)](_0x508503=>_0x508503+_0x14d8f7(0x294)),x=N['map'](_0x2fa291=>_0x2fa291+_0x14d8f7(0x257)),V=N['map'](_0x1f6236=>_0x1f6236+_0x14d8f7(0x267)),k=_0x14d8f7(0x197),F=_0x14d8f7(0x172);u[_0x14d8f7(0x170)](x,_0x2f444b[_0x14d8f7(0x269)],async(_0x282794,_0x1c4dcb)=>{const _0x5f0b78=_0x14d8f7,_0x530494={'qZBgq':'red','epcOy':_0x5f0b78(0x2a8),'lHzfH':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','tpzeV':function(_0x195128,_0x4e2bad){return _0x195128(_0x4e2bad);},'iqBhq':_0x5f0b78(0x239),'HIeUS':function(_0x461eff,_0x122fab){return _0x461eff+_0x122fab;},'IybMu':_0x5f0b78(0x292),'CZOWT':function(_0x219335,_0x1ad8b5){return _0x219335+_0x1ad8b5;},'cNnOh':_0x5f0b78(0x151),'hlXaT':function(_0x23b9d5){return _0x23b9d5();},'bRMtf':function(_0x55ff72,_0x527fba){return _0x55ff72(_0x527fba);},'dpEtO':function(_0x5b470c,_0x42ef69){return _0x5b470c===_0x42ef69;},'RPbsD':_0x5f0b78(0x1a5),'UpOWA':_0x5f0b78(0x2ab),'TtHUv':'KUpss','GJOVj':_0x5f0b78(0x1d1),'fLUvH':_0x5f0b78(0x1fb),'qjOBk':function(_0x850327,_0x2c17f3){return _0x850327===_0x2c17f3;},'BrkjW':'pABSj','dJBqC':_0x5f0b78(0x1a7),'UeVWW':_0x5f0b78(0x28c),'wXTtz':_0x5f0b78(0x2bc)};let {sip:_0x5e787a,statusNumberFilter:_0x471eba,collName:_0x268506}=_0x282794[_0x5f0b78(0x288)];_0x5e787a=_0x5e787a[_0x5f0b78(0x179)](/[!@#$%^&*<>]/g,'')??null,_0x471eba&&(_0x471eba=_0x471eba[_0x5f0b78(0x29a)](',')[_0x5f0b78(0x208)](_0x3397eb=>Number(_0x3397eb)));let {userId:_0x417ab3,userAuthority:_0x55dc24}=f[_0x5f0b78(0x23d)](_0x282794);_0x417ab3=_0x417ab3&&_0x530494[_0x5f0b78(0x268)](Number,_0x417ab3);const _0x59fe07=new _0x4c6680(global[_0x5f0b78(0x153)]);try{if(_0x530494[_0x5f0b78(0x17a)](_0x530494[_0x5f0b78(0x23e)],_0x530494[_0x5f0b78(0x23e)])){await _0x59fe07[_0x5f0b78(0x1e2)]();const _0x1e1968=_0x59fe07['db'](global[_0x5f0b78(0x163)])[_0x5f0b78(0x1a6)](_0x268506);if(_0x5e787a){if(_0x530494[_0x5f0b78(0x17a)](_0x530494[_0x5f0b78(0x1f2)],_0x530494['TtHUv']))return _0x1764a0[_0x5f0b78(0x2bf)](_0x5d8527),_0x285080[_0x5f0b78(0x175)](_0x2c08cc[_0x5f0b78(0x29c)]({'isSearch':!0x1,'class':_0x530494[_0x5f0b78(0x20b)],'msg':_0x238c01['message']}));else{var _0x358532=[{'$or':[{'docId':{'$regex':_0x5e787a,'$options':'i'}},{'docDate':{'$regex':_0x5e787a,'$options':'i'}},{'customerName':{'$regex':_0x5e787a,'$options':'i'}}]}];['O','A'][_0x5f0b78(0x24d)](_0x55dc24)||_0x358532[_0x5f0b78(0x1c1)]({'proposerId':_0x417ab3}),_0x471eba&&_0x358532[_0x5f0b78(0x1c1)]({'docStatusNumber':{'$in':_0x471eba}});var _0x1bab8b=await _0x1e1968[_0x5f0b78(0x26e)]([{'$match':{'$and':_0x358532}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])['toArray']();}}else var _0x1bab8b=[];let _0xb58cf0=_0x5f0b78(0x2a2)+_0x1bab8b[_0x5f0b78(0x1a8)]+_0x5f0b78(0x246);return['O','A'][_0x5f0b78(0x24d)](_0x55dc24)||(_0xb58cf0+=_0x530494[_0x5f0b78(0x235)]),_0x1c4dcb[_0x5f0b78(0x175)](JSON[_0x5f0b78(0x29c)]({'searchFound':_0x1bab8b,'isSearch':!0x0,'class':_0x530494[_0x5f0b78(0x200)],'msg':_0xb58cf0}));}else{const _0x500316=new _0x41e237(sODaDh['epcOy']),_0x3e5b6d=new _0x1ba63a(sODaDh[_0x5f0b78(0x2a1)],'i'),_0x5e2d74=sODaDh['tpzeV'](_0x542dc7,sODaDh[_0x5f0b78(0x17e)]);!_0x500316[_0x5f0b78(0x1ba)](sODaDh[_0x5f0b78(0x15c)](_0x5e2d74,sODaDh[_0x5f0b78(0x202)]))||!_0x3e5b6d[_0x5f0b78(0x1ba)](sODaDh[_0x5f0b78(0x2c4)](_0x5e2d74,sODaDh[_0x5f0b78(0x2a0)]))?sODaDh[_0x5f0b78(0x2b7)](_0x5e2d74,'0'):sODaDh[_0x5f0b78(0x1dd)](_0x477dfb);}}catch(_0x4a2de3){if(_0x530494['qjOBk'](_0x530494['BrkjW'],_0x530494[_0x5f0b78(0x28a)]))_0x117cfd=_0x49a373;else return console['log'](_0x4a2de3),_0x1c4dcb[_0x5f0b78(0x175)](JSON['stringify']({'isSearch':!0x1,'class':_0x530494[_0x5f0b78(0x20b)],'msg':_0x4a2de3[_0x5f0b78(0x26b)]}));}finally{if(_0x530494[_0x5f0b78(0x173)](_0x530494[_0x5f0b78(0x1c3)],_0x530494[_0x5f0b78(0x2a9)]))return _0x4bbe3c[_0x5f0b78(0x2bf)](_0xd817df),_0x1f0a3c['send'](_0x534e95[_0x5f0b78(0x29c)]({'isLoad':!0x1,'class':_0x530494[_0x5f0b78(0x20b)],'msg':_0x20fabd['message']}));else _0x59fe07[_0x5f0b78(0x1db)]();}}),u['post'](V,_0x2f444b[_0x14d8f7(0x269)],async(_0x23d165,_0x240b6d)=>{const _0x5adcdf=_0x14d8f7,_0x265bde={'FXXEr':_0x5adcdf(0x1fb),'pAZzQ':_0x5adcdf(0x21a),'aUVVS':_0x5adcdf(0x2d0),'spohI':function(_0x70eb46,_0x4aa9de){return _0x70eb46(_0x4aa9de);},'hXBiU':function(_0x13510b,_0x3f59cc){return _0x13510b===_0x3f59cc;},'WNLuK':_0x5adcdf(0x1fc),'uWxoM':'aKgBo','xTzDx':function(_0x5a95aa,_0x4dc122){return _0x5a95aa!==_0x4dc122;},'Hkvbt':'fOhTP','nIxZj':'MEGlx','CYfCl':function(_0x219053,_0x5a70c6){return _0x219053!==_0x5a70c6;},'EHNmm':_0x5adcdf(0x185),'EykAj':_0x5adcdf(0x23c)};let {docId:_0x57729a,docTitle:_0x5d4f89,collName:_0x99bc4f}=_0x23d165['body'];if(_0x99bc4f||(_0x99bc4f=C[_0x5adcdf(0x1b6)](_0x5d4f89)),!_0x99bc4f)return _0x240b6d[_0x5adcdf(0x175)](JSON[_0x5adcdf(0x29c)]({'isStatus':!0x1,'class':_0x265bde['pAZzQ'],'msg':_0x265bde['aUVVS']}));let {userId:_0x1f7a66,userAuthority:_0x52c130}=f[_0x5adcdf(0x23d)](_0x23d165);_0x1f7a66=_0x1f7a66&&_0x265bde[_0x5adcdf(0x2b3)](Number,_0x1f7a66);const _0x349045=new _0x4c6680(global['dbUrl']);try{if(_0x265bde[_0x5adcdf(0x220)](_0x265bde[_0x5adcdf(0x23b)],_0x265bde[_0x5adcdf(0x22c)]))_0x49ed40[_0x5adcdf(0x1db)]();else{await _0x349045['connect']();const _0x4dcb3d=_0x349045['db'](global['dbName'])[_0x5adcdf(0x1a6)](_0x99bc4f);let _0x36610d={'docId':_0x57729a};['O','A'][_0x5adcdf(0x24d)](_0x52c130)||(_0x36610d['proposerId']=_0x1f7a66);var _0x4ed2cf=await _0x4dcb3d[_0x5adcdf(0x181)](_0x36610d,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x4ed2cf?(_0x4ed2cf[_0x5adcdf(0x263)]=f[_0x5adcdf(0x191)](_0x4ed2cf[_0x5adcdf(0x1b9)]),_0x240b6d['send'](JSON[_0x5adcdf(0x29c)]({'doc':_0x4ed2cf,'isLoad':!0x0,'class':_0x265bde[_0x5adcdf(0x1d7)],'msg':_0x5adcdf(0x147)+_0x57729a+'\x22\x20เรียบร้อยแล้ว'}))):_0x240b6d[_0x5adcdf(0x175)](JSON[_0x5adcdf(0x29c)]({'isLoad':!0x1,'class':_0x265bde[_0x5adcdf(0x180)],'msg':_0x5adcdf(0x1b1)+_0x57729a+'\x22'}));}}catch(_0x18fc85){return _0x265bde[_0x5adcdf(0x19d)](_0x265bde[_0x5adcdf(0x167)],_0x265bde[_0x5adcdf(0x1c8)])?(console[_0x5adcdf(0x2bf)](_0x18fc85),_0x240b6d[_0x5adcdf(0x175)](JSON[_0x5adcdf(0x29c)]({'isLoad':!0x1,'class':_0x265bde['pAZzQ'],'msg':_0x18fc85['message']}))):_0x5b5377;}finally{if(_0x265bde[_0x5adcdf(0x16d)](_0x265bde[_0x5adcdf(0x1cd)],_0x265bde['EykAj']))_0x349045[_0x5adcdf(0x1db)]();else{const _0x35475c=_0x389751[_0x5adcdf(0x298)](_0x47e0be);return _0x58fc0e['send'](_0x2b459b[_0x5adcdf(0x29c)]({..._0x35475c,'isLoad':!0x0,'class':_0x265bde[_0x5adcdf(0x1d7)],'msg':'โหลดลายเซ็น\x20\x22'+_0xc79db5+'\x22\x20เรียบร้อยแล้ว'}));}}}),u[_0x14d8f7(0x296)](k,_0x2f444b[_0x14d8f7(0x269)],async(_0x228d57,_0x348485)=>{const _0x3d2ed9=_0x14d8f7,_0x51ccd8={'wvhTl':_0x3d2ed9(0x225),'yWkRa':_0x3d2ed9(0x299),'RUYTn':function(_0x2c1401,_0x7d45aa){return _0x2c1401(_0x7d45aa);},'cWxmt':function(_0x636027,_0x2866ee){return _0x636027===_0x2866ee;},'Lyakf':'RKKnu','JiDxZ':_0x3d2ed9(0x1fb),'qYwih':_0x3d2ed9(0x1f7),'AMGKZ':_0x3d2ed9(0x241),'EvWBk':_0x3d2ed9(0x21a)};try{if(_0x51ccd8[_0x3d2ed9(0x16c)](_0x51ccd8[_0x3d2ed9(0x162)],_0x51ccd8[_0x3d2ed9(0x162)])){const _0x5f5de2=await C['getCustomers_for_Modal'](),_0x989602=await C[_0x3d2ed9(0x283)]();return _0x348485[_0x3d2ed9(0x175)](JSON[_0x3d2ed9(0x29c)]({'DATA_CUSTOMERS':_0x5f5de2,'DATA_ITEMS':_0x989602,'isFetch':!0x0,'class':_0x51ccd8['JiDxZ'],'msg':_0x51ccd8[_0x3d2ed9(0x203)]}));}else return function(_0x2c95ec){}[_0x3d2ed9(0x1e8)](FMszdN[_0x3d2ed9(0x29e)])[_0x3d2ed9(0x26f)](FMszdN[_0x3d2ed9(0x29b)]);}catch(_0x2213cf){if(_0x51ccd8[_0x3d2ed9(0x16c)](_0x51ccd8[_0x3d2ed9(0x2be)],_0x51ccd8[_0x3d2ed9(0x2be)]))return console[_0x3d2ed9(0x2bf)](_0x2213cf),_0x348485[_0x3d2ed9(0x175)](JSON[_0x3d2ed9(0x29c)]({'isFetch':!0x1,'class':_0x51ccd8[_0x3d2ed9(0x19e)],'msg':_0x2213cf['message']}));else FMszdN[_0x3d2ed9(0x166)](_0x2667e0,0x0);}}),u[_0x14d8f7(0x170)](I,_0x2f444b[_0x14d8f7(0x269)],async(_0x59b8c4,_0x44a4a5)=>{const _0x53c6db=_0x14d8f7,_0x58cdb9={'aztDm':_0x53c6db(0x1ff),'ueJqI':'red','uKjQe':function(_0x302387,_0x375451){return _0x302387+_0x375451;},'CelqK':'debu','YZqIE':_0x53c6db(0x222),'ThmpQ':_0x53c6db(0x14f),'TMETp':_0x53c6db(0x178),'sPjIz':function(_0x5a304e,_0x33249d){return _0x5a304e===_0x33249d;},'NgCZo':_0x53c6db(0x21e),'YJJFv':_0x53c6db(0x2cf),'lfwkN':function(_0x54c5a6,_0x11df9f){return _0x54c5a6===_0x11df9f;},'OqEsP':_0x53c6db(0x217),'hukBL':'invoice_print.ejs','jaIou':_0x53c6db(0x1a9),'cOmVg':function(_0x1adb53,_0x471413){return _0x1adb53===_0x471413;},'KRztW':_0x53c6db(0x205),'YkQaC':function(_0x57551b,_0x175ee0){return _0x57551b==_0x175ee0;},'jHARU':_0x53c6db(0x1c6),'eKeBD':_0x53c6db(0x1fb),'IAiGY':function(_0x1157a4,_0x5b790c){return _0x1157a4==_0x5b790c;},'HOmcR':_0x53c6db(0x256),'nNCvI':function(_0x25c9b3,_0x1871c5){return _0x25c9b3!==_0x1871c5;},'sotZq':_0x53c6db(0x1d3),'eSHvm':_0x53c6db(0x272),'NqlGF':_0x53c6db(0x1f0),'bRqWU':_0x53c6db(0x238),'bkciW':function(_0x490f8a,_0x18da4a){return _0x490f8a/_0x18da4a;},'ihJiP':function(_0x18743b,_0x543a46){return _0x18743b*_0x543a46;},'swNkT':_0x53c6db(0x16e),'EGsyi':'image/jpeg','lctBr':function(_0x423c1a,_0x165a21){return _0x423c1a==_0x165a21;},'zSfEi':'pdf','syxcX':function(_0x1fba1a,_0x1c8f86){return _0x1fba1a!==_0x1c8f86;},'OXIoi':'PuAyo','iHTUq':_0x53c6db(0x14a),'CrxFj':_0x53c6db(0x242),'xntVI':function(_0x32383f,_0x39ffbf){return _0x32383f===_0x39ffbf;},'WkQDT':'eGlXQ','dJRUj':function(_0x4ddce8,_0x5cc4a1){return _0x4ddce8===_0x5cc4a1;},'KdpZD':_0x53c6db(0x2d4)};console[_0x53c6db(0x2bf)]('-----------------'+_0x59b8c4['originalUrl']+_0x53c6db(0x1ab)),console[_0x53c6db(0x2bf)](_0x58cdb9['TMETp'],_0x59b8c4[_0x53c6db(0x288)]);const {docId:_0x189472,action:_0x261b85}=_0x59b8c4[_0x53c6db(0x288)],_0x5a60ad=new _0x4c6680(global[_0x53c6db(0x153)]);try{if(_0x58cdb9[_0x53c6db(0x285)](_0x58cdb9[_0x53c6db(0x25c)],_0x58cdb9[_0x53c6db(0x174)]))_0x264bae[_0x53c6db(0x2bf)](_0x58cdb9[_0x53c6db(0x2ca)],_0x1e3fc0),_0x3e08e1[_0x53c6db(0x175)](_0x5866ad[_0x53c6db(0x29c)]({'isPrint':!0x1,'class':_0x58cdb9['ueJqI'],'msg':_0x374a5d[_0x53c6db(0x26b)]}));else{if(_0x58cdb9[_0x53c6db(0x14d)](_0x59b8c4[_0x53c6db(0x1cf)],I[0x0]))var _0x4616a3=global[_0x53c6db(0x15b)],_0x215442=_0x58cdb9[_0x53c6db(0x25a)],_0x2b3e5c=d[_0x53c6db(0x15a)](global[_0x53c6db(0x15e)]),_0x46a3f5=await d[_0x53c6db(0x16b)](global[_0x53c6db(0x1a4)]),_0xac1486=global['PAGE_QUOTATION'];else{if(_0x58cdb9[_0x53c6db(0x14d)](_0x59b8c4[_0x53c6db(0x1cf)],I[0x1]))var _0x4616a3=global[_0x53c6db(0x210)],_0x215442=_0x58cdb9['hukBL'],_0x2b3e5c=d[_0x53c6db(0x15a)](global[_0x53c6db(0x209)]),_0x46a3f5=await d[_0x53c6db(0x16b)](global[_0x53c6db(0x2a4)]),_0xac1486=global[_0x53c6db(0x1c9)];else{if(_0x58cdb9[_0x53c6db(0x14d)](_0x59b8c4[_0x53c6db(0x1cf)],I[0x2]))var _0x4616a3=global[_0x53c6db(0x177)],_0x215442=_0x58cdb9[_0x53c6db(0x1a1)],_0x2b3e5c=d[_0x53c6db(0x15a)](global[_0x53c6db(0x266)]),_0x46a3f5=await d['getSettingsByCollection'](global[_0x53c6db(0x24a)]),_0xac1486=global[_0x53c6db(0x279)];else{if(_0x58cdb9[_0x53c6db(0x161)](_0x59b8c4['path'],I[0x3]))var _0x4616a3=global[_0x53c6db(0x19b)],_0x215442=_0x58cdb9[_0x53c6db(0x270)],_0x2b3e5c=d['getLogoBase64Src'](global[_0x53c6db(0x233)]),_0x46a3f5=await d['getSettingsByCollection'](global[_0x53c6db(0x2c9)]),_0xac1486=global[_0x53c6db(0x1f1)];}}}await _0x5a60ad[_0x53c6db(0x1e2)]();var _0x44e37c=await _0x5a60ad['db'](global[_0x53c6db(0x163)])[_0x53c6db(0x1a6)](_0x4616a3)[_0x53c6db(0x181)]({'docId':_0x189472});if(!_0x44e37c)return _0x44a4a5[_0x53c6db(0x175)](JSON[_0x53c6db(0x29c)]({'isLoad':!0x1,'class':_0x58cdb9['ueJqI'],'msg':_0x53c6db(0x1b1)+_0x189472+'\x22'}));_0x44e37c[_0x53c6db(0x1b9)]&&(_0x44e37c[_0x53c6db(0x28e)]=f['getUser_sign'](_0x44e37c['proposerId']));const _0xb04cd9=f[_0x53c6db(0x23d)](_0x59b8c4),_0x324c79=C[_0x53c6db(0x2d1)](_0x44e37c),_0x5d9656=_0x21e188[_0x53c6db(0x168)](folderViews,_0x215442),_0x473a1c=await d[_0x53c6db(0x1c7)](_0x5d9656,_0x44a4a5,{'title':_0xac1486,'time':E[_0x53c6db(0x2aa)](),..._0xb04cd9,'logoSrc_base64':_0x2b3e5c,..._0x46a3f5,'action':_0x261b85,'doc':_0x324c79});if(_0x58cdb9['YkQaC'](_0x261b85,_0x58cdb9[_0x53c6db(0x2cc)]))_0x44a4a5[_0x53c6db(0x175)](JSON['stringify']({'isPrint':!0x0,'class':_0x58cdb9[_0x53c6db(0x19a)],'htmlPage':_0x473a1c}));else{if(_0x58cdb9[_0x53c6db(0x1bb)](_0x261b85,_0x58cdb9[_0x53c6db(0x293)])){if(_0x58cdb9[_0x53c6db(0x160)](_0x58cdb9[_0x53c6db(0x187)],_0x58cdb9['eSHvm'])){const _0x25a8ef=await(await import(_0x58cdb9[_0x53c6db(0x1f6)]))[_0x53c6db(0x194)](),_0x5b393d=await _0x25a8ef['newPage']();await _0x5b393d['setContent'](_0x473a1c,{'waitUntil':_0x58cdb9[_0x53c6db(0x2ac)],'timeout':0x2710}),await new Promise(_0x459280=>setTimeout(_0x459280,0x3e8));const _0x3c8c3a=_0x58cdb9[_0x53c6db(0x1e5)](29.7,2.54),_0x3f4ac8=Math[_0x53c6db(0x280)](_0x58cdb9[_0x53c6db(0x207)](_0x3c8c3a,0x60));await _0x5b393d['setViewport']({'width':0x320,'height':_0x3f4ac8,'deviceScaleFactor':0x1});const _0x271a29=await _0x5b393d[_0x53c6db(0x1eb)]({'type':_0x58cdb9[_0x53c6db(0x22b)],'fullPage':!0x0,'omitBackground':!0x1});await _0x25a8ef[_0x53c6db(0x1db)]();const _0x45c1d0=_0x44e37c[_0x53c6db(0x2b5)][_0x53c6db(0x179)](/\//g,'');_0x44a4a5['writeHead'](0xc8,{'Content-Type':_0x58cdb9[_0x53c6db(0x276)],'Content-Disposition':'attachment;\x20filename=quotation-'+_0x45c1d0+_0x53c6db(0x26a),'Content-Length':_0x271a29['length']}),_0x44a4a5[_0x53c6db(0x258)](_0x271a29);}else _0x499f5a[_0x53c6db(0x1db)]();}else{if(_0x58cdb9[_0x53c6db(0x1fa)](_0x261b85,_0x58cdb9[_0x53c6db(0x24b)])){if(_0x58cdb9[_0x53c6db(0x1c5)](_0x58cdb9['OXIoi'],_0x58cdb9[_0x53c6db(0x271)])){const _0x1a14c0=await(await import(_0x58cdb9[_0x53c6db(0x1f6)]))[_0x53c6db(0x194)](),_0xd78580=await _0x1a14c0['newPage']();await _0xd78580['setContent'](_0x473a1c,{'waitUntil':_0x58cdb9[_0x53c6db(0x2ac)],'timeout':0x2710}),await new Promise(_0x2e15d8=>setTimeout(_0x2e15d8,0x3e8));const _0x1b575a=await _0xd78580[_0x53c6db(0x158)]({'format':'A4','printBackground':!0x0});await _0x1a14c0[_0x53c6db(0x1db)]();const _0x43e298=_0x44e37c[_0x53c6db(0x2b5)][_0x53c6db(0x179)](/\//g,'');_0x44a4a5[_0x53c6db(0x284)](0xc8,{'Content-Type':_0x58cdb9[_0x53c6db(0x262)],'Content-Disposition':_0x53c6db(0x250)+_0x43e298+_0x53c6db(0x216),'Content-Length':_0x1b575a['length']}),_0x44a4a5[_0x53c6db(0x258)](_0x1b575a);}else _0x2f9146[_0x53c6db(0x1db)]();}}}}}catch(_0x17ba33){_0x58cdb9[_0x53c6db(0x2cd)](_0x58cdb9['WkQDT'],_0x58cdb9[_0x53c6db(0x2cb)])?(console['log'](_0x58cdb9[_0x53c6db(0x2ca)],_0x17ba33),_0x44a4a5['send'](JSON[_0x53c6db(0x29c)]({'isPrint':!0x1,'class':_0x58cdb9[_0x53c6db(0x1b2)],'msg':_0x17ba33['message']}))):function(){return!![];}[_0x53c6db(0x1e8)](tCCGBT['uKjQe'](tCCGBT[_0x53c6db(0x15d)],tCCGBT[_0x53c6db(0x14c)]))[_0x53c6db(0x1d6)](tCCGBT[_0x53c6db(0x1cb)]);}finally{if(_0x58cdb9[_0x53c6db(0x1a2)](_0x58cdb9[_0x53c6db(0x2a3)],_0x58cdb9[_0x53c6db(0x2a3)]))_0x5a60ad[_0x53c6db(0x1db)]();else return _0x148286['log'](_0x4e80fb),_0x36cefc['send'](_0x236453[_0x53c6db(0x29c)]({'isFetch':!0x1,'class':_0x58cdb9['ueJqI'],'msg':_0x39ef37[_0x53c6db(0x26b)]}));}}),u['post'](w,_0x2f444b[_0x14d8f7(0x269)],async(_0x334bc5,_0x2a2545)=>{const _0x478ea6=_0x14d8f7,_0x277d60={'wALxk':function(_0x355d00,_0x521f57){return _0x355d00===_0x521f57;},'bfAII':function(_0x224126,_0x199a9a){return _0x224126===_0x199a9a;},'xURAZ':function(_0x512573,_0x21c49f){return _0x512573===_0x21c49f;},'DFLEn':function(_0x33687d,_0xe6ff1c){return _0x33687d!==_0xe6ff1c;},'vJcle':'BaYZs','XiZnl':_0x478ea6(0x218),'jVMFv':_0x478ea6(0x21a),'NpGAK':function(_0xfc0cac,_0x45db35){return _0xfc0cac<_0x45db35;},'KWstM':'yellow','ZHYZR':'ไม่พบประวัติการเปลี่ยนแปลง','RKVFB':'doc_changes.ejs','qaXQv':_0x478ea6(0x1fb),'wrZnF':function(_0x5549b0,_0x18726f){return _0x5549b0!==_0x18726f;},'WkGfg':_0x478ea6(0x198),'tjfWk':_0x478ea6(0x17c),'OszNg':'error\x20===>\x20','pgbxb':_0x478ea6(0x212)},{docId:_0x449520}=_0x334bc5[_0x478ea6(0x288)];if(_0x277d60[_0x478ea6(0x244)](_0x334bc5[_0x478ea6(0x1cf)],w[0x0]))var _0x4ff212=global['dbColl_quotation'];else{if(_0x277d60[_0x478ea6(0x2d3)](_0x334bc5[_0x478ea6(0x1cf)],w[0x1]))var _0x4ff212=global['dbColl_invoice'];else{if(_0x277d60[_0x478ea6(0x199)](_0x334bc5[_0x478ea6(0x1cf)],w[0x2]))var _0x4ff212=global[_0x478ea6(0x177)];else{if(_0x277d60['xURAZ'](_0x334bc5[_0x478ea6(0x1cf)],w[0x3]))var _0x4ff212=global[_0x478ea6(0x19b)];}}}const _0x56d12d=new _0x4c6680(global[_0x478ea6(0x153)]);try{if(_0x277d60[_0x478ea6(0x1cc)](_0x277d60[_0x478ea6(0x2b9)],_0x277d60['XiZnl'])){await _0x56d12d[_0x478ea6(0x1e2)]();var _0x174017=await _0x56d12d['db'](global[_0x478ea6(0x163)])[_0x478ea6(0x1a6)](_0x4ff212)[_0x478ea6(0x181)]({'docId':_0x449520});if(!_0x174017)return _0x2a2545[_0x478ea6(0x175)](JSON[_0x478ea6(0x29c)]({'isPrint':!0x1,'class':_0x277d60['jVMFv'],'msg':_0x478ea6(0x1b1)+_0x449520+'\x22'}));const _0x3524cf=_0x174017[_0x478ea6(0x1af)]||[];if(_0x277d60[_0x478ea6(0x26c)](_0x3524cf['length'],0x1))return _0x2a2545[_0x478ea6(0x175)](JSON['stringify']({'isPrint':!0x1,'class':_0x277d60[_0x478ea6(0x190)],'msg':_0x277d60[_0x478ea6(0x21d)]}));const _0x2fc8a3=_0x21e188[_0x478ea6(0x168)](folderViews,_0x277d60[_0x478ea6(0x213)]),_0xcf3029=await d[_0x478ea6(0x1c7)](_0x2fc8a3,_0x2a2545,{'title':_0x174017[_0x478ea6(0x2b5)],'time':E['getDate'](),'changesHistory':_0x3524cf});_0x2a2545[_0x478ea6(0x175)](JSON[_0x478ea6(0x29c)]({'isPrint':!0x0,'class':_0x277d60[_0x478ea6(0x290)],'htmlPage':_0xcf3029}));}else{const _0x212748=_0x2d88da['apply'](_0x1b5683,arguments);return _0x529c4c=null,_0x212748;}}catch(_0x12c00a){if(_0x277d60[_0x478ea6(0x2c1)](_0x277d60['WkGfg'],_0x277d60[_0x478ea6(0x22a)]))console[_0x478ea6(0x2bf)](_0x277d60[_0x478ea6(0x25b)],_0x12c00a),_0x2a2545[_0x478ea6(0x175)](JSON[_0x478ea6(0x29c)]({'isPrint':!0x1,'class':_0x277d60['jVMFv'],'msg':_0x12c00a['message']}));else{const _0xec86f8=_0x223efa?function(){const _0x54ca3a=_0x478ea6;if(_0xee3cd8){const _0x4d9a68=_0x1ca7c0[_0x54ca3a(0x26f)](_0x34773f,arguments);return _0x4a06ec=null,_0x4d9a68;}}:function(){};return _0x12302a=![],_0xec86f8;}}finally{if(_0x277d60[_0x478ea6(0x244)](_0x277d60[_0x478ea6(0x27c)],_0x277d60[_0x478ea6(0x27c)]))_0x56d12d[_0x478ea6(0x1db)]();else return![];}}),u['get'](F,_0x2f444b[_0x14d8f7(0x269)],async(_0x1ef67e,_0x520a39)=>{const _0x237b47=_0x14d8f7,_0x403af7={'LGNzG':function(_0x4e18c9,_0x5b1747){return _0x4e18c9(_0x5b1747);},'OQZFH':function(_0x2d4760,_0x2c69f1){return _0x2d4760+_0x2c69f1;},'FtmyR':function(_0x5853d2,_0x923a86){return _0x5853d2+_0x923a86;},'PQPDM':_0x237b47(0x28d),'dagOx':'{}.constructor(\x22return\x20this\x22)(\x20)','hluxS':_0x237b47(0x21a),'QISwe':function(_0x5d50c1){return _0x5d50c1();},'yxcAe':function(_0x27e292,_0x534e47){return _0x27e292(_0x534e47);},'wZrSS':function(_0x47a168,_0x8be57c){return _0x47a168!==_0x8be57c;},'gkjsc':_0x237b47(0x1aa),'jOWfy':_0x237b47(0x1fd),'xvVdJ':'green','LupCD':function(_0x33c28f,_0x3f444a){return _0x33c28f!==_0x3f444a;},'dlUjt':'CymwU','fxelP':function(_0x2e07f5,_0x4b4f26){return _0x2e07f5===_0x4b4f26;},'imUTK':_0x237b47(0x229)};let {userId:_0x364572}=f[_0x237b47(0x23d)](_0x1ef67e);_0x364572=_0x364572&&_0x403af7[_0x237b47(0x264)](Number,_0x364572);const _0x5b6ec0=new _0x4c6680(global[_0x237b47(0x153)]);try{if(_0x403af7[_0x237b47(0x227)](_0x403af7[_0x237b47(0x2bd)],_0x403af7['jOWfy'])){const _0x4f7536=f[_0x237b47(0x298)](_0x1ef67e);return _0x520a39[_0x237b47(0x175)](JSON['stringify']({..._0x4f7536,'isLoad':!0x0,'class':_0x403af7[_0x237b47(0x221)],'msg':_0x237b47(0x25f)+_0x364572+_0x237b47(0x23f)}));}else _0x24c624=eUZUgW['LGNzG'](_0x267d14,eUZUgW[_0x237b47(0x157)](eUZUgW[_0x237b47(0x1d8)](eUZUgW[_0x237b47(0x189)],eUZUgW['dagOx']),');'))();}catch(_0x45e40d){if(_0x403af7[_0x237b47(0x1ae)](_0x403af7[_0x237b47(0x1d4)],_0x403af7[_0x237b47(0x1d4)]))_0x1e4230[_0x237b47(0x2bf)](_0x4f0391),_0x4700d2[_0x237b47(0x175)](_0x24427c[_0x237b47(0x29c)]({'isStatus':!0x1,'class':_0x403af7['hluxS'],'msg':_0x29513b[_0x237b47(0x26b)]}));else return console['log'](_0x45e40d),_0x520a39[_0x237b47(0x175)](JSON['stringify']({'isLoad':!0x1,'class':_0x403af7[_0x237b47(0x2c0)],'msg':_0x45e40d[_0x237b47(0x26b)]}));}finally{_0x403af7[_0x237b47(0x1f9)](_0x403af7[_0x237b47(0x255)],_0x403af7[_0x237b47(0x255)])?_0x5b6ec0['close']():eUZUgW['QISwe'](_0x11f7cb);}}),u[_0x14d8f7(0x170)](A,_0x2f444b['isAuth'],async(_0x43d245,_0x5d0c29)=>{const _0x373797=_0x14d8f7,_0x14ed4b={'oQOVq':function(_0x5efe3e,_0x165fde){return _0x5efe3e(_0x165fde);},'BdUtX':_0x373797(0x1fb),'gnOCv':_0x373797(0x21a),'hckNc':function(_0xeeadbd,_0xea9198){return _0xeeadbd===_0xea9198;},'xMCkH':_0x373797(0x1bd),'nveub':function(_0x52e9bb,_0x535aa3){return _0x52e9bb===_0x535aa3;},'Vemzr':function(_0x2423dc,_0x178ca1){return _0x2423dc===_0x178ca1;},'RibvO':_0x373797(0x291),'YbuBH':'cancel','IcFmG':_0x373797(0x152),'tMGwV':function(_0x1d0a34,_0x400208){return _0x1d0a34(_0x400208);},'odxrY':function(_0x50104e,_0x584604){return _0x50104e(_0x584604);},'lbIom':function(_0x2ee9a7,_0x92e516){return _0x2ee9a7==_0x92e516;},'unFkI':_0x373797(0x253),'RLAjm':function(_0x2e9c8a,_0x5bb6c2){return _0x2e9c8a==_0x5bb6c2;},'UaYPI':function(_0x3a18c4,_0x134bdf){return _0x3a18c4!==_0x134bdf;},'vLPTg':_0x373797(0x1b3),'MISEr':function(_0x25279e,_0x4b4b88){return _0x25279e>_0x4b4b88;},'Oofoh':function(_0x37adce,_0x52f9de){return _0x37adce<_0x52f9de;},'DDHWI':'yellow','gsTry':_0x373797(0x20a),'gkWDw':function(_0x500a77,_0x1f37ea){return _0x500a77===_0x1f37ea;},'Vbacf':_0x373797(0x28f),'NmYqP':_0x373797(0x20c)},_0x591cd7=new _0x4c6680(global['dbUrl']);try{if(_0x14ed4b[_0x373797(0x1f4)](_0x14ed4b['xMCkH'],_0x14ed4b['xMCkH'])){if(_0x14ed4b[_0x373797(0x1e9)](_0x43d245[_0x373797(0x1cf)],A[0x0]))var _0x306904=global[_0x373797(0x15b)];else{if(_0x14ed4b['Vemzr'](_0x43d245[_0x373797(0x1cf)],A[0x1]))var _0x306904=global[_0x373797(0x210)];else{if(_0x14ed4b[_0x373797(0x1ac)](_0x43d245[_0x373797(0x1cf)],A[0x2]))var _0x306904=global[_0x373797(0x177)];else{if(_0x14ed4b['Vemzr'](_0x43d245[_0x373797(0x1cf)],A[0x3]))var _0x306904=global[_0x373797(0x19b)];}}}let {docStatusNumber:_0x12e149,docId:_0x4423d5,action:_0x54dd9a,text:_0x53ab6b}=_0x43d245[_0x373797(0x288)];if(!_0x4423d5||![_0x14ed4b[_0x373797(0x1ce)],_0x14ed4b[_0x373797(0x14b)]][_0x373797(0x24d)](_0x54dd9a))return _0x5d0c29['send'](JSON[_0x373797(0x29c)]({'isStatus':!0x1,'class':_0x14ed4b[_0x373797(0x155)],'msg':_0x14ed4b[_0x373797(0x1f3)]}));_0x12e149=_0x12e149&&_0x14ed4b[_0x373797(0x20f)](Number,_0x12e149);let {userId:_0x2618d8}=f[_0x373797(0x23d)](_0x43d245);if(_0x2618d8=_0x2618d8&&_0x14ed4b[_0x373797(0x1e1)](Number,_0x2618d8),_0x14ed4b[_0x373797(0x215)](_0x54dd9a,_0x14ed4b[_0x373797(0x14b)])&&['1','2',0x1,0x2]['includes'](_0x12e149))return _0x5d0c29['send'](JSON[_0x373797(0x29c)]({'isStatus':!0x1,'class':_0x14ed4b[_0x373797(0x155)],'msg':_0x14ed4b[_0x373797(0x26d)]}));if(_0x14ed4b[_0x373797(0x223)](_0x54dd9a,_0x14ed4b['RibvO'])&&_0x14ed4b[_0x373797(0x232)](_0x12e149,0x1))return _0x5d0c29[_0x373797(0x175)](JSON[_0x373797(0x29c)]({'isStatus':!0x1,'class':_0x14ed4b[_0x373797(0x155)],'msg':_0x14ed4b[_0x373797(0x1a0)]}));const _0x270b56=_0x591cd7['db'](global[_0x373797(0x163)])[_0x373797(0x1a6)](_0x306904);if(!await _0x270b56[_0x373797(0x181)]({'docId':_0x4423d5,'proposerId':_0x2618d8}))return _0x5d0c29[_0x373797(0x175)](JSON[_0x373797(0x29c)]({'isStatus':!0x1,'class':_0x14ed4b[_0x373797(0x155)],'msg':_0x373797(0x1c0)+_0x4423d5+'\x22'}));const _0x40c86b=_0x14ed4b[_0x373797(0x215)](_0x54dd9a,_0x14ed4b['RibvO'])?0x2:0xa,_0x4961e1=await _0x270b56['updateOne']({'docId':_0x4423d5,'proposerId':_0x2618d8},{'$set':{'docStatusNumber':_0x40c86b}});if(_0x14ed4b['MISEr'](_0x4961e1['modifiedCount'],0x0))return _0x5d0c29['send'](JSON[_0x373797(0x29c)]({'isStatus':!0x0,'docId':_0x4423d5,'docStatusNumber':_0x40c86b,'class':_0x14ed4b['BdUtX'],'msg':_0x53ab6b+'\x20\x22'+_0x4423d5+'\x22\x20เรียบร้อยแล้ว'}));if(_0x4961e1[_0x373797(0x248)]&&_0x14ed4b['Oofoh'](_0x4961e1[_0x373797(0x240)],0x1))return _0x5d0c29['send'](JSON[_0x373797(0x29c)]({'isStatus':!0x1,'docId':_0x4423d5,'docStatusNumber':_0x12e149,'class':_0x14ed4b[_0x373797(0x286)],'msg':_0x373797(0x2ce)+_0x4423d5+'\x22'}));}else{let {userId:_0x465ed3}=_0x1f93c7[_0x373797(0x23d)](_0x2bb98c);_0x465ed3=_0x465ed3&&_0x14ed4b[_0x373797(0x18d)](_0x4b6f1e,_0x465ed3);const _0xc4ace5=new _0x2e9b4c(_0x3b1db3['dbUrl']);try{const _0x469189=_0x435f9f[_0x373797(0x298)](_0x5d9e1f);return _0x16a88c['send'](_0xf5ea4c[_0x373797(0x29c)]({..._0x469189,'isLoad':!0x0,'class':_0x14ed4b[_0x373797(0x20d)],'msg':_0x373797(0x25f)+_0x465ed3+_0x373797(0x23f)}));}catch(_0xe11092){return _0x5787cc[_0x373797(0x2bf)](_0xe11092),_0x4bd290[_0x373797(0x175)](_0x49ce80[_0x373797(0x29c)]({'isLoad':!0x1,'class':_0x14ed4b['gnOCv'],'msg':_0xe11092[_0x373797(0x26b)]}));}finally{_0xc4ace5[_0x373797(0x1db)]();}}}catch(_0x5d3f2a){if(_0x14ed4b['UaYPI'](_0x14ed4b[_0x373797(0x1ec)],_0x14ed4b[_0x373797(0x1ec)])){const _0x5b5c2c=_0x2af355?function(){if(_0x170d9d){const _0x1a0326=_0xc2a6dd['apply'](_0x435776,arguments);return _0xd88c6c=null,_0x1a0326;}}:function(){};return _0x908da8=![],_0x5b5c2c;}else console['log'](_0x5d3f2a),_0x5d0c29[_0x373797(0x175)](JSON[_0x373797(0x29c)]({'isStatus':!0x1,'class':_0x14ed4b[_0x373797(0x155)],'msg':_0x5d3f2a[_0x373797(0x26b)]}));}finally{if(_0x14ed4b[_0x373797(0x195)](_0x14ed4b[_0x373797(0x17b)],_0x14ed4b[_0x373797(0x1be)])){const _0x50bddc=_0x354cb0[_0x373797(0x26f)](_0x1cba10,arguments);return _0x902683=null,_0x50bddc;}else _0x591cd7['close']();}});export default u;function _0x56b6d4(_0x58961d){const _0x15ddd2=_0x14d8f7,_0x56e239={'SAdFn':function(_0x3169b4,_0x176eeb){return _0x3169b4===_0x176eeb;},'vOLnd':_0x15ddd2(0x295),'ImlTk':function(_0x3e7758,_0x170314){return _0x3e7758!==_0x170314;},'nrxuJ':_0x15ddd2(0x183),'LGFij':_0x15ddd2(0x225),'BImBE':_0x15ddd2(0x299),'fTOXp':function(_0x4a5adb,_0x3510d1){return _0x4a5adb+_0x3510d1;},'IUsXQ':function(_0x242913,_0x497474){return _0x242913/_0x497474;},'zchGZ':_0x15ddd2(0x1a8),'dJXkR':function(_0x1480ed,_0x4f9567){return _0x1480ed===_0x4f9567;},'JDfBo':function(_0x2e5382,_0x4dba12){return _0x2e5382%_0x4dba12;},'MFoaQ':function(_0x2d576b,_0x43e9ba){return _0x2d576b+_0x43e9ba;},'XduGK':'debu','TKhuG':_0x15ddd2(0x222),'yBIps':_0x15ddd2(0x14f),'vtQzS':function(_0x6873b4,_0x1fb121){return _0x6873b4+_0x1fb121;},'ufjMb':_0x15ddd2(0x176),'DYQCH':function(_0x2db233,_0x5167db){return _0x2db233(_0x5167db);},'dkvkc':function(_0x51f014,_0x527c89){return _0x51f014(_0x527c89);}};function _0x531483(_0x5aa8ae){const _0x224fd0=_0x15ddd2;if(_0x56e239[_0x224fd0(0x27a)](typeof _0x5aa8ae,_0x56e239[_0x224fd0(0x297)])){if(_0x56e239['ImlTk'](_0x56e239[_0x224fd0(0x287)],_0x56e239[_0x224fd0(0x287)]))_0x34062a[_0x224fd0(0x1db)]();else return function(_0x342d16){}[_0x224fd0(0x1e8)](_0x56e239['LGFij'])[_0x224fd0(0x26f)](_0x56e239[_0x224fd0(0x2b6)]);}else _0x56e239[_0x224fd0(0x23a)](_0x56e239[_0x224fd0(0x1d2)]('',_0x56e239['IUsXQ'](_0x5aa8ae,_0x5aa8ae))[_0x56e239[_0x224fd0(0x27e)]],0x1)||_0x56e239[_0x224fd0(0x234)](_0x56e239[_0x224fd0(0x214)](_0x5aa8ae,0x14),0x0)?function(){return!![];}[_0x224fd0(0x1e8)](_0x56e239['MFoaQ'](_0x56e239[_0x224fd0(0x18a)],_0x56e239['TKhuG']))[_0x224fd0(0x1d6)](_0x56e239[_0x224fd0(0x1b7)]):function(){return![];}['constructor'](_0x56e239['vtQzS'](_0x56e239[_0x224fd0(0x18a)],_0x56e239[_0x224fd0(0x165)]))[_0x224fd0(0x26f)](_0x56e239[_0x224fd0(0x1b0)]);_0x56e239['DYQCH'](_0x531483,++_0x5aa8ae);}try{if(_0x58961d)return _0x531483;else _0x56e239[_0x15ddd2(0x259)](_0x531483,0x0);}catch(_0x4d4545){}}