const _0x38258e=_0x2513;(function(_0x3d84d0,_0x5dc964){const _0x122ea5=_0x2513,_0xb8df65=_0x3d84d0();while(!![]){try{const _0x47d720=parseInt(_0x122ea5(0x160))/0x1*(-parseInt(_0x122ea5(0x1f7))/0x2)+parseInt(_0x122ea5(0x204))/0x3+-parseInt(_0x122ea5(0x24b))/0x4*(parseInt(_0x122ea5(0x27e))/0x5)+-parseInt(_0x122ea5(0x214))/0x6+-parseInt(_0x122ea5(0x18c))/0x7*(-parseInt(_0x122ea5(0x1a2))/0x8)+parseInt(_0x122ea5(0x1d0))/0x9+parseInt(_0x122ea5(0x122))/0xa;if(_0x47d720===_0x5dc964)break;else _0xb8df65['push'](_0xb8df65['shift']());}catch(_0x51d4c7){_0xb8df65['push'](_0xb8df65['shift']());}}}(_0x5892,0x951e9));const _0x267a06=(function(){const _0x40461c=_0x2513,_0x482c28={'xxNYC':function(_0x29a339,_0x1e80b2){return _0x29a339(_0x1e80b2);},'CXcbO':_0x40461c(0x171),'ThvYr':'counter','QXLuS':function(_0x527b06,_0x38f087){return _0x527b06===_0x38f087;},'UUQOs':_0x40461c(0x183),'yFTcK':function(_0x12a08b,_0x5c4b27){return _0x12a08b!==_0x5c4b27;},'fdTft':'KdZzl','cXFEN':_0x40461c(0x1e6),'Dcauc':_0x40461c(0x115),'rjzJQ':_0x40461c(0x18b)};let _0x1d00b2=!![];return function(_0x178b24,_0x56e4db){const _0x1640a1=_0x40461c,_0x172c4c={'VOIza':_0x482c28['CXcbO'],'bMaXB':_0x482c28[_0x1640a1(0x201)],'QXSIo':function(_0x4486fe,_0x18347c){const _0x2f2aab=_0x1640a1;return _0x482c28[_0x2f2aab(0x1a7)](_0x4486fe,_0x18347c);},'WrcBp':_0x482c28['UUQOs'],'MUAAD':function(_0x1ce55f,_0xf635a9){const _0xb5b43=_0x1640a1;return _0x482c28[_0xb5b43(0x235)](_0x1ce55f,_0xf635a9);},'rcNsi':_0x482c28['fdTft'],'tXTSt':_0x482c28[_0x1640a1(0x16b)]};if(_0x482c28[_0x1640a1(0x235)](_0x482c28['Dcauc'],_0x482c28['rjzJQ'])){const _0x5e8156=_0x1d00b2?function(){const _0x508083=_0x1640a1;if(_0x172c4c[_0x508083(0x13b)](_0x172c4c[_0x508083(0x1e5)],_0x172c4c[_0x508083(0x1e5)])){if(_0x56e4db){if(_0x172c4c['MUAAD'](_0x172c4c[_0x508083(0x13a)],_0x172c4c[_0x508083(0x25e)])){const _0x5b2efb=_0x56e4db[_0x508083(0x189)](_0x178b24,arguments);return _0x56e4db=null,_0x5b2efb;}else return function(_0x534070){}[_0x508083(0x291)](_0x172c4c[_0x508083(0x1e8)])[_0x508083(0x189)](_0x172c4c[_0x508083(0x21c)]);}}else{if(_0x56ad6f){const _0xcf4c3c=_0x434717['apply'](_0x5ddaf1,arguments);return _0x3bdb31=null,_0xcf4c3c;}}}:function(){};return _0x1d00b2=![],_0x5e8156;}else _0x482c28[_0x1640a1(0x286)](_0x60a9da,'0');};}());(function(){const _0x2aacab=_0x2513,_0x22f6f6={'IHTCX':function(_0x23bc99,_0x17bf64){return _0x23bc99(_0x17bf64);},'vUNYu':function(_0x50cd40,_0x495dd7){return _0x50cd40+_0x495dd7;},'XoOBS':function(_0x53cf4c,_0x427f87){return _0x53cf4c+_0x427f87;},'nZteJ':_0x2aacab(0x285),'savex':_0x2aacab(0x259),'iUSqP':function(_0x57757e){return _0x57757e();},'rojbf':'log','zAReP':_0x2aacab(0x22e),'kDoGJ':_0x2aacab(0x21f),'QBDXY':_0x2aacab(0x131),'MUxZM':_0x2aacab(0x1c4),'ULheW':'table','Ytxce':_0x2aacab(0x1e2),'prvsy':function(_0x3c23c5,_0x126f5b){return _0x3c23c5<_0x126f5b;},'spUIR':function(_0x1553d0){return _0x1553d0();},'JLayZ':'green','eldMU':function(_0x42fdaa,_0x1694c9){return _0x42fdaa===_0x1694c9;},'yjpjB':_0x2aacab(0x1fe),'cviHb':_0x2aacab(0x273),'XkigM':'function\x20*\x5c(\x20*\x5c)','BZeGK':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','Ffsim':function(_0x310864,_0x527482){return _0x310864(_0x527482);},'qJnwz':_0x2aacab(0x21b),'ILfLI':function(_0x25bf3c,_0x346fab){return _0x25bf3c+_0x346fab;},'XOQcF':_0x2aacab(0x1db),'OtWRc':'input','UsCYC':function(_0x3af52f,_0x3c474e){return _0x3af52f===_0x3c474e;},'BZBcd':_0x2aacab(0x140),'VzMPY':_0x2aacab(0x142),'EyhKj':_0x2aacab(0x1fa),'rCqhe':function(_0x10a249,_0x123fbe,_0xd0cfd6){return _0x10a249(_0x123fbe,_0xd0cfd6);}};_0x22f6f6[_0x2aacab(0x207)](_0x267a06,this,function(){const _0x5a0353=_0x2aacab,_0xdb8c1b={'ODkMB':_0x22f6f6[_0x5a0353(0x254)]};if(_0x22f6f6[_0x5a0353(0x26e)](_0x22f6f6[_0x5a0353(0x113)],_0x22f6f6[_0x5a0353(0x1bb)])){const _0x3af7af=_0x4f314c[_0x5a0353(0x23a)](_0x3970f3);return _0x171999[_0x5a0353(0x240)](_0x57dbc0[_0x5a0353(0x174)]({..._0x3af7af,'isLoad':!0x0,'class':_0xdb8c1b['ODkMB'],'msg':_0x5a0353(0x16a)+_0x1ce38c+_0x5a0353(0x120)}));}else{const _0x9b9e5=new RegExp(_0x22f6f6[_0x5a0353(0x277)]),_0x5f4a0f=new RegExp(_0x22f6f6[_0x5a0353(0x1d1)],'i'),_0x32d838=_0x22f6f6['Ffsim'](_0x191556,_0x22f6f6[_0x5a0353(0x241)]);if(!_0x9b9e5['test'](_0x22f6f6[_0x5a0353(0x15b)](_0x32d838,_0x22f6f6[_0x5a0353(0x195)]))||!_0x5f4a0f['test'](_0x22f6f6[_0x5a0353(0x1c2)](_0x32d838,_0x22f6f6[_0x5a0353(0x13e)]))){if(_0x22f6f6[_0x5a0353(0x1ea)](_0x22f6f6[_0x5a0353(0x118)],_0x22f6f6[_0x5a0353(0x118)]))_0x22f6f6[_0x5a0353(0x1cf)](_0x32d838,'0');else{let _0x3d5e26;try{const _0x5b239c=_0x22f6f6['IHTCX'](_0x5e4678,_0x22f6f6[_0x5a0353(0x261)](_0x22f6f6[_0x5a0353(0x1c2)](_0x22f6f6[_0x5a0353(0x248)],_0x22f6f6[_0x5a0353(0x116)]),');'));_0x3d5e26=_0x22f6f6['iUSqP'](_0x5b239c);}catch(_0x23680a){_0x3d5e26=_0x32fc88;}const _0x1e8bb1=_0x3d5e26[_0x5a0353(0x199)]=_0x3d5e26[_0x5a0353(0x199)]||{},_0x152bb6=[_0x22f6f6['rojbf'],_0x22f6f6['zAReP'],_0x22f6f6[_0x5a0353(0x246)],_0x22f6f6[_0x5a0353(0x12f)],_0x22f6f6[_0x5a0353(0x215)],_0x22f6f6[_0x5a0353(0x143)],_0x22f6f6[_0x5a0353(0x1d6)]];for(let _0x91bf9a=0x0;_0x22f6f6['prvsy'](_0x91bf9a,_0x152bb6[_0x5a0353(0x170)]);_0x91bf9a++){const _0x16777a=_0x3a61dc[_0x5a0353(0x291)][_0x5a0353(0x136)][_0x5a0353(0x1a1)](_0x128c78),_0x129cfb=_0x152bb6[_0x91bf9a],_0xdbfd91=_0x1e8bb1[_0x129cfb]||_0x16777a;_0x16777a[_0x5a0353(0x24f)]=_0x4415d6[_0x5a0353(0x1a1)](_0xe78f0),_0x16777a[_0x5a0353(0x1c3)]=_0xdbfd91['toString'][_0x5a0353(0x1a1)](_0xdbfd91),_0x1e8bb1[_0x129cfb]=_0x16777a;}}}else _0x22f6f6['eldMU'](_0x22f6f6['VzMPY'],_0x22f6f6[_0x5a0353(0x14a)])?_0x22f6f6[_0x5a0353(0x1ed)](_0x37ad8a):_0x22f6f6[_0x5a0353(0x1e3)](_0x191556);}})();}());const _0xf3248a=(function(){const _0x54474e=_0x2513,_0x180ff9={'fYGDo':function(_0x1ee2c,_0x2145f2){return _0x1ee2c(_0x2145f2);},'GFMvL':function(_0x58cd06,_0x1b1c30){return _0x58cd06!==_0x1b1c30;},'UVOpc':_0x54474e(0x238),'eGQAC':function(_0x58337b,_0x424cde){return _0x58337b!==_0x424cde;},'lJBCh':_0x54474e(0x177),'ZXXdl':function(_0x3bcd29,_0x1a9211){return _0x3bcd29===_0x1a9211;},'FUJzr':'UoDdS'};let _0x2f3b60=!![];return function(_0x2c3ff6,_0xc90080){const _0x2690b9=_0x54474e,_0x4832b3={'cejiM':function(_0x21a3c3,_0xd06725){return _0x180ff9['GFMvL'](_0x21a3c3,_0xd06725);},'zntgz':_0x180ff9['UVOpc'],'irFTe':function(_0x5ecf22,_0xa0a5b6){const _0x2b4b0f=_0x2513;return _0x180ff9[_0x2b4b0f(0x208)](_0x5ecf22,_0xa0a5b6);},'WUxEm':_0x180ff9[_0x2690b9(0x1d3)]};if(_0x180ff9[_0x2690b9(0x1f8)](_0x180ff9[_0x2690b9(0x17e)],_0x180ff9[_0x2690b9(0x17e)])){const _0x1c33df=_0x2f3b60?function(){const _0xfe3243=_0x2690b9;if(_0x4832b3[_0xfe3243(0x18a)](_0x4832b3[_0xfe3243(0x1f5)],_0x4832b3[_0xfe3243(0x1f5)]))_0x43f10a[_0xfe3243(0x1b1)]();else{if(_0xc90080){if(_0x4832b3[_0xfe3243(0x19e)](_0x4832b3[_0xfe3243(0x221)],_0x4832b3['WUxEm']))return _0x23eadc;else{const _0x2e3256=_0xc90080['apply'](_0x2c3ff6,arguments);return _0xc90080=null,_0x2e3256;}}}}:function(){};return _0x2f3b60=![],_0x1c33df;}else _0x180ff9['fYGDo'](_0x6c886d,0x0);};}()),_0x59d11c=_0xf3248a(this,function(){const _0xaeed90=_0x2513,_0x31edc2={'TeuRs':function(_0x187346,_0xe5296a){return _0x187346(_0xe5296a);},'pbDcU':function(_0x2aaf5d,_0x4e5f37){return _0x2aaf5d+_0x4e5f37;},'wExCh':_0xaeed90(0x216),'pLYAX':_0xaeed90(0x1a6),'gBpkC':_0xaeed90(0x262),'ngAXi':_0xaeed90(0x293),'JAZkq':function(_0x7647b6,_0x87c19){return _0x7647b6===_0x87c19;},'qsXrU':'mRuGn','QEYMY':_0xaeed90(0x23e),'MAhre':function(_0x4f62c4,_0x30d320){return _0x4f62c4+_0x30d320;},'KhDab':_0xaeed90(0x285),'BTFQs':_0xaeed90(0x259),'RcxFK':function(_0x7cf427){return _0x7cf427();},'alENe':function(_0x3030f2,_0x426af3){return _0x3030f2!==_0x426af3;},'ABeta':'aPSty','GoFhB':'log','pHhEz':_0xaeed90(0x22e),'UVYQk':'info','ainPy':_0xaeed90(0x131),'OkXOD':_0xaeed90(0x1c4),'ecjUM':_0xaeed90(0x224),'TuQsP':_0xaeed90(0x1e2),'TIbSk':function(_0x201e04,_0x52524f){return _0x201e04<_0x52524f;},'ydpwp':function(_0x299a00,_0x4574a4){return _0x299a00!==_0x4574a4;},'XXLsT':_0xaeed90(0x139),'NqhJc':'tYfOs'};let _0x433d71;try{if(_0x31edc2[_0xaeed90(0x123)](_0x31edc2[_0xaeed90(0x119)],_0x31edc2[_0xaeed90(0x28a)])){if(_0x21190e)return _0x3f7141;else _0x31edc2[_0xaeed90(0x187)](_0x13bb58,0x0);}else{const _0x11407b=_0x31edc2[_0xaeed90(0x187)](Function,_0x31edc2[_0xaeed90(0x1b6)](_0x31edc2[_0xaeed90(0x17b)](_0x31edc2[_0xaeed90(0x212)],_0x31edc2[_0xaeed90(0x11d)]),');'));_0x433d71=_0x31edc2['RcxFK'](_0x11407b);}}catch(_0x1098eb){_0x31edc2[_0xaeed90(0x185)](_0x31edc2['ABeta'],_0x31edc2[_0xaeed90(0x22f)])?function(){return!![];}[_0xaeed90(0x291)](_0x31edc2[_0xaeed90(0x1b6)](_0x31edc2['wExCh'],_0x31edc2[_0xaeed90(0x25f)]))[_0xaeed90(0x15d)](_0x31edc2[_0xaeed90(0x23f)]):_0x433d71=window;}const _0x23b7a5=_0x433d71[_0xaeed90(0x199)]=_0x433d71['console']||{},_0x39224d=[_0x31edc2[_0xaeed90(0x12a)],_0x31edc2['pHhEz'],_0x31edc2['UVYQk'],_0x31edc2[_0xaeed90(0x20f)],_0x31edc2[_0xaeed90(0x156)],_0x31edc2[_0xaeed90(0x12c)],_0x31edc2['TuQsP']];for(let _0x5092ed=0x0;_0x31edc2[_0xaeed90(0x1c9)](_0x5092ed,_0x39224d[_0xaeed90(0x170)]);_0x5092ed++){if(_0x31edc2[_0xaeed90(0x203)](_0x31edc2['XXLsT'],_0x31edc2[_0xaeed90(0x149)])){const _0x2cad6f=_0xf3248a[_0xaeed90(0x291)][_0xaeed90(0x136)][_0xaeed90(0x1a1)](_0xf3248a),_0x44a615=_0x39224d[_0x5092ed],_0x5676c4=_0x23b7a5[_0x44a615]||_0x2cad6f;_0x2cad6f[_0xaeed90(0x24f)]=_0xf3248a[_0xaeed90(0x1a1)](_0xf3248a),_0x2cad6f[_0xaeed90(0x1c3)]=_0x5676c4[_0xaeed90(0x1c3)][_0xaeed90(0x1a1)](_0x5676c4),_0x23b7a5[_0x44a615]=_0x2cad6f;}else return _0x227fae[_0xaeed90(0x138)](_0x1b9050),_0x2053ea['send'](_0x492447[_0xaeed90(0x174)]({'isFetch':!0x1,'class':_0x31edc2[_0xaeed90(0x1ad)],'msg':_0x59ac3b[_0xaeed90(0x164)]}));}});_0x59d11c();import _0x534a68 from'express';const u=_0x534a68[_0x38258e(0x26b)]();function _0x5892(){const _0x18b348=['CQwDn','rcNsi','QXSIo','QDWZR','faqFw','OtWRc','hLHHJ','ALLcu','MzcKC','sTCyY','ULheW','.jpeg','BzeZX','UILvR','yQxGl','etIBk','NqhJc','EyhKj','../','ไม่พบประวัติการเปลี่ยนแปลง','/myUsers.js','zvHTg','BQSss','/fetch/modal','/bill','JOHfK','AYlLZ','fuVhy','acknowledged','OkXOD','HiKFA','counter','dbColl_settings_Quotation','dbColl_settings_Bill','ILfLI','modifiedCount','call','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','attachment;\x20filename=quotation-','17emeWbp','collection','JMRTR','ojqEr','message','bIUMe','screenshot','originalUrl','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','MYXTs','โหลดลายเซ็น\x20\x22','cXFEN','ZgpAd','KrZrh','join','rjBcE','length','while\x20(true)\x20{}','path','mrMNu','stringify','push','TnAcc','pZyqh','-----------------','mMgJU','ZvnqE','MAhre','GzEwe','dbColl_bill','FUJzr','LOGO_INVOICE_FILENAME','pcdpQ','jIvLf','WYTVv','hFFCl','LTHGX','alENe','WtYiQ','TeuRs','function\x20*\x5c(\x20*\x5c)','apply','cejiM','UHxXQ','9289FlNfgI','ffGUJ','renderView','vUSCF','fYoyh','ksVwy','dbName','DGfCm','tXmAO','XOQcF','replace','ykcHT','SeEvR','console','csJzJ','cancel','/user/signature','updateOne','irFTe','dbColl_settings_Invoice','UPcaB','bind','6744SGvbTD','dPGpi','khxkY','string','gger','QXLuS','ngDSJ','vaEsb','proposerId','LbppD','Lhnaj','ngAXi','green','print','error\x20===>\x20','close','gXoDE','tEjcM','OFEkh','RdoXq','pbDcU','fSlwt','PAGE_QUOTATION','EFCDe','lRcrv','cviHb','jRKdc','findOne','sSduw','get','/receipt','req.body\x20===>\x20','XoOBS','toString','exception','LenRT','xILSD','puppeteer','wGDEX','TIbSk','aBRPd','cWwBc','UxFuP','NPxWF','โหลดเอกสารเลขที่\x20\x22','Ffsim','713808JpRGPp','BZeGK','fZIYz','lJBCh','TUyNm','foXFj','Ytxce','tFloK','CJqTi','getUser_sign','พบ\x20\x22','chain','mdmMq','/print','BGldQ','wdbek','kKYGQ','/invoice','trace','iUSqP','dhzjE','WrcBp','QnVMg','uhWZc','VOIza','quotation_print.ejs','UsCYC','IIUIs','rktQT','spUIR','awkkB','FCGhR','writeHead','pHtcS','WnQCH','tuBEL','OnhHP','zntgz','nrXCj','137868VVTPLL','ZXXdl','docId','ERWoZ','EiGBx','getCollName_by_DocTitle','toArray','WFGla','pdf','stateObject','ThvYr','getDate','ydpwp','3478455sUcOCx','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','ODUPw','rCqhe','eGQAC','jEDUI','PZjJx','EZwgQ','LoloB','isAuth','vbRgT','ainPy','fMxDZ','userImageSignature_Src','KhDab','CGLkX','5184180jINsin','MUxZM','debu','PAGE_BILL','xbDpR','/myDocs.js','TWsrE','init','bMaXB','/load','UXkTL','info','CwBNQ','WUxEm','nVuWo','QulZj','table','AZqQI','hjBvY','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','DZgBu','CujuR','hlcQS','fnABE','InFBs','LOGO_BILL_FILENAME','warn','ABeta','puyhs','XCSAi','FPIYc','EzMTV','hYxRg','yFTcK','tOJwo','LOGO_RECEIPT_FILENAME','LJsoW','IXsgN','getSessionData_sign','includes','FndkP','input','LoonG','gBpkC','send','qJnwz','invoice_print.ejs','jpeg','ItknO','TIEZJ','kDoGJ','post','nZteJ','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','test','12604UtSyDw','QTxFY','tZHbX','getSettingsByCollection','__proto__','hBSgp','MITvL','/quotation','KwIdu','JLayZ','ZZFTY','map','iBkNW','aWSOp','{}.constructor(\x22return\x20this\x22)(\x20)','iRCCz','UbqyV','PtdDU','getLogoBase64Src','tXTSt','pLYAX','end','vUNYu','action','EgbYs','iMPvr','PtEsj','AkrvR','MwEQW','XrRXK','jmAuS','dbUrl','Router','yellow','setContent','eldMU','Fytsh','dbColl_invoice','KsAnZ','koKts','RyuRu','getSessionData','ZLoyb','wBpIH','XkigM','getCustomers_for_Modal','dnXXN','\x22ไม่สามารถเขียนข้อมูลลง\x20','ไม่พบเอกสารเลขที่\x20\x22','mRCdD','KOTig','1565JNEuZW','IVjIb','ibFwV','ZEmas','newPage','connect','oYjTe','return\x20(function()\x20','xxNYC','split','oLNnd','UkdmP','QEYMY','/myDateTime.js','launch','miTwP','XoHON','RHhuK','XTFPG','constructor','------------------','red','yjpjB','SndtN','vXxEw','savex','LZKTG','BZBcd','qsXrU','ZLJaZ','dbColl_receipt','KYEHb','BTFQs','ZVGHT','ไม่พบชื่อคอเล็กชั่น','\x22\x20เรียบร้อยแล้ว','HzWGU','12755060CbKxWI','JAZkq','LOGO_QUOTATION_FILENAME','Bnpok','scQAh','PAGE_INVOICE','gAkcG','aggregate','GoFhB','eZZgZ','ecjUM','cdZFV','VTDXE','QBDXY','UpKiZ','error','getItems_for_Modal','xYjxn','dbColl_quotation','body','prototype','bJtUz','log'];_0x5892=function(){return _0x18b348;};return _0x5892();}import _0x5b2f96 from'path';import{MongoClient as _0x3e89a8}from'mongodb';function _0x2513(_0xa633cc,_0x32af11){const _0x5821b4=_0x5892();return _0x2513=function(_0x59d11c,_0xf3248a){_0x59d11c=_0x59d11c-0x113;let _0x273399=_0x5821b4[_0x59d11c];return _0x273399;},_0x2513(_0xa633cc,_0x32af11);}import _0x32752b from'../middleware/mainAuth.js';import'luxon';const d=await import('../'+mymoduleFolder+'/myModule.js'),E=await import(_0x38258e(0x14b)+mymoduleFolder+_0x38258e(0x28b)),f=await import(_0x38258e(0x14b)+mymoduleFolder+_0x38258e(0x14d)),C=await import(_0x38258e(0x14b)+mymoduleFolder+_0x38258e(0x219)),j=_0x38258e(0x252),B=_0x38258e(0x1e1),M=_0x38258e(0x1c0),G=_0x38258e(0x151),N=[j,B,M,G],w=N['map'](_0x5e983d=>_0x5e983d+'/changes'),I=N[_0x38258e(0x256)](_0x134e5b=>_0x134e5b+_0x38258e(0x1dd)),A=N[_0x38258e(0x256)](_0x5e666=>_0x5e666+'/status'),x=N['map'](_0x35926c=>_0x35926c+'/search'),V=N[_0x38258e(0x256)](_0x199d23=>_0x199d23+_0x38258e(0x21d)),k=_0x38258e(0x150),F=_0x38258e(0x19c);u['post'](x,_0x32752b['isAuth'],async(_0x3de9e5,_0x189a78)=>{const _0x7f018f=_0x38258e,_0x18efe2={'QulZj':_0x7f018f(0x293),'yQxGl':function(_0x5d839f,_0x4c47d1){return _0x5d839f(_0x4c47d1);},'BPxmB':function(_0x1679cb,_0x3dee88){return _0x1679cb===_0x3dee88;},'ngDSJ':_0x7f018f(0x1d2),'sSduw':function(_0x540dd4,_0x11b720){return _0x540dd4!==_0x11b720;},'jEDUI':_0x7f018f(0x245),'AWeWz':_0x7f018f(0x16d),'rjBcE':_0x7f018f(0x168),'tOJwo':_0x7f018f(0x1ae),'ZvnqE':_0x7f018f(0x1b7),'InFBs':_0x7f018f(0x1e4),'bfqKZ':function(_0x47a120,_0x55cf92){return _0x47a120===_0x55cf92;},'AYlLZ':_0x7f018f(0x182)};let {sip:_0x5859ee,statusNumberFilter:_0x5bfa11,collName:_0x7d5fa}=_0x3de9e5[_0x7f018f(0x135)];_0x5859ee=_0x5859ee['replace'](/[!@#$%^&*<>]/g,'')??null,_0x5bfa11&&(_0x5bfa11=_0x5bfa11[_0x7f018f(0x287)](',')[_0x7f018f(0x256)](_0x404e47=>Number(_0x404e47)));let {userId:_0x39fa3b,userAuthority:_0xa990d2}=f[_0x7f018f(0x274)](_0x3de9e5);_0x39fa3b=_0x39fa3b&&_0x18efe2[_0x7f018f(0x147)](Number,_0x39fa3b);const _0x32fc58=new _0x3e89a8(global[_0x7f018f(0x26a)]);try{if(_0x18efe2['BPxmB'](_0x18efe2[_0x7f018f(0x1a8)],_0x18efe2['ngDSJ'])){await _0x32fc58[_0x7f018f(0x283)]();const _0x190959=_0x32fc58['db'](global[_0x7f018f(0x192)])[_0x7f018f(0x161)](_0x7d5fa);if(_0x5859ee){if(_0x18efe2['sSduw'](_0x18efe2[_0x7f018f(0x209)],_0x18efe2['AWeWz'])){var _0x5d8e24=[{'$or':[{'docId':{'$regex':_0x5859ee,'$options':'i'}},{'docDate':{'$regex':_0x5859ee,'$options':'i'}},{'customerName':{'$regex':_0x5859ee,'$options':'i'}}]}];['O','A'][_0x7f018f(0x23b)](_0xa990d2)||_0x5d8e24[_0x7f018f(0x175)]({'proposerId':_0x39fa3b}),_0x5bfa11&&_0x5d8e24[_0x7f018f(0x175)]({'docStatusNumber':{'$in':_0x5bfa11}});var _0x37e2be=await _0x190959[_0x7f018f(0x129)]([{'$match':{'$and':_0x5d8e24}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])[_0x7f018f(0x1fd)]();}else _0x4c85a6=_0x35a697;}else var _0x37e2be=[];let _0x2a7a5e=_0x7f018f(0x1da)+_0x37e2be[_0x7f018f(0x170)]+'\x22\x20เอกสาร';return['O','A'][_0x7f018f(0x23b)](_0xa990d2)||(_0x2a7a5e+=_0x18efe2[_0x7f018f(0x16f)]),_0x189a78[_0x7f018f(0x240)](JSON[_0x7f018f(0x174)]({'searchFound':_0x37e2be,'isSearch':!0x0,'class':_0x18efe2[_0x7f018f(0x236)],'msg':_0x2a7a5e}));}else _0x338da4[_0x7f018f(0x1b1)]();}catch(_0x14b5df){return _0x18efe2[_0x7f018f(0x1be)](_0x18efe2[_0x7f018f(0x17a)],_0x18efe2[_0x7f018f(0x22c)])?(console['log'](_0x14b5df),_0x189a78[_0x7f018f(0x240)](JSON['stringify']({'isSearch':!0x1,'class':_0x18efe2[_0x7f018f(0x223)],'msg':_0x14b5df['message']}))):(_0x473cd0[_0x7f018f(0x138)](_0x58b3d7),_0x553c47[_0x7f018f(0x240)](_0x4372bd[_0x7f018f(0x174)]({'isLoad':!0x1,'class':_0x18efe2[_0x7f018f(0x223)],'msg':_0x4380d0['message']})));}finally{if(_0x18efe2['bfqKZ'](_0x18efe2[_0x7f018f(0x153)],_0x18efe2['AYlLZ']))_0x32fc58[_0x7f018f(0x1b1)]();else return _0x219888['log'](_0x28b9d2),_0x63694d['send'](_0x585967['stringify']({'isSearch':!0x1,'class':_0x18efe2[_0x7f018f(0x223)],'msg':_0x2eede3[_0x7f018f(0x164)]}));}}),u['post'](V,_0x32752b[_0x38258e(0x20d)],async(_0x62373c,_0xa17892)=>{const _0x212695=_0x38258e,_0x52adf8={'LoloB':_0x212695(0x293),'xxYLc':_0x212695(0x11f),'wdbek':function(_0x5209d2,_0x806197){return _0x5209d2(_0x806197);},'gAkcG':function(_0x443ab6,_0x39afc6){return _0x443ab6!==_0x39afc6;},'ZEmas':_0x212695(0x1ee),'UbqyV':_0x212695(0x1b2),'vUSCF':'green','oYjTe':'EZxNY','EFCDe':_0x212695(0x222),'KsAnZ':_0x212695(0x272)};let {docId:_0x455b13,docTitle:_0x17fb1b,collName:_0x17f4b9}=_0x62373c[_0x212695(0x135)];if(_0x17f4b9||(_0x17f4b9=C[_0x212695(0x1fc)](_0x17fb1b)),!_0x17f4b9)return _0xa17892[_0x212695(0x240)](JSON['stringify']({'isStatus':!0x1,'class':_0x52adf8[_0x212695(0x20c)],'msg':_0x52adf8['xxYLc']}));let {userId:_0x4cc385,userAuthority:_0x22b9a1}=f[_0x212695(0x274)](_0x62373c);_0x4cc385=_0x4cc385&&_0x52adf8[_0x212695(0x1df)](Number,_0x4cc385);const _0x1bf034=new _0x3e89a8(global['dbUrl']);try{if(_0x52adf8['gAkcG'](_0x52adf8[_0x212695(0x281)],_0x52adf8[_0x212695(0x25b)])){await _0x1bf034['connect']();const _0x3dd243=_0x1bf034['db'](global[_0x212695(0x192)])['collection'](_0x17f4b9);let _0x404d74={'docId':_0x455b13};['O','A'][_0x212695(0x23b)](_0x22b9a1)||(_0x404d74[_0x212695(0x1aa)]=_0x4cc385);var _0x162364=await _0x3dd243['findOne'](_0x404d74,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x162364?(_0x162364[_0x212695(0x211)]=f[_0x212695(0x1d9)](_0x162364[_0x212695(0x1aa)]),_0xa17892[_0x212695(0x240)](JSON[_0x212695(0x174)]({'doc':_0x162364,'isLoad':!0x0,'class':_0x52adf8[_0x212695(0x18f)],'msg':_0x212695(0x1ce)+_0x455b13+_0x212695(0x120)}))):_0xa17892['send'](JSON[_0x212695(0x174)]({'isLoad':!0x1,'class':_0x52adf8['LoloB'],'msg':_0x212695(0x27b)+_0x455b13+'\x22'}));}else{const _0xee7cc2=_0x51af1a['constructor'][_0x212695(0x136)][_0x212695(0x1a1)](_0x38d4df),_0x2cde5b=_0x49f215[_0x4c81fe],_0x5f49b4=_0x23cf82[_0x2cde5b]||_0xee7cc2;_0xee7cc2[_0x212695(0x24f)]=_0x556db8[_0x212695(0x1a1)](_0x367f11),_0xee7cc2[_0x212695(0x1c3)]=_0x5f49b4[_0x212695(0x1c3)][_0x212695(0x1a1)](_0x5f49b4),_0x23f668[_0x2cde5b]=_0xee7cc2;}}catch(_0x1ebdb4){if(_0x52adf8[_0x212695(0x128)](_0x52adf8[_0x212695(0x284)],_0x52adf8[_0x212695(0x1b9)]))return console[_0x212695(0x138)](_0x1ebdb4),_0xa17892[_0x212695(0x240)](JSON['stringify']({'isLoad':!0x1,'class':_0x52adf8[_0x212695(0x20c)],'msg':_0x1ebdb4['message']}));else _0x5d0326[_0x212695(0x138)](_0x35420d),_0x390f82['send'](_0x7043f0['stringify']({'isStatus':!0x1,'class':_0x52adf8[_0x212695(0x20c)],'msg':_0x3c2b12[_0x212695(0x164)]}));}finally{if(_0x52adf8[_0x212695(0x128)](_0x52adf8['KsAnZ'],_0x52adf8[_0x212695(0x271)]))return!![];else _0x1bf034[_0x212695(0x1b1)]();}}),u[_0x38258e(0x1bf)](k,_0x32752b[_0x38258e(0x20d)],async(_0x53c525,_0x49a818)=>{const _0x375d9f=_0x38258e,_0x4af81d={'tuBEL':function(_0x105681,_0x2cb022){return _0x105681(_0x2cb022);},'fuVhy':function(_0x34ea95,_0x247d04){return _0x34ea95+_0x247d04;},'wpYQH':_0x375d9f(0x285),'CGLkX':_0x375d9f(0x259),'jIvLf':function(_0x17baab){return _0x17baab();},'ngVoO':function(_0x1d0f61,_0x78c30c){return _0x1d0f61===_0x78c30c;},'pHtcS':_0x375d9f(0x24d),'hLHHJ':_0x375d9f(0x198),'wxEIz':_0x375d9f(0x1ae),'miTwP':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','AZqQI':function(_0x5d6e45,_0x261329){return _0x5d6e45!==_0x261329;},'XTFPG':'MTDGY','mRCdD':_0x375d9f(0x121),'hjBvY':_0x375d9f(0x293)};try{if(_0x4af81d['ngVoO'](_0x4af81d[_0x375d9f(0x1f1)],_0x4af81d[_0x375d9f(0x13f)]))_0x554304['close']();else{const _0x3c1a3d=await C[_0x375d9f(0x278)](),_0x60249e=await C[_0x375d9f(0x132)]();return _0x49a818[_0x375d9f(0x240)](JSON[_0x375d9f(0x174)]({'DATA_CUSTOMERS':_0x3c1a3d,'DATA_ITEMS':_0x60249e,'isFetch':!0x0,'class':_0x4af81d['wxEIz'],'msg':_0x4af81d[_0x375d9f(0x28d)]}));}}catch(_0x1ce214){if(_0x4af81d[_0x375d9f(0x225)](_0x4af81d[_0x375d9f(0x290)],_0x4af81d[_0x375d9f(0x27c)]))return console[_0x375d9f(0x138)](_0x1ce214),_0x49a818[_0x375d9f(0x240)](JSON[_0x375d9f(0x174)]({'isFetch':!0x1,'class':_0x4af81d[_0x375d9f(0x226)],'msg':_0x1ce214[_0x375d9f(0x164)]}));else{const _0x52a9b2=lzjGqw[_0x375d9f(0x1f3)](_0x3151e8,lzjGqw[_0x375d9f(0x154)](lzjGqw[_0x375d9f(0x154)](lzjGqw['wpYQH'],lzjGqw[_0x375d9f(0x213)]),');'));_0x45ff72=lzjGqw[_0x375d9f(0x181)](_0x52a9b2);}}}),u[_0x38258e(0x247)](I,_0x32752b['isAuth'],async(_0x495a05,_0x9f2b86)=>{const _0x593511=_0x38258e,_0x5ca31d={'fnABE':_0x593511(0x1b0),'RHhuK':_0x593511(0x293),'UPcaB':_0x593511(0x188),'lrRMy':_0x593511(0x227),'kKYGQ':function(_0x2ba636,_0x2cfb6e){return _0x2ba636(_0x2cfb6e);},'faqFw':_0x593511(0x21b),'jmAuS':function(_0x552b92,_0x5427fb){return _0x552b92+_0x5427fb;},'VLQjj':_0x593511(0x1db),'ZLoyb':function(_0xecf1ce,_0x5dcbd1){return _0xecf1ce+_0x5dcbd1;},'YBZOi':'input','RVTgE':function(_0xd2325b,_0x59527b){return _0xd2325b(_0x59527b);},'vaEsb':function(_0x5555bb){return _0x5555bb();},'WnQCH':_0x593511(0x1ae),'mdmMq':_0x593511(0x1c1),'FPIYc':function(_0x4c6279,_0x400087){return _0x4c6279!==_0x400087;},'SndtN':_0x593511(0x194),'mrMNu':_0x593511(0x1eb),'ItknO':function(_0xe300e1,_0x5550a5){return _0xe300e1===_0x5550a5;},'KOTig':_0x593511(0x1e9),'MwEQW':_0x593511(0x242),'LJaSg':'receipt_print.ejs','eZZgZ':'bill_print.ejs','KwIdu':function(_0x112db2,_0x1bef7e){return _0x112db2==_0x1bef7e;},'Lhnaj':_0x593511(0x1af),'IVjIb':'image','FCGhR':function(_0x52b65b,_0x4af88f){return _0x52b65b===_0x4af88f;},'DGfCm':_0x593511(0x1cb),'OFEkh':_0x593511(0x20a),'ODUPw':_0x593511(0x1c7),'tEjcM':'networkidle0','hBSgp':function(_0xa4ad87,_0x2ce0b6){return _0xa4ad87/_0x2ce0b6;},'dnXXN':function(_0x1c9928,_0x2f5614){return _0x1c9928*_0x2f5614;},'aWSOp':_0x593511(0x243),'fMxDZ':'image/jpeg','JMRTR':function(_0x338363,_0x2ade0a){return _0x338363==_0x2ade0a;},'WtYiQ':_0x593511(0x1ff),'jRKdc':function(_0x261a8c,_0x18d5d2){return _0x261a8c===_0x18d5d2;},'iMPvr':_0x593511(0x1de),'MYXTs':'application/pdf','EaflP':_0x593511(0x228),'ZZFTY':'PWzNH','vOHtM':function(_0x1446a4,_0x385236){return _0x1446a4!==_0x385236;},'iBkNW':_0x593511(0x25c)};console[_0x593511(0x138)](_0x593511(0x178)+_0x495a05[_0x593511(0x167)]+_0x593511(0x292)),console['log'](_0x5ca31d[_0x593511(0x1dc)],_0x495a05['body']);const {docId:_0x213358,action:_0x4a9692}=_0x495a05[_0x593511(0x135)],_0x3ef0ab=new _0x3e89a8(global['dbUrl']);try{if(_0x5ca31d[_0x593511(0x232)](_0x5ca31d[_0x593511(0x114)],_0x5ca31d[_0x593511(0x173)])){if(_0x5ca31d[_0x593511(0x244)](_0x495a05[_0x593511(0x172)],I[0x0]))var _0x5162ab=global[_0x593511(0x134)],_0x56c151=_0x5ca31d[_0x593511(0x27d)],_0x480def=d[_0x593511(0x25d)](global[_0x593511(0x124)]),_0x13de84=await d[_0x593511(0x24e)](global[_0x593511(0x159)]),_0x19a289=global[_0x593511(0x1b8)];else{if(_0x5ca31d[_0x593511(0x244)](_0x495a05[_0x593511(0x172)],I[0x1]))var _0x5162ab=global['dbColl_invoice'],_0x56c151=_0x5ca31d[_0x593511(0x267)],_0x480def=d[_0x593511(0x25d)](global[_0x593511(0x17f)]),_0x13de84=await d[_0x593511(0x24e)](global[_0x593511(0x19f)]),_0x19a289=global[_0x593511(0x127)];else{if(_0x5ca31d['ItknO'](_0x495a05[_0x593511(0x172)],I[0x2]))var _0x5162ab=global[_0x593511(0x11b)],_0x56c151=_0x5ca31d['LJaSg'],_0x480def=d[_0x593511(0x25d)](global[_0x593511(0x237)]),_0x13de84=await d[_0x593511(0x24e)](global['dbColl_settings_Receipt']),_0x19a289=global['PAGE_RECEIPT'];else{if(_0x5ca31d['ItknO'](_0x495a05[_0x593511(0x172)],I[0x3]))var _0x5162ab=global['dbColl_bill'],_0x56c151=_0x5ca31d[_0x593511(0x12b)],_0x480def=d['getLogoBase64Src'](global[_0x593511(0x22d)]),_0x13de84=await d['getSettingsByCollection'](global[_0x593511(0x15a)]),_0x19a289=global[_0x593511(0x217)];}}}await _0x3ef0ab[_0x593511(0x283)]();var _0x58d958=await _0x3ef0ab['db'](global[_0x593511(0x192)])[_0x593511(0x161)](_0x5162ab)['findOne']({'docId':_0x213358});if(!_0x58d958)return _0x9f2b86[_0x593511(0x240)](JSON[_0x593511(0x174)]({'isLoad':!0x1,'class':_0x5ca31d['RHhuK'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x213358+'\x22'}));_0x58d958[_0x593511(0x1aa)]&&(_0x58d958['proposerImageSign']=f['getUser_sign'](_0x58d958['proposerId']));const _0x3441ce=f['getSessionData'](_0x495a05),_0x24d86c=C['convert_DocPrint'](_0x58d958),_0x1d1abd=_0x5b2f96[_0x593511(0x16e)](folderViews,_0x56c151),_0x40cf47=await d['renderView'](_0x1d1abd,_0x9f2b86,{'title':_0x19a289,'time':E[_0x593511(0x202)](),..._0x3441ce,'logoSrc_base64':_0x480def,..._0x13de84,'action':_0x4a9692,'doc':_0x24d86c});if(_0x5ca31d[_0x593511(0x253)](_0x4a9692,_0x5ca31d[_0x593511(0x1ac)]))_0x9f2b86[_0x593511(0x240)](JSON[_0x593511(0x174)]({'isPrint':!0x0,'class':_0x5ca31d[_0x593511(0x1f2)],'htmlPage':_0x40cf47}));else{if(_0x5ca31d[_0x593511(0x253)](_0x4a9692,_0x5ca31d[_0x593511(0x27f)])){if(_0x5ca31d[_0x593511(0x1ef)](_0x5ca31d[_0x593511(0x193)],_0x5ca31d[_0x593511(0x1b4)]))_0x2ed909['log'](_0x5ca31d['fnABE'],_0x413ba3),_0x3c8459[_0x593511(0x240)](_0x4d4f1c[_0x593511(0x174)]({'isPrint':!0x1,'class':_0x5ca31d['RHhuK'],'msg':_0xb0c908['message']}));else{const _0x5304c8=await(await import(_0x5ca31d[_0x593511(0x206)]))[_0x593511(0x28c)](),_0x4edb56=await _0x5304c8[_0x593511(0x282)]();await _0x4edb56[_0x593511(0x26d)](_0x40cf47,{'waitUntil':_0x5ca31d['tEjcM'],'timeout':0x2710}),await new Promise(_0x582672=>setTimeout(_0x582672,0x3e8));const _0x183e68=_0x5ca31d[_0x593511(0x250)](29.7,2.54),_0x2f3335=Math['floor'](_0x5ca31d[_0x593511(0x279)](_0x183e68,0x60));await _0x4edb56['setViewport']({'width':0x320,'height':_0x2f3335,'deviceScaleFactor':0x1});const _0x529207=await _0x4edb56[_0x593511(0x166)]({'type':_0x5ca31d[_0x593511(0x258)],'fullPage':!0x0,'omitBackground':!0x1});await _0x5304c8[_0x593511(0x1b1)]();const _0x3db78b=_0x58d958['docId']['replace'](/\//g,'');_0x9f2b86[_0x593511(0x1f0)](0xc8,{'Content-Type':_0x5ca31d[_0x593511(0x210)],'Content-Disposition':_0x593511(0x15f)+_0x3db78b+_0x593511(0x144),'Content-Length':_0x529207[_0x593511(0x170)]}),_0x9f2b86[_0x593511(0x260)](_0x529207);}}else{if(_0x5ca31d[_0x593511(0x162)](_0x4a9692,_0x5ca31d[_0x593511(0x186)])){if(_0x5ca31d[_0x593511(0x1bc)](_0x5ca31d[_0x593511(0x264)],_0x5ca31d[_0x593511(0x264)])){const _0x5a4bb3=await(await import(_0x5ca31d[_0x593511(0x206)]))[_0x593511(0x28c)](),_0xb32741=await _0x5a4bb3[_0x593511(0x282)]();await _0xb32741['setContent'](_0x40cf47,{'waitUntil':_0x5ca31d[_0x593511(0x1b3)],'timeout':0x2710}),await new Promise(_0x4ff32c=>setTimeout(_0x4ff32c,0x3e8));const _0x5ca0b8=await _0xb32741['pdf']({'format':'A4','printBackground':!0x0});await _0x5a4bb3[_0x593511(0x1b1)]();const _0x57581c=_0x58d958[_0x593511(0x1f9)][_0x593511(0x196)](/\//g,'');_0x9f2b86[_0x593511(0x1f0)](0xc8,{'Content-Type':_0x5ca31d[_0x593511(0x169)],'Content-Disposition':'attachment;\x20filename=quotation-'+_0x57581c+'.pdf','Content-Length':_0x5ca0b8['length']}),_0x9f2b86[_0x593511(0x260)](_0x5ca0b8);}else _0x20e906[_0x593511(0x1b1)]();}}}}else{const _0x30626c=new _0x332bb4(XMXbNb[_0x593511(0x1a0)]),_0x413da1=new _0x5a1956(XMXbNb['lrRMy'],'i'),_0xa943f1=XMXbNb[_0x593511(0x1e0)](_0x5d832c,XMXbNb[_0x593511(0x13d)]);!_0x30626c[_0x593511(0x24a)](XMXbNb[_0x593511(0x269)](_0xa943f1,XMXbNb['VLQjj']))||!_0x413da1[_0x593511(0x24a)](XMXbNb[_0x593511(0x275)](_0xa943f1,XMXbNb['YBZOi']))?XMXbNb['RVTgE'](_0xa943f1,'0'):XMXbNb[_0x593511(0x1a9)](_0x5943c6);}}catch(_0x53891f){if(_0x5ca31d[_0x593511(0x1ef)](_0x5ca31d['EaflP'],_0x5ca31d[_0x593511(0x255)]))return![];else console['log'](_0x5ca31d[_0x593511(0x22b)],_0x53891f),_0x9f2b86[_0x593511(0x240)](JSON[_0x593511(0x174)]({'isPrint':!0x1,'class':_0x5ca31d[_0x593511(0x28f)],'msg':_0x53891f[_0x593511(0x164)]}));}finally{if(_0x5ca31d['vOHtM'](_0x5ca31d[_0x593511(0x257)],_0x5ca31d[_0x593511(0x257)])){let {userId:_0x3e0d72}=_0x4c66d6[_0x593511(0x274)](_0x6ba28);_0x3e0d72=_0x3e0d72&&_0x5ca31d[_0x593511(0x1e0)](_0x44e4ed,_0x3e0d72);const _0xab8f97=new _0x4f53a6(_0x10db7[_0x593511(0x26a)]);try{const _0x19f417=_0x4f10f9[_0x593511(0x23a)](_0x418105);return _0xe1ca3e[_0x593511(0x240)](_0x2d3255[_0x593511(0x174)]({..._0x19f417,'isLoad':!0x0,'class':_0x5ca31d[_0x593511(0x1f2)],'msg':_0x593511(0x16a)+_0x3e0d72+_0x593511(0x120)}));}catch(_0x1cdf25){return _0x58e375[_0x593511(0x138)](_0x1cdf25),_0x6b26fe['send'](_0x1c2fd1[_0x593511(0x174)]({'isLoad':!0x1,'class':_0x5ca31d[_0x593511(0x28f)],'msg':_0x1cdf25[_0x593511(0x164)]}));}finally{_0xab8f97[_0x593511(0x1b1)]();}}else _0x3ef0ab['close']();}}),u[_0x38258e(0x247)](w,_0x32752b[_0x38258e(0x20d)],async(_0x220759,_0x439ba4)=>{const _0x24357b=_0x38258e,_0x6fdcb9={'LenRT':'red','EgbYs':function(_0xd46ac9,_0x599363){return _0xd46ac9===_0x599363;},'UXkTL':function(_0x4ecde8,_0x19a0b9){return _0x4ecde8===_0x19a0b9;},'OnhHP':function(_0x46a2ec,_0x10f177){return _0x46a2ec!==_0x10f177;},'TUyNm':_0x24357b(0x1fb),'FQkJr':_0x24357b(0x1e7),'kDBcA':function(_0x54213d,_0x599462){return _0x54213d<_0x599462;},'CJqTi':'yellow','PtEsj':_0x24357b(0x14c),'LbppD':'doc_changes.ejs','Bnpok':_0x24357b(0x1ae),'vbRgT':function(_0x52d1db,_0x4aed83){return _0x52d1db!==_0x4aed83;},'lRcrv':'OlevX','rktQT':_0x24357b(0x1b0),'ZLJaZ':function(_0x5d5b03,_0x453172){return _0x5d5b03===_0x453172;},'UxFuP':_0x24357b(0x239)},{docId:_0x5eab2f}=_0x220759[_0x24357b(0x135)];if(_0x6fdcb9[_0x24357b(0x263)](_0x220759[_0x24357b(0x172)],w[0x0]))var _0x2282e4=global[_0x24357b(0x134)];else{if(_0x6fdcb9[_0x24357b(0x21e)](_0x220759[_0x24357b(0x172)],w[0x1]))var _0x2282e4=global[_0x24357b(0x270)];else{if(_0x6fdcb9[_0x24357b(0x263)](_0x220759['path'],w[0x2]))var _0x2282e4=global[_0x24357b(0x11b)];else{if(_0x6fdcb9['UXkTL'](_0x220759[_0x24357b(0x172)],w[0x3]))var _0x2282e4=global['dbColl_bill'];}}}const _0x5226b8=new _0x3e89a8(global['dbUrl']);try{if(_0x6fdcb9[_0x24357b(0x1f4)](_0x6fdcb9[_0x24357b(0x1d4)],_0x6fdcb9['FQkJr'])){await _0x5226b8[_0x24357b(0x283)]();var _0xae7c55=await _0x5226b8['db'](global['dbName'])[_0x24357b(0x161)](_0x2282e4)[_0x24357b(0x1bd)]({'docId':_0x5eab2f});if(!_0xae7c55)return _0x439ba4[_0x24357b(0x240)](JSON[_0x24357b(0x174)]({'isPrint':!0x1,'class':_0x6fdcb9['LenRT'],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x5eab2f+'\x22'}));const _0x1bdc71=_0xae7c55['changesHistory']||[];if(_0x6fdcb9['kDBcA'](_0x1bdc71['length'],0x1))return _0x439ba4['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x6fdcb9[_0x24357b(0x1d8)],'msg':_0x6fdcb9[_0x24357b(0x265)]}));const _0x51d530=_0x5b2f96[_0x24357b(0x16e)](folderViews,_0x6fdcb9[_0x24357b(0x1ab)]),_0x2e548c=await d[_0x24357b(0x18e)](_0x51d530,_0x439ba4,{'title':_0xae7c55[_0x24357b(0x1f9)],'time':E['getDate'](),'changesHistory':_0x1bdc71});_0x439ba4[_0x24357b(0x240)](JSON[_0x24357b(0x174)]({'isPrint':!0x0,'class':_0x6fdcb9[_0x24357b(0x125)],'htmlPage':_0x2e548c}));}else return _0x4c6c10['log'](_0x242147),_0x37bb29[_0x24357b(0x240)](_0x514793[_0x24357b(0x174)]({'isLoad':!0x1,'class':_0x6fdcb9[_0x24357b(0x1c5)],'msg':_0x392c51[_0x24357b(0x164)]}));}catch(_0x152b7b){_0x6fdcb9[_0x24357b(0x20e)](_0x6fdcb9[_0x24357b(0x1ba)],_0x6fdcb9[_0x24357b(0x1ba)])?_0x2ddec4[_0x24357b(0x1b1)]():(console[_0x24357b(0x138)](_0x6fdcb9[_0x24357b(0x1ec)],_0x152b7b),_0x439ba4[_0x24357b(0x240)](JSON[_0x24357b(0x174)]({'isPrint':!0x1,'class':_0x6fdcb9[_0x24357b(0x1c5)],'msg':_0x152b7b[_0x24357b(0x164)]})));}finally{if(_0x6fdcb9[_0x24357b(0x11a)](_0x6fdcb9[_0x24357b(0x1cc)],_0x6fdcb9[_0x24357b(0x1cc)]))_0x5226b8[_0x24357b(0x1b1)]();else{const _0x53e182=_0x52701e?function(){if(_0x6ecd7d){const _0x559a40=_0x105a44['apply'](_0x107224,arguments);return _0x2dbef3=null,_0x559a40;}}:function(){};return _0x230530=![],_0x53e182;}}}),u[_0x38258e(0x1bf)](F,_0x32752b[_0x38258e(0x20d)],async(_0x537e03,_0x17b42b)=>{const _0x1b97d2=_0x38258e,_0x157146={'EZwgQ':function(_0x5a6a1a,_0x43791c){return _0x5a6a1a+_0x43791c;},'KYEHb':_0x1b97d2(0x216),'AnMbN':'gger','UkdmP':_0x1b97d2(0x200),'pcdpQ':_0x1b97d2(0x188),'etIBk':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','EzMTV':function(_0x1c4fc6,_0x117293){return _0x1c4fc6(_0x117293);},'TnAcc':'init','hYxRg':_0x1b97d2(0x1db),'xYjxn':_0x1b97d2(0x23d),'bIUMe':function(_0x347884,_0xe171bb){return _0x347884(_0xe171bb);},'mdFmi':function(_0x1d9a80){return _0x1d9a80();},'ksVwy':function(_0x4a154c,_0x47c129,_0xbb6b6c){return _0x4a154c(_0x47c129,_0xbb6b6c);},'tFloK':function(_0x53abba,_0x560969){return _0x53abba(_0x560969);},'NPxWF':function(_0x3b85d1,_0x3c263b){return _0x3b85d1!==_0x3c263b;},'fYoyh':_0x1b97d2(0x14f),'lgFNR':_0x1b97d2(0x1ae),'RdoXq':function(_0xa74c71,_0x20c259){return _0xa74c71===_0x20c259;},'ffGUJ':'nyCfz','ZVGHT':'XTlAn','wBpIH':_0x1b97d2(0x293),'foXFj':'HCahp'};let {userId:_0x51a403}=f['getSessionData'](_0x537e03);_0x51a403=_0x51a403&&_0x157146[_0x1b97d2(0x1d7)](Number,_0x51a403);const _0xe54c7e=new _0x3e89a8(global[_0x1b97d2(0x26a)]);try{if(_0x157146[_0x1b97d2(0x1cd)](_0x157146[_0x1b97d2(0x190)],_0x157146[_0x1b97d2(0x190)])){const _0x15537d=_0x4d8adb?function(){const _0x12a5be=_0x1b97d2;if(_0x21c715){const _0x922a19=_0x5936cf[_0x12a5be(0x189)](_0x3b244c,arguments);return _0x7d45dc=null,_0x922a19;}}:function(){};return _0x3679b3=![],_0x15537d;}else{const _0x18d77f=f[_0x1b97d2(0x23a)](_0x537e03);return _0x17b42b[_0x1b97d2(0x240)](JSON[_0x1b97d2(0x174)]({..._0x18d77f,'isLoad':!0x0,'class':_0x157146['lgFNR'],'msg':_0x1b97d2(0x16a)+_0x51a403+_0x1b97d2(0x120)}));}}catch(_0x5e146c){if(_0x157146[_0x1b97d2(0x1b5)](_0x157146[_0x1b97d2(0x18d)],_0x157146[_0x1b97d2(0x11e)]))(function(){return![];}[_0x1b97d2(0x291)](AMQsKj[_0x1b97d2(0x20b)](AMQsKj[_0x1b97d2(0x11c)],AMQsKj['AnMbN']))[_0x1b97d2(0x189)](AMQsKj[_0x1b97d2(0x289)]));else return console['log'](_0x5e146c),_0x17b42b[_0x1b97d2(0x240)](JSON[_0x1b97d2(0x174)]({'isLoad':!0x1,'class':_0x157146[_0x1b97d2(0x276)],'msg':_0x5e146c['message']}));}finally{_0x157146[_0x1b97d2(0x1b5)](_0x157146[_0x1b97d2(0x1d5)],_0x157146[_0x1b97d2(0x1d5)])?_0xe54c7e[_0x1b97d2(0x1b1)]():AMQsKj[_0x1b97d2(0x191)](_0x34e634,this,function(){const _0x22ce1c=_0x1b97d2,_0x52e1fc=new _0x3e16a9(AMQsKj[_0x22ce1c(0x180)]),_0x35bc12=new _0x305b7d(AMQsKj[_0x22ce1c(0x148)],'i'),_0x576c8f=AMQsKj[_0x22ce1c(0x233)](_0x15d11c,AMQsKj[_0x22ce1c(0x176)]);!_0x52e1fc[_0x22ce1c(0x24a)](AMQsKj[_0x22ce1c(0x20b)](_0x576c8f,AMQsKj[_0x22ce1c(0x234)]))||!_0x35bc12[_0x22ce1c(0x24a)](AMQsKj['EZwgQ'](_0x576c8f,AMQsKj[_0x22ce1c(0x133)]))?AMQsKj[_0x22ce1c(0x165)](_0x576c8f,'0'):AMQsKj['mdFmi'](_0x5de006);})();}}),u[_0x38258e(0x247)](A,_0x32752b[_0x38258e(0x20d)],async(_0x8ee451,_0x21a9f4)=>{const _0x370a73=_0x38258e,_0x4c78b1={'LZKTG':_0x370a73(0x1b0),'GzEwe':_0x370a73(0x293),'TWsrE':function(_0x5701fb,_0x44b5fd){return _0x5701fb===_0x44b5fd;},'FndkP':'BIvLw','ojqEr':function(_0x5cce95,_0x49b2fd){return _0x5cce95===_0x49b2fd;},'eLNmO':function(_0x569e1f,_0x473843){return _0x569e1f===_0x473843;},'xbDpR':'finish','KJUAo':_0x370a73(0x19b),'OtbaA':_0x370a73(0x249),'iyYeM':function(_0x27ee49,_0x6a6fda){return _0x27ee49(_0x6a6fda);},'khxkY':function(_0x287041,_0x596aed){return _0x287041(_0x596aed);},'VTDXE':function(_0x3e4932,_0x409203){return _0x3e4932==_0x409203;},'XrRXK':_0x370a73(0x205),'MITvL':function(_0x51c160,_0x34a537){return _0x51c160!==_0x34a537;},'scQAh':_0x370a73(0x15e),'UpKiZ':function(_0x8d6a1a,_0x5c9c9b){return _0x8d6a1a>_0x5c9c9b;},'nrXCj':_0x370a73(0x1ae),'CujuR':function(_0x3e7629,_0x3b46ff){return _0x3e7629<_0x3b46ff;},'bJtUz':_0x370a73(0x26c),'CwBNQ':_0x370a73(0x1ca),'MzcKC':_0x370a73(0x146),'JOHfK':function(_0x2da1bf,_0x397722){return _0x2da1bf!==_0x397722;},'ykcHT':_0x370a73(0x266)},_0x2c7794=new _0x3e89a8(global[_0x370a73(0x26a)]);try{if(_0x4c78b1[_0x370a73(0x21a)](_0x4c78b1[_0x370a73(0x23c)],_0x4c78b1[_0x370a73(0x23c)])){if(_0x4c78b1[_0x370a73(0x21a)](_0x8ee451['path'],A[0x0]))var _0x3d12f9=global['dbColl_quotation'];else{if(_0x4c78b1[_0x370a73(0x21a)](_0x8ee451['path'],A[0x1]))var _0x3d12f9=global[_0x370a73(0x270)];else{if(_0x4c78b1[_0x370a73(0x163)](_0x8ee451[_0x370a73(0x172)],A[0x2]))var _0x3d12f9=global['dbColl_receipt'];else{if(_0x4c78b1['eLNmO'](_0x8ee451[_0x370a73(0x172)],A[0x3]))var _0x3d12f9=global[_0x370a73(0x17d)];}}}let {docStatusNumber:_0x199a83,docId:_0x34ae52,action:_0x1071ec,text:_0x490c93}=_0x8ee451[_0x370a73(0x135)];if(!_0x34ae52||![_0x4c78b1['xbDpR'],_0x4c78b1['KJUAo']]['includes'](_0x1071ec))return _0x21a9f4[_0x370a73(0x240)](JSON[_0x370a73(0x174)]({'isStatus':!0x1,'class':_0x4c78b1[_0x370a73(0x17c)],'msg':_0x4c78b1['OtbaA']}));_0x199a83=_0x199a83&&_0x4c78b1['iyYeM'](Number,_0x199a83);let {userId:_0x4219a8}=f[_0x370a73(0x274)](_0x8ee451);if(_0x4219a8=_0x4219a8&&_0x4c78b1[_0x370a73(0x1a4)](Number,_0x4219a8),_0x4c78b1[_0x370a73(0x12e)](_0x1071ec,_0x4c78b1['KJUAo'])&&['1','2',0x1,0x2][_0x370a73(0x23b)](_0x199a83))return _0x21a9f4[_0x370a73(0x240)](JSON[_0x370a73(0x174)]({'isStatus':!0x1,'class':_0x4c78b1[_0x370a73(0x17c)],'msg':_0x4c78b1[_0x370a73(0x268)]}));if(_0x4c78b1[_0x370a73(0x12e)](_0x1071ec,_0x4c78b1[_0x370a73(0x218)])&&_0x4c78b1[_0x370a73(0x251)](_0x199a83,0x1))return _0x21a9f4['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x4c78b1[_0x370a73(0x17c)],'msg':_0x4c78b1[_0x370a73(0x126)]}));const _0x1f1a78=_0x2c7794['db'](global[_0x370a73(0x192)])[_0x370a73(0x161)](_0x3d12f9);if(!await _0x1f1a78[_0x370a73(0x1bd)]({'docId':_0x34ae52,'proposerId':_0x4219a8}))return _0x21a9f4[_0x370a73(0x240)](JSON[_0x370a73(0x174)]({'isStatus':!0x1,'class':_0x4c78b1[_0x370a73(0x17c)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x34ae52+'\x22'}));const _0x49b728=_0x4c78b1[_0x370a73(0x12e)](_0x1071ec,_0x4c78b1[_0x370a73(0x218)])?0x2:0xa,_0x553449=await _0x1f1a78[_0x370a73(0x19d)]({'docId':_0x34ae52,'proposerId':_0x4219a8},{'$set':{'docStatusNumber':_0x49b728}});if(_0x4c78b1[_0x370a73(0x130)](_0x553449[_0x370a73(0x15c)],0x0))return _0x21a9f4[_0x370a73(0x240)](JSON[_0x370a73(0x174)]({'isStatus':!0x0,'docId':_0x34ae52,'docStatusNumber':_0x49b728,'class':_0x4c78b1[_0x370a73(0x1f6)],'msg':_0x490c93+'\x20\x22'+_0x34ae52+_0x370a73(0x120)}));if(_0x553449[_0x370a73(0x155)]&&_0x4c78b1[_0x370a73(0x229)](_0x553449[_0x370a73(0x15c)],0x1))return _0x21a9f4[_0x370a73(0x240)](JSON['stringify']({'isStatus':!0x1,'docId':_0x34ae52,'docStatusNumber':_0x199a83,'class':_0x4c78b1[_0x370a73(0x137)],'msg':_0x370a73(0x27a)+_0x34ae52+'\x22'}));}else _0x52c344['log'](_0x4c78b1[_0x370a73(0x117)],_0x5547d9),_0x177e2e[_0x370a73(0x240)](_0x363108[_0x370a73(0x174)]({'isPrint':!0x1,'class':_0x4c78b1[_0x370a73(0x17c)],'msg':_0x353d73[_0x370a73(0x164)]}));}catch(_0xba8992){if(_0x4c78b1[_0x370a73(0x163)](_0x4c78b1[_0x370a73(0x220)],_0x4c78b1[_0x370a73(0x141)])){if(_0x30e574){const _0x53eb6a=_0x40f645[_0x370a73(0x189)](_0x558ec5,arguments);return _0x581b3d=null,_0x53eb6a;}}else console[_0x370a73(0x138)](_0xba8992),_0x21a9f4[_0x370a73(0x240)](JSON['stringify']({'isStatus':!0x1,'class':_0x4c78b1['GzEwe'],'msg':_0xba8992['message']}));}finally{if(_0x4c78b1[_0x370a73(0x152)](_0x4c78b1['ykcHT'],_0x4c78b1[_0x370a73(0x197)])){const _0x1b3820=_0x1f7148[_0x370a73(0x189)](_0x5a3e67,arguments);return _0xf959e5=null,_0x1b3820;}else _0x2c7794[_0x370a73(0x1b1)]();}});export default u;function _0x191556(_0x3a6743){const _0x440cb3=_0x38258e,_0xddb12c={'QDWZR':function(_0x21487c,_0x581c67){return _0x21487c!==_0x581c67;},'cdZFV':_0x440cb3(0x1c8),'oLNnd':'VgYiN','XCSAi':function(_0x4fb04c,_0x42cd25){return _0x4fb04c===_0x42cd25;},'Vrwbs':_0x440cb3(0x1a5),'Mzlhg':function(_0x108401,_0x684594){return _0x108401!==_0x684594;},'ibFwV':_0x440cb3(0x1c6),'zvHTg':'while\x20(true)\x20{}','ZgpAd':_0x440cb3(0x158),'QTxFY':function(_0x18a9f5,_0x136251){return _0x18a9f5!==_0x136251;},'HiKFA':function(_0x51c549,_0x92bc8d){return _0x51c549+_0x92bc8d;},'dPGpi':function(_0xeb63e0,_0x50aeda){return _0xeb63e0/_0x50aeda;},'XoHON':_0x440cb3(0x170),'csJzJ':function(_0x554690,_0x6a9ec5){return _0x554690%_0x6a9ec5;},'fjDjm':function(_0x2db006,_0x459bd1){return _0x2db006+_0x459bd1;},'LTHGX':_0x440cb3(0x216),'Fytsh':_0x440cb3(0x1a6),'BzeZX':_0x440cb3(0x262),'hlcQS':function(_0x507ab4,_0x3c2458){return _0x507ab4+_0x3c2458;},'yqIPL':_0x440cb3(0x200),'PYVxN':function(_0x43b34a,_0x1606ae){return _0x43b34a(_0x1606ae);}};function _0x159846(_0x324cac){const _0x538810=_0x440cb3,_0x2456ca={'iRCCz':function(_0x596bff,_0x52d25a){const _0x10d1bb=_0x2513;return _0xddb12c[_0x10d1bb(0x13c)](_0x596bff,_0x52d25a);},'puyhs':_0xddb12c[_0x538810(0x12d)],'mMgJU':_0xddb12c[_0x538810(0x288)]};if(_0xddb12c[_0x538810(0x231)](typeof _0x324cac,_0xddb12c['Vrwbs'])){if(_0xddb12c['Mzlhg'](_0xddb12c[_0x538810(0x280)],_0xddb12c[_0x538810(0x280)])){const _0x1190e8=_0x1f9ee5[_0x538810(0x189)](_0x297af5,arguments);return _0x5a5919=null,_0x1190e8;}else return function(_0x1b6abd){}[_0x538810(0x291)](_0xddb12c[_0x538810(0x14e)])['apply'](_0xddb12c[_0x538810(0x16c)]);}else _0xddb12c[_0x538810(0x24c)](_0xddb12c[_0x538810(0x157)]('',_0xddb12c[_0x538810(0x1a3)](_0x324cac,_0x324cac))[_0xddb12c[_0x538810(0x28e)]],0x1)||_0xddb12c[_0x538810(0x231)](_0xddb12c[_0x538810(0x19a)](_0x324cac,0x14),0x0)?function(){const _0x3de4a6=_0x538810;if(_0x2456ca[_0x3de4a6(0x25a)](_0x2456ca[_0x3de4a6(0x230)],_0x2456ca[_0x3de4a6(0x179)]))return!![];else _0xa4c709[_0x3de4a6(0x1b1)]();}[_0x538810(0x291)](_0xddb12c['fjDjm'](_0xddb12c[_0x538810(0x184)],_0xddb12c[_0x538810(0x26f)]))[_0x538810(0x15d)](_0xddb12c[_0x538810(0x145)]):function(){return![];}[_0x538810(0x291)](_0xddb12c[_0x538810(0x22a)](_0xddb12c[_0x538810(0x184)],_0xddb12c[_0x538810(0x26f)]))['apply'](_0xddb12c['yqIPL']);_0xddb12c['PYVxN'](_0x159846,++_0x324cac);}try{if(_0x3a6743)return _0x159846;else _0xddb12c['PYVxN'](_0x159846,0x0);}catch(_0x2ac741){}}