const _0x40b709=_0x54b2;(function(_0x43efd4,_0x3e9005){const _0x4558f6=_0x54b2,_0x2bbda1=_0x43efd4();while(!![]){try{const _0x321dcc=-parseInt(_0x4558f6(0x328))/0x1+parseInt(_0x4558f6(0x315))/0x2+parseInt(_0x4558f6(0x31f))/0x3+parseInt(_0x4558f6(0x1f9))/0x4*(-parseInt(_0x4558f6(0x21d))/0x5)+-parseInt(_0x4558f6(0x298))/0x6+-parseInt(_0x4558f6(0x2e3))/0x7*(parseInt(_0x4558f6(0x338))/0x8)+-parseInt(_0x4558f6(0x32e))/0x9*(-parseInt(_0x4558f6(0x2d4))/0xa);if(_0x321dcc===_0x3e9005)break;else _0x2bbda1['push'](_0x2bbda1['shift']());}catch(_0x5f0833){_0x2bbda1['push'](_0x2bbda1['shift']());}}}(_0x475d,0x38f49));const _0x59e8ee=(function(){const _0x47de44=_0x54b2,_0x5d900d={'cKqjl':function(_0x517a91,_0x2c484a){return _0x517a91(_0x2c484a);},'BErXQ':function(_0x12965f,_0x142430){return _0x12965f===_0x142430;},'ImEtW':_0x47de44(0x204),'CiTBb':function(_0x343a38,_0x3e88a7){return _0x343a38!==_0x3e88a7;},'XVvKA':_0x47de44(0x26a),'bMmwC':_0x47de44(0x2fe),'AoZJg':function(_0x318746,_0x5a2ca4){return _0x318746!==_0x5a2ca4;},'GVeDc':'JBpmO','hkRNi':_0x47de44(0x28f)};let _0x509de0=!![];return function(_0x3598aa,_0x3a1d56){const _0xac02fd=_0x47de44,_0x735042={'IYCLh':function(_0x2685ba,_0x5e5e64){const _0x3ad0e8=_0x54b2;return _0x5d900d[_0x3ad0e8(0x27d)](_0x2685ba,_0x5e5e64);},'hlRra':_0x5d900d[_0xac02fd(0x2f1)],'SAguh':function(_0x25edcd,_0x3e78ec){const _0x3c06e5=_0xac02fd;return _0x5d900d[_0x3c06e5(0x1ea)](_0x25edcd,_0x3e78ec);},'eRiaH':_0x5d900d[_0xac02fd(0x2db)],'ryYUO':_0x5d900d[_0xac02fd(0x203)]};if(_0x5d900d['AoZJg'](_0x5d900d[_0xac02fd(0x29a)],_0x5d900d[_0xac02fd(0x1dc)])){const _0x45290c=_0x509de0?function(){const _0x3ce996=_0xac02fd;if(_0x735042['IYCLh'](_0x735042['hlRra'],_0x735042[_0x3ce996(0x2b2)])){if(_0x3a1d56){if(_0x735042['SAguh'](_0x735042[_0x3ce996(0x1e0)],_0x735042[_0x3ce996(0x1f1)])){const _0x394782=_0x3a1d56['apply'](_0x3598aa,arguments);return _0x3a1d56=null,_0x394782;}else{const _0xe5c9b9=_0xdcd5d6?function(){const _0x1bee21=_0x3ce996;if(_0xb2506e){const _0x408826=_0x1d556e[_0x1bee21(0x2e9)](_0x45f500,arguments);return _0x4b931d=null,_0x408826;}}:function(){};return _0x4ab127=![],_0xe5c9b9;}}}else _0x27f5c3=_0x32ce67;}:function(){};return _0x509de0=![],_0x45290c;}else _0x5d900d['cKqjl'](_0x28c5a3,'0');};}());(function(){const _0x44062f=_0x54b2,_0x4b9edf={'sQooB':function(_0x382719,_0x3b1616){return _0x382719+_0x3b1616;},'pTzjt':'debu','ryelP':_0x44062f(0x295),'AnRto':_0x44062f(0x20f),'KgLoT':_0x44062f(0x28e),'ZraCV':function(_0x31d7d5,_0x4487a3){return _0x31d7d5(_0x4487a3);},'kHxLH':_0x44062f(0x248),'fQkMb':function(_0x14324c,_0x333d31){return _0x14324c===_0x333d31;},'EQwGL':_0x44062f(0x2b4),'SHjau':'function\x20*\x5c(\x20*\x5c)','TIBOC':_0x44062f(0x24f),'eAlhN':_0x44062f(0x319),'YSVTL':_0x44062f(0x2ad),'qYdAP':_0x44062f(0x235),'gADaR':function(_0x3bf3b8,_0x15aa09){return _0x3bf3b8!==_0x15aa09;},'FOMEh':'SxPeE','BtTyh':'nIivg','cWfeh':_0x44062f(0x2b7),'KXwJQ':function(_0x3b61d6){return _0x3b61d6();},'SeRYY':function(_0xd8fe36,_0x4b08b3,_0x3ee405){return _0xd8fe36(_0x4b08b3,_0x3ee405);}};_0x4b9edf[_0x44062f(0x2bf)](_0x59e8ee,this,function(){const _0x5125f6=_0x44062f,_0x3cd552={'Wlqid':function(_0x4dc386,_0x3eee62){const _0x44b51e=_0x54b2;return _0x4b9edf[_0x44b51e(0x2fd)](_0x4dc386,_0x3eee62);},'qltIK':_0x4b9edf['kHxLH'],'kSmfR':_0x4b9edf[_0x5125f6(0x2ab)]};if(_0x4b9edf['fQkMb'](_0x4b9edf[_0x5125f6(0x33f)],_0x4b9edf[_0x5125f6(0x33f)])){const _0x4db10c=new RegExp(_0x4b9edf[_0x5125f6(0x25a)]),_0x1bbd77=new RegExp(_0x4b9edf['TIBOC'],'i'),_0x4a1778=_0x4b9edf[_0x5125f6(0x2fd)](_0x44582a,_0x4b9edf['eAlhN']);if(!_0x4db10c[_0x5125f6(0x290)](_0x4b9edf[_0x5125f6(0x301)](_0x4a1778,_0x4b9edf[_0x5125f6(0x201)]))||!_0x1bbd77[_0x5125f6(0x290)](_0x4b9edf[_0x5125f6(0x301)](_0x4a1778,_0x4b9edf[_0x5125f6(0x291)])))_0x4b9edf[_0x5125f6(0x329)](_0x4b9edf[_0x5125f6(0x2ee)],_0x4b9edf['BtTyh'])?_0x4b9edf[_0x5125f6(0x2fd)](_0x4a1778,'0'):function(){return![];}[_0x5125f6(0x333)](_0x4b9edf['sQooB'](_0x4b9edf[_0x5125f6(0x2a0)],_0x4b9edf[_0x5125f6(0x20b)]))[_0x5125f6(0x2e9)](_0x4b9edf[_0x5125f6(0x22d)]);else{if(_0x4b9edf['gADaR'](_0x4b9edf['cWfeh'],_0x4b9edf[_0x5125f6(0x33c)])){let {userId:_0x1711ba}=_0x464a5f[_0x5125f6(0x2e4)](_0x4a39bc);_0x1711ba=_0x1711ba&&_0x3cd552[_0x5125f6(0x253)](_0x239583,_0x1711ba);const _0x47af01=new _0x310d00(_0x327483[_0x5125f6(0x247)]);try{const _0x5eee87=_0x151052[_0x5125f6(0x2ca)](_0x19ba4d);return _0x39bd31['send'](_0x4cf80b['stringify']({..._0x5eee87,'isLoad':!0x0,'class':_0x3cd552[_0x5125f6(0x2df)],'msg':_0x5125f6(0x2f4)+_0x1711ba+'\x22\x20เรียบร้อยแล้ว'}));}catch(_0x4ea65c){return _0x843b46[_0x5125f6(0x2d6)](_0x4ea65c),_0x2bde3a[_0x5125f6(0x2ba)](_0x7ff4ff[_0x5125f6(0x218)]({'isLoad':!0x1,'class':_0x3cd552['kSmfR'],'msg':_0x4ea65c[_0x5125f6(0x1d7)]}));}finally{_0x47af01[_0x5125f6(0x2b9)]();}}else _0x4b9edf['KXwJQ'](_0x44582a);}}else return _0x3a2ab4[_0x5125f6(0x2d6)](_0x370dc7),_0x1875a3[_0x5125f6(0x2ba)](_0x3f8749['stringify']({'isFetch':!0x1,'class':_0x4b9edf[_0x5125f6(0x2ab)],'msg':_0x43cd11[_0x5125f6(0x1d7)]}));})();}());const _0x2eaa67=(function(){const _0x1b3c27=_0x54b2,_0x4f76c1={'zYLcY':function(_0x4da00e,_0x394756){return _0x4da00e===_0x394756;},'sqNVj':_0x1b3c27(0x2c4),'hDkUK':_0x1b3c27(0x277),'uwNxg':function(_0x22b03a,_0x147144){return _0x22b03a===_0x147144;},'asmog':_0x1b3c27(0x221),'JNPPY':_0x1b3c27(0x207),'aqURW':_0x1b3c27(0x265)};let _0x29349f=!![];return function(_0x11ad58,_0x1dbc4b){const _0x3936a1=_0x1b3c27;if(_0x4f76c1[_0x3936a1(0x2c0)](_0x4f76c1[_0x3936a1(0x2f3)],_0x4f76c1[_0x3936a1(0x2f3)])){const _0x2a2685=_0x29349f?function(){const _0x55717a=_0x3936a1;if(_0x4f76c1['zYLcY'](_0x4f76c1[_0x55717a(0x20c)],_0x4f76c1[_0x55717a(0x259)]))_0x3cc8b4['close']();else{if(_0x1dbc4b){if(_0x4f76c1[_0x55717a(0x325)](_0x4f76c1[_0x55717a(0x238)],_0x4f76c1['JNPPY']))_0x504a1c[_0x55717a(0x2b9)]();else{const _0x149461=_0x1dbc4b[_0x55717a(0x2e9)](_0x11ad58,arguments);return _0x1dbc4b=null,_0x149461;}}}}:function(){};return _0x29349f=![],_0x2a2685;}else{_0x1cfc2a=!0x1;return;}};}()),_0x3778b9=_0x2eaa67(this,function(){const _0x2f9bc3=_0x54b2,_0x146244={'jxSoo':'while\x20(true)\x20{}','cXKKK':_0x2f9bc3(0x1f4),'VyzDg':_0x2f9bc3(0x28e),'vYRTC':function(_0xc93906,_0xe59d1d){return _0xc93906!==_0xe59d1d;},'lWHyx':_0x2f9bc3(0x1ec),'uxCMB':function(_0x19bb91,_0x3c2d38){return _0x19bb91!==_0x3c2d38;},'dQlgd':'qADzT','OejkH':function(_0x1bfa16,_0x217c5b){return _0x1bfa16(_0x217c5b);},'tFlzO':function(_0x4d1fcf,_0x3656ef){return _0x4d1fcf+_0x3656ef;},'TfsMy':function(_0x2334be,_0x23d89b){return _0x2334be+_0x23d89b;},'rHoKz':_0x2f9bc3(0x1fa),'KEUOF':_0x2f9bc3(0x316),'FzpUf':function(_0x567106,_0x55fde4){return _0x567106===_0x55fde4;},'OEkyg':_0x2f9bc3(0x330),'cHoPj':_0x2f9bc3(0x2b3),'LTUAq':function(_0x4a8a1c){return _0x4a8a1c();},'QzPTZ':function(_0x39504b){return _0x39504b();},'hsSsK':_0x2f9bc3(0x2d6),'nAcAq':'warn','QbKMm':_0x2f9bc3(0x2fb),'OqnJB':_0x2f9bc3(0x1fb),'vQfeO':'exception','paLQe':_0x2f9bc3(0x213),'suygn':_0x2f9bc3(0x26d),'yyNtf':function(_0x577943,_0x536540){return _0x577943<_0x536540;},'uqcJM':function(_0x1acd0c,_0x231bd1){return _0x1acd0c===_0x231bd1;},'jFnpr':'NyzpI','GPMRz':_0x2f9bc3(0x20d)},_0x5b6dd3=function(){const _0x2c0b19=_0x2f9bc3,_0x275897={'TmRuh':_0x146244[_0x2c0b19(0x217)]};if(_0x146244[_0x2c0b19(0x2eb)](_0x146244[_0x2c0b19(0x228)],_0x146244[_0x2c0b19(0x228)]))_0x11eda0[_0x2c0b19(0x2d6)](_0x1ba47f),_0x2bd85d['send'](_0x1315bd['stringify']({'isStatus':!0x1,'class':_0x275897['TmRuh'],'msg':_0x54514d[_0x2c0b19(0x1d7)]}));else{let _0x457e0d;try{if(_0x146244['uxCMB'](_0x146244[_0x2c0b19(0x312)],_0x146244[_0x2c0b19(0x312)]))return function(_0xc720c4){}[_0x2c0b19(0x333)](_0x146244['jxSoo'])[_0x2c0b19(0x2e9)](_0x146244[_0x2c0b19(0x1d6)]);else _0x457e0d=_0x146244[_0x2c0b19(0x2d8)](Function,_0x146244[_0x2c0b19(0x285)](_0x146244[_0x2c0b19(0x24c)](_0x146244[_0x2c0b19(0x2dc)],_0x146244['KEUOF']),');'))();}catch(_0x4552fe){if(_0x146244['FzpUf'](_0x146244['OEkyg'],_0x146244[_0x2c0b19(0x1e6)])){const _0x212704=_0x50adec?function(){const _0xfdf490=_0x2c0b19;if(_0x221ec4){const _0x1b5935=_0x3496b1[_0xfdf490(0x2e9)](_0x3fe9dc,arguments);return _0x4195bd=null,_0x1b5935;}}:function(){};return _0x3b6599=![],_0x212704;}else _0x457e0d=window;}return _0x457e0d;}},_0x43f293=_0x146244[_0x2f9bc3(0x1e2)](_0x5b6dd3),_0x4d8a2b=_0x43f293['console']=_0x43f293['console']||{},_0x34e74f=[_0x146244['hsSsK'],_0x146244['nAcAq'],_0x146244['QbKMm'],_0x146244[_0x2f9bc3(0x2d5)],_0x146244[_0x2f9bc3(0x2ce)],_0x146244[_0x2f9bc3(0x242)],_0x146244[_0x2f9bc3(0x222)]];for(let _0x2e1fc7=0x0;_0x146244['yyNtf'](_0x2e1fc7,_0x34e74f[_0x2f9bc3(0x21e)]);_0x2e1fc7++){if(_0x146244[_0x2f9bc3(0x2d0)](_0x146244[_0x2f9bc3(0x32f)],_0x146244['GPMRz']))_0x146244[_0x2f9bc3(0x2f6)](_0x1cffb3);else{const _0xc60683=_0x2eaa67[_0x2f9bc3(0x333)][_0x2f9bc3(0x29c)]['bind'](_0x2eaa67),_0x2e365d=_0x34e74f[_0x2e1fc7],_0x2d0ae8=_0x4d8a2b[_0x2e365d]||_0xc60683;_0xc60683['__proto__']=_0x2eaa67[_0x2f9bc3(0x1d5)](_0x2eaa67),_0xc60683['toString']=_0x2d0ae8['toString']['bind'](_0x2d0ae8),_0x4d8a2b[_0x2e365d]=_0xc60683;}}});_0x3778b9();import _0x639c7d from'express';const b=_0x639c7d[_0x40b709(0x342)]();import _0x4fcce0 from'path';import{MongoClient as _0x3bcaa8}from'mongodb';import _0x2b2c43 from'../middleware/mainAuth.js';import*as _0x4e9b62 from'../mymodule/myUsers.js';import*as _0x18b199 from'../mymodule/myDateTime.js';import*as _0x59b12c from'../mymodule/myModule.js';function _0x475d(){const _0x1a6dc0=['wvrTg','wGlQK','45TcdIHZ','jFnpr','xKjyl','RhPLq','EzJLb','constructor','TyUkN','\x22\x20เรียบร้อยแล้ว','hUeqO','changesHistory','179000iiYkgJ','OSvSy','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','NxaWX','cWfeh','UtQlt','aMpiV','EQwGL','daShu','dWZHZ','Router','bind','cXKKK','message','/print','CoOIe','LgXMd','gpBuk','hkRNi','KCbgo','NYZgi','dFFEj','eRiaH','wNdmN','QzPTZ','nIcFN','error\x20===>\x20','replace','cHoPj','getItems_for_Modal','userImageSignature_Src','.jpeg','CiTBb','post','zMcQb','proposerImageSign','mlOMW','YIzYq','includes','ryYUO','ZTaWv','mhLdG','counter','writeHead','bAvGs','pRfLT','cexFI','36stMuaJ','return\x20(function()\x20','error','kHrOS','IMObK','HCvbS','bill_print.ejs','kvrtQ','YSVTL','launch','bMmwC','jeWuU','Sueyh','yWiYy','LlnSP','string','application/pdf','DKsSB','ryelP','sqNVj','XnSWp','findOne','stateObject','dbName','UVDbL','FdmKA','table','setViewport','โหลดเอกสารเลขที่\x20\x22','rqwIS','VyzDg','stringify','VTAly','zMXNT','VgdLs','setContent','13705ILyCLh','length','dagpr','stxiN','wdKnb','suygn','dbColl_receipt','hvjip','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','IFIkm','sdOoQ','lWHyx','TxRDd','PAGE_RECEIPT','URrBG','CrOEg','AnRto','xrTuJ','renderView','qjUXP','JwhyN','hsjZJ','wXHcy','OwMCO','input','immvk','IXGzL','asmog','WlPJR','yzmVQ','yCChf','puppeteer','convert_DocPrint','ZpGgh','/bill','ZKySe','FKLqj','paLQe','GjUQz','pMFHU','ไม่พบชื่อคอเล็กชั่น','connect','dbUrl','green','/fetch/modal','getLogoBase64Src','qjTtq','TfsMy','ZZCff','WRgoY','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','YuCao','qZXjZ','flKtj','Wlqid','/quotation','pdf','oKgpK','NqlMs','sXpgz','hDkUK','SHjau','FeySP','rzSXn','/search','rsNEV','ROKqF','\x22ไม่สามารถเขียนข้อมูลลง\x20','eSMbH','lDjvb','image','push','XJftw','dbColl_quotation','zoAdq','LOGO_BILL_FILENAME','VqZoj','jHmTX','newPage','\x22\x20เอกสาร','trace','sAUrC','ewQIN','acknowledged','mzdrJ','rkJIB','WNGQs','xqURq','LOGO_RECEIPT_FILENAME','ไม่พบเอกสารเลขที่\x20\x22','PSSmZ','image/jpeg','getSettingsByCollection','dbColl_bill','VvdfT','GTMJZ','BErXQ','byUth','dbColl_invoice','maimL','kfmpJ','xQXwV','cmzop','/invoice','tFlzO','getCustomers_for_Modal','ypMdq','gNQAC','QipEa','XABdA','XbfTW','xZlLG','mWYEk','red','UrfRf','test','qYdAP','LOGO_QUOTATION_FILENAME','mcGEK','ZjEMy','gger','พบ\x20\x22','IXeIe','2391414PcAXgo','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','GVeDc','PAGE_INVOICE','prototype','uBHQm','HJDFj','/receipt','pTzjt','invoice_print.ejs','get','QCbhS','yellow','HvECs','WXUch','kjSLG','modifiedCount','gGpUV','bHzwA','KgLoT','DjkpF','chain','HSExl','finish','WZuQH','split','hlRra','zodqa','ALWCm','KDbNk','end','mqnaK','/status','close','send','lpTJo','jYcPh','sQxbA','Xftqv','SeRYY','zYLcY','attachment;\x20filename=quotation-','call','yzAiI','Ttjqw','body','xiwAO','dbColl_settings_Invoice','idlZC','toArray','getSessionData_sign','vecio','aLSyk','docId','vQfeO','screenshot','uqcJM','getCollName_by_DocTitle','ZngEH','dXoYT','1683910eTgaph','OqnJB','log','while\x20(true)\x20{}','OejkH','dbColl_settings_Bill','VopHH','XVvKA','rHoKz','aggregate','Hgfag','qltIK','RKHlp','isAuth','jyPyg','42VuvngA','getSessionData','pJIwy','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','IdOGl','GRhCe','apply','kQLlT','vYRTC','eBjoc','/load','FOMEh','QcFBi','BMzpK','ImEtW','/changes','aqURW','โหลดลายเซ็น\x20\x22','VYpiF','LTUAq','KQdEc','umyKe','PAGE_BILL','jCcgS','info','join','ZraCV','mWaEP','CINjY','eVcyq','sQooB','toString','ABDFK','HkiAz','dbColl_settings_Quotation','lTGxe','ReYkI','function\x20*\x5c(\x20*\x5c)','HeTXd','collection','VYFFj','quotation_print.ejs','cancel','VuHpY','floor','Vpqlx','vXxzi','dQlgd','YwZLi','NHPBT','239590ExbfpY','{}.constructor(\x22return\x20this\x22)(\x20)','proposerId','formatDate','init','xFftw','ZpCId','RXkDh','lPXrl','NvWTI','17421uxOCNv','RAyzq','reBrO','debu','.pdf','zLlWK','uwNxg','qZetJ','getUser_sign','176780ULotwh','gADaR','cVBlf','ZCnkK'];_0x475d=function(){return _0x1a6dc0;};return _0x475d();}function _0x54b2(_0x2b11b1,_0x4e9e89){const _0x1bbaca=_0x475d();return _0x54b2=function(_0x3778b9,_0x2eaa67){_0x3778b9=_0x3778b9-0x1d5;let _0x58117d=_0x1bbaca[_0x3778b9];return _0x58117d;},_0x54b2(_0x2b11b1,_0x4e9e89);}import*as _0x4aa089 from'../mymodule/myDocs.js';const w=_0x40b709(0x254),I=_0x40b709(0x284),O=_0x40b709(0x29f),A=_0x40b709(0x23f),H=[I+_0x40b709(0x2f2),w+_0x40b709(0x2f2),O+'/changes',A+'/changes'],j=[I+_0x40b709(0x1d8),w+_0x40b709(0x1d8),O+_0x40b709(0x1d8),A+_0x40b709(0x1d8)],M=[I+'/status',w+'/status',O+_0x40b709(0x2b8),A+_0x40b709(0x2b8)],G=[I+_0x40b709(0x25d),w+'/search',O+_0x40b709(0x25d),A+_0x40b709(0x25d)],q=[I+'/load',w+_0x40b709(0x2ed),O+_0x40b709(0x2ed),A+_0x40b709(0x2ed)],x=_0x40b709(0x249),V='/user/signature';b[_0x40b709(0x1eb)](G,_0x2b2c43[_0x40b709(0x2e1)],async(_0x1ce800,_0x520cb6)=>{const _0x412506=_0x40b709,_0x3fa3f0={'VYFFj':'error\x20===>\x20','IXeIe':'red','lDjvb':_0x412506(0x248),'HCvbS':function(_0x2da099,_0x4c7e3a){return _0x2da099(_0x4c7e3a);},'ztLVK':function(_0x32974d,_0xb5619a){return _0x32974d+_0xb5619a;},'gpBuk':function(_0x212511,_0x3affc2){return _0x212511+_0x3affc2;},'IkLdw':_0x412506(0x1fa),'wvrTg':_0x412506(0x316),'XbfTW':function(_0x15f457,_0x121b5f){return _0x15f457!==_0x121b5f;},'sAUrC':_0x412506(0x2be),'NHPBT':function(_0x317d82,_0x432923){return _0x317d82===_0x432923;},'McdNG':_0x412506(0x30e),'WEAyA':_0x412506(0x324),'FjMNN':_0x412506(0x2e6),'VgdLs':function(_0x34df3e,_0xbb8969){return _0x34df3e===_0xbb8969;},'jyPyg':_0x412506(0x232),'VvdfT':_0x412506(0x2ff)};let {sip:_0x1ea920,collName:_0x4f653a,statusNumberFilter:_0x337940}=_0x1ce800['body'];_0x1ea920=_0x1ea920[_0x412506(0x1e5)](/[!@#$%^&*<>]/g,'')??null;let {userId:_0x529a7f,userAuthority:_0x63af4b}=_0x4e9b62['getSessionData'](_0x1ce800);_0x529a7f=_0x529a7f&&_0x3fa3f0[_0x412506(0x1fe)](Number,_0x529a7f),_0x337940&&(_0x337940=_0x337940?_0x337940[_0x412506(0x2b1)](',')['map'](_0x487b58=>Number(_0x487b58)):[0x1,0x2,0x3,0xa]);const _0x30737d=new _0x3bcaa8(global[_0x412506(0x247)]);try{if(_0x3fa3f0[_0x412506(0x28b)](_0x3fa3f0[_0x412506(0x26e)],_0x3fa3f0[_0x412506(0x26e)]))_0x2b7e35[_0x412506(0x2d6)](_0x3fa3f0[_0x412506(0x30b)],_0x581a28),_0x5adf43[_0x412506(0x2ba)](_0x5b42b9[_0x412506(0x218)]({'isPrint':!0x1,'class':_0x3fa3f0['IXeIe'],'msg':_0x1f9701['message']}));else{await _0x30737d['connect']();const _0x497a3a=_0x30737d['db'](global[_0x412506(0x210)])[_0x412506(0x30a)](_0x4f653a);if(_0x1ea920){if(_0x3fa3f0[_0x412506(0x314)](_0x3fa3f0['McdNG'],_0x3fa3f0['WEAyA'])){const _0x501666=_0x44604a['getSessionData_sign'](_0x18c5f4);return _0x287d18[_0x412506(0x2ba)](_0x427006['stringify']({..._0x501666,'isLoad':!0x0,'class':_0x3fa3f0[_0x412506(0x262)],'msg':_0x412506(0x2f4)+_0x36a199+_0x412506(0x335)}));}else{var _0xd4047e=[{'$or':[{'docId':{'$regex':_0x1ea920,'$options':'i'}},{'docDate':{'$regex':_0x1ea920,'$options':'i'}},{'customerName':{'$regex':_0x1ea920,'$options':'i'}}]}];['O','A'][_0x412506(0x1f0)](_0x63af4b)||_0xd4047e[_0x412506(0x264)]({'proposerId':_0x529a7f}),_0x337940&&_0xd4047e[_0x412506(0x264)]({'docStatusNumber':{'$in':_0x337940}});var _0x4d82ef=await _0x497a3a[_0x412506(0x2dd)]([{'$match':{'$and':_0xd4047e}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])[_0x412506(0x2c9)]();}}else var _0x4d82ef=[];let _0x40c66b=_0x412506(0x296)+_0x4d82ef[_0x412506(0x21e)]+_0x412506(0x26c);return['O','A'][_0x412506(0x1f0)](_0x63af4b)||(_0x40c66b+=_0x3fa3f0['FjMNN']),_0x520cb6[_0x412506(0x2ba)](JSON[_0x412506(0x218)]({'searchFound':_0x4d82ef,'isSearch':!0x0,'class':_0x3fa3f0[_0x412506(0x262)],'msg':_0x40c66b}));}}catch(_0x560d8b){return _0x3fa3f0[_0x412506(0x21b)](_0x3fa3f0[_0x412506(0x2e2)],_0x3fa3f0[_0x412506(0x2e2)])?(console[_0x412506(0x2d6)](_0x560d8b),_0x520cb6[_0x412506(0x2ba)](JSON[_0x412506(0x218)]({'isSearch':!0x1,'class':_0x3fa3f0[_0x412506(0x297)],'msg':_0x560d8b[_0x412506(0x1d7)]}))):!![];}finally{_0x3fa3f0[_0x412506(0x28b)](_0x3fa3f0[_0x412506(0x27b)],_0x3fa3f0[_0x412506(0x27b)])?_0x5851a7=WHNMnZ[_0x412506(0x1fe)](_0x2834b5,WHNMnZ['ztLVK'](WHNMnZ[_0x412506(0x1db)](WHNMnZ['IkLdw'],WHNMnZ[_0x412506(0x32c)]),');'))():_0x30737d[_0x412506(0x2b9)]();}}),b[_0x40b709(0x1eb)](q,_0x2b2c43[_0x40b709(0x2e1)],async(_0x4a26cb,_0x86be84)=>{const _0x1a2144=_0x40b709,_0x553a32={'bHzwA':_0x1a2144(0x28e),'qZXjZ':_0x1a2144(0x1e4),'YwZLi':_0x1a2144(0x245),'wGlQK':function(_0x187818,_0xec1b06){return _0x187818(_0xec1b06);},'KDbNk':function(_0x48df7a,_0x2d4efb){return _0x48df7a===_0x2d4efb;},'eSMbH':'ZLbHH','lTGxe':_0x1a2144(0x248),'xQXwV':function(_0x34a4de,_0x4d9e66){return _0x34a4de!==_0x4d9e66;},'zoAdq':_0x1a2144(0x27e),'iMvlE':function(_0x4298e2,_0x1c1322){return _0x4298e2!==_0x1c1322;},'kjSLG':_0x1a2144(0x320),'WZuQH':_0x1a2144(0x2ef)};let {docId:_0x10a504,docTitle:_0x1db431,collName:_0x52ee3a}=_0x4a26cb[_0x1a2144(0x2c5)];if(_0x52ee3a||(_0x52ee3a=_0x4aa089[_0x1a2144(0x2d1)](_0x1db431)),!_0x52ee3a)return _0x86be84[_0x1a2144(0x2ba)](JSON['stringify']({'isStatus':!0x1,'class':_0x553a32[_0x1a2144(0x2aa)],'msg':_0x553a32[_0x1a2144(0x313)]}));let {userId:_0x7b2ae,userAuthority:_0x231f02}=_0x4e9b62[_0x1a2144(0x2e4)](_0x4a26cb);_0x7b2ae=_0x7b2ae&&_0x553a32[_0x1a2144(0x32d)](Number,_0x7b2ae);const _0x1f1fa9=new _0x3bcaa8(global['dbUrl']);try{if(_0x553a32[_0x1a2144(0x2b5)](_0x553a32[_0x1a2144(0x261)],_0x553a32['eSMbH'])){await _0x1f1fa9[_0x1a2144(0x246)]();const _0x365f0e=_0x1f1fa9['db'](global[_0x1a2144(0x210)])[_0x1a2144(0x30a)](_0x52ee3a);let _0x5ade24={'docId':_0x10a504};['O','A']['includes'](_0x231f02)||(_0x5ade24[_0x1a2144(0x317)]=_0x7b2ae);var _0x4249be=await _0x365f0e[_0x1a2144(0x20e)](_0x5ade24,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x4249be?(_0x4249be[_0x1a2144(0x1e8)]=_0x4e9b62[_0x1a2144(0x327)](_0x4249be['proposerId']),_0x86be84[_0x1a2144(0x2ba)](JSON[_0x1a2144(0x218)]({'doc':_0x4249be,'isLoad':!0x0,'class':_0x553a32[_0x1a2144(0x306)],'msg':_0x1a2144(0x215)+_0x10a504+'\x22\x20เรียบร้อยแล้ว'}))):_0x86be84['send'](JSON['stringify']({'isLoad':!0x1,'class':_0x553a32[_0x1a2144(0x2aa)],'msg':'ไม่พบเอกสารเลขที่\x20\x22'+_0x10a504+'\x22'}));}else return _0x34de41['log'](_0x294ad1),_0x4bfe1f[_0x1a2144(0x2ba)](_0x4df014[_0x1a2144(0x218)]({'isLoad':!0x1,'class':_0x553a32[_0x1a2144(0x2aa)],'msg':_0x1f2662[_0x1a2144(0x1d7)]}));}catch(_0x5936bb){if(_0x553a32[_0x1a2144(0x282)](_0x553a32[_0x1a2144(0x267)],_0x553a32[_0x1a2144(0x267)]))_0x2084e3[_0x1a2144(0x2d6)](_0x553a32[_0x1a2144(0x251)],_0x5daca1),_0x5b273e[_0x1a2144(0x2ba)](_0x3fea6a[_0x1a2144(0x218)]({'isPrint':!0x1,'class':_0x553a32[_0x1a2144(0x2aa)],'msg':_0x222422[_0x1a2144(0x1d7)]}));else return console['log'](_0x5936bb),_0x86be84['send'](JSON[_0x1a2144(0x218)]({'isLoad':!0x1,'class':_0x553a32[_0x1a2144(0x2aa)],'msg':_0x5936bb[_0x1a2144(0x1d7)]}));}finally{if(_0x553a32['iMvlE'](_0x553a32[_0x1a2144(0x2a7)],_0x553a32[_0x1a2144(0x2b0)]))_0x1f1fa9[_0x1a2144(0x2b9)]();else return![];}}),b[_0x40b709(0x2a2)](x,_0x2b2c43[_0x40b709(0x2e1)],async(_0x3236c0,_0x3ef8ec)=>{const _0x2cbb81=_0x40b709,_0x271290={'VTAly':function(_0x4c191e,_0x3c384c){return _0x4c191e!==_0x3c384c;},'qjTtq':_0x2cbb81(0x2a9),'NDOza':'green','HeTXd':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','IXtzg':function(_0x3d9a8f,_0x2c3006){return _0x3d9a8f!==_0x2c3006;},'QipEa':_0x2cbb81(0x2f0),'NqlMs':_0x2cbb81(0x21f),'GjUQz':'red'};try{if(_0x271290[_0x2cbb81(0x219)](_0x271290[_0x2cbb81(0x24b)],_0x271290[_0x2cbb81(0x24b)]))_0x100ca0['close']();else{const _0xe55e52=await _0x4aa089[_0x2cbb81(0x286)](),_0x3fc012=await _0x4aa089[_0x2cbb81(0x1e7)]();return _0x3ef8ec[_0x2cbb81(0x2ba)](JSON['stringify']({'DATA_CUSTOMERS':_0xe55e52,'DATA_ITEMS':_0x3fc012,'isFetch':!0x0,'class':_0x271290['NDOza'],'msg':_0x271290[_0x2cbb81(0x309)]}));}}catch(_0x450248){if(_0x271290['IXtzg'](_0x271290[_0x2cbb81(0x289)],_0x271290[_0x2cbb81(0x257)]))return console[_0x2cbb81(0x2d6)](_0x450248),_0x3ef8ec[_0x2cbb81(0x2ba)](JSON[_0x2cbb81(0x218)]({'isFetch':!0x1,'class':_0x271290[_0x2cbb81(0x243)],'msg':_0x450248[_0x2cbb81(0x1d7)]}));else{const _0x1a3ebf=_0x4b8e04[_0x2cbb81(0x2e9)](_0x101f33,arguments);return _0x2c86d7=null,_0x1a3ebf;}}}),b['post'](j,_0x2b2c43['isAuth'],async(_0x140e63,_0x119ed8)=>{const _0x407019=_0x40b709,_0x2b7694={'NeFIG':'function\x20*\x5c(\x20*\x5c)','lPXrl':_0x407019(0x24f),'wNdmN':function(_0x3cc29e,_0x52b78e){return _0x3cc29e(_0x52b78e);},'kfmpJ':_0x407019(0x319),'RKHlp':function(_0x5de082,_0x4fdb7c){return _0x5de082+_0x4fdb7c;},'hvjip':_0x407019(0x2ad),'xqURq':function(_0x42e28e,_0x1657fa){return _0x42e28e+_0x1657fa;},'umyKe':_0x407019(0x235),'kQLlT':function(_0x1870cf){return _0x1870cf();},'mlOMW':function(_0x4600a9,_0x41f5d5,_0x1e32e3){return _0x4600a9(_0x41f5d5,_0x1e32e3);},'xZlLG':function(_0x44d976,_0x1bc109){return _0x44d976(_0x1bc109);},'pFvLX':function(_0x41ff60,_0x3e7a35){return _0x41ff60+_0x3e7a35;},'eBjoc':function(_0x125d8f,_0x1cad0e){return _0x125d8f+_0x1cad0e;},'HSExl':_0x407019(0x1fa),'CrOEg':_0x407019(0x316),'wXHcy':function(_0x58b4c9,_0x596b12){return _0x58b4c9!==_0x596b12;},'wXeTj':_0x407019(0x32b),'kHrOS':function(_0x1206d3,_0x54e995){return _0x1206d3===_0x54e995;},'qQxSJ':_0x407019(0x30c),'oMaLH':_0x407019(0x2a1),'rzSXn':'receipt_print.ejs','URrBG':function(_0x813f8,_0x2c311f){return _0x813f8===_0x2c311f;},'mWUnV':_0x407019(0x1ff),'ZTaWv':_0x407019(0x28e),'DKsSB':function(_0x516f60,_0x47afa9){return _0x516f60==_0x47afa9;},'jCcgS':'print','LDuDD':_0x407019(0x248),'flKtj':function(_0x3be823,_0x5140e3){return _0x3be823==_0x5140e3;},'ZZCff':_0x407019(0x263),'flYZj':'yXpvJ','uBHQm':_0x407019(0x1fd),'reBrO':_0x407019(0x23c),'sQxbA':'networkidle0','ydEKR':function(_0x55703a,_0x58dcaa){return _0x55703a/_0x58dcaa;},'DjkpF':function(_0x201d4c,_0x33b518){return _0x201d4c*_0x33b518;},'oKgpK':'jpeg','pRfLT':_0x407019(0x278),'bJEym':function(_0x559b0a,_0x3e2c7d){return _0x559b0a==_0x3e2c7d;},'FdmKA':_0x407019(0x255),'YIzYq':function(_0x2d5151,_0x1b05c4){return _0x2d5151!==_0x1b05c4;},'lpTJo':_0x407019(0x310),'RXkDh':_0x407019(0x33d),'WNGQs':_0x407019(0x209),'QWkRb':_0x407019(0x2a5),'zFmMJ':_0x407019(0x1e4),'xnVUJ':_0x407019(0x25f),'eVcyq':'aabuj'},{docId:_0x51f342,action:_0x3406ab,docTitle:_0x44ff39}=_0x140e63['body'],_0x626d60=new _0x3bcaa8(global[_0x407019(0x247)]);try{if(_0x2b7694[_0x407019(0x233)](_0x2b7694['wXeTj'],_0x2b7694['wXeTj']))nqmoxD[_0x407019(0x1ee)](_0x5b7e38,this,function(){const _0x43ff0a=_0x407019,_0x2c8cea=new _0xd50ae9(nqmoxD['NeFIG']),_0x285e03=new _0x517c57(nqmoxD[_0x43ff0a(0x31d)],'i'),_0x331a51=nqmoxD[_0x43ff0a(0x1e1)](_0x35cca7,nqmoxD[_0x43ff0a(0x281)]);!_0x2c8cea['test'](nqmoxD[_0x43ff0a(0x2e0)](_0x331a51,nqmoxD[_0x43ff0a(0x224)]))||!_0x285e03['test'](nqmoxD[_0x43ff0a(0x274)](_0x331a51,nqmoxD[_0x43ff0a(0x2f8)]))?nqmoxD[_0x43ff0a(0x1e1)](_0x331a51,'0'):nqmoxD[_0x43ff0a(0x2ea)](_0x38ad3f);})();else{if(_0x2b7694[_0x407019(0x1fc)](_0x44ff39,global['PAGE_QUOTATION']))var _0x58aae7=global[_0x407019(0x266)],_0x17ac98=_0x2b7694['qQxSJ'],_0xa8a371=_0x59b12c[_0x407019(0x24a)](global[_0x407019(0x292)]),{dataSettings:_0x2e9f9c}=await _0x59b12c[_0x407019(0x279)](global[_0x407019(0x305)]);else{if(_0x2b7694['kHrOS'](_0x44ff39,global[_0x407019(0x29b)]))var _0x58aae7=global[_0x407019(0x27f)],_0x17ac98=_0x2b7694['oMaLH'],_0xa8a371=_0x59b12c[_0x407019(0x24a)](global['LOGO_INVOICE_FILENAME']),{dataSettings:_0x2e9f9c}=await _0x59b12c[_0x407019(0x279)](global[_0x407019(0x2c7)]);else{if(_0x2b7694[_0x407019(0x1fc)](_0x44ff39,global[_0x407019(0x22a)]))var _0x58aae7=global[_0x407019(0x223)],_0x17ac98=_0x2b7694[_0x407019(0x25c)],_0xa8a371=_0x59b12c[_0x407019(0x24a)](global[_0x407019(0x275)]),{dataSettings:_0x2e9f9c}=await _0x59b12c['getSettingsByCollection'](global['dbColl_settings_Receipt']);else{if(_0x2b7694[_0x407019(0x22b)](_0x44ff39,global[_0x407019(0x2f9)]))var _0x58aae7=global[_0x407019(0x27a)],_0x17ac98=_0x2b7694['mWUnV'],_0xa8a371=_0x59b12c['getLogoBase64Src'](global[_0x407019(0x268)]),{dataSettings:_0x2e9f9c}=await _0x59b12c[_0x407019(0x279)](global[_0x407019(0x2d9)]);}}}await _0x626d60[_0x407019(0x246)]();var _0x4cc71a=await _0x626d60['db'](global['dbName'])[_0x407019(0x30a)](_0x58aae7)[_0x407019(0x20e)]({'docId':_0x51f342});if(!_0x4cc71a)return _0x119ed8[_0x407019(0x2ba)](JSON[_0x407019(0x218)]({'isLoad':!0x1,'class':_0x2b7694[_0x407019(0x1f2)],'msg':_0x407019(0x276)+_0x51f342+'\x22'}));_0x4cc71a[_0x407019(0x317)]&&(_0x4cc71a[_0x407019(0x1ed)]=_0x4e9b62['getUser_sign'](_0x4cc71a[_0x407019(0x317)]));const _0x4d18af=_0x4e9b62[_0x407019(0x2e4)](_0x140e63),_0x47d069=_0x4aa089[_0x407019(0x23d)](_0x4cc71a),_0x57c2ae=_0x4fcce0[_0x407019(0x2fc)](folderViews,_0x17ac98),_0x14eb13=await _0x59b12c[_0x407019(0x22f)](_0x57c2ae,_0x119ed8,{'title':_0x44ff39,'time':_0x18b199['formatDate'](new Date()),..._0x4d18af,'logoSrc_base64':_0xa8a371,..._0x2e9f9c,'action':_0x3406ab,'doc':_0x47d069});if(_0x2b7694[_0x407019(0x20a)](_0x3406ab,_0x2b7694[_0x407019(0x2fa)]))_0x119ed8[_0x407019(0x2ba)](JSON[_0x407019(0x218)]({'isPrint':!0x0,'class':_0x2b7694['LDuDD'],'htmlPage':_0x14eb13}));else{if(_0x2b7694[_0x407019(0x252)](_0x3406ab,_0x2b7694[_0x407019(0x24d)])){if(_0x2b7694[_0x407019(0x233)](_0x2b7694['flYZj'],_0x2b7694[_0x407019(0x29d)])){const _0x4edbbb=await(await import(_0x2b7694['reBrO']))['launch'](),_0xfc2903=await _0x4edbbb[_0x407019(0x26b)]();await _0xfc2903[_0x407019(0x21c)](_0x14eb13,{'waitUntil':_0x2b7694[_0x407019(0x2bd)],'timeout':0x2710}),await new Promise(_0xb59b10=>setTimeout(_0xb59b10,0x3e8));const _0x2b95e7=_0x2b7694['ydEKR'](29.7,2.54),_0x33b220=Math[_0x407019(0x30f)](_0x2b7694[_0x407019(0x2ac)](_0x2b95e7,0x60));await _0xfc2903[_0x407019(0x214)]({'width':0x320,'height':_0x33b220,'deviceScaleFactor':0x1});const _0x42b9d9=await _0xfc2903[_0x407019(0x2cf)]({'type':_0x2b7694[_0x407019(0x256)],'fullPage':!0x0,'omitBackground':!0x1});await _0x4edbbb[_0x407019(0x2b9)]();const _0x4d6085=_0x4cc71a[_0x407019(0x2cd)][_0x407019(0x1e5)](/\//g,'');_0x119ed8[_0x407019(0x1f5)](0xc8,{'Content-Type':_0x2b7694[_0x407019(0x1f7)],'Content-Disposition':_0x407019(0x2c1)+_0x4d6085+_0x407019(0x1e9),'Content-Length':_0x42b9d9[_0x407019(0x21e)]}),_0x119ed8['end'](_0x42b9d9);}else{let _0x324827;try{_0x324827=nqmoxD[_0x407019(0x28c)](_0x4b15ea,nqmoxD['pFvLX'](nqmoxD[_0x407019(0x2ec)](nqmoxD[_0x407019(0x2ae)],nqmoxD[_0x407019(0x22c)]),');'))();}catch(_0x20f72e){_0x324827=_0x5da165;}return _0x324827;}}else{if(_0x2b7694['bJEym'](_0x3406ab,_0x2b7694[_0x407019(0x212)])){if(_0x2b7694[_0x407019(0x1ef)](_0x2b7694[_0x407019(0x2bb)],_0x2b7694[_0x407019(0x31c)])){const _0x181627=await(await import(_0x2b7694[_0x407019(0x321)]))[_0x407019(0x202)](),_0x817b1d=await _0x181627['newPage']();await _0x817b1d['setContent'](_0x14eb13,{'waitUntil':_0x2b7694[_0x407019(0x2bd)],'timeout':0x2710}),await new Promise(_0x3f15d4=>setTimeout(_0x3f15d4,0x3e8));const _0x278a50=await _0x817b1d[_0x407019(0x255)]({'format':'A4','printBackground':!0x0});await _0x181627['close']();const _0x2c4f37=_0x4cc71a['docId']['replace'](/\//g,'');_0x119ed8[_0x407019(0x1f5)](0xc8,{'Content-Type':_0x2b7694[_0x407019(0x273)],'Content-Disposition':'attachment;\x20filename=quotation-'+_0x2c4f37+_0x407019(0x323),'Content-Length':_0x278a50[_0x407019(0x21e)]}),_0x119ed8[_0x407019(0x2b6)](_0x278a50);}else _0x222f39[_0x407019(0x2b9)]();}}}}}catch(_0xf25675){if(_0x2b7694[_0x407019(0x22b)](_0x2b7694['QWkRb'],_0x2b7694['QWkRb']))console[_0x407019(0x2d6)](_0x2b7694['zFmMJ'],_0xf25675),_0x119ed8['send'](JSON['stringify']({'isPrint':!0x1,'class':_0x2b7694['ZTaWv'],'msg':_0xf25675[_0x407019(0x1d7)]}));else{if(_0x4d0e96){const _0x5a7964=_0x3b1bb2[_0x407019(0x2e9)](_0x526403,arguments);return _0x37cc95=null,_0x5a7964;}}}finally{if(_0x2b7694['YIzYq'](_0x2b7694['xnVUJ'],_0x2b7694[_0x407019(0x300)]))_0x626d60[_0x407019(0x2b9)]();else{if(_0x405698)return _0x4bf803;else nqmoxD[_0x407019(0x28c)](_0x4a90bc,0x0);}}}),b[_0x40b709(0x1eb)](H,_0x2b2c43[_0x40b709(0x2e1)],async(_0x5b0f47,_0x1ac916)=>{const _0x29d6e6=_0x40b709,_0x47ced9={'uomAU':function(_0x56c12a,_0x414bdc){return _0x56c12a+_0x414bdc;},'zMXNT':_0x29d6e6(0x322),'xHYPT':'gger','sdOoQ':'action','XABdA':function(_0x4a6625,_0x158b73){return _0x4a6625===_0x158b73;},'WlPJR':_0x29d6e6(0x304),'cmzop':_0x29d6e6(0x307),'HJDFj':_0x29d6e6(0x28e),'mWYEk':function(_0xd8ac74,_0x5745be){return _0xd8ac74<_0x5745be;},'WRgoY':_0x29d6e6(0x2a4),'xrTuJ':'ไม่พบประวัติการเปลี่ยนแปลง','nJpZW':'doc_changes.ejs','ABDFK':_0x29d6e6(0x248),'rqwIS':function(_0x3c45f6,_0x90c2d6){return _0x3c45f6!==_0x90c2d6;},'xFftw':'WunTb','yWiYy':_0x29d6e6(0x1e4),'NxaWX':_0x29d6e6(0x2a6),'cexFI':_0x29d6e6(0x23a)},{docId:_0x414abd,docTitle:_0x545e41}=_0x5b0f47[_0x29d6e6(0x2c5)],_0x31f410=_0x4aa089[_0x29d6e6(0x2d1)](_0x545e41),_0x3f850d=new _0x3bcaa8(global[_0x29d6e6(0x247)]);try{if(_0x47ced9[_0x29d6e6(0x28a)](_0x47ced9[_0x29d6e6(0x239)],_0x47ced9[_0x29d6e6(0x283)])){if(_0x55bc1f){const _0x52e0c5=_0x93f9a2[_0x29d6e6(0x2e9)](_0x25e982,arguments);return _0x3289aa=null,_0x52e0c5;}}else{await _0x3f850d[_0x29d6e6(0x246)]();var _0x4c040e=await _0x3f850d['db'](global[_0x29d6e6(0x210)])['collection'](_0x31f410)[_0x29d6e6(0x20e)]({'docId':_0x414abd});if(!_0x4c040e)return _0x1ac916['send'](JSON[_0x29d6e6(0x218)]({'isPrint':!0x1,'class':_0x47ced9[_0x29d6e6(0x29e)],'msg':_0x29d6e6(0x276)+_0x414abd+'\x22'}));const _0x2410e8=_0x4c040e[_0x29d6e6(0x337)]||[];if(_0x47ced9[_0x29d6e6(0x28d)](_0x2410e8[_0x29d6e6(0x21e)],0x1))return _0x1ac916[_0x29d6e6(0x2ba)](JSON[_0x29d6e6(0x218)]({'isPrint':!0x1,'class':_0x47ced9[_0x29d6e6(0x24e)],'msg':_0x47ced9[_0x29d6e6(0x22e)]}));const _0x19b556=_0x4fcce0['join'](folderViews,_0x47ced9['nJpZW']),_0x586241=await _0x59b12c[_0x29d6e6(0x22f)](_0x19b556,_0x1ac916,{'title':_0x4c040e['docId'],'time':_0x18b199[_0x29d6e6(0x318)](new Date()),'changesHistory':_0x2410e8});_0x1ac916[_0x29d6e6(0x2ba)](JSON['stringify']({'isPrint':!0x0,'class':_0x47ced9[_0x29d6e6(0x303)],'htmlPage':_0x586241}));}}catch(_0x5e46de){if(_0x47ced9[_0x29d6e6(0x216)](_0x47ced9[_0x29d6e6(0x31a)],_0x47ced9[_0x29d6e6(0x31a)])){const _0xb165f0=_0x53cb81[_0x29d6e6(0x2e9)](_0x51b5dd,arguments);return _0xc96a23=null,_0xb165f0;}else console['log'](_0x47ced9[_0x29d6e6(0x206)],_0x5e46de),_0x1ac916[_0x29d6e6(0x2ba)](JSON[_0x29d6e6(0x218)]({'isPrint':!0x1,'class':_0x47ced9[_0x29d6e6(0x29e)],'msg':_0x5e46de['message']}));}finally{_0x47ced9['rqwIS'](_0x47ced9[_0x29d6e6(0x33b)],_0x47ced9[_0x29d6e6(0x1f8)])?_0x3f850d[_0x29d6e6(0x2b9)]():function(){return!![];}[_0x29d6e6(0x333)](nuLfUk['uomAU'](nuLfUk[_0x29d6e6(0x21a)],nuLfUk['xHYPT']))[_0x29d6e6(0x2c2)](nuLfUk[_0x29d6e6(0x227)]);}}),b[_0x40b709(0x2a2)](V,_0x2b2c43[_0x40b709(0x2e1)],async(_0x5b78fa,_0x4a6eef)=>{const _0xaa797b=_0x40b709,_0x300139={'mhLdG':_0xaa797b(0x308),'FeySP':_0xaa797b(0x24f),'IXGzL':function(_0x1d191a,_0x3365b7){return _0x1d191a(_0x3365b7);},'xiwAO':_0xaa797b(0x319),'daShu':function(_0x325c7e,_0x19c9a4){return _0x325c7e+_0x19c9a4;},'vXxzi':_0xaa797b(0x2ad),'ZpGgh':_0xaa797b(0x235),'ZPXVO':function(_0x2c46ff){return _0x2c46ff();},'immvk':function(_0x559709,_0x4d1f46){return _0x559709===_0x4d1f46;},'QCbhS':_0xaa797b(0x2f5),'gSOPg':_0xaa797b(0x248),'UVDbL':function(_0x51f7d2,_0x31985f){return _0x51f7d2===_0x31985f;},'akQYo':_0xaa797b(0x332),'gNQAC':_0xaa797b(0x269),'vICRh':_0xaa797b(0x28e),'rsNEV':function(_0x3a0bf6,_0x2497b4){return _0x3a0bf6!==_0x2497b4;},'dWZHZ':_0xaa797b(0x2e5)};let {userId:_0x1e896e}=_0x4e9b62['getSessionData'](_0x5b78fa);_0x1e896e=_0x1e896e&&_0x300139[_0xaa797b(0x237)](Number,_0x1e896e);const _0x3a3487=new _0x3bcaa8(global[_0xaa797b(0x247)]);try{if(_0x300139[_0xaa797b(0x236)](_0x300139[_0xaa797b(0x2a3)],_0x300139[_0xaa797b(0x2a3)])){const _0x16fd93=_0x4e9b62[_0xaa797b(0x2ca)](_0x5b78fa);return _0x4a6eef['send'](JSON[_0xaa797b(0x218)]({..._0x16fd93,'isLoad':!0x0,'class':_0x300139['gSOPg'],'msg':'โหลดลายเซ็น\x20\x22'+_0x1e896e+_0xaa797b(0x335)}));}else _0x49298e[_0xaa797b(0x2b9)]();}catch(_0x156666){if(_0x300139[_0xaa797b(0x211)](_0x300139['akQYo'],_0x300139[_0xaa797b(0x288)])){const _0x258bae=new _0x4059fc(cOXyXh[_0xaa797b(0x1f3)]),_0x58b22f=new _0x33ac75(cOXyXh[_0xaa797b(0x25b)],'i'),_0x150fb0=cOXyXh[_0xaa797b(0x237)](_0x209c48,cOXyXh[_0xaa797b(0x2c6)]);!_0x258bae[_0xaa797b(0x290)](cOXyXh[_0xaa797b(0x340)](_0x150fb0,cOXyXh[_0xaa797b(0x311)]))||!_0x58b22f[_0xaa797b(0x290)](cOXyXh[_0xaa797b(0x340)](_0x150fb0,cOXyXh[_0xaa797b(0x23e)]))?cOXyXh['IXGzL'](_0x150fb0,'0'):cOXyXh['ZPXVO'](_0x238f25);}else return console[_0xaa797b(0x2d6)](_0x156666),_0x4a6eef[_0xaa797b(0x2ba)](JSON[_0xaa797b(0x218)]({'isLoad':!0x1,'class':_0x300139['vICRh'],'msg':_0x156666[_0xaa797b(0x1d7)]}));}finally{if(_0x300139[_0xaa797b(0x25e)](_0x300139[_0xaa797b(0x341)],_0x300139[_0xaa797b(0x341)])){const _0x237309=_0x478501[_0xaa797b(0x333)][_0xaa797b(0x29c)]['bind'](_0x406f4a),_0x2ccf4f=_0x3149ac[_0x41be0b],_0x4c34b0=_0xdf20b0[_0x2ccf4f]||_0x237309;_0x237309['__proto__']=_0x420ace[_0xaa797b(0x1d5)](_0x5d89a1),_0x237309[_0xaa797b(0x302)]=_0x4c34b0[_0xaa797b(0x302)][_0xaa797b(0x1d5)](_0x4c34b0),_0x56c17c[_0x2ccf4f]=_0x237309;}else _0x3a3487[_0xaa797b(0x2b9)]();}}),b[_0x40b709(0x1eb)](M,_0x2b2c43['isAuth'],async(_0x1ad410,_0x34ed04)=>{const _0x312027=_0x40b709,_0x9f910c={'OwMCO':function(_0x3697ad,_0x561f0a){return _0x3697ad!==_0x561f0a;},'qjUXP':_0x312027(0x287),'YuCao':_0x312027(0x244),'dXoYT':function(_0x3944f1,_0x213137){return _0x3944f1===_0x213137;},'NwtEM':function(_0x23455c,_0x250efa){return _0x23455c===_0x250efa;},'Atmxu':'hQXKR','mcGEK':_0x312027(0x1da),'kvrtQ':function(_0x3fb2aa,_0x442d50,_0x563779){return _0x3fb2aa(_0x442d50,_0x563779);},'CoOIe':function(_0x15377e){return _0x15377e();},'hUeqO':_0x312027(0x28e),'NvWTI':function(_0x400862,_0x3be58b){return _0x400862(_0x3be58b);},'jYcPh':_0x312027(0x2da),'GTMJZ':_0x312027(0x241),'qZetJ':_0x312027(0x2af),'OSvSy':_0x312027(0x30d),'yCChf':_0x312027(0x33a),'mzdrJ':function(_0x52d359,_0x1d1577){return _0x52d359==_0x1d1577;},'tZojn':_0x312027(0x225),'vecio':function(_0x557f5e,_0x6aeff0){return _0x557f5e==_0x6aeff0;},'bAvGs':function(_0x4a75e0,_0x21ad9c){return _0x4a75e0!==_0x21ad9c;},'maimL':_0x312027(0x299),'KCbgo':_0x312027(0x245),'pEEpX':function(_0xbeb91d,_0x2f86b4){return _0xbeb91d>_0x2f86b4;},'sXpgz':'green','stxiN':function(_0x17ce03,_0x3af526){return _0x17ce03<_0x3af526;},'fobMM':_0x312027(0x2a4),'ZjEMy':_0x312027(0x2f7),'JwhyN':_0x312027(0x1df),'NYZgi':'RgyoA','idlZC':'KbbDg','aLSyk':function(_0x845f68){return _0x845f68();}},_0x1e8772=[];let _0x426971=!0x1;const _0x2374af=async()=>{const _0x36c700=_0x312027;if(_0x9f910c[_0x36c700(0x234)](_0x9f910c[_0x36c700(0x230)],_0x9f910c[_0x36c700(0x250)])){if(_0x9f910c[_0x36c700(0x2d3)](_0x1e8772[_0x36c700(0x21e)],0x0)){if(_0x9f910c['NwtEM'](_0x9f910c['Atmxu'],_0x9f910c[_0x36c700(0x293)]))_0x24bb2e[_0x36c700(0x2b9)]();else{_0x426971=!0x1;return;}}_0x426971=!0x0;const {req:_0x29d219,res:_0x521ca9}=_0x1e8772['shift']();await _0x9f910c[_0x36c700(0x200)](_0x5a39d8,_0x29d219,_0x521ca9),_0x9f910c[_0x36c700(0x1d9)](_0x2374af);}else return _0xc2b214;},_0x5a39d8=async(_0x5973fd,_0x31dc35)=>{const _0x1e2582=_0x312027,_0x9d54ce={'Hgfag':function(_0x5a39a4,_0x45b8f8){const _0x4fafd3=_0x54b2;return _0x9f910c[_0x4fafd3(0x31e)](_0x5a39a4,_0x45b8f8);},'yzAiI':_0x9f910c[_0x1e2582(0x336)]},_0x126288=new _0x3bcaa8(global['dbUrl']);try{if(_0x9f910c['OwMCO'](_0x9f910c[_0x1e2582(0x2bc)],_0x9f910c[_0x1e2582(0x27c)])){let {userId:_0x43f136}=_0x4e9b62[_0x1e2582(0x2e4)](_0x5973fd);_0x43f136=_0x43f136&&_0x9f910c[_0x1e2582(0x31e)](Number,_0x43f136);let {docStatusNumber:_0x1b471d,docId:_0x2d1a84,action:_0x2e33d3,text:_0x1762a8,docTitle:_0x2d6f7f}=_0x5973fd[_0x1e2582(0x2c5)];if(_0x1b471d=_0x1b471d&&_0x9f910c['NvWTI'](Number,_0x1b471d),!_0x2d1a84||![_0x9f910c[_0x1e2582(0x326)],_0x9f910c[_0x1e2582(0x339)]]['includes'](_0x2e33d3))return _0x31dc35[_0x1e2582(0x2ba)](JSON[_0x1e2582(0x218)]({'isStatus':!0x1,'class':_0x9f910c[_0x1e2582(0x336)],'msg':_0x9f910c[_0x1e2582(0x23b)]}));if(_0x9f910c[_0x1e2582(0x271)](_0x2e33d3,_0x9f910c[_0x1e2582(0x339)])&&['1','2'][_0x1e2582(0x1f0)](_0x1b471d))return _0x31dc35[_0x1e2582(0x2ba)](JSON['stringify']({'isStatus':!0x1,'class':_0x9f910c[_0x1e2582(0x336)],'msg':_0x9f910c['tZojn']}));if(_0x9f910c[_0x1e2582(0x2cb)](_0x2e33d3,_0x9f910c[_0x1e2582(0x326)])&&_0x9f910c[_0x1e2582(0x1f6)](_0x1b471d,0x1))return _0x31dc35[_0x1e2582(0x2ba)](JSON[_0x1e2582(0x218)]({'isStatus':!0x1,'class':_0x9f910c['hUeqO'],'msg':_0x9f910c[_0x1e2582(0x280)]}));const _0x33a18b=_0x4aa089[_0x1e2582(0x2d1)](_0x2d6f7f);if(!_0x33a18b)return _0x31dc35[_0x1e2582(0x2ba)](JSON[_0x1e2582(0x218)]({'isStatus':!0x1,'class':_0x9f910c[_0x1e2582(0x336)],'msg':_0x9f910c[_0x1e2582(0x1dd)]}));const _0x3625b3=_0x126288['db'](global[_0x1e2582(0x210)])['collection'](_0x33a18b);if(!await _0x3625b3[_0x1e2582(0x20e)]({'docId':_0x2d1a84,'proposerId':_0x43f136}))return _0x31dc35[_0x1e2582(0x2ba)](JSON[_0x1e2582(0x218)]({'isStatus':!0x1,'class':_0x9f910c[_0x1e2582(0x336)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x2d1a84+'\x22'}));const _0x219e6e=_0x9f910c[_0x1e2582(0x271)](_0x2e33d3,_0x9f910c[_0x1e2582(0x326)])?0x2:0xa,_0x2533c0=await _0x3625b3['updateOne']({'docId':_0x2d1a84,'proposerId':_0x43f136},{'$set':{'docStatusNumber':_0x219e6e}});if(_0x9f910c['pEEpX'](_0x2533c0[_0x1e2582(0x2a8)],0x0))return _0x31dc35[_0x1e2582(0x2ba)](JSON[_0x1e2582(0x218)]({'isStatus':!0x0,'docId':_0x2d1a84,'docStatusNumber':_0x219e6e,'class':_0x9f910c[_0x1e2582(0x258)],'msg':_0x1762a8+'\x20\x22'+_0x2d1a84+'\x22\x20เรียบร้อยแล้ว'}));if(_0x2533c0[_0x1e2582(0x270)]&&_0x9f910c[_0x1e2582(0x220)](_0x2533c0[_0x1e2582(0x2a8)],0x1))return _0x31dc35[_0x1e2582(0x2ba)](JSON[_0x1e2582(0x218)]({'isStatus':!0x1,'docId':_0x2d1a84,'docStatusNumber':_0x1b471d,'class':_0x9f910c['fobMM'],'msg':_0x1e2582(0x260)+_0x2d1a84+'\x22'}));}else DDDHdz[_0x1e2582(0x2de)](_0x46f6fd,0x0);}catch(_0x6ce451){if(_0x9f910c['dXoYT'](_0x9f910c[_0x1e2582(0x294)],_0x9f910c[_0x1e2582(0x231)]))return _0x3d556a[_0x1e2582(0x2d6)](_0x505385),_0x20d768[_0x1e2582(0x2ba)](_0x5e5335[_0x1e2582(0x218)]({'isLoad':!0x1,'class':_0x9d54ce[_0x1e2582(0x2c3)],'msg':_0x2ea721[_0x1e2582(0x1d7)]}));else console[_0x1e2582(0x2d6)](_0x6ce451),_0x31dc35[_0x1e2582(0x2ba)](JSON['stringify']({'isStatus':!0x1,'class':_0x9f910c[_0x1e2582(0x336)],'msg':_0x6ce451['message']}));}finally{if(_0x9f910c[_0x1e2582(0x1f6)](_0x9f910c[_0x1e2582(0x1de)],_0x9f910c[_0x1e2582(0x2c8)]))_0x126288[_0x1e2582(0x2b9)]();else return _0x4b1a91[_0x1e2582(0x2d6)](_0x19c748),_0x4a3a73[_0x1e2582(0x2ba)](_0x3c60f2[_0x1e2582(0x218)]({'isSearch':!0x1,'class':_0x9f910c[_0x1e2582(0x336)],'msg':_0x128d91[_0x1e2582(0x1d7)]}));}};_0x1e8772[_0x312027(0x264)]({'req':_0x1ad410,'res':_0x34ed04}),_0x426971||_0x9f910c[_0x312027(0x2cc)](_0x2374af);});export default b;function _0x44582a(_0x41734b){const _0x14ce8f=_0x40b709,_0x576cb9={'GRhCe':function(_0x597cfa,_0x5b790e){return _0x597cfa===_0x5b790e;},'ZKySe':_0x14ce8f(0x208),'IFIkm':_0x14ce8f(0x2d7),'dzeHM':_0x14ce8f(0x1f4),'uykJj':function(_0x5168b4,_0x2a17ca){return _0x5168b4!==_0x2a17ca;},'nIcFN':function(_0x28e748,_0x2b5942){return _0x28e748+_0x2b5942;},'ewQIN':function(_0x2c1747,_0x5898af){return _0x2c1747/_0x5898af;},'ZpCId':_0x14ce8f(0x21e),'RhPLq':function(_0x3d89a4,_0x1aa0d1){return _0x3d89a4%_0x1aa0d1;},'TyUkN':function(_0x170f16,_0x39a4ad){return _0x170f16+_0x39a4ad;},'Sueyh':_0x14ce8f(0x322),'IdOGl':_0x14ce8f(0x295),'rkJIB':'action','ZngEH':function(_0x2fc67f,_0x1260a0){return _0x2fc67f+_0x1260a0;},'cVBlf':_0x14ce8f(0x20f),'TxRDd':function(_0x38b3bd,_0x4f3f3d){return _0x38b3bd(_0x4f3f3d);},'aMpiV':function(_0x2fb881,_0x16e64d){return _0x2fb881(_0x16e64d);}};function _0x28a377(_0x5aec70){const _0x193217=_0x14ce8f;if(_0x576cb9[_0x193217(0x2e8)](typeof _0x5aec70,_0x576cb9[_0x193217(0x240)]))return function(_0x464268){}['constructor'](_0x576cb9[_0x193217(0x226)])[_0x193217(0x2e9)](_0x576cb9['dzeHM']);else _0x576cb9['uykJj'](_0x576cb9[_0x193217(0x1e3)]('',_0x576cb9[_0x193217(0x26f)](_0x5aec70,_0x5aec70))[_0x576cb9[_0x193217(0x31b)]],0x1)||_0x576cb9[_0x193217(0x2e8)](_0x576cb9[_0x193217(0x331)](_0x5aec70,0x14),0x0)?function(){return!![];}[_0x193217(0x333)](_0x576cb9[_0x193217(0x334)](_0x576cb9['Sueyh'],_0x576cb9[_0x193217(0x2e7)]))[_0x193217(0x2c2)](_0x576cb9[_0x193217(0x272)]):function(){return![];}[_0x193217(0x333)](_0x576cb9[_0x193217(0x2d2)](_0x576cb9[_0x193217(0x205)],_0x576cb9[_0x193217(0x2e7)]))['apply'](_0x576cb9[_0x193217(0x32a)]);_0x576cb9[_0x193217(0x229)](_0x28a377,++_0x5aec70);}try{if(_0x41734b)return _0x28a377;else _0x576cb9[_0x14ce8f(0x33e)](_0x28a377,0x0);}catch(_0x6ffb0e){}}