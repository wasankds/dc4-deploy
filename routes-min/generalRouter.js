const _0x1d22c9=_0x5242;(function(_0x313fe2,_0x64da8c){const _0x5783f1=_0x5242,_0x236b4d=_0x313fe2();while(!![]){try{const _0x4251dc=-parseInt(_0x5783f1(0x2b9))/0x1+parseInt(_0x5783f1(0x2c5))/0x2+parseInt(_0x5783f1(0x1cb))/0x3*(parseInt(_0x5783f1(0x2f0))/0x4)+-parseInt(_0x5783f1(0x2b8))/0x5+-parseInt(_0x5783f1(0x1ad))/0x6*(parseInt(_0x5783f1(0x2c9))/0x7)+-parseInt(_0x5783f1(0x1b1))/0x8*(parseInt(_0x5783f1(0x1c1))/0x9)+-parseInt(_0x5783f1(0x1c6))/0xa*(-parseInt(_0x5783f1(0x27b))/0xb);if(_0x4251dc===_0x64da8c)break;else _0x236b4d['push'](_0x236b4d['shift']());}catch(_0xf1ca58){_0x236b4d['push'](_0x236b4d['shift']());}}}(_0x2b73,0xba93f));const _0xd9c9b8=(function(){const _0x4091e7=_0x5242,_0x2aa366={'ktMaW':_0x4091e7(0x2b2),'afRgg':_0x4091e7(0x261),'rNvMA':function(_0x5d6ec2,_0x1d022c){return _0x5d6ec2(_0x1d022c);},'nGWNL':_0x4091e7(0x1c2),'BTzBP':function(_0x56799,_0xcfc25e){return _0x56799+_0xcfc25e;},'AZfWZ':_0x4091e7(0x194),'Ggdan':_0x4091e7(0x2e2),'bWCtK':function(_0x9c0bdf){return _0x9c0bdf();},'NDzzV':function(_0x40d2d0,_0x4e8ce4,_0x2b2e0b){return _0x40d2d0(_0x4e8ce4,_0x2b2e0b);},'FycrW':function(_0x1cd35f,_0x5e1aca){return _0x1cd35f!==_0x5e1aca;},'OZHGK':_0x4091e7(0x1ff),'MdcHk':function(_0x111932,_0x1955d9){return _0x111932===_0x1955d9;},'AHGjW':_0x4091e7(0x2cb),'VdQRP':_0x4091e7(0x220),'aQgXH':_0x4091e7(0x223)};let _0x13b87e=!![];return function(_0x11d9e4,_0xa87488){const _0xc32521=_0x4091e7,_0x39307c={'CZBWh':function(_0x5954f5,_0xebc236){const _0x14078a=_0x5242;return _0x2aa366[_0x14078a(0x2e1)](_0x5954f5,_0xebc236);},'NrATc':_0x2aa366[_0xc32521(0x23c)],'qmTss':function(_0xee2ce6,_0x5cf753){return _0x2aa366['MdcHk'](_0xee2ce6,_0x5cf753);},'LeLYg':_0x2aa366[_0xc32521(0x1bd)],'UrnJK':_0x2aa366['VdQRP']};if(_0x2aa366[_0xc32521(0x23a)](_0x2aa366['aQgXH'],_0x2aa366[_0xc32521(0x1ac)])){const _0xd2168e=_0x13b87e?function(){const _0x153f82=_0xc32521;if(_0x39307c[_0x153f82(0x212)](_0x39307c['NrATc'],_0x39307c[_0x153f82(0x2c6)]))_0x3d07f8[_0x153f82(0x284)]();else{if(_0xa87488){if(_0x39307c[_0x153f82(0x246)](_0x39307c[_0x153f82(0x1ba)],_0x39307c[_0x153f82(0x202)])){const _0x3d7008=_0x19e82a[_0x153f82(0x1de)][_0x153f82(0x236)][_0x153f82(0x29a)](_0x2045bb),_0x5b4c54=_0x5112ca[_0x2c8702],_0x592256=_0x16dfa3[_0x5b4c54]||_0x3d7008;_0x3d7008[_0x153f82(0x1d1)]=_0x839147[_0x153f82(0x29a)](_0x8b06b6),_0x3d7008[_0x153f82(0x2a9)]=_0x592256[_0x153f82(0x2a9)][_0x153f82(0x29a)](_0x592256),_0x446f32[_0x5b4c54]=_0x3d7008;}else{const _0x2ff926=_0xa87488['apply'](_0x11d9e4,arguments);return _0xa87488=null,_0x2ff926;}}}}:function(){};return _0x13b87e=![],_0xd2168e;}else{const _0x1b1452={'aJMnn':_0x2aa366[_0xc32521(0x26f)],'ZgCSj':_0x2aa366[_0xc32521(0x2a0)],'Zowci':function(_0x22e5b4,_0x92e42f){const _0x183246=_0xc32521;return _0x2aa366[_0x183246(0x283)](_0x22e5b4,_0x92e42f);},'HHKrd':_0x2aa366[_0xc32521(0x22c)],'IBkLB':function(_0x129efc,_0x3549c7){return _0x2aa366['BTzBP'](_0x129efc,_0x3549c7);},'dgNlh':_0x2aa366[_0xc32521(0x225)],'mRaKn':_0x2aa366['Ggdan'],'GnrOF':function(_0x39780e){const _0x2e1eec=_0xc32521;return _0x2aa366[_0x2e1eec(0x255)](_0x39780e);}};_0x2aa366['NDzzV'](_0x7cb84e,this,function(){const _0x59a3fb=_0xc32521,_0x4a09ae=new _0x2e30a3(_0x1b1452[_0x59a3fb(0x1c9)]),_0x1a08fc=new _0x2c0959(_0x1b1452[_0x59a3fb(0x1fa)],'i'),_0x11338d=_0x1b1452[_0x59a3fb(0x1c3)](_0x1dbec1,_0x1b1452[_0x59a3fb(0x2c4)]);!_0x4a09ae[_0x59a3fb(0x189)](_0x1b1452[_0x59a3fb(0x20d)](_0x11338d,_0x1b1452[_0x59a3fb(0x218)]))||!_0x1a08fc[_0x59a3fb(0x189)](_0x1b1452['IBkLB'](_0x11338d,_0x1b1452[_0x59a3fb(0x243)]))?_0x1b1452[_0x59a3fb(0x1c3)](_0x11338d,'0'):_0x1b1452[_0x59a3fb(0x28c)](_0x1edde6);})();}};}());(function(){const _0x5ae1b1=_0x5242,_0x9c5db9={'UrXth':function(_0x235b60,_0x398ac7){return _0x235b60+_0x398ac7;},'kaTLG':_0x5ae1b1(0x28f),'EecAv':_0x5ae1b1(0x26d),'KZHQV':'stateObject','Mclpd':function(_0x4d563e,_0x150d6e){return _0x4d563e(_0x150d6e);},'nfqOW':_0x5ae1b1(0x1e8),'NPyDT':_0x5ae1b1(0x21f),'lJCJP':function(_0xc39c0d,_0x369cdd){return _0xc39c0d!==_0x369cdd;},'KMmur':_0x5ae1b1(0x2a3),'yXUMg':_0x5ae1b1(0x2b2),'KaakE':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','JzrcW':function(_0x30e30e,_0x50fb0b){return _0x30e30e(_0x50fb0b);},'rSAFn':_0x5ae1b1(0x1c2),'RIard':'chain','DWKVb':_0x5ae1b1(0x2e2),'nTaJX':function(_0x279a8e,_0x42da57){return _0x279a8e===_0x42da57;},'gvUJl':_0x5ae1b1(0x232),'Aqqmz':function(_0x3a177d,_0xff983b){return _0x3a177d(_0xff983b);},'kIakr':function(_0x489b62,_0x26bf63){return _0x489b62!==_0x26bf63;},'dwqaY':_0x5ae1b1(0x290),'cbEsx':'rFKdV','OUVRD':function(_0x246c8c){return _0x246c8c();},'WSaaH':function(_0x3b0ded,_0xe9e6cb,_0x4a248c){return _0x3b0ded(_0xe9e6cb,_0x4a248c);}};_0x9c5db9[_0x5ae1b1(0x1e5)](_0xd9c9b8,this,function(){const _0x1dc470=_0x5ae1b1,_0x22013a={'aLVsv':function(_0x4af7ab,_0xae5569){const _0x1322bb=_0x5242;return _0x9c5db9[_0x1322bb(0x2c0)](_0x4af7ab,_0xae5569);}};if(_0x9c5db9['lJCJP'](_0x9c5db9[_0x1dc470(0x1f2)],_0x9c5db9['KMmur']))_0x22013a['aLVsv'](_0x1a3d24,'0');else{const _0x725bcd=new RegExp(_0x9c5db9[_0x1dc470(0x251)]),_0x1852c7=new RegExp(_0x9c5db9['KaakE'],'i'),_0x44de8f=_0x9c5db9['JzrcW'](_0x47e5f1,_0x9c5db9['rSAFn']);if(!_0x725bcd[_0x1dc470(0x189)](_0x9c5db9['UrXth'](_0x44de8f,_0x9c5db9[_0x1dc470(0x1ab)]))||!_0x1852c7[_0x1dc470(0x189)](_0x9c5db9['UrXth'](_0x44de8f,_0x9c5db9[_0x1dc470(0x28a)])))_0x9c5db9[_0x1dc470(0x25e)](_0x9c5db9[_0x1dc470(0x28b)],_0x9c5db9[_0x1dc470(0x28b)])?_0x9c5db9[_0x1dc470(0x2ac)](_0x44de8f,'0'):function(){return![];}['constructor'](_0x9c5db9[_0x1dc470(0x27d)](_0x9c5db9[_0x1dc470(0x249)],_0x9c5db9[_0x1dc470(0x235)]))[_0x1dc470(0x264)](_0x9c5db9['KZHQV']);else{if(_0x9c5db9['kIakr'](_0x9c5db9['dwqaY'],_0x9c5db9['cbEsx']))_0x9c5db9['OUVRD'](_0x47e5f1);else{let _0x21a2f0;try{_0x21a2f0=_0x9c5db9['Mclpd'](_0x2f0b7b,_0x9c5db9[_0x1dc470(0x27d)](_0x9c5db9[_0x1dc470(0x27d)](_0x9c5db9[_0x1dc470(0x1c8)],_0x9c5db9['NPyDT']),');'))();}catch(_0x1283ee){_0x21a2f0=_0x174178;}return _0x21a2f0;}}}})();}());function _0x2b73(){const _0x1c717a=['length','UrXth','BhUSG','receipt_print.ejs','kqSkN','leSTF','Bqddy','rNvMA','close','lVlOE','uatjJ','MZjzn','doc_changes.ejs','xfndN','DWKVb','gvUJl','GnrOF','LXVoK','DZGRa','debu','jGCPI','map','ไม่พบเอกสารเลขที่\x20\x22','tHWDz','red','send','renderView','baviL','getItems_for_Modal','bill_print.ejs','bind','push','YixZt','kAtaQ','connect','xedqf','afRgg','โหลดลายเซ็น\x20\x22','AUlzx','qVTLX','vZFRF','YSBWB','PAMLD','ufQKK','HQedd','toString','KvpYG','image/jpeg','Aqqmz','tbBSZ','RZRoK','print','jpeg','jWtYF','function\x20*\x5c(\x20*\x5c)','modifiedCount','FAkqz','VRXTI','join','quotation_print.ejs','7279355iotsYL','580065bRnBrv','convert_DocPrint','docId','Lxdqv','jXJRR','bSMhV','iVTLC','Mclpd','PANRO','/bill','dbColl_receipt','HHKrd','40324GLFmAJ','NrATc','LOGO_INVOICE_FILENAME','HRdnH','119fAlFVf','cVYWx','JIuWp','getSessionData','IBuca','JnPaj','jzBwV','qSaqS','EiAsR','fWJpN','\x22\x20เรียบร้อยแล้ว','aggregate','jLzdT','LteCH','split','kcBxh','getSettingsByCollection','rhIXf','mKZez','iRowy','getSessionData_sign','proposerImageSign','uQVet','jBraX','FycrW','input','QnDef','oNPvO','LqXQx','xQtRu','dbColl_settings_Quotation','yzARL','dbColl_bill','setViewport','updateOne','.jpeg','voBtE','CkzhU','PAGE_RECEIPT','2636ahUTpv','QZSMy','azJgL','RXLAy','attachment;\x20filename=quotation-','userImageSignature_Src','LOGO_RECEIPT_FILENAME','LOGO_BILL_FILENAME','collection','test','oyVCY','application/pdf','LHvxO','tqMlj','IZBPS','while\x20(true)\x20{}','vsTWD','setContent','hQZXV','yellow','chain','trace','xmBKl','dztSk','pFwKG','.pdf','GsCbi','WecVW','rxUpq','invoice_print.ejs','DmamF','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','WmPRL','green','ntIqj','cancel','xbjpJ','ifycb','call','yxurp','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','OJhOg','findOne','RIard','aQgXH','250356wvznnV','stringify','kkSPr','ZCogn','184hlRQxa','GdmMK','QwluK','/user/signature','axwsC','error\x20===>\x20','MInCg','bMlIu','UHlCO','LeLYg','dbColl_settings_Bill','formatDate','AHGjW','wlNFd','SKAZg','oPNTs','205776lmHmRF','init','Zowci','Jtcww','proposerId','6266900tsfYor','IWAVI','nfqOW','aJMnn','getCollName_by_DocTitle','6867VwzFUk','tqxAo','TGaRF','EqwPM','CJbRO','\x22\x20เอกสาร','__proto__','Ncpkc','gEThT','post','writeHead','oruls','/status','WTJtb','hvPsx','pdtsY','MYtFQ','string','gEpFP','constructor','tgAmy','EYLRZ','dZUYT','dZxzb','HwJPZ','MvkiZ','WSaaH','XlreR','bvVmA','return\x20(function()\x20','qluxQ','bZFZQ','tiaIa','BNEcx','cmRSV','isAuth','error','TIjmb','yjXoY','KMmur','OSqgC','JkVPy','plbBC','EHFhG','BIAss','TrKFH','cxDbi','ZgCSj','RSCDq','XlNUQ','eEHtG','MTCbL','ApZoN','mZooJ','BiSnT','UrnJK','MhNIq','IIPJM','BmhQx','XxHkS','ECjZG','ISnAp','cMCiV','console','wyzLv','พบ\x20\x22','IBkLB','floor','vVxFA','replace','dbColl_settings_Invoice','CZBWh','geXqR','zoohd','oaEwH','Nlggg','fZcWc','dgNlh','PAGE_INVOICE','dbColl_quotation','wfxAn','table','launch','/changes','{}.constructor(\x22return\x20this\x22)(\x20)','oCHht','JTCIm','/receipt','Yyveq','YHbVr','AZfWZ','changesHistory','smYRG','PAGE_BILL','dbUrl','getLogoBase64Src','/search','nGWNL','body','warn','vgBDX','TwpDN','newPage','NxZlY','xpIyD','JZLFR','EecAv','prototype','byFkn','ekHSu','IPKgB','MdcHk','hBQAu','OZHGK','ClKRY','uuwWe','/invoice','dUESf','/quotation','ZQCXK','mRaKn','RfAcX','EazNO','qmTss','WcBaU','dbColl_invoice','kaTLG','ไม่พบชื่อคอเล็กชั่น','info','tAIbw','piXiN','wmvGt','shift','message','yXUMg','nZCZC','KKyWV','rEYIe','bWCtK','NAsRJ','/load','tCeaO','log','dbName','xBljH','\x22ไม่สามารถเขียนข้อมูลลง\x20','/fetch/modal','nTaJX','finish','ITphU','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','wYEkB','pdf','apply','wgiXa','toArray','action','/print','acknowledged','stateObject','aIXfK','AcKHQ','gger','EUvrH','ktMaW','networkidle0','SEuUw','VmHHa','YrEpi','Qxqgl','FVIpr','NGJKA','includes','NdsLV','get','HzBWh','44KWrDYy'];_0x2b73=function(){return _0x1c717a;};return _0x2b73();}const _0x517ea7=(function(){const _0x523f2a=_0x5242,_0x10aa62={'tJSFw':function(_0x29d775,_0x24d7b1){return _0x29d775!==_0x24d7b1;},'fZcWc':_0x523f2a(0x2c1),'CpIoN':function(_0x1d0f89,_0x4cf01a){return _0x1d0f89===_0x4cf01a;},'oLzZX':_0x523f2a(0x285),'JkVPy':_0x523f2a(0x1eb),'DmamF':function(_0x191c18,_0x37dd58){return _0x191c18+_0x37dd58;},'HcDEg':_0x523f2a(0x28f),'wyzLv':'gger','PxDMC':_0x523f2a(0x267),'jBraX':function(_0x563260,_0xbc5895){return _0x563260!==_0xbc5895;},'uuwWe':_0x523f2a(0x2cf),'LqXQx':'ytMns'};let _0x19d121=!![];return function(_0x5786bf,_0x36f0b6){const _0x363082=_0x523f2a;if(_0x10aa62[_0x363082(0x2e0)](_0x10aa62[_0x363082(0x23e)],_0x10aa62[_0x363082(0x2e5)])){const _0x5bd5bf=_0x19d121?function(){const _0x1674e8=_0x363082;if(_0x10aa62['tJSFw'](_0x10aa62[_0x1674e8(0x217)],_0x10aa62[_0x1674e8(0x217)])){if(_0x305802){const _0x57c496=_0x42263d[_0x1674e8(0x264)](_0x42e9d6,arguments);return _0x5dd5e7=null,_0x57c496;}}else{if(_0x36f0b6){if(_0x10aa62['CpIoN'](_0x10aa62['oLzZX'],_0x10aa62[_0x1674e8(0x1f4)]))return![];else{const _0x53758f=_0x36f0b6['apply'](_0x5786bf,arguments);return _0x36f0b6=null,_0x53758f;}}}}:function(){};return _0x19d121=![],_0x5bd5bf;}else(function(){return!![];}[_0x363082(0x1de)](_0x10aa62[_0x363082(0x19e)](_0x10aa62['HcDEg'],_0x10aa62[_0x363082(0x20b)]))[_0x363082(0x1a6)](_0x10aa62['PxDMC']));};}()),_0x2f1227=_0x517ea7(this,function(){const _0x3d24d9=_0x5242,_0x54d0c8={'bvVmA':'red','WmPRL':function(_0x567753,_0x3eeff7){return _0x567753(_0x3eeff7);},'tqMlj':function(_0x4cf160,_0x1185c7){return _0x4cf160===_0x1185c7;},'FKoQP':'Evpoi','MhNIq':function(_0x575843,_0x520f36){return _0x575843===_0x520f36;},'xedqf':_0x3d24d9(0x1bf),'MInCg':function(_0x5379c1,_0x2a06ba){return _0x5379c1+_0x2a06ba;},'hQZXV':_0x3d24d9(0x1e8),'BhUSG':'{}.constructor(\x22return\x20this\x22)(\x20)','VyCBy':_0x3d24d9(0x1da),'NAsRJ':_0x3d24d9(0x1ce),'tVgBu':_0x3d24d9(0x1b6),'UwVYe':function(_0x494fe9){return _0x494fe9();},'xpIyD':'log','NGJKA':_0x3d24d9(0x22e),'BmhQx':_0x3d24d9(0x24b),'oyVCY':_0x3d24d9(0x1ef),'tqxAo':'exception','VmHHa':_0x3d24d9(0x21c),'HQedd':_0x3d24d9(0x195),'plbBC':function(_0x37e806,_0x10c02a){return _0x37e806<_0x10c02a;},'CNssi':_0x3d24d9(0x1ed),'MTCbL':'FwqjS'},_0x211fe4=function(){const _0x4eae19=_0x3d24d9,_0x4ff602={'wYEkB':function(_0x127667,_0x1b31ce){const _0x774c94=_0x5242;return _0x54d0c8[_0x774c94(0x1a0)](_0x127667,_0x1b31ce);}};if(_0x54d0c8['tqMlj'](_0x54d0c8['FKoQP'],_0x54d0c8['FKoQP'])){let _0xa669db;try{if(_0x54d0c8[_0x4eae19(0x203)](_0x54d0c8[_0x4eae19(0x29f)],_0x54d0c8[_0x4eae19(0x29f)]))_0xa669db=_0x54d0c8['WmPRL'](Function,_0x54d0c8[_0x4eae19(0x1b7)](_0x54d0c8['MInCg'](_0x54d0c8[_0x4eae19(0x192)],_0x54d0c8[_0x4eae19(0x27e)]),');'))();else return _0x4e21c6[_0x4eae19(0x259)](_0x2bd911),_0x602d5c[_0x4eae19(0x295)](_0x1c78e3[_0x4eae19(0x1ae)]({'isLoad':!0x1,'class':_0x54d0c8[_0x4eae19(0x1e7)],'msg':_0x116687[_0x4eae19(0x250)]}));}catch(_0x17cf1a){_0x54d0c8[_0x4eae19(0x18d)](_0x54d0c8['VyCBy'],_0x54d0c8[_0x4eae19(0x256)])?_0x4ff602[_0x4eae19(0x262)](_0x55cf57,0x0):_0xa669db=window;}return _0xa669db;}else _0x568b2e=_0x1c43eb;},_0x222a16=_0x54d0c8['UwVYe'](_0x211fe4),_0x6eb1c1=_0x222a16[_0x3d24d9(0x20a)]=_0x222a16[_0x3d24d9(0x20a)]||{},_0x27aba2=[_0x54d0c8[_0x3d24d9(0x233)],_0x54d0c8[_0x3d24d9(0x276)],_0x54d0c8[_0x3d24d9(0x205)],_0x54d0c8[_0x3d24d9(0x18a)],_0x54d0c8[_0x3d24d9(0x1cc)],_0x54d0c8[_0x3d24d9(0x272)],_0x54d0c8[_0x3d24d9(0x2a8)]];for(let _0x575bc4=0x0;_0x54d0c8[_0x3d24d9(0x1f5)](_0x575bc4,_0x27aba2[_0x3d24d9(0x27c)]);_0x575bc4++){if(_0x54d0c8[_0x3d24d9(0x203)](_0x54d0c8['CNssi'],_0x54d0c8[_0x3d24d9(0x1fe)]))_0x1d715d[_0x3d24d9(0x259)](_0x54d0c8['tVgBu'],_0x442b30),_0x2720b3[_0x3d24d9(0x295)](_0x48da9c['stringify']({'isPrint':!0x1,'class':_0x54d0c8[_0x3d24d9(0x1e7)],'msg':_0x319e02[_0x3d24d9(0x250)]}));else{const _0x2b3883=_0x517ea7[_0x3d24d9(0x1de)]['prototype'][_0x3d24d9(0x29a)](_0x517ea7),_0x1d3a62=_0x27aba2[_0x575bc4],_0x561409=_0x6eb1c1[_0x1d3a62]||_0x2b3883;_0x2b3883[_0x3d24d9(0x1d1)]=_0x517ea7[_0x3d24d9(0x29a)](_0x517ea7),_0x2b3883[_0x3d24d9(0x2a9)]=_0x561409['toString'][_0x3d24d9(0x29a)](_0x561409),_0x6eb1c1[_0x1d3a62]=_0x2b3883;}}});_0x2f1227();import _0x4d7d5e from'express';const b=_0x4d7d5e['Router']();import _0x5dbe5d from'path';import{MongoClient as _0x41141d}from'mongodb';import _0x37d1b8 from'../middleware/mainAuth.js';import*as _0x4f4276 from'../mymodule/myUsers.js';function _0x5242(_0x1cc5cf,_0x1f74f0){const _0x5dc9d9=_0x2b73();return _0x5242=function(_0x2f1227,_0x517ea7){_0x2f1227=_0x2f1227-0x181;let _0x486a22=_0x5dc9d9[_0x2f1227];return _0x486a22;},_0x5242(_0x1cc5cf,_0x1f74f0);}import*as _0x312905 from'../mymodule/myDateTime.js';import*as _0x1e135c from'../mymodule/myModule.js';import*as _0x24daa1 from'../mymodule/myDocs.js';const w=_0x1d22c9(0x241),I=_0x1d22c9(0x23f),O=_0x1d22c9(0x222),A=_0x1d22c9(0x2c2),H=[I+'/changes',w+_0x1d22c9(0x21e),O+'/changes',A+_0x1d22c9(0x21e)],j=[I+_0x1d22c9(0x268),w+'/print',O+_0x1d22c9(0x268),A+_0x1d22c9(0x268)],M=[I+_0x1d22c9(0x1d7),w+'/status',O+_0x1d22c9(0x1d7),A+_0x1d22c9(0x1d7)],G=[I+_0x1d22c9(0x22b),w+'/search',O+'/search',A+_0x1d22c9(0x22b)],q=[I+_0x1d22c9(0x257),w+_0x1d22c9(0x257),O+'/load',A+_0x1d22c9(0x257)],x=_0x1d22c9(0x25d),V=_0x1d22c9(0x1b4);b[_0x1d22c9(0x1d4)](G,_0x37d1b8[_0x1d22c9(0x1ee)],async(_0x1321e1,_0x331f3b)=>{const _0x4cfb9e=_0x1d22c9,_0x221875={'sZwXl':'error\x20===>\x20','ISnAp':'red','FVIpr':function(_0x30f4e9,_0x2d0c1f){return _0x30f4e9(_0x2d0c1f);},'HwJPZ':function(_0x14c052,_0x47045b){return _0x14c052!==_0x47045b;},'BiSnT':_0x4cfb9e(0x28e),'voBtE':function(_0x5ef5c2,_0x28f207){return _0x5ef5c2===_0x28f207;},'leSTF':_0x4cfb9e(0x252),'TBnZY':_0x4cfb9e(0x19f),'BNEcx':_0x4cfb9e(0x1a1),'pFwKG':'vXjsc','OJhOg':function(_0x43ede6,_0xa4fb82){return _0x43ede6!==_0xa4fb82;},'hBQAu':_0x4cfb9e(0x206)};let {sip:_0x1c3144,collName:_0x1dfac7,statusNumberFilter:_0x589973}=_0x1321e1['body'];_0x1c3144=_0x1c3144['replace'](/[!@#$%^&*<>]/g,'')??null;let {userId:_0x50ce4e,userAuthority:_0x4d799b}=_0x4f4276[_0x4cfb9e(0x2cc)](_0x1321e1);_0x50ce4e=_0x50ce4e&&_0x221875[_0x4cfb9e(0x275)](Number,_0x50ce4e),_0x589973&&(_0x589973=_0x589973?_0x589973[_0x4cfb9e(0x2d7)](',')[_0x4cfb9e(0x291)](_0xeaf783=>Number(_0xeaf783)):[0x1,0x2,0x3,0xa]);const _0x86064b=new _0x41141d(global[_0x4cfb9e(0x229)]);try{if(_0x221875[_0x4cfb9e(0x1e3)](_0x221875[_0x4cfb9e(0x201)],_0x221875[_0x4cfb9e(0x201)])){_0x1ba8f3=!0x1;return;}else{await _0x86064b['connect']();const _0x24798e=_0x86064b['db'](global[_0x4cfb9e(0x25a)])[_0x4cfb9e(0x188)](_0x1dfac7);if(_0x1c3144){if(_0x221875[_0x4cfb9e(0x2ed)](_0x221875[_0x4cfb9e(0x281)],_0x221875[_0x4cfb9e(0x281)])){var _0x3d1998=[{'$or':[{'docId':{'$regex':_0x1c3144,'$options':'i'}},{'docDate':{'$regex':_0x1c3144,'$options':'i'}},{'customerName':{'$regex':_0x1c3144,'$options':'i'}}]}];['O','A'][_0x4cfb9e(0x277)](_0x4d799b)||_0x3d1998[_0x4cfb9e(0x29b)]({'proposerId':_0x50ce4e}),_0x589973&&_0x3d1998[_0x4cfb9e(0x29b)]({'docStatusNumber':{'$in':_0x589973}});var _0xcecf46=await _0x24798e[_0x4cfb9e(0x2d4)]([{'$match':{'$and':_0x3d1998}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])[_0x4cfb9e(0x266)]();}else{if(_0x3cd07f){const _0x3b8d89=_0x48b380['apply'](_0x33e75c,arguments);return _0xf775e9=null,_0x3b8d89;}}}else var _0xcecf46=[];let _0x156cc0=_0x4cfb9e(0x20c)+_0xcecf46['length']+_0x4cfb9e(0x1d0);return['O','A'][_0x4cfb9e(0x277)](_0x4d799b)||(_0x156cc0+=_0x221875['TBnZY']),_0x331f3b['send'](JSON['stringify']({'searchFound':_0xcecf46,'isSearch':!0x0,'class':_0x221875[_0x4cfb9e(0x1ec)],'msg':_0x156cc0}));}}catch(_0x526a9d){if(_0x221875['HwJPZ'](_0x221875[_0x4cfb9e(0x198)],_0x221875[_0x4cfb9e(0x198)]))_0x10e516[_0x4cfb9e(0x259)](_0x221875['sZwXl'],_0x5d22f0),_0x483578[_0x4cfb9e(0x295)](_0x58137c[_0x4cfb9e(0x1ae)]({'isPrint':!0x1,'class':_0x221875[_0x4cfb9e(0x208)],'msg':_0x4cbb93[_0x4cfb9e(0x250)]}));else return console[_0x4cfb9e(0x259)](_0x526a9d),_0x331f3b[_0x4cfb9e(0x295)](JSON[_0x4cfb9e(0x1ae)]({'isSearch':!0x1,'class':_0x221875[_0x4cfb9e(0x208)],'msg':_0x526a9d[_0x4cfb9e(0x250)]}));}finally{if(_0x221875[_0x4cfb9e(0x1a9)](_0x221875[_0x4cfb9e(0x23b)],_0x221875['hBQAu']))return _0xed7134;else _0x86064b[_0x4cfb9e(0x284)]();}}),b[_0x1d22c9(0x1d4)](q,_0x37d1b8[_0x1d22c9(0x1ee)],async(_0x547e37,_0x18eb05)=>{const _0x327d2c=_0x1d22c9,_0x171c5c={'EazNO':function(_0x557efa,_0x99fbbb){return _0x557efa(_0x99fbbb);},'cxDbi':_0x327d2c(0x1a1),'RSCDq':_0x327d2c(0x294),'ekHSu':function(_0x46fd39){return _0x46fd39();},'fkmLt':_0x327d2c(0x24a),'xmBKl':function(_0x1563c3,_0x1a7bbe){return _0x1563c3(_0x1a7bbe);},'tbBSZ':function(_0x583802,_0x385701){return _0x583802===_0x385701;},'oPNTs':_0x327d2c(0x20f),'YixZt':_0x327d2c(0x1c7),'MYtFQ':function(_0x3be79,_0x3ee527){return _0x3be79!==_0x3ee527;},'PAMLD':_0x327d2c(0x1b3),'LXVoK':'FzCcp','jLzdT':_0x327d2c(0x1ea),'yzARL':'nseII'};let {docId:_0x14d2e0,docTitle:_0x4910f9,collName:_0x365903}=_0x547e37[_0x327d2c(0x22d)];if(_0x365903||(_0x365903=_0x24daa1['getCollName_by_DocTitle'](_0x4910f9)),!_0x365903)return _0x18eb05[_0x327d2c(0x295)](JSON[_0x327d2c(0x1ae)]({'isStatus':!0x1,'class':_0x171c5c[_0x327d2c(0x1fb)],'msg':_0x171c5c['fkmLt']}));let {userId:_0x23bafe,userAuthority:_0x15af48}=_0x4f4276[_0x327d2c(0x2cc)](_0x547e37);_0x23bafe=_0x23bafe&&_0x171c5c[_0x327d2c(0x196)](Number,_0x23bafe);const _0x71c63c=new _0x41141d(global['dbUrl']);try{if(_0x171c5c[_0x327d2c(0x2ad)](_0x171c5c[_0x327d2c(0x1c0)],_0x171c5c[_0x327d2c(0x29c)])){let {userId:_0x40fa70}=_0x35a8c8[_0x327d2c(0x2cc)](_0x311634);_0x40fa70=_0x40fa70&&_0x171c5c[_0x327d2c(0x245)](_0x27fb66,_0x40fa70);const _0x588ad7=new _0x460932(_0x3b9ede[_0x327d2c(0x229)]);try{const _0x21c1d8=_0x23c735[_0x327d2c(0x2dd)](_0x1a6f8d);return _0x236e5e[_0x327d2c(0x295)](_0x4ea11d['stringify']({..._0x21c1d8,'isLoad':!0x0,'class':_0x171c5c[_0x327d2c(0x1f9)],'msg':_0x327d2c(0x2a1)+_0x40fa70+_0x327d2c(0x2d3)}));}catch(_0x1693d3){return _0xe38678[_0x327d2c(0x259)](_0x1693d3),_0x20f4d8[_0x327d2c(0x295)](_0xc0aacb[_0x327d2c(0x1ae)]({'isLoad':!0x1,'class':_0x171c5c[_0x327d2c(0x1fb)],'msg':_0x1693d3['message']}));}finally{_0x588ad7[_0x327d2c(0x284)]();}}else{await _0x71c63c[_0x327d2c(0x29e)]();const _0xc72127=_0x71c63c['db'](global[_0x327d2c(0x25a)])[_0x327d2c(0x188)](_0x365903);let _0x1ac9e3={'docId':_0x14d2e0};['O','A'][_0x327d2c(0x277)](_0x15af48)||(_0x1ac9e3[_0x327d2c(0x1c5)]=_0x23bafe);var _0x530e4d=await _0xc72127[_0x327d2c(0x1aa)](_0x1ac9e3,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x530e4d?(_0x530e4d[_0x327d2c(0x185)]=_0x4f4276['getUser_sign'](_0x530e4d['proposerId']),_0x18eb05[_0x327d2c(0x295)](JSON['stringify']({'doc':_0x530e4d,'isLoad':!0x0,'class':_0x171c5c[_0x327d2c(0x1f9)],'msg':'โหลดเอกสารเลขที่\x20\x22'+_0x14d2e0+'\x22\x20เรียบร้อยแล้ว'}))):_0x18eb05[_0x327d2c(0x295)](JSON[_0x327d2c(0x1ae)]({'isLoad':!0x1,'class':_0x171c5c[_0x327d2c(0x1fb)],'msg':_0x327d2c(0x292)+_0x14d2e0+'\x22'}));}}catch(_0x4b9235){if(_0x171c5c[_0x327d2c(0x1db)](_0x171c5c[_0x327d2c(0x2a6)],_0x171c5c[_0x327d2c(0x28d)]))return console[_0x327d2c(0x259)](_0x4b9235),_0x18eb05['send'](JSON[_0x327d2c(0x1ae)]({'isLoad':!0x1,'class':_0x171c5c['RSCDq'],'msg':_0x4b9235[_0x327d2c(0x250)]}));else PLsnAo[_0x327d2c(0x238)](_0x43861c);}finally{_0x171c5c[_0x327d2c(0x2ad)](_0x171c5c[_0x327d2c(0x2d5)],_0x171c5c[_0x327d2c(0x2e8)])?_0x33277b[_0x327d2c(0x284)]():_0x71c63c[_0x327d2c(0x284)]();}}),b['get'](x,_0x37d1b8[_0x1d22c9(0x1ee)],async(_0x43f858,_0x3611fb)=>{const _0x502fcf=_0x1d22c9,_0xe5c60f={'vsTWD':function(_0x791ec0,_0x5610b7){return _0x791ec0===_0x5610b7;},'rhIXf':_0x502fcf(0x274),'yxurp':_0x502fcf(0x183),'mKZez':'green','iRowy':'โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','piXiN':function(_0x1dd95e,_0x5ea540){return _0x1dd95e!==_0x5ea540;},'IIPJM':'lLHiC','xQtRu':_0x502fcf(0x294)};try{if(_0xe5c60f[_0x502fcf(0x190)](_0xe5c60f[_0x502fcf(0x2da)],_0xe5c60f[_0x502fcf(0x1a7)]))_0x4523ed[_0x502fcf(0x284)]();else{const _0x57c509=await _0x24daa1['getCustomers_for_Modal'](),_0x1e3a19=await _0x24daa1[_0x502fcf(0x298)]();return _0x3611fb[_0x502fcf(0x295)](JSON[_0x502fcf(0x1ae)]({'DATA_CUSTOMERS':_0x57c509,'DATA_ITEMS':_0x1e3a19,'isFetch':!0x0,'class':_0xe5c60f[_0x502fcf(0x2db)],'msg':_0xe5c60f[_0x502fcf(0x2dc)]}));}}catch(_0x238225){if(_0xe5c60f[_0x502fcf(0x24d)](_0xe5c60f[_0x502fcf(0x204)],_0xe5c60f[_0x502fcf(0x204)])){const _0x538add=_0x1e23c3[_0x502fcf(0x264)](_0x2e66ba,arguments);return _0xbcf74a=null,_0x538add;}else return console[_0x502fcf(0x259)](_0x238225),_0x3611fb[_0x502fcf(0x295)](JSON['stringify']({'isFetch':!0x1,'class':_0xe5c60f[_0x502fcf(0x2e6)],'msg':_0x238225[_0x502fcf(0x250)]}));}}),b[_0x1d22c9(0x1d4)](j,_0x37d1b8[_0x1d22c9(0x1ee)],async(_0x78b85f,_0x3726c0)=>{const _0xe02b44=_0x1d22c9,_0x1b9caa={'hvPsx':_0xe02b44(0x294),'SZono':_0xe02b44(0x18f),'PZCbA':'counter','dUESf':'function\x20*\x5c(\x20*\x5c)','QnDef':_0xe02b44(0x261),'IZBPS':function(_0x233dc6,_0x43efe2){return _0x233dc6(_0x43efe2);},'rxUpq':_0xe02b44(0x1c2),'WecVW':function(_0x2713bd,_0x58d169){return _0x2713bd+_0x58d169;},'EYLRZ':'chain','tHWDz':function(_0x5de938,_0x4cc160){return _0x5de938+_0x4cc160;},'TrKFH':_0xe02b44(0x2e2),'oruls':function(_0x17472e){return _0x17472e();},'wlNFd':function(_0x38638b,_0x1d6673){return _0x38638b===_0x1d6673;},'TwpDN':_0xe02b44(0x29d),'konzt':_0xe02b44(0x2b7),'GtYyZ':function(_0x4e6a12,_0x4a0677){return _0x4e6a12===_0x4a0677;},'ZCogn':_0xe02b44(0x19d),'wgiXa':function(_0x5b5a8c,_0x17c122){return _0x5b5a8c===_0x17c122;},'Nlggg':_0xe02b44(0x27f),'xbjpJ':function(_0x21bac0,_0x458df0){return _0x21bac0===_0x458df0;},'AUlzx':_0xe02b44(0x299),'yjXoY':function(_0x3ce721,_0x191ad7){return _0x3ce721==_0x191ad7;},'cEazp':_0xe02b44(0x2af),'Firch':_0xe02b44(0x1a1),'YrEpi':'image','knxbh':function(_0x36d80d,_0x104f23){return _0x36d80d!==_0x104f23;},'tgAmy':'EXATB','zoohd':'puppeteer','wmvGt':_0xe02b44(0x270),'uatjJ':function(_0x53e480,_0x40aaf0){return _0x53e480/_0x40aaf0;},'CJPvU':function(_0x4a1b6f,_0x121087){return _0x4a1b6f*_0x121087;},'HRdnH':_0xe02b44(0x2b0),'syhqV':_0xe02b44(0x2ab),'NHpIo':function(_0x482caa,_0x114fec){return _0x482caa==_0x114fec;},'FAkqz':'pdf','OSqgC':'sfWFk','kcBxh':_0xe02b44(0x237),'tAIbw':_0xe02b44(0x18b),'kiIxr':function(_0x3e320d,_0x2339be){return _0x3e320d!==_0x2339be;},'XlreR':_0xe02b44(0x1d3),'WTJtb':_0xe02b44(0x1b6),'CJbRO':_0xe02b44(0x234)},{docId:_0x3ce5b1,action:_0x1fb90d,docTitle:_0x452caf}=_0x78b85f['body'],_0x227953=new _0x41141d(global[_0xe02b44(0x229)]);try{if(_0x1b9caa['wlNFd'](_0x1b9caa[_0xe02b44(0x230)],_0x1b9caa[_0xe02b44(0x230)])){if(_0x1b9caa[_0xe02b44(0x1be)](_0x452caf,global['PAGE_QUOTATION']))var _0x7cf7cf=global[_0xe02b44(0x21a)],_0x5dc0cf=_0x1b9caa['konzt'],_0x3587b3=_0x1e135c[_0xe02b44(0x22a)](global['LOGO_QUOTATION_FILENAME']),{dataSettings:_0x472702}=await _0x1e135c[_0xe02b44(0x2d9)](global[_0xe02b44(0x2e7)]);else{if(_0x1b9caa['GtYyZ'](_0x452caf,global[_0xe02b44(0x219)]))var _0x7cf7cf=global[_0xe02b44(0x248)],_0x5dc0cf=_0x1b9caa[_0xe02b44(0x1b0)],_0x3587b3=_0x1e135c[_0xe02b44(0x22a)](global[_0xe02b44(0x2c7)]),{dataSettings:_0x472702}=await _0x1e135c['getSettingsByCollection'](global[_0xe02b44(0x211)]);else{if(_0x1b9caa[_0xe02b44(0x265)](_0x452caf,global[_0xe02b44(0x2ef)]))var _0x7cf7cf=global[_0xe02b44(0x2c3)],_0x5dc0cf=_0x1b9caa[_0xe02b44(0x216)],_0x3587b3=_0x1e135c['getLogoBase64Src'](global[_0xe02b44(0x186)]),{dataSettings:_0x472702}=await _0x1e135c[_0xe02b44(0x2d9)](global['dbColl_settings_Receipt']);else{if(_0x1b9caa[_0xe02b44(0x1a4)](_0x452caf,global[_0xe02b44(0x228)]))var _0x7cf7cf=global[_0xe02b44(0x2e9)],_0x5dc0cf=_0x1b9caa[_0xe02b44(0x2a2)],_0x3587b3=_0x1e135c[_0xe02b44(0x22a)](global[_0xe02b44(0x187)]),{dataSettings:_0x472702}=await _0x1e135c['getSettingsByCollection'](global[_0xe02b44(0x1bb)]);}}}await _0x227953[_0xe02b44(0x29e)]();var _0x1a33a1=await _0x227953['db'](global[_0xe02b44(0x25a)])[_0xe02b44(0x188)](_0x7cf7cf)[_0xe02b44(0x1aa)]({'docId':_0x3ce5b1});if(!_0x1a33a1)return _0x3726c0[_0xe02b44(0x295)](JSON['stringify']({'isLoad':!0x1,'class':_0x1b9caa[_0xe02b44(0x1d9)],'msg':_0xe02b44(0x292)+_0x3ce5b1+'\x22'}));_0x1a33a1['proposerId']&&(_0x1a33a1[_0xe02b44(0x2de)]=_0x4f4276['getUser_sign'](_0x1a33a1[_0xe02b44(0x1c5)]));const _0x35e139=_0x4f4276[_0xe02b44(0x2cc)](_0x78b85f),_0x38d4d6=_0x24daa1[_0xe02b44(0x2ba)](_0x1a33a1),_0x4ae703=_0x5dbe5d['join'](folderViews,_0x5dc0cf),_0xb4ce2a=await _0x1e135c['renderView'](_0x4ae703,_0x3726c0,{'title':_0x452caf,'time':_0x312905['formatDate'](new Date()),..._0x35e139,'logoSrc_base64':_0x3587b3,..._0x472702,'action':_0x1fb90d,'doc':_0x38d4d6});if(_0x1b9caa['yjXoY'](_0x1fb90d,_0x1b9caa['cEazp']))_0x3726c0[_0xe02b44(0x295)](JSON[_0xe02b44(0x1ae)]({'isPrint':!0x0,'class':_0x1b9caa['Firch'],'htmlPage':_0xb4ce2a}));else{if(_0x1b9caa[_0xe02b44(0x1f1)](_0x1fb90d,_0x1b9caa[_0xe02b44(0x273)])){if(_0x1b9caa['knxbh'](_0x1b9caa[_0xe02b44(0x1df)],_0x1b9caa[_0xe02b44(0x1df)]))return _0xa23d01[_0xe02b44(0x259)](_0x58406f),_0x18abdc[_0xe02b44(0x295)](_0x5bc246['stringify']({'isFetch':!0x1,'class':_0x1b9caa[_0xe02b44(0x1d9)],'msg':_0x2ec882[_0xe02b44(0x250)]}));else{const _0x17190f=await(await import(_0x1b9caa[_0xe02b44(0x214)]))[_0xe02b44(0x21d)](),_0x47e975=await _0x17190f['newPage']();await _0x47e975[_0xe02b44(0x191)](_0xb4ce2a,{'waitUntil':_0x1b9caa[_0xe02b44(0x24e)],'timeout':0x2710}),await new Promise(_0x22b880=>setTimeout(_0x22b880,0x3e8));const _0x4e7116=_0x1b9caa[_0xe02b44(0x286)](29.7,2.54),_0x420c27=Math[_0xe02b44(0x20e)](_0x1b9caa['CJPvU'](_0x4e7116,0x60));await _0x47e975[_0xe02b44(0x2ea)]({'width':0x320,'height':_0x420c27,'deviceScaleFactor':0x1});const _0x1b7258=await _0x47e975['screenshot']({'type':_0x1b9caa[_0xe02b44(0x2c8)],'fullPage':!0x0,'omitBackground':!0x1});await _0x17190f[_0xe02b44(0x284)]();const _0x5ca5b1=_0x1a33a1[_0xe02b44(0x2bb)][_0xe02b44(0x210)](/\//g,'');_0x3726c0[_0xe02b44(0x1d5)](0xc8,{'Content-Type':_0x1b9caa['syhqV'],'Content-Disposition':'attachment;\x20filename=quotation-'+_0x5ca5b1+_0xe02b44(0x2ec),'Content-Length':_0x1b7258[_0xe02b44(0x27c)]}),_0x3726c0['end'](_0x1b7258);}}else{if(_0x1b9caa['NHpIo'](_0x1fb90d,_0x1b9caa[_0xe02b44(0x2b4)])){if(_0x1b9caa[_0xe02b44(0x1be)](_0x1b9caa[_0xe02b44(0x1f3)],_0x1b9caa[_0xe02b44(0x2d8)])){const _0x354d9e=_0x4957ff['apply'](_0x4da0fa,arguments);return _0x3bf026=null,_0x354d9e;}else{const _0x192e9a=await(await import(_0x1b9caa['zoohd']))[_0xe02b44(0x21d)](),_0x3f1f98=await _0x192e9a[_0xe02b44(0x231)]();await _0x3f1f98[_0xe02b44(0x191)](_0xb4ce2a,{'waitUntil':_0x1b9caa[_0xe02b44(0x24e)],'timeout':0x2710}),await new Promise(_0x813379=>setTimeout(_0x813379,0x3e8));const _0x29ba39=await _0x3f1f98[_0xe02b44(0x263)]({'format':'A4','printBackground':!0x0});await _0x192e9a[_0xe02b44(0x284)]();const _0x41c427=_0x1a33a1[_0xe02b44(0x2bb)][_0xe02b44(0x210)](/\//g,'');_0x3726c0[_0xe02b44(0x1d5)](0xc8,{'Content-Type':_0x1b9caa[_0xe02b44(0x24c)],'Content-Disposition':_0xe02b44(0x184)+_0x41c427+_0xe02b44(0x199),'Content-Length':_0x29ba39[_0xe02b44(0x27c)]}),_0x3726c0['end'](_0x29ba39);}}}}}else return function(_0x169b71){}[_0xe02b44(0x1de)](uQSgFf['SZono'])[_0xe02b44(0x264)](uQSgFf['PZCbA']);}catch(_0x29fcef){_0x1b9caa['kiIxr'](_0x1b9caa[_0xe02b44(0x1e6)],_0x1b9caa[_0xe02b44(0x1e6)])?_0x28485c[_0xe02b44(0x284)]():(console[_0xe02b44(0x259)](_0x1b9caa[_0xe02b44(0x1d8)],_0x29fcef),_0x3726c0[_0xe02b44(0x295)](JSON['stringify']({'isPrint':!0x1,'class':_0x1b9caa[_0xe02b44(0x1d9)],'msg':_0x29fcef[_0xe02b44(0x250)]})));}finally{if(_0x1b9caa[_0xe02b44(0x1a4)](_0x1b9caa['CJbRO'],_0x1b9caa[_0xe02b44(0x1cf)]))_0x227953['close']();else{const _0x1a5e49=new _0x1cc6de(uQSgFf[_0xe02b44(0x240)]),_0x4860fb=new _0x429b43(uQSgFf[_0xe02b44(0x2e3)],'i'),_0xbac306=uQSgFf['IZBPS'](_0x3de817,uQSgFf[_0xe02b44(0x19c)]);!_0x1a5e49[_0xe02b44(0x189)](uQSgFf[_0xe02b44(0x19b)](_0xbac306,uQSgFf[_0xe02b44(0x1e0)]))||!_0x4860fb[_0xe02b44(0x189)](uQSgFf[_0xe02b44(0x293)](_0xbac306,uQSgFf[_0xe02b44(0x1f8)]))?uQSgFf[_0xe02b44(0x18e)](_0xbac306,'0'):uQSgFf[_0xe02b44(0x1d6)](_0x1219a2);}}}),b[_0x1d22c9(0x1d4)](H,_0x37d1b8[_0x1d22c9(0x1ee)],async(_0x2d0f62,_0x2113c8)=>{const _0x5f041f=_0x1d22c9,_0x1e38fd={'WcBaU':_0x5f041f(0x1a1),'LHvxO':function(_0x5cc05f,_0x38d618){return _0x5cc05f(_0x38d618);},'ifycb':function(_0xaed0da,_0x4bbf92){return _0xaed0da!==_0x4bbf92;},'oaEwH':_0x5f041f(0x1e4),'qSaqS':_0x5f041f(0x294),'Jtcww':function(_0x36a378,_0x161bd3){return _0x36a378<_0x161bd3;},'ieQPt':'yellow','Ncpkc':'ไม่พบประวัติการเปลี่ยนแปลง','HzBWh':_0x5f041f(0x288),'xfndN':_0x5f041f(0x227),'ITphU':_0x5f041f(0x287),'bSMhV':_0x5f041f(0x1b6),'jWtYF':function(_0xb73f8b,_0x51f356){return _0xb73f8b!==_0x51f356;},'vZFRF':_0x5f041f(0x258)},{docId:_0x2ea606,docTitle:_0xb8058c}=_0x2d0f62[_0x5f041f(0x22d)],_0x2b881d=_0x24daa1[_0x5f041f(0x1ca)](_0xb8058c),_0x47da23=new _0x41141d(global['dbUrl']);try{if(_0x1e38fd['ifycb'](_0x1e38fd[_0x5f041f(0x215)],_0x1e38fd[_0x5f041f(0x215)])){const _0x4c8d07=_0x410c06?function(){const _0x4bfa26=_0x5f041f;if(_0x501631){const _0x184d00=_0x2eb5c7[_0x4bfa26(0x264)](_0x195cb5,arguments);return _0x3a8e45=null,_0x184d00;}}:function(){};return _0x8dd43e=![],_0x4c8d07;}else{await _0x47da23['connect']();var _0x1ed9f7=await _0x47da23['db'](global[_0x5f041f(0x25a)])[_0x5f041f(0x188)](_0x2b881d)[_0x5f041f(0x1aa)]({'docId':_0x2ea606});if(!_0x1ed9f7)return _0x2113c8[_0x5f041f(0x295)](JSON['stringify']({'isPrint':!0x1,'class':_0x1e38fd[_0x5f041f(0x2d0)],'msg':_0x5f041f(0x292)+_0x2ea606+'\x22'}));const _0x37e66f=_0x1ed9f7[_0x5f041f(0x226)]||[];if(_0x1e38fd[_0x5f041f(0x1c4)](_0x37e66f[_0x5f041f(0x27c)],0x1))return _0x2113c8[_0x5f041f(0x295)](JSON[_0x5f041f(0x1ae)]({'isPrint':!0x1,'class':_0x1e38fd['ieQPt'],'msg':_0x1e38fd[_0x5f041f(0x1d2)]}));const _0x3f0b52=_0x5dbe5d[_0x5f041f(0x2b6)](folderViews,_0x1e38fd[_0x5f041f(0x27a)]),_0x162d65=await _0x1e135c[_0x5f041f(0x296)](_0x3f0b52,_0x2113c8,{'title':_0x1ed9f7[_0x5f041f(0x2bb)],'time':_0x312905[_0x5f041f(0x1bc)](new Date()),'changesHistory':_0x37e66f});_0x2113c8[_0x5f041f(0x295)](JSON[_0x5f041f(0x1ae)]({'isPrint':!0x0,'class':_0x1e38fd[_0x5f041f(0x247)],'htmlPage':_0x162d65}));}}catch(_0x1030c4){if(_0x1e38fd[_0x5f041f(0x1a5)](_0x1e38fd[_0x5f041f(0x289)],_0x1e38fd[_0x5f041f(0x260)]))console[_0x5f041f(0x259)](_0x1e38fd[_0x5f041f(0x2be)],_0x1030c4),_0x2113c8[_0x5f041f(0x295)](JSON[_0x5f041f(0x1ae)]({'isPrint':!0x1,'class':_0x1e38fd[_0x5f041f(0x2d0)],'msg':_0x1030c4['message']}));else{const _0x105173=_0x3ba465[_0x5f041f(0x2dd)](_0xf55f27);return _0x545989['send'](_0x330235[_0x5f041f(0x1ae)]({..._0x105173,'isLoad':!0x0,'class':_0x1e38fd[_0x5f041f(0x247)],'msg':'โหลดลายเซ็น\x20\x22'+_0x304342+_0x5f041f(0x2d3)}));}}finally{if(_0x1e38fd[_0x5f041f(0x2b1)](_0x1e38fd['vZFRF'],_0x1e38fd[_0x5f041f(0x2a4)])){if(_0x46564d)return _0x541a37;else BLiMVh[_0x5f041f(0x18c)](_0x2f3681,0x0);}else _0x47da23['close']();}}),b[_0x1d22c9(0x279)](V,_0x37d1b8[_0x1d22c9(0x1ee)],async(_0x1745ca,_0x288176)=>{const _0x3f5219=_0x1d22c9,_0x193454={'CkzhU':'red','BIAss':function(_0x1002cf,_0x22bed5){return _0x1002cf(_0x22bed5);},'ECjZG':function(_0x5468ff,_0x5a50c4){return _0x5468ff+_0x5a50c4;},'YRysV':function(_0x396ec2,_0x38d094){return _0x396ec2+_0x38d094;},'ufQKK':_0x3f5219(0x1e8),'ElFwq':_0x3f5219(0x21f),'mZooJ':function(_0x4863e4,_0x15a324){return _0x4863e4(_0x15a324);},'axwsC':function(_0x3847e7,_0x3f7f4d){return _0x3847e7===_0x3f7f4d;},'ntIqj':_0x3f5219(0x224),'dztSk':_0x3f5219(0x254),'IPKgB':_0x3f5219(0x1a1),'vgBDX':_0x3f5219(0x271),'aIXfK':function(_0x4eb13d,_0x1cd7b6){return _0x4eb13d!==_0x1cd7b6;},'LteCH':_0x3f5219(0x1e1),'UHlCO':_0x3f5219(0x23d)};let {userId:_0x343c98}=_0x4f4276[_0x3f5219(0x2cc)](_0x1745ca);_0x343c98=_0x343c98&&_0x193454[_0x3f5219(0x200)](Number,_0x343c98);const _0x5e5a65=new _0x41141d(global[_0x3f5219(0x229)]);try{if(_0x193454[_0x3f5219(0x1b5)](_0x193454[_0x3f5219(0x1a2)],_0x193454[_0x3f5219(0x197)]))return!![];else{const _0x1230c0=_0x4f4276['getSessionData_sign'](_0x1745ca);return _0x288176[_0x3f5219(0x295)](JSON[_0x3f5219(0x1ae)]({..._0x1230c0,'isLoad':!0x0,'class':_0x193454[_0x3f5219(0x239)],'msg':_0x3f5219(0x2a1)+_0x343c98+_0x3f5219(0x2d3)}));}}catch(_0x5179cf){if(_0x193454[_0x3f5219(0x1b5)](_0x193454['vgBDX'],_0x193454[_0x3f5219(0x22f)]))return console[_0x3f5219(0x259)](_0x5179cf),_0x288176[_0x3f5219(0x295)](JSON[_0x3f5219(0x1ae)]({'isLoad':!0x1,'class':_0x193454['CkzhU'],'msg':_0x5179cf[_0x3f5219(0x250)]}));else _0xf4efe0[_0x3f5219(0x259)](_0x21c662),_0x17d2a1[_0x3f5219(0x295)](_0x3228f4[_0x3f5219(0x1ae)]({'isStatus':!0x1,'class':_0x193454[_0x3f5219(0x2ee)],'msg':_0x2bb354[_0x3f5219(0x250)]}));}finally{_0x193454[_0x3f5219(0x26b)](_0x193454[_0x3f5219(0x2d6)],_0x193454[_0x3f5219(0x1b9)])?_0x5e5a65[_0x3f5219(0x284)]():_0x14603e=JJZYnJ[_0x3f5219(0x1f7)](_0x2e27cc,JJZYnJ[_0x3f5219(0x207)](JJZYnJ['YRysV'](JJZYnJ[_0x3f5219(0x2a7)],JJZYnJ['ElFwq']),');'))();}}),b['post'](M,_0x37d1b8['isAuth'],async(_0x1e69f8,_0x5e4cdd)=>{const _0x1e5397=_0x1d22c9,_0xf8ddd1={'kkSPr':_0x1e5397(0x294),'QZSMy':function(_0x9025ba,_0x2bfcaa){return _0x9025ba===_0x2bfcaa;},'RZRoK':_0x1e5397(0x278),'aDOCc':'MqbrC','cVYWx':function(_0xf12a67,_0x254dec){return _0xf12a67!==_0x254dec;},'YSBWB':'weYQp','nfHmt':_0x1e5397(0x2d2),'JTCIm':function(_0x44e7fb,_0x2e6560,_0x3d8be4){return _0x44e7fb(_0x2e6560,_0x3d8be4);},'TGaRF':function(_0x3dd1ac){return _0x3dd1ac();},'JnPaj':function(_0x39b51f,_0x530c3f){return _0x39b51f!==_0x530c3f;},'baviL':'WOqlB','RfAcX':function(_0x4565f5,_0x547bf6){return _0x4565f5(_0x547bf6);},'azJgL':function(_0x3cd440,_0x44acf0){return _0x3cd440(_0x44acf0);},'Lxdqv':_0x1e5397(0x25f),'geXqR':_0x1e5397(0x1a3),'TIjmb':'เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','GdmMK':function(_0x316c01,_0x4a9bcb){return _0x316c01==_0x4a9bcb;},'bMlIu':_0x1e5397(0x1a8),'eEHtG':function(_0x1c2d0c,_0xd9ff54){return _0x1c2d0c==_0xd9ff54;},'KKyWV':'ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','Bqddy':_0x1e5397(0x24a),'wfxAn':function(_0x2f1468,_0x55f953){return _0x2f1468==_0x55f953;},'kqSkN':function(_0x2d4c79,_0x339fd9){return _0x2d4c79>_0x339fd9;},'EUvrH':_0x1e5397(0x1a1),'ZQCXK':function(_0x624a3b,_0x2dd0a8){return _0x624a3b<_0x2dd0a8;},'jXJRR':_0x1e5397(0x193),'dZxzb':_0x1e5397(0x2cd),'GsCbi':'WlsbB'},_0x4de8ba=[];let _0x3c230b=!0x1;const _0x4f9d25=async()=>{const _0x121c4b=_0x1e5397;if(_0xf8ddd1[_0x121c4b(0x181)](_0xf8ddd1[_0x121c4b(0x2ae)],_0xf8ddd1['aDOCc']))return _0x1e0c2e['log'](_0x5ba1e6),_0x350636[_0x121c4b(0x295)](_0x468ad3['stringify']({'isLoad':!0x1,'class':_0xf8ddd1[_0x121c4b(0x1af)],'msg':_0x1854d6[_0x121c4b(0x250)]}));else{if(_0xf8ddd1[_0x121c4b(0x181)](_0x4de8ba[_0x121c4b(0x27c)],0x0)){if(_0xf8ddd1[_0x121c4b(0x2ca)](_0xf8ddd1[_0x121c4b(0x2a5)],_0xf8ddd1['nfHmt'])){_0x3c230b=!0x1;return;}else{const _0x502e9d=_0x15c60b?function(){if(_0xdaf2a4){const _0x3b16d6=_0x2c43de['apply'](_0x3636b1,arguments);return _0xb72e83=null,_0x3b16d6;}}:function(){};return _0x3c2b85=![],_0x502e9d;}}_0x3c230b=!0x0;const {req:_0x1484ee,res:_0x331fd8}=_0x4de8ba[_0x121c4b(0x24f)]();await _0xf8ddd1[_0x121c4b(0x221)](_0x41d189,_0x1484ee,_0x331fd8),_0xf8ddd1[_0x121c4b(0x1cd)](_0x4f9d25);}},_0x41d189=async(_0x55acbd,_0x13dd79)=>{const _0x5aff4d=_0x1e5397,_0x5b7d15={'EiAsR':_0xf8ddd1[_0x5aff4d(0x1af)]},_0x24525d=new _0x41141d(global[_0x5aff4d(0x229)]);try{if(_0xf8ddd1[_0x5aff4d(0x2ce)](_0xf8ddd1[_0x5aff4d(0x297)],_0xf8ddd1[_0x5aff4d(0x297)]))_0x1c53c9[_0x5aff4d(0x284)]();else{let {userId:_0x557bd6}=_0x4f4276[_0x5aff4d(0x2cc)](_0x55acbd);_0x557bd6=_0x557bd6&&_0xf8ddd1[_0x5aff4d(0x244)](Number,_0x557bd6);let {docStatusNumber:_0x4c3694,docId:_0x578201,action:_0x3c4ce0,text:_0x5b2fa6,docTitle:_0xba4cc1}=_0x55acbd[_0x5aff4d(0x22d)];if(_0x4c3694=_0x4c3694&&_0xf8ddd1[_0x5aff4d(0x182)](Number,_0x4c3694),!_0x578201||![_0xf8ddd1[_0x5aff4d(0x2bc)],_0xf8ddd1[_0x5aff4d(0x213)]]['includes'](_0x3c4ce0))return _0x13dd79[_0x5aff4d(0x295)](JSON[_0x5aff4d(0x1ae)]({'isStatus':!0x1,'class':_0xf8ddd1[_0x5aff4d(0x1af)],'msg':_0xf8ddd1[_0x5aff4d(0x1f0)]}));if(_0xf8ddd1[_0x5aff4d(0x1b2)](_0x3c4ce0,_0xf8ddd1[_0x5aff4d(0x213)])&&['1','2']['includes'](_0x4c3694))return _0x13dd79[_0x5aff4d(0x295)](JSON[_0x5aff4d(0x1ae)]({'isStatus':!0x1,'class':_0xf8ddd1[_0x5aff4d(0x1af)],'msg':_0xf8ddd1[_0x5aff4d(0x1b8)]}));if(_0xf8ddd1[_0x5aff4d(0x1fd)](_0x3c4ce0,_0xf8ddd1['Lxdqv'])&&_0xf8ddd1[_0x5aff4d(0x2ce)](_0x4c3694,0x1))return _0x13dd79[_0x5aff4d(0x295)](JSON['stringify']({'isStatus':!0x1,'class':_0xf8ddd1[_0x5aff4d(0x1af)],'msg':_0xf8ddd1[_0x5aff4d(0x253)]}));const _0x228c55=_0x24daa1[_0x5aff4d(0x1ca)](_0xba4cc1);if(!_0x228c55)return _0x13dd79['send'](JSON[_0x5aff4d(0x1ae)]({'isStatus':!0x1,'class':_0xf8ddd1['kkSPr'],'msg':_0xf8ddd1[_0x5aff4d(0x282)]}));const _0x5d82a7=_0x24525d['db'](global[_0x5aff4d(0x25a)])['collection'](_0x228c55);if(!await _0x5d82a7[_0x5aff4d(0x1aa)]({'docId':_0x578201,'proposerId':_0x557bd6}))return _0x13dd79[_0x5aff4d(0x295)](JSON[_0x5aff4d(0x1ae)]({'isStatus':!0x1,'class':_0xf8ddd1[_0x5aff4d(0x1af)],'msg':'ไม่พบเอกสาร\x20\x22'+_0x578201+'\x22'}));const _0x1aed09=_0xf8ddd1[_0x5aff4d(0x21b)](_0x3c4ce0,_0xf8ddd1[_0x5aff4d(0x2bc)])?0x2:0xa,_0x4d2f7d=await _0x5d82a7[_0x5aff4d(0x2eb)]({'docId':_0x578201,'proposerId':_0x557bd6},{'$set':{'docStatusNumber':_0x1aed09}});if(_0xf8ddd1[_0x5aff4d(0x280)](_0x4d2f7d[_0x5aff4d(0x2b3)],0x0))return _0x13dd79['send'](JSON[_0x5aff4d(0x1ae)]({'isStatus':!0x0,'docId':_0x578201,'docStatusNumber':_0x1aed09,'class':_0xf8ddd1[_0x5aff4d(0x26e)],'msg':_0x5b2fa6+'\x20\x22'+_0x578201+_0x5aff4d(0x2d3)}));if(_0x4d2f7d[_0x5aff4d(0x269)]&&_0xf8ddd1[_0x5aff4d(0x242)](_0x4d2f7d[_0x5aff4d(0x2b3)],0x1))return _0x13dd79[_0x5aff4d(0x295)](JSON[_0x5aff4d(0x1ae)]({'isStatus':!0x1,'docId':_0x578201,'docStatusNumber':_0x4c3694,'class':_0xf8ddd1[_0x5aff4d(0x2bd)],'msg':_0x5aff4d(0x25c)+_0x578201+'\x22'}));}}catch(_0x55b081){_0xf8ddd1[_0x5aff4d(0x2ca)](_0xf8ddd1[_0x5aff4d(0x1e2)],_0xf8ddd1['dZxzb'])?_0x2f3dcc[_0x5aff4d(0x284)]():(console[_0x5aff4d(0x259)](_0x55b081),_0x13dd79[_0x5aff4d(0x295)](JSON['stringify']({'isStatus':!0x1,'class':_0xf8ddd1['kkSPr'],'msg':_0x55b081[_0x5aff4d(0x250)]})));}finally{if(_0xf8ddd1[_0x5aff4d(0x181)](_0xf8ddd1[_0x5aff4d(0x19a)],_0xf8ddd1['GsCbi']))_0x24525d['close']();else return _0x181f3e[_0x5aff4d(0x259)](_0x3317c1),_0x5572c6[_0x5aff4d(0x295)](_0x9172bc[_0x5aff4d(0x1ae)]({'isSearch':!0x1,'class':_0x5b7d15[_0x5aff4d(0x2d1)],'msg':_0xaeee86[_0x5aff4d(0x250)]}));}};_0x4de8ba[_0x1e5397(0x29b)]({'req':_0x1e69f8,'res':_0x5e4cdd}),_0x3c230b||_0xf8ddd1[_0x1e5397(0x1cd)](_0x4f9d25);});export default b;function _0x47e5f1(_0x5194fc){const _0x4f333e=_0x1d22c9,_0x28eade={'qluxQ':function(_0x379689,_0x25fa07){return _0x379689===_0x25fa07;},'ccepJ':_0x4f333e(0x1dc),'EHFhG':'while\x20(true)\x20{}','AcKHQ':'counter','xBljH':function(_0x4f3b67,_0x3ee24a){return _0x4f3b67!==_0x3ee24a;},'oNPvO':function(_0x317800,_0x179678){return _0x317800+_0x179678;},'XlNUQ':function(_0x4de257,_0x519c25){return _0x4de257/_0x519c25;},'VRXTI':_0x4f333e(0x27c),'OdkQv':function(_0xc0688a,_0x582ea5){return _0xc0688a%_0x582ea5;},'QpbzI':function(_0x2386dd,_0x4e0b04){return _0x2386dd+_0x4e0b04;},'cMCiV':_0x4f333e(0x28f),'uQVet':_0x4f333e(0x26d),'gEpFP':_0x4f333e(0x267),'tboPD':function(_0x29e244,_0x18377a){return _0x29e244+_0x18377a;},'iVTLC':_0x4f333e(0x26a),'KvpYG':function(_0x54ab48,_0x4fab55){return _0x54ab48(_0x4fab55);}};function _0x2260e3(_0x1a4bb1){const _0x200fed=_0x4f333e;if(_0x28eade['qluxQ'](typeof _0x1a4bb1,_0x28eade['ccepJ']))return function(_0x43d3dd){}[_0x200fed(0x1de)](_0x28eade[_0x200fed(0x1f6)])[_0x200fed(0x264)](_0x28eade[_0x200fed(0x26c)]);else _0x28eade[_0x200fed(0x25b)](_0x28eade[_0x200fed(0x2e4)]('',_0x28eade[_0x200fed(0x1fc)](_0x1a4bb1,_0x1a4bb1))[_0x28eade[_0x200fed(0x2b5)]],0x1)||_0x28eade[_0x200fed(0x1e9)](_0x28eade['OdkQv'](_0x1a4bb1,0x14),0x0)?function(){return!![];}[_0x200fed(0x1de)](_0x28eade['QpbzI'](_0x28eade[_0x200fed(0x209)],_0x28eade[_0x200fed(0x2df)]))[_0x200fed(0x1a6)](_0x28eade[_0x200fed(0x1dd)]):function(){return![];}[_0x200fed(0x1de)](_0x28eade['tboPD'](_0x28eade['cMCiV'],_0x28eade[_0x200fed(0x2df)]))['apply'](_0x28eade[_0x200fed(0x2bf)]);_0x28eade[_0x200fed(0x2aa)](_0x2260e3,++_0x1a4bb1);}try{if(_0x5194fc)return _0x2260e3;else _0x28eade[_0x4f333e(0x2aa)](_0x2260e3,0x0);}catch(_0x12e71a){}}