const _0x3dd3ed=_0x2186;(function(_0x377277,_0x1cd47e){const _0x4dbbf1=_0x2186,_0x54d503=_0x377277();while(!![]){try{const _0x35265d=parseInt(_0x4dbbf1(0x1cf))/0x1*(parseInt(_0x4dbbf1(0x1df))/0x2)+-parseInt(_0x4dbbf1(0x1b9))/0x3*(-parseInt(_0x4dbbf1(0x146))/0x4)+-parseInt(_0x4dbbf1(0x213))/0x5+-parseInt(_0x4dbbf1(0x145))/0x6+-parseInt(_0x4dbbf1(0x227))/0x7+-parseInt(_0x4dbbf1(0x206))/0x8*(-parseInt(_0x4dbbf1(0x1e5))/0x9)+parseInt(_0x4dbbf1(0x102))/0xa;if(_0x35265d===_0x1cd47e)break;else _0x54d503['push'](_0x54d503['shift']());}catch(_0x53f669){_0x54d503['push'](_0x54d503['shift']());}}}(_0x2a1a,0xb255a));const _0x13c47d=(function(){const _0x4c87a8=_0x2186,_0x177eac={'UthKr':function(_0x36b3ab,_0x256f87){return _0x36b3ab!==_0x256f87;},'YzHJs':_0x4c87a8(0x168),'eYjNW':_0x4c87a8(0x14b),'FjdhB':_0x4c87a8(0x21c),'sEEwJ':function(_0x442f93,_0xacc4e0){return _0x442f93(_0xacc4e0);},'unWTe':function(_0x238231,_0x88fa8a){return _0x238231+_0x88fa8a;},'FWuba':_0x4c87a8(0x1d2),'XKHOq':'{}.constructor(\x22return\x20this\x22)(\x20)','Oieii':function(_0xd239f5){return _0xd239f5();},'qrjex':_0x4c87a8(0x13e),'oTYcc':_0x4c87a8(0x140),'QZZMK':_0x4c87a8(0x181),'LVmFs':_0x4c87a8(0x193),'eUfcy':'exception','zPqWi':_0x4c87a8(0x179),'OfXJz':'trace','RGwrb':function(_0x535daf,_0x12d0d1){return _0x535daf<_0x12d0d1;},'RghXi':_0x4c87a8(0x14c),'xUKMl':_0x4c87a8(0x16c),'RxqLA':_0x4c87a8(0x129),'QlIlZ':function(_0x148d89,_0x465c64){return _0x148d89!==_0x465c64;},'GpRum':'wpULG','HuEDh':_0x4c87a8(0x159)};let _0x4d5ae9=!![];return function(_0x5d7a51,_0x32bd04){const _0x15477b=_0x4c87a8,_0x31e9b1={'ruNQu':function(_0x443e06,_0x2db673){return _0x177eac['unWTe'](_0x443e06,_0x2db673);},'kDdkL':_0x177eac[_0x15477b(0x207)],'btgcu':_0x177eac[_0x15477b(0x120)],'oituO':_0x177eac['RxqLA']};if(_0x177eac[_0x15477b(0x112)](_0x177eac['GpRum'],_0x177eac['HuEDh'])){const _0x4baece=_0x4d5ae9?function(){const _0x211bb7=_0x15477b;if(_0x177eac[_0x211bb7(0x26f)](_0x177eac['YzHJs'],_0x177eac[_0x211bb7(0x116)]))_0x2430b0[_0x211bb7(0x125)]();else{if(_0x32bd04){if(_0x177eac[_0x211bb7(0x26f)](_0x177eac[_0x211bb7(0x167)],_0x177eac['FjdhB'])){const _0x5992e7=_0x32bd04[_0x211bb7(0x108)](_0x5d7a51,arguments);return _0x32bd04=null,_0x5992e7;}else(function(){return!![];}[_0x211bb7(0x184)](_0x31e9b1[_0x211bb7(0x249)](_0x31e9b1[_0x211bb7(0x25a)],_0x31e9b1[_0x211bb7(0x22f)]))[_0x211bb7(0x106)](_0x31e9b1['oituO']));}}}:function(){};return _0x4d5ae9=![],_0x4baece;}else{let _0x11a179;try{const _0x2e3df8=_0x177eac[_0x15477b(0x10f)](_0x392c2f,_0x177eac['unWTe'](_0x177eac[_0x15477b(0x195)](_0x177eac[_0x15477b(0x1d9)],_0x177eac[_0x15477b(0x23b)]),');'));_0x11a179=_0x177eac[_0x15477b(0x127)](_0x2e3df8);}catch(_0x1a3e65){_0x11a179=_0x165efd;}const _0x4d176b=_0x11a179[_0x15477b(0x23e)]=_0x11a179[_0x15477b(0x23e)]||{},_0x9c0608=[_0x177eac[_0x15477b(0x1ca)],_0x177eac[_0x15477b(0x15c)],_0x177eac[_0x15477b(0x1ef)],_0x177eac[_0x15477b(0x25f)],_0x177eac[_0x15477b(0x14f)],_0x177eac[_0x15477b(0x21e)],_0x177eac[_0x15477b(0x126)]];for(let _0x1c3b5e=0x0;_0x177eac[_0x15477b(0x1a3)](_0x1c3b5e,_0x9c0608[_0x15477b(0x20a)]);_0x1c3b5e++){const _0x2fd40c=_0x1bc59d[_0x15477b(0x184)][_0x15477b(0x233)]['bind'](_0x898a77),_0x3d28b4=_0x9c0608[_0x1c3b5e],_0x113248=_0x4d176b[_0x3d28b4]||_0x2fd40c;_0x2fd40c[_0x15477b(0x1b3)]=_0x4100f8[_0x15477b(0x1e1)](_0x2f0742),_0x2fd40c[_0x15477b(0x17f)]=_0x113248[_0x15477b(0x17f)][_0x15477b(0x1e1)](_0x113248),_0x4d176b[_0x3d28b4]=_0x2fd40c;}}};}());(function(){const _0x1ca994=_0x2186,_0x126e46={'rSZpV':function(_0x47d60d,_0x51d877){return _0x47d60d(_0x51d877);},'GZMfr':_0x1ca994(0x182),'hcMvG':_0x1ca994(0x15d),'QtLdW':'error\x20===>\x20','JcWYI':function(_0xa6b4c,_0x25228f){return _0xa6b4c===_0x25228f;},'uGXOZ':'rohTg','gKrnu':_0x1ca994(0x18e),'dGlzL':_0x1ca994(0x235),'ytVAb':_0x1ca994(0x16a),'Ykcsb':function(_0x18dc74,_0x557491){return _0x18dc74(_0x557491);},'wyzmm':_0x1ca994(0x109),'lvlvj':function(_0x3283b2,_0x3dc314){return _0x3283b2+_0x3dc314;},'pVztm':_0x1ca994(0x230),'Gjbqw':_0x1ca994(0x1f6),'MCphC':_0x1ca994(0x1b2),'Rbxwr':function(_0x5a80f8,_0x1566e9){return _0x5a80f8(_0x1566e9);},'ZHXlY':function(_0x8a812d,_0x54ca58){return _0x8a812d!==_0x54ca58;},'ILqPK':_0x1ca994(0x1f1),'KPfAv':function(_0x16c4d3){return _0x16c4d3();},'kwvDs':function(_0x412f04,_0x44a663,_0x5997ea){return _0x412f04(_0x44a663,_0x5997ea);}};_0x126e46['kwvDs'](_0x13c47d,this,function(){const _0x27037a=_0x1ca994,_0x2f1ce8={'mWIBc':_0x126e46[_0x27037a(0x11e)],'easAO':_0x126e46[_0x27037a(0x1bf)]};if(_0x126e46['JcWYI'](_0x126e46[_0x27037a(0x117)],_0x126e46['gKrnu'])){const _0x204174=_0xa2defd[_0x27037a(0x108)](_0x454854,arguments);return _0xc7bbfe=null,_0x204174;}else{const _0x5bdf15=new RegExp(_0x126e46[_0x27037a(0x119)]),_0x1164a8=new RegExp(_0x126e46[_0x27037a(0x25d)],'i'),_0x190048=_0x126e46[_0x27037a(0x250)](_0x14943d,_0x126e46['wyzmm']);if(!_0x5bdf15[_0x27037a(0x240)](_0x126e46[_0x27037a(0x157)](_0x190048,_0x126e46['pVztm']))||!_0x1164a8[_0x27037a(0x240)](_0x126e46['lvlvj'](_0x190048,_0x126e46['Gjbqw']))){if(_0x126e46[_0x27037a(0x267)](_0x126e46[_0x27037a(0x131)],_0x126e46[_0x27037a(0x131)]))_0x126e46[_0x27037a(0x261)](_0x190048,'0');else{let {userId:_0x366549}=_0x1bc559[_0x27037a(0x191)](_0x53ece0);_0x366549=_0x366549&&_0x126e46[_0x27037a(0x228)](_0x31a117,_0x366549);const _0xe97cda=new _0x22dbe5(_0x7a863f[_0x27037a(0x11b)]);try{const _0x5f17be=_0x3649e7[_0x27037a(0x1f5)](_0x42c58e);return _0x6c47d1[_0x27037a(0x24b)](_0x4d036a[_0x27037a(0x244)]({..._0x5f17be,'isLoad':!0x0,'class':_0x126e46['GZMfr'],'msg':_0x27037a(0x24f)+_0x366549+_0x27037a(0x26e)}));}catch(_0x1401c2){return _0x234215[_0x27037a(0x13e)](_0x1401c2),_0x58b72d['send'](_0x460a8b['stringify']({'isLoad':!0x1,'class':_0x126e46['hcMvG'],'msg':_0x1401c2[_0x27037a(0x18a)]}));}finally{_0xe97cda[_0x27037a(0x125)]();}}}else _0x126e46[_0x27037a(0x211)](_0x126e46[_0x27037a(0x15f)],_0x126e46[_0x27037a(0x15f)])?(_0xaf4e78[_0x27037a(0x13e)](_0x2f1ce8[_0x27037a(0x11f)],_0x26ab72),_0x5c42b9[_0x27037a(0x24b)](_0x5a8529[_0x27037a(0x244)]({'isPrint':!0x1,'class':_0x2f1ce8[_0x27037a(0x1e6)],'msg':_0x53f33e[_0x27037a(0x18a)]}))):_0x126e46['KPfAv'](_0x14943d);}})();}());const _0x374b7c=(function(){const _0x4aa49d=_0x2186,_0x4e334f={'kMTPR':function(_0x35bf99,_0xb1100c){return _0x35bf99===_0xb1100c;},'CWAWU':'gyXaD','Dhtke':_0x4aa49d(0x223),'yZsCM':_0x4aa49d(0x10c),'IZAuJ':_0x4aa49d(0x1f8),'tyHBO':'khZIz'};let _0x3d8757=!![];return function(_0x269998,_0x4204d6){const _0x416892=_0x4aa49d;if(_0x4e334f[_0x416892(0x270)](_0x4e334f[_0x416892(0x1c1)],_0x4e334f['tyHBO'])){const _0x3395b9=_0x3d8757?function(){const _0x7daebe=_0x416892;if(_0x4e334f[_0x7daebe(0x270)](_0x4e334f[_0x7daebe(0x153)],_0x4e334f[_0x7daebe(0x171)])){const _0x2a2690=_0x5dc428[_0x7daebe(0x108)](_0x12954b,arguments);return _0x11ba3e=null,_0x2a2690;}else{if(_0x4204d6){if(_0x4e334f[_0x7daebe(0x270)](_0x4e334f[_0x7daebe(0x10e)],_0x4e334f[_0x7daebe(0x187)])){const _0x98cdb2=_0x305b85?function(){const _0xd8d510=_0x7daebe;if(_0x4c279e){const _0x1eec4c=_0x2c937b[_0xd8d510(0x108)](_0x2a6bc9,arguments);return _0x4bd229=null,_0x1eec4c;}}:function(){};return _0x26047c=![],_0x98cdb2;}else{const _0x413551=_0x4204d6[_0x7daebe(0x108)](_0x269998,arguments);return _0x4204d6=null,_0x413551;}}}}:function(){};return _0x3d8757=![],_0x3395b9;}else _0x4dc99b['close']();};}()),_0x4ae341=_0x374b7c(this,function(){const _0x23997f=_0x2186,_0x3e602f={'yHFxq':_0x23997f(0x15d),'bYHpW':function(_0x5c1da7,_0x99ccc7){return _0x5c1da7!==_0x99ccc7;},'zbNLi':_0x23997f(0x16b),'yTdZm':'iMoWf','vpqaa':function(_0x202455,_0x1bf5fd){return _0x202455(_0x1bf5fd);},'qJyiV':function(_0x1c99a9,_0x3eedcb){return _0x1c99a9+_0x3eedcb;},'yAHWv':function(_0x2f9595,_0x1cd976){return _0x2f9595+_0x1cd976;},'iuuZX':_0x23997f(0x1d2),'cpjlc':_0x23997f(0x218),'HeChO':function(_0x11e97a){return _0x11e97a();},'HjYgL':function(_0x70ec6d,_0x4d019d){return _0x70ec6d===_0x4d019d;},'FlIdV':_0x23997f(0x1d6),'NSXqv':_0x23997f(0x13e),'FzaBI':_0x23997f(0x140),'SeFDf':_0x23997f(0x181),'otcfr':_0x23997f(0x193),'CgEho':'exception','taaxb':_0x23997f(0x179),'cOArx':'trace','ebLPn':function(_0x308933,_0x3d67ea){return _0x308933<_0x3d67ea;},'iqomk':function(_0x2a3402,_0x1f093a){return _0x2a3402!==_0x1f093a;},'zrHOK':_0x23997f(0x26a)};let _0xdfb6d7;try{if(_0x3e602f['bYHpW'](_0x3e602f[_0x23997f(0x21a)],_0x3e602f[_0x23997f(0x1c8)])){const _0x1aefaa=_0x3e602f[_0x23997f(0x236)](Function,_0x3e602f[_0x23997f(0x25e)](_0x3e602f['yAHWv'](_0x3e602f[_0x23997f(0x19f)],_0x3e602f['cpjlc']),');'));_0xdfb6d7=_0x3e602f[_0x23997f(0x164)](_0x1aefaa);}else return _0x19f581[_0x23997f(0x13e)](_0x245410),_0x28f7e5[_0x23997f(0x24b)](_0x49376c[_0x23997f(0x244)]({'isFetch':!0x1,'class':_0x3e602f['yHFxq'],'msg':_0x1c7ff0[_0x23997f(0x18a)]}));}catch(_0x18e2d4){if(_0x3e602f[_0x23997f(0x1cb)](_0x3e602f[_0x23997f(0x202)],_0x3e602f[_0x23997f(0x202)]))_0xdfb6d7=window;else return!![];}const _0x1fdc99=_0xdfb6d7[_0x23997f(0x23e)]=_0xdfb6d7[_0x23997f(0x23e)]||{},_0x32bee2=[_0x3e602f[_0x23997f(0x1fa)],_0x3e602f['FzaBI'],_0x3e602f[_0x23997f(0x1c3)],_0x3e602f['otcfr'],_0x3e602f['CgEho'],_0x3e602f[_0x23997f(0x192)],_0x3e602f['cOArx']];for(let _0x5f3816=0x0;_0x3e602f[_0x23997f(0x147)](_0x5f3816,_0x32bee2[_0x23997f(0x20a)]);_0x5f3816++){if(_0x3e602f['iqomk'](_0x3e602f[_0x23997f(0x26c)],_0x3e602f['zrHOK']))_0x132d0e[_0x23997f(0x125)]();else{const _0x1d92a5=_0x374b7c['constructor'][_0x23997f(0x233)][_0x23997f(0x1e1)](_0x374b7c),_0x506308=_0x32bee2[_0x5f3816],_0x4d122c=_0x1fdc99[_0x506308]||_0x1d92a5;_0x1d92a5[_0x23997f(0x1b3)]=_0x374b7c[_0x23997f(0x1e1)](_0x374b7c),_0x1d92a5[_0x23997f(0x17f)]=_0x4d122c[_0x23997f(0x17f)][_0x23997f(0x1e1)](_0x4d122c),_0x1fdc99[_0x506308]=_0x1d92a5;}}});_0x4ae341();import _0xa033bb from'express';const b=_0xa033bb[_0x3dd3ed(0x186)]();import _0x52e304 from'path';import{MongoClient as _0x5c174c}from'mongodb';import _0x2256c from'../middleware/mainAuth.js';import*as _0x2c1261 from'../mymodule/myUsers.js';import*as _0x551bd6 from'../mymodule/myDateTime.js';function _0x2186(_0x134daa,_0x303a7b){const _0x2df604=_0x2a1a();return _0x2186=function(_0x4ae341,_0x374b7c){_0x4ae341=_0x4ae341-0x102;let _0x22ad23=_0x2df604[_0x4ae341];return _0x22ad23;},_0x2186(_0x134daa,_0x303a7b);}import*as _0x397f26 from'../mymodule/myModule.js';import*as _0x5159b3 from'../mymodule/myDocs.js';function _0x2a1a(){const _0xa8026b=['ALssB','chmUX','ไม่พบเอกสาร\x20\x22','MFejg','jpeg','pgfRz','RyAKV','เลขที่เอกสารไม่ถูกต้อง\x20หรือ\x20action\x20ไม่ถูกต้อง','kDdkL','uEjfn','IqEoK','ytVAb','qJyiV','LVmFs','AtBnt','Rbxwr','LOGO_BILL_FILENAME','VwiNJ','dmtDh','/status','shift','JcWYI','haOsH','PGDRO','tsgIB','newPage','zrHOK','PoRbR','\x22\x20เรียบร้อยแล้ว','UthKr','kMTPR','HfEfa','16628570NtgvRL','zrqMk','modifiedCount','oUYUz','call','get','apply','init','qwjBC','push','iGxfw','PAGE_INVOICE','yZsCM','sEEwJ','BPtMo','zpRov','QlIlZ','aZdLX','eTjnQ','includes','YzHJs','uGXOZ','dbColl_settings_Quotation','dGlzL','collection','dbUrl','AZjhg','RIxVM','QtLdW','mWIBc','xUKMl','aggregate','qlsTs','replace','zHUtD','close','OfXJz','Oieii','CROFo','action','YkMNc','RLeZk','LOGO_QUOTATION_FILENAME','error\x20===>\x20','BhYbC','KQRVz','OfyEE','MCphC','Bhhpk','iQPIu','lIoJB','renderView','sOtah','UcMSr','formatDate','xfXkq','OttoY','lvJwX','post','QjZil','log','hQyHY','warn','/bill','/invoice','mokat','application/pdf','3218010PeIENf','8ngxtZU','ebLPn','FznmO','proposerImageSign','QezIc','fzXcC','debu','โหลดข้อมูลทั้งหมดเรียบร้อยแล้ว','jRWZi','eUfcy','networkidle0','wBGau','DkqUZ','CWAWU','dbName','AqfbH','IlSAe','lvlvj','PAdBM','gyMHI','/changes','AYFHA','oTYcc','red','image/jpeg','ILqPK','getCollName_by_DocTitle','Lwkcd','writeHead','toArray','HeChO','dumuv','ynWGZ','eYjNW','uOrCw','YIiOf','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','zjSzM','gger','join','proposerId','counter','dbColl_receipt','Dhtke','QdTDf','FEnOq','tgdqf','DmdNd','JIXRA','dbColl_invoice','PAGE_BILL','table','{{sep}}[\x20ค้นหาเฉพาะของตนเอง\x20]','eiBiC','qXpzM','split','/search','toString','QeuCZ','info','green','tYHVA','constructor','string','Router','IZAuJ','OyrMD','DccKA','message','NBmIp','sCnJi','kRapU','gbmFk','UOZVk','finish','getSessionData','taaxb','error','NxGQd','unWTe','Zpwqv','KkKUI','ldUep','qEJhG','BeAsN','doc_changes.ejs','XnPkQ','FLUht','qLmSu','iuuZX','hJOyR','hIIrh','dLuXU','RGwrb','zuhBG','tSNac','stateObject','lEXAB','docId','KGcjx','UFBjv','getLogoBase64Src','getUser_sign','/user/signature','\x22\x20เอกสาร','BgKlW','LcrEz','WyRee','OocEZ','__proto__','DailF','nmHOg','UjPNy','launch','bAmxU','428571ZZZBEQ','hjJZo','QoFAK','SYmvJ','getCustomers_for_Modal','gHwhz','hcMvG','bvIXB','tyHBO','ZaNov','SeFDf','IScnk','zFAxz','connect','QDTov','yTdZm','ADuKa','qrjex','HjYgL','ไม่สามารถจบเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20ได้','WMhEh','YiPme','11tUCsck','quotation_print.ejs','/quotation','return\x20(function()\x20','wSZIE','gXzvd','usjQY','qAFWd','VFRAb','bill_print.ejs','FWuba','okTeD','wVTTD','gdpuM','aZfRa','oiTxn','124934WTSvKT','kEhaw','bind','NpgYb','oYArC','puppeteer','296154LuGDSr','easAO','userImageSignature_Src','floor','TQtza','Oengt','boljj','getSettingsByCollection','cancel','ftNzz','QZZMK','BpFgo','AhjFz','XCQHP','yellow','blNLr','getSessionData_sign','input','FfwDR','vKwDD','โหลดเอกสารเลขที่\x20\x22','NSXqv','isAuth','gfSJz','BIwgV','YiGsz','IppSO','WwyUE','PAGE_QUOTATION','FlIdV','dzbjI','ODLaA','dbColl_settings_Invoice','72FWmNkF','RghXi','kqElO','ecYBu','length','ไม่พบชื่อคอเล็กชั่น','yXcAQ','kjExU','PqJQS','AVWsp','WPzpw','ZHXlY','xsPIM','4828980wHYcDG','EEJHu','CTGcf','/load','YBTOs','{}.constructor(\x22return\x20this\x22)(\x20)','sXuOh','zbNLi','setContent','JmrUc','\x22ไม่สามารถเขียนข้อมูลลง\x20','zPqWi','uZUdC','mBYVb','LOGO_INVOICE_FILENAME','setViewport','mRWng','mZGCb','image','oPgJz','4894911TsPnwU','rSZpV','NOvaq','utoDJ','LOGO_RECEIPT_FILENAME','dbColl_settings_Bill','receipt_print.ejs','VNApV','btgcu','chain','dbColl_quotation','findOne','prototype','ไม่พบประวัติการเปลี่ยนแปลง','function\x20*\x5c(\x20*\x5c)','vpqaa','LZVEH','cioKr','WXpyZ','EpEYV','XKHOq','updateOne','ไม่พบเอกสารเลขที่\x20\x22','console','ไม่สามารถยกเลิกเอกสาร\x20ที่ไม่อยู่ในสถานะ\x201\x20หรือ\x202\x20ได้','test','voKUS','Dpilt','screenshot','stringify','BvfLe','while\x20(true)\x20{}','body','pdf','ruNQu','DktFS','send','/print','changesHistory','KebIJ','โหลดลายเซ็น\x20\x22','Ykcsb','พบ\x20\x22'];_0x2a1a=function(){return _0xa8026b;};return _0x2a1a();}const w=_0x3dd3ed(0x1d1),I=_0x3dd3ed(0x142),O='/receipt',A=_0x3dd3ed(0x141),H=[I+_0x3dd3ed(0x15a),w+'/changes',O+'/changes',A+_0x3dd3ed(0x15a)],j=[I+_0x3dd3ed(0x24c),w+_0x3dd3ed(0x24c),O+'/print',A+_0x3dd3ed(0x24c)],M=[I+'/status',w+'/status',O+_0x3dd3ed(0x265),A+'/status'],G=[I+_0x3dd3ed(0x17e),w+_0x3dd3ed(0x17e),O+'/search',A+_0x3dd3ed(0x17e)],q=[I+_0x3dd3ed(0x216),w+_0x3dd3ed(0x216),O+_0x3dd3ed(0x216),A+_0x3dd3ed(0x216)],x='/fetch/modal',V=_0x3dd3ed(0x1ad);b[_0x3dd3ed(0x13c)](G,_0x2256c[_0x3dd3ed(0x1fb)],async(_0x3bc090,_0x25eb3d)=>{const _0x5bd824=_0x3dd3ed,_0x5aee20={'QDTov':function(_0x2465af,_0x2066a1){return _0x2465af(_0x2066a1);},'WwyUE':_0x5bd824(0x15d),'PAdBM':function(_0x20ee12,_0x1490a2){return _0x20ee12!==_0x1490a2;},'HfEfa':_0x5bd824(0x1b4),'KkKUI':_0x5bd824(0x255),'KGcjx':function(_0x587c2d,_0x284e88){return _0x587c2d!==_0x284e88;},'Oengt':'kmZBi','YkMNc':_0x5bd824(0x17a),'dzbjI':_0x5bd824(0x182),'uEjfn':'YzIWP','dLuXU':_0x5bd824(0x210)};let {sip:_0x10d680,collName:_0x3e1074,statusNumberFilter:_0x3cfd02}=_0x3bc090[_0x5bd824(0x247)];_0x10d680=_0x10d680[_0x5bd824(0x123)](/[!@#$%^&*<>]/g,'')??null;let {userId:_0x338d77,userAuthority:_0x49d02b}=_0x2c1261[_0x5bd824(0x191)](_0x3bc090);_0x338d77=_0x338d77&&_0x5aee20[_0x5bd824(0x1c7)](Number,_0x338d77),_0x3cfd02&&(_0x3cfd02=_0x3cfd02?_0x3cfd02[_0x5bd824(0x17d)](',')['map'](_0x59271a=>Number(_0x59271a)):[0x1,0x2,0x3,0xa]);const _0x16f738=new _0x5c174c(global[_0x5bd824(0x11b)]);try{if(_0x5aee20[_0x5bd824(0x158)](_0x5aee20[_0x5bd824(0x271)],_0x5aee20[_0x5bd824(0x197)])){await _0x16f738[_0x5bd824(0x1c6)]();const _0x246773=_0x16f738['db'](global['dbName'])[_0x5bd824(0x11a)](_0x3e1074);if(_0x10d680){if(_0x5aee20[_0x5bd824(0x1a9)](_0x5aee20[_0x5bd824(0x1ea)],_0x5aee20['Oengt'])){if(_0x1a1478)return _0x121e2d;else oRJWmh[_0x5bd824(0x1c7)](_0x5a3c20,0x0);}else{var _0x3d0724=[{'$or':[{'docId':{'$regex':_0x10d680,'$options':'i'}},{'docDate':{'$regex':_0x10d680,'$options':'i'}},{'customerName':{'$regex':_0x10d680,'$options':'i'}}]}];['O','A'][_0x5bd824(0x115)](_0x49d02b)||_0x3d0724[_0x5bd824(0x10b)]({'proposerId':_0x338d77}),_0x3cfd02&&_0x3d0724[_0x5bd824(0x10b)]({'docStatusNumber':{'$in':_0x3cfd02}});var _0x10d376=await _0x246773[_0x5bd824(0x121)]([{'$match':{'$and':_0x3d0724}},{'$project':{'_id':0x0,'docId':0x1,'docStatusNumber':0x1,'customerName':0x1,'proposerId':0x1}}])[_0x5bd824(0x163)]();}}else var _0x10d376=[];let _0x2e5cc3=_0x5bd824(0x251)+_0x10d376['length']+_0x5bd824(0x1ae);return['O','A'][_0x5bd824(0x115)](_0x49d02b)||(_0x2e5cc3+=_0x5aee20[_0x5bd824(0x12a)]),_0x25eb3d[_0x5bd824(0x24b)](JSON[_0x5bd824(0x244)]({'searchFound':_0x10d376,'isSearch':!0x0,'class':_0x5aee20[_0x5bd824(0x203)],'msg':_0x2e5cc3}));}else _0x54e550=_0x1405fe;}catch(_0x1516c0){if(_0x5aee20[_0x5bd824(0x1a9)](_0x5aee20[_0x5bd824(0x25b)],_0x5aee20[_0x5bd824(0x25b)]))oRJWmh[_0x5bd824(0x1c7)](_0x100ed8,0x0);else return console[_0x5bd824(0x13e)](_0x1516c0),_0x25eb3d['send'](JSON[_0x5bd824(0x244)]({'isSearch':!0x1,'class':_0x5aee20[_0x5bd824(0x200)],'msg':_0x1516c0['message']}));}finally{if(_0x5aee20[_0x5bd824(0x1a9)](_0x5aee20['dLuXU'],_0x5aee20[_0x5bd824(0x1a2)]))return _0x517a83['log'](_0x2b6149),_0x2f6fcc[_0x5bd824(0x24b)](_0x36da2d[_0x5bd824(0x244)]({'isLoad':!0x1,'class':_0x5aee20['WwyUE'],'msg':_0x4df7fe[_0x5bd824(0x18a)]}));else _0x16f738[_0x5bd824(0x125)]();}}),b[_0x3dd3ed(0x13c)](q,_0x2256c[_0x3dd3ed(0x1fb)],async(_0x5bc83b,_0x1e1dcf)=>{const _0x3fce94=_0x3dd3ed,_0x197aeb={'DkqUZ':'red','YiPme':'ไม่พบชื่อคอเล็กชั่น','RLeZk':function(_0x3094df,_0x5a3613){return _0x3094df(_0x5a3613);},'QdTDf':function(_0x4d6ebe,_0x3672e3){return _0x4d6ebe===_0x3672e3;},'Dvncj':'FLVnW','WMhEh':_0x3fce94(0x182),'chmUX':function(_0x56a172,_0x54796b){return _0x56a172!==_0x54796b;},'dWkzB':_0x3fce94(0x189),'oUYUz':_0x3fce94(0x1be),'AqfbH':_0x3fce94(0x1bb),'YBTOs':_0x3fce94(0x1f7)};let {docId:_0x25f176,docTitle:_0x4081e4,collName:_0x366284}=_0x5bc83b[_0x3fce94(0x247)];if(_0x366284||(_0x366284=_0x5159b3[_0x3fce94(0x160)](_0x4081e4)),!_0x366284)return _0x1e1dcf[_0x3fce94(0x24b)](JSON[_0x3fce94(0x244)]({'isStatus':!0x1,'class':_0x197aeb[_0x3fce94(0x152)],'msg':_0x197aeb[_0x3fce94(0x1ce)]}));let {userId:_0x416846,userAuthority:_0x244d61}=_0x2c1261[_0x3fce94(0x191)](_0x5bc83b);_0x416846=_0x416846&&_0x197aeb[_0x3fce94(0x12b)](Number,_0x416846);const _0x4eabfc=new _0x5c174c(global[_0x3fce94(0x11b)]);try{if(_0x197aeb[_0x3fce94(0x172)](_0x197aeb['Dvncj'],_0x197aeb['Dvncj'])){await _0x4eabfc['connect']();const _0xbe7cdf=_0x4eabfc['db'](global[_0x3fce94(0x154)])[_0x3fce94(0x11a)](_0x366284);let _0x16b9fc={'docId':_0x25f176};['O','A'][_0x3fce94(0x115)](_0x244d61)||(_0x16b9fc[_0x3fce94(0x16e)]=_0x416846);var _0x397d1d=await _0xbe7cdf[_0x3fce94(0x232)](_0x16b9fc,{'projection':{'_id':0x0,'changesHistory':0x0}});return _0x397d1d?(_0x397d1d[_0x3fce94(0x1e7)]=_0x2c1261[_0x3fce94(0x1ac)](_0x397d1d['proposerId']),_0x1e1dcf['send'](JSON['stringify']({'doc':_0x397d1d,'isLoad':!0x0,'class':_0x197aeb[_0x3fce94(0x1cd)],'msg':_0x3fce94(0x1f9)+_0x25f176+'\x22\x20เรียบร้อยแล้ว'}))):_0x1e1dcf[_0x3fce94(0x24b)](JSON[_0x3fce94(0x244)]({'isLoad':!0x1,'class':_0x197aeb['DkqUZ'],'msg':_0x3fce94(0x23d)+_0x25f176+'\x22'}));}else return _0x10c2f8[_0x3fce94(0x13e)](_0x3da3bd),_0x408f16[_0x3fce94(0x24b)](_0x4b48c3['stringify']({'isLoad':!0x1,'class':_0x197aeb[_0x3fce94(0x152)],'msg':_0x3af8df['message']}));}catch(_0x186c22){if(_0x197aeb[_0x3fce94(0x253)](_0x197aeb['dWkzB'],_0x197aeb[_0x3fce94(0x105)]))return console['log'](_0x186c22),_0x1e1dcf[_0x3fce94(0x24b)](JSON[_0x3fce94(0x244)]({'isLoad':!0x1,'class':_0x197aeb[_0x3fce94(0x152)],'msg':_0x186c22[_0x3fce94(0x18a)]}));else _0x5607fb[_0x3fce94(0x125)]();}finally{_0x197aeb['QdTDf'](_0x197aeb[_0x3fce94(0x155)],_0x197aeb[_0x3fce94(0x217)])?_0x4b9463['close']():_0x4eabfc['close']();}}),b['get'](x,_0x2256c['isAuth'],async(_0x8d550c,_0x786f6b)=>{const _0xf0c848=_0x3dd3ed,_0x236fea={'ltkIk':function(_0x25334f,_0x268a86){return _0x25334f===_0x268a86;},'eiBiC':_0xf0c848(0x1db),'NpgYb':'uxQtO','zrqMk':_0xf0c848(0x182),'zFAxz':_0xf0c848(0x14d),'OfyEE':function(_0x95f0a5,_0x3e540e){return _0x95f0a5!==_0x3e540e;},'DktFS':_0xf0c848(0x17c),'AtBnt':'kygSP','aZfRa':_0xf0c848(0x15d)};try{if(_0x236fea['ltkIk'](_0x236fea[_0xf0c848(0x17b)],_0x236fea[_0xf0c848(0x1e2)])){_0x3129c3=!0x1;return;}else{const _0x597c23=await _0x5159b3[_0xf0c848(0x1bd)](),_0x206625=await _0x5159b3['getItems_for_Modal']();return _0x786f6b[_0xf0c848(0x24b)](JSON[_0xf0c848(0x244)]({'DATA_CUSTOMERS':_0x597c23,'DATA_ITEMS':_0x206625,'isFetch':!0x0,'class':_0x236fea[_0xf0c848(0x103)],'msg':_0x236fea[_0xf0c848(0x1c5)]}));}}catch(_0x2f1596){if(_0x236fea[_0xf0c848(0x130)](_0x236fea[_0xf0c848(0x24a)],_0x236fea[_0xf0c848(0x260)]))return console['log'](_0x2f1596),_0x786f6b[_0xf0c848(0x24b)](JSON[_0xf0c848(0x244)]({'isFetch':!0x1,'class':_0x236fea[_0xf0c848(0x1dd)],'msg':_0x2f1596[_0xf0c848(0x18a)]}));else{const _0x3b72e8=_0x359249?function(){const _0x57f9e4=_0xf0c848;if(_0x5d01a6){const _0xe13e5c=_0x49ff48[_0x57f9e4(0x108)](_0x3903ad,arguments);return _0x1c786f=null,_0xe13e5c;}}:function(){};return _0x107e14=![],_0x3b72e8;}}}),b[_0x3dd3ed(0x13c)](j,_0x2256c[_0x3dd3ed(0x1fb)],async(_0x4d6065,_0x14ea2d)=>{const _0x12d73b=_0x3dd3ed,_0x50ac3f={'TQtza':function(_0x160b5c,_0x27ea30){return _0x160b5c(_0x27ea30);},'qlsTs':_0x12d73b(0x246),'WzuRo':_0x12d73b(0x16f),'ALssB':_0x12d73b(0x235),'PqJQS':_0x12d73b(0x16a),'WyRee':function(_0x14428d,_0x416a9e){return _0x14428d(_0x416a9e);},'IScnk':'init','GKuet':function(_0x32488a,_0x164faf){return _0x32488a+_0x164faf;},'aZdLX':'chain','YIiOf':function(_0x44cc9e,_0x26ae9c){return _0x44cc9e+_0x26ae9c;},'DmdNd':_0x12d73b(0x1f6),'IqEoK':function(_0x5047f3){return _0x5047f3();},'edQve':function(_0x11c5e6,_0x2fea26){return _0x11c5e6!==_0x2fea26;},'myTNR':_0x12d73b(0x1dc),'arjrU':_0x12d73b(0x1a1),'sOtah':function(_0x2a5511,_0x438cd2){return _0x2a5511===_0x438cd2;},'QjZil':_0x12d73b(0x1d0),'IppSO':'invoice_print.ejs','mZGCb':function(_0x3ef7ce,_0x358969){return _0x3ef7ce===_0x358969;},'tgdqf':_0x12d73b(0x22d),'NBmIp':function(_0x5a7081,_0x39d55c){return _0x5a7081===_0x39d55c;},'nmHOg':_0x12d73b(0x1d8),'BpFgo':'red','BhYbC':function(_0x5e21a3,_0x39b3e4){return _0x5e21a3==_0x39b3e4;},'mokat':'print','tSNac':_0x12d73b(0x182),'bAmxU':_0x12d73b(0x225),'PoRbR':_0x12d73b(0x128),'oPgJz':_0x12d73b(0x1e4),'voKUS':_0x12d73b(0x150),'wSZIE':function(_0x1ca5f9,_0x4def33){return _0x1ca5f9/_0x4def33;},'Dyjzk':function(_0x357e74,_0x186efb){return _0x357e74*_0x186efb;},'oiTxn':_0x12d73b(0x256),'NOvaq':_0x12d73b(0x15e),'XCQHP':function(_0xf6d0fa,_0x35a262){return _0xf6d0fa==_0x35a262;},'FznmO':_0x12d73b(0x248),'dDasb':_0x12d73b(0x204),'xfXkq':_0x12d73b(0x188),'ftNzz':_0x12d73b(0x144),'lEXAB':'smZsg','BCeLa':_0x12d73b(0x1c9),'cxuhz':_0x12d73b(0x12d),'sXuOh':function(_0x297b64,_0x1dda00){return _0x297b64===_0x1dda00;},'JIXRA':_0x12d73b(0x13f)},{docId:_0xbdaf29,action:_0x2fb9a6,docTitle:_0x4b425b}=_0x4d6065['body'],_0x7d992a=new _0x5c174c(global[_0x12d73b(0x11b)]);try{if(_0x50ac3f['edQve'](_0x50ac3f['myTNR'],_0x50ac3f['arjrU'])){if(_0x50ac3f[_0x12d73b(0x136)](_0x4b425b,global[_0x12d73b(0x201)]))var _0x19ee74=global[_0x12d73b(0x231)],_0x5f453c=_0x50ac3f[_0x12d73b(0x13d)],_0x37c3db=_0x397f26[_0x12d73b(0x1ab)](global[_0x12d73b(0x12c)]),{dataSettings:_0x1419be}=await _0x397f26['getSettingsByCollection'](global[_0x12d73b(0x118)]);else{if(_0x50ac3f[_0x12d73b(0x136)](_0x4b425b,global[_0x12d73b(0x10d)]))var _0x19ee74=global[_0x12d73b(0x177)],_0x5f453c=_0x50ac3f[_0x12d73b(0x1ff)],_0x37c3db=_0x397f26[_0x12d73b(0x1ab)](global[_0x12d73b(0x221)]),{dataSettings:_0x1419be}=await _0x397f26['getSettingsByCollection'](global[_0x12d73b(0x205)]);else{if(_0x50ac3f[_0x12d73b(0x224)](_0x4b425b,global['PAGE_RECEIPT']))var _0x19ee74=global[_0x12d73b(0x170)],_0x5f453c=_0x50ac3f[_0x12d73b(0x174)],_0x37c3db=_0x397f26[_0x12d73b(0x1ab)](global[_0x12d73b(0x22b)]),{dataSettings:_0x1419be}=await _0x397f26[_0x12d73b(0x1ec)](global['dbColl_settings_Receipt']);else{if(_0x50ac3f[_0x12d73b(0x18b)](_0x4b425b,global[_0x12d73b(0x178)]))var _0x19ee74=global['dbColl_bill'],_0x5f453c=_0x50ac3f[_0x12d73b(0x1b5)],_0x37c3db=_0x397f26['getLogoBase64Src'](global[_0x12d73b(0x262)]),{dataSettings:_0x1419be}=await _0x397f26[_0x12d73b(0x1ec)](global[_0x12d73b(0x22c)]);}}}await _0x7d992a[_0x12d73b(0x1c6)]();var _0x580dd6=await _0x7d992a['db'](global[_0x12d73b(0x154)])['collection'](_0x19ee74)[_0x12d73b(0x232)]({'docId':_0xbdaf29});if(!_0x580dd6)return _0x14ea2d[_0x12d73b(0x24b)](JSON[_0x12d73b(0x244)]({'isLoad':!0x1,'class':_0x50ac3f[_0x12d73b(0x1f0)],'msg':_0x12d73b(0x23d)+_0xbdaf29+'\x22'}));_0x580dd6[_0x12d73b(0x16e)]&&(_0x580dd6[_0x12d73b(0x149)]=_0x2c1261[_0x12d73b(0x1ac)](_0x580dd6['proposerId']));const _0x1b7c48=_0x2c1261[_0x12d73b(0x191)](_0x4d6065),_0x55a81b=_0x5159b3['convert_DocPrint'](_0x580dd6),_0x37d6d1=_0x52e304[_0x12d73b(0x16d)](folderViews,_0x5f453c),_0x2de82b=await _0x397f26[_0x12d73b(0x135)](_0x37d6d1,_0x14ea2d,{'title':_0x4b425b,'time':_0x551bd6[_0x12d73b(0x138)](new Date()),..._0x1b7c48,'logoSrc_base64':_0x37c3db,..._0x1419be,'action':_0x2fb9a6,'doc':_0x55a81b});if(_0x50ac3f[_0x12d73b(0x12e)](_0x2fb9a6,_0x50ac3f[_0x12d73b(0x143)]))_0x14ea2d['send'](JSON[_0x12d73b(0x244)]({'isPrint':!0x0,'class':_0x50ac3f[_0x12d73b(0x1a5)],'htmlPage':_0x2de82b}));else{if(_0x50ac3f[_0x12d73b(0x12e)](_0x2fb9a6,_0x50ac3f[_0x12d73b(0x1b8)])){if(_0x50ac3f['NBmIp'](_0x50ac3f['PoRbR'],_0x50ac3f[_0x12d73b(0x26d)])){const _0x6f79b3=await(await import(_0x50ac3f[_0x12d73b(0x226)]))[_0x12d73b(0x1b7)](),_0x550e06=await _0x6f79b3['newPage']();await _0x550e06[_0x12d73b(0x21b)](_0x2de82b,{'waitUntil':_0x50ac3f[_0x12d73b(0x241)],'timeout':0x2710}),await new Promise(_0x4d2a16=>setTimeout(_0x4d2a16,0x3e8));const _0x2312c8=_0x50ac3f[_0x12d73b(0x1d3)](29.7,2.54),_0x44052d=Math[_0x12d73b(0x1e8)](_0x50ac3f['Dyjzk'](_0x2312c8,0x60));await _0x550e06[_0x12d73b(0x222)]({'width':0x320,'height':_0x44052d,'deviceScaleFactor':0x1});const _0x3bafe9=await _0x550e06[_0x12d73b(0x243)]({'type':_0x50ac3f[_0x12d73b(0x1de)],'fullPage':!0x0,'omitBackground':!0x1});await _0x6f79b3[_0x12d73b(0x125)]();const _0x55222e=_0x580dd6[_0x12d73b(0x1a8)][_0x12d73b(0x123)](/\//g,'');_0x14ea2d[_0x12d73b(0x162)](0xc8,{'Content-Type':_0x50ac3f[_0x12d73b(0x229)],'Content-Disposition':'attachment;\x20filename=quotation-'+_0x55222e+'.jpeg','Content-Length':_0x3bafe9['length']}),_0x14ea2d['end'](_0x3bafe9);}else{if(_0x2c4a04){const _0x54f275=_0x1c49f7[_0x12d73b(0x108)](_0x24f53f,arguments);return _0x35849a=null,_0x54f275;}}}else{if(_0x50ac3f[_0x12d73b(0x1f2)](_0x2fb9a6,_0x50ac3f[_0x12d73b(0x148)])){if(_0x50ac3f[_0x12d73b(0x224)](_0x50ac3f['dDasb'],_0x50ac3f[_0x12d73b(0x139)]))uDKfrj[_0x12d73b(0x1e9)](_0x2410f1,'0');else{const _0x48ad42=await(await import(_0x50ac3f[_0x12d73b(0x226)]))[_0x12d73b(0x1b7)](),_0x1ceff2=await _0x48ad42[_0x12d73b(0x26b)]();await _0x1ceff2[_0x12d73b(0x21b)](_0x2de82b,{'waitUntil':_0x50ac3f[_0x12d73b(0x241)],'timeout':0x2710}),await new Promise(_0x5e449b=>setTimeout(_0x5e449b,0x3e8));const _0x3f30d1=await _0x1ceff2['pdf']({'format':'A4','printBackground':!0x0});await _0x48ad42['close']();const _0x58a43f=_0x580dd6[_0x12d73b(0x1a8)][_0x12d73b(0x123)](/\//g,'');_0x14ea2d[_0x12d73b(0x162)](0xc8,{'Content-Type':_0x50ac3f[_0x12d73b(0x1ee)],'Content-Disposition':'attachment;\x20filename=quotation-'+_0x58a43f+'.pdf','Content-Length':_0x3f30d1[_0x12d73b(0x20a)]}),_0x14ea2d['end'](_0x3f30d1);}}}}}else{if(_0x140823){const _0x225c3b=_0x16dcda[_0x12d73b(0x108)](_0x50b5d0,arguments);return _0xb7f151=null,_0x225c3b;}}}catch(_0x3eb743){if(_0x50ac3f['edQve'](_0x50ac3f[_0x12d73b(0x1a7)],_0x50ac3f['BCeLa']))console[_0x12d73b(0x13e)](_0x50ac3f['cxuhz'],_0x3eb743),_0x14ea2d[_0x12d73b(0x24b)](JSON[_0x12d73b(0x244)]({'isPrint':!0x1,'class':_0x50ac3f[_0x12d73b(0x1f0)],'msg':_0x3eb743[_0x12d73b(0x18a)]}));else return function(_0x2eedf5){}[_0x12d73b(0x184)](uDKfrj[_0x12d73b(0x122)])[_0x12d73b(0x108)](uDKfrj['WzuRo']);}finally{if(_0x50ac3f[_0x12d73b(0x219)](_0x50ac3f[_0x12d73b(0x176)],_0x50ac3f[_0x12d73b(0x176)]))_0x7d992a[_0x12d73b(0x125)]();else{const _0x54f185=new _0x3277f1(uDKfrj[_0x12d73b(0x252)]),_0x1decbb=new _0x2590c2(uDKfrj[_0x12d73b(0x20e)],'i'),_0x19625b=uDKfrj[_0x12d73b(0x1b1)](_0x3ca380,uDKfrj[_0x12d73b(0x1c4)]);!_0x54f185[_0x12d73b(0x240)](uDKfrj['GKuet'](_0x19625b,uDKfrj[_0x12d73b(0x113)]))||!_0x1decbb[_0x12d73b(0x240)](uDKfrj[_0x12d73b(0x169)](_0x19625b,uDKfrj[_0x12d73b(0x175)]))?uDKfrj[_0x12d73b(0x1e9)](_0x19625b,'0'):uDKfrj[_0x12d73b(0x25c)](_0x50890f);}}}),b[_0x3dd3ed(0x13c)](H,_0x2256c[_0x3dd3ed(0x1fb)],async(_0x3774a6,_0xa63802)=>{const _0x135bfd=_0x3dd3ed,_0x26dcea={'IlSAe':function(_0x535852){return _0x535852();},'lIoJB':function(_0x51ad18,_0x2ae7d4){return _0x51ad18!==_0x2ae7d4;},'lvJwX':_0x135bfd(0x22a),'fxkrn':_0x135bfd(0x196),'jRWZi':_0x135bfd(0x15d),'OttoY':function(_0x1c6a2e,_0x11f9e5){return _0x1c6a2e<_0x11f9e5;},'VotJW':_0x135bfd(0x1f3),'kqElO':_0x135bfd(0x234),'ZaNov':_0x135bfd(0x19b),'EARnD':'green','AZjhg':'vhcvn','HPIts':_0x135bfd(0x12d),'eTjnQ':function(_0x130edd,_0x4fe20e){return _0x130edd===_0x4fe20e;},'QeuCZ':'fNwTh'},{docId:_0x18af21,docTitle:_0x310225}=_0x3774a6['body'],_0x289847=_0x5159b3[_0x135bfd(0x160)](_0x310225),_0x5937c1=new _0x5c174c(global[_0x135bfd(0x11b)]);try{if(_0x26dcea['lIoJB'](_0x26dcea[_0x135bfd(0x13b)],_0x26dcea['fxkrn'])){await _0x5937c1['connect']();var _0x76d0f2=await _0x5937c1['db'](global['dbName'])[_0x135bfd(0x11a)](_0x289847)['findOne']({'docId':_0x18af21});if(!_0x76d0f2)return _0xa63802[_0x135bfd(0x24b)](JSON['stringify']({'isPrint':!0x1,'class':_0x26dcea[_0x135bfd(0x14e)],'msg':_0x135bfd(0x23d)+_0x18af21+'\x22'}));const _0x2b0faa=_0x76d0f2[_0x135bfd(0x24d)]||[];if(_0x26dcea[_0x135bfd(0x13a)](_0x2b0faa[_0x135bfd(0x20a)],0x1))return _0xa63802['send'](JSON[_0x135bfd(0x244)]({'isPrint':!0x1,'class':_0x26dcea['VotJW'],'msg':_0x26dcea[_0x135bfd(0x208)]}));const _0x1461bb=_0x52e304[_0x135bfd(0x16d)](folderViews,_0x26dcea[_0x135bfd(0x1c2)]),_0xf57b0a=await _0x397f26[_0x135bfd(0x135)](_0x1461bb,_0xa63802,{'title':_0x76d0f2['docId'],'time':_0x551bd6['formatDate'](new Date()),'changesHistory':_0x2b0faa});_0xa63802[_0x135bfd(0x24b)](JSON['stringify']({'isPrint':!0x0,'class':_0x26dcea['EARnD'],'htmlPage':_0xf57b0a}));}else mSRolt[_0x135bfd(0x156)](_0x30f141);}catch(_0x55da1c){_0x26dcea[_0x135bfd(0x134)](_0x26dcea[_0x135bfd(0x11c)],_0x26dcea[_0x135bfd(0x11c)])?_0x17dbcd[_0x135bfd(0x125)]():(console[_0x135bfd(0x13e)](_0x26dcea['HPIts'],_0x55da1c),_0xa63802[_0x135bfd(0x24b)](JSON['stringify']({'isPrint':!0x1,'class':_0x26dcea[_0x135bfd(0x14e)],'msg':_0x55da1c[_0x135bfd(0x18a)]})));}finally{if(_0x26dcea[_0x135bfd(0x114)](_0x26dcea['QeuCZ'],_0x26dcea[_0x135bfd(0x180)]))_0x5937c1['close']();else{const _0x545b90=_0x453cf4[_0x135bfd(0x184)]['prototype'][_0x135bfd(0x1e1)](_0x363bbf),_0x597258=_0x164599[_0x280db6],_0x44f57f=_0x280199[_0x597258]||_0x545b90;_0x545b90[_0x135bfd(0x1b3)]=_0x3fa53a[_0x135bfd(0x1e1)](_0x331724),_0x545b90[_0x135bfd(0x17f)]=_0x44f57f[_0x135bfd(0x17f)]['bind'](_0x44f57f),_0x3b98f0[_0x597258]=_0x545b90;}}}),b[_0x3dd3ed(0x107)](V,_0x2256c[_0x3dd3ed(0x1fb)],async(_0x2c5ee4,_0x5ed357)=>{const _0x2517f7=_0x3dd3ed,_0x19432c={'KebIJ':_0x2517f7(0x12d),'ynWGZ':_0x2517f7(0x15d),'VggrH':_0x2517f7(0x235),'BIwgV':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','qLmSu':function(_0x1f8a9e,_0x219b35){return _0x1f8a9e(_0x219b35);},'yXcAQ':_0x2517f7(0x109),'UOZVk':function(_0x2d9683,_0x128ca8){return _0x2d9683+_0x128ca8;},'kjExU':_0x2517f7(0x230),'haGxN':function(_0x7e3f0c,_0xce8ada){return _0x7e3f0c+_0xce8ada;},'iQPIu':_0x2517f7(0x1f6),'Dpilt':function(_0x2e2dd7){return _0x2e2dd7();},'dmtDh':function(_0x33be7c,_0x53d261,_0x32f2f9){return _0x33be7c(_0x53d261,_0x32f2f9);},'okTeD':function(_0x219d6a,_0x2d7a36){return _0x219d6a+_0x2d7a36;},'bvIXB':_0x2517f7(0x1d2),'XnPkQ':_0x2517f7(0x218),'UcMSr':function(_0x169f55){return _0x169f55();},'rXpdc':function(_0xce606e,_0x5ca759){return _0xce606e===_0x5ca759;},'kEhaw':'ySBYI','sCnJi':_0x2517f7(0x182),'zuhBG':function(_0x233dc0,_0x13f2ee){return _0x233dc0!==_0x13f2ee;},'KQRVz':'rnxsA','UjPNy':function(_0x13216c,_0x7aa45d){return _0x13216c!==_0x7aa45d;},'BeAsN':_0x2517f7(0x183)};let {userId:_0xddbf10}=_0x2c1261[_0x2517f7(0x191)](_0x2c5ee4);_0xddbf10=_0xddbf10&&_0x19432c[_0x2517f7(0x19e)](Number,_0xddbf10);const _0x4dce26=new _0x5c174c(global[_0x2517f7(0x11b)]);try{if(_0x19432c['rXpdc'](_0x19432c[_0x2517f7(0x1e0)],_0x19432c['kEhaw'])){const _0x3dd329=_0x2c1261[_0x2517f7(0x1f5)](_0x2c5ee4);return _0x5ed357['send'](JSON[_0x2517f7(0x244)]({..._0x3dd329,'isLoad':!0x0,'class':_0x19432c[_0x2517f7(0x18c)],'msg':_0x2517f7(0x24f)+_0xddbf10+'\x22\x20เรียบร้อยแล้ว'}));}else _0x4efec4['log'](_0x19432c[_0x2517f7(0x24e)],_0x3e1c0e),_0x1cf927['send'](_0x555ddb[_0x2517f7(0x244)]({'isPrint':!0x1,'class':_0x19432c[_0x2517f7(0x166)],'msg':_0x14f0d1['message']}));}catch(_0x13f287){if(_0x19432c[_0x2517f7(0x1a4)](_0x19432c[_0x2517f7(0x12f)],_0x19432c[_0x2517f7(0x12f)]))OrMoIj[_0x2517f7(0x264)](_0x152a43,this,function(){const _0x48ea10=_0x2517f7,_0x192045=new _0x9e221e(OrMoIj['VggrH']),_0x140ceb=new _0x5a7027(OrMoIj[_0x48ea10(0x1fd)],'i'),_0x1242e2=OrMoIj['qLmSu'](_0x781a21,OrMoIj[_0x48ea10(0x20c)]);!_0x192045[_0x48ea10(0x240)](OrMoIj['UOZVk'](_0x1242e2,OrMoIj[_0x48ea10(0x20d)]))||!_0x140ceb[_0x48ea10(0x240)](OrMoIj['haGxN'](_0x1242e2,OrMoIj[_0x48ea10(0x133)]))?OrMoIj[_0x48ea10(0x19e)](_0x1242e2,'0'):OrMoIj[_0x48ea10(0x242)](_0x1e3407);})();else return console['log'](_0x13f287),_0x5ed357[_0x2517f7(0x24b)](JSON[_0x2517f7(0x244)]({'isLoad':!0x1,'class':_0x19432c[_0x2517f7(0x166)],'msg':_0x13f287[_0x2517f7(0x18a)]}));}finally{if(_0x19432c[_0x2517f7(0x1b6)](_0x19432c[_0x2517f7(0x19a)],_0x19432c[_0x2517f7(0x19a)])){const _0xccbf7b=OrMoIj[_0x2517f7(0x19e)](_0x43c0ab,OrMoIj[_0x2517f7(0x1da)](OrMoIj[_0x2517f7(0x18f)](OrMoIj[_0x2517f7(0x1c0)],OrMoIj[_0x2517f7(0x19c)]),');'));_0x15b645=OrMoIj[_0x2517f7(0x137)](_0xccbf7b);}else _0x4dce26['close']();}}),b[_0x3dd3ed(0x13c)](M,_0x2256c[_0x3dd3ed(0x1fb)],async(_0x5d703a,_0x4d198e)=>{const _0x3a35fa=_0x3dd3ed,_0x533f63={'qEJhG':_0x3a35fa(0x182),'RyAKV':function(_0x5bedda,_0x4682bd){return _0x5bedda===_0x4682bd;},'nulLK':_0x3a35fa(0x257),'CTGcf':_0x3a35fa(0x165),'ewoJb':function(_0x3571d6,_0x242614){return _0x3571d6===_0x242614;},'teBds':_0x3a35fa(0x21f),'usjQY':_0x3a35fa(0x238),'boljj':function(_0x3f80c5,_0xeba086,_0x2ed358){return _0x3f80c5(_0xeba086,_0x2ed358);},'TNAya':function(_0x5212de){return _0x5212de();},'WXpyZ':'red','VFRAb':function(_0x49f75c,_0x50508a){return _0x49f75c+_0x50508a;},'oYArC':_0x3a35fa(0x14c),'AVWsp':_0x3a35fa(0x16c),'zHUtD':_0x3a35fa(0x1a6),'LZVEH':function(_0x2168ad,_0x37c5a8){return _0x2168ad===_0x37c5a8;},'BvfLe':_0x3a35fa(0x1a0),'AYFHA':_0x3a35fa(0x132),'pOGQA':function(_0x486a9b,_0xe573f5){return _0x486a9b(_0xe573f5);},'SYmvJ':function(_0x9af2fe,_0x4e9b4){return _0x9af2fe(_0x4e9b4);},'zpRov':_0x3a35fa(0x190),'NxGQd':_0x3a35fa(0x1ed),'blNLr':_0x3a35fa(0x259),'kRapU':function(_0x40dd33,_0x5b9999){return _0x40dd33==_0x5b9999;},'haOsH':_0x3a35fa(0x23f),'UFBjv':function(_0x49de12,_0x577a44){return _0x49de12!==_0x577a44;},'FLUht':_0x3a35fa(0x1cc),'EpEYV':_0x3a35fa(0x20b),'VNApV':function(_0x28d616,_0x2c9794){return _0x28d616==_0x2c9794;},'hjJZo':function(_0x809982,_0x4e73af){return _0x809982>_0x4e73af;},'gfSJz':function(_0x480489,_0x1e2b28){return _0x480489<_0x1e2b28;},'YiGsz':_0x3a35fa(0x1f3),'RIxVM':'JGqwb','suymh':function(_0x5bab31,_0x3e7eca){return _0x5bab31===_0x3e7eca;},'BgKlW':_0x3a35fa(0x263),'rBpHZ':function(_0x534c21){return _0x534c21();}},_0x21bcef=[];let _0x500e56=!0x1;const _0x4a082a=async()=>{const _0x414504=_0x3a35fa;if(_0x533f63[_0x414504(0x258)](_0x533f63['nulLK'],_0x533f63[_0x414504(0x215)]))return _0x23306e;else{if(_0x533f63[_0x414504(0x258)](_0x21bcef[_0x414504(0x20a)],0x0)){if(_0x533f63['ewoJb'](_0x533f63['teBds'],_0x533f63[_0x414504(0x1d5)])){const _0x355206=_0x3322ad[_0x414504(0x1f5)](_0x1752da);return _0x1e376a[_0x414504(0x24b)](_0x4e60dd[_0x414504(0x244)]({..._0x355206,'isLoad':!0x0,'class':_0x533f63[_0x414504(0x199)],'msg':_0x414504(0x24f)+_0x56034d+_0x414504(0x26e)}));}else{_0x500e56=!0x1;return;}}_0x500e56=!0x0;const {req:_0x3e7255,res:_0x406e19}=_0x21bcef[_0x414504(0x266)]();await _0x533f63[_0x414504(0x1eb)](_0xacd50c,_0x3e7255,_0x406e19),_0x533f63['TNAya'](_0x4a082a);}},_0xacd50c=async(_0x370123,_0x3f0216)=>{const _0x2bea94=_0x3a35fa,_0x2357d4={'xsPIM':_0x533f63['WXpyZ']};if(_0x533f63[_0x2bea94(0x237)](_0x533f63[_0x2bea94(0x245)],_0x533f63['BvfLe'])){const _0x4c38f5=new _0x5c174c(global[_0x2bea94(0x11b)]);try{if(_0x533f63[_0x2bea94(0x237)](_0x533f63[_0x2bea94(0x15b)],_0x533f63[_0x2bea94(0x15b)])){let {userId:_0x331ddc}=_0x2c1261[_0x2bea94(0x191)](_0x370123);_0x331ddc=_0x331ddc&&_0x533f63['pOGQA'](Number,_0x331ddc);let {docStatusNumber:_0xa4db51,docId:_0x1cae8e,action:_0x3127ba,text:_0x337bff,docTitle:_0x5c7438}=_0x370123[_0x2bea94(0x247)];if(_0xa4db51=_0xa4db51&&_0x533f63[_0x2bea94(0x1bc)](Number,_0xa4db51),!_0x1cae8e||![_0x533f63['zpRov'],_0x533f63['NxGQd']][_0x2bea94(0x115)](_0x3127ba))return _0x3f0216[_0x2bea94(0x24b)](JSON[_0x2bea94(0x244)]({'isStatus':!0x1,'class':_0x533f63[_0x2bea94(0x239)],'msg':_0x533f63[_0x2bea94(0x1f4)]}));if(_0x533f63[_0x2bea94(0x18d)](_0x3127ba,_0x533f63[_0x2bea94(0x194)])&&['1','2'][_0x2bea94(0x115)](_0xa4db51))return _0x3f0216[_0x2bea94(0x24b)](JSON[_0x2bea94(0x244)]({'isStatus':!0x1,'class':_0x533f63[_0x2bea94(0x239)],'msg':_0x533f63[_0x2bea94(0x268)]}));if(_0x533f63[_0x2bea94(0x18d)](_0x3127ba,_0x533f63[_0x2bea94(0x111)])&&_0x533f63['UFBjv'](_0xa4db51,0x1))return _0x3f0216[_0x2bea94(0x24b)](JSON[_0x2bea94(0x244)]({'isStatus':!0x1,'class':_0x533f63['WXpyZ'],'msg':_0x533f63[_0x2bea94(0x19d)]}));const _0xb7d3f=_0x5159b3[_0x2bea94(0x160)](_0x5c7438);if(!_0xb7d3f)return _0x3f0216['send'](JSON['stringify']({'isStatus':!0x1,'class':_0x533f63['WXpyZ'],'msg':_0x533f63[_0x2bea94(0x23a)]}));const _0x4bb755=_0x4c38f5['db'](global[_0x2bea94(0x154)])[_0x2bea94(0x11a)](_0xb7d3f);if(!await _0x4bb755['findOne']({'docId':_0x1cae8e,'proposerId':_0x331ddc}))return _0x3f0216[_0x2bea94(0x24b)](JSON[_0x2bea94(0x244)]({'isStatus':!0x1,'class':_0x533f63[_0x2bea94(0x239)],'msg':_0x2bea94(0x254)+_0x1cae8e+'\x22'}));const _0xc99f9b=_0x533f63[_0x2bea94(0x22e)](_0x3127ba,_0x533f63[_0x2bea94(0x111)])?0x2:0xa,_0x49ffb1=await _0x4bb755[_0x2bea94(0x23c)]({'docId':_0x1cae8e,'proposerId':_0x331ddc},{'$set':{'docStatusNumber':_0xc99f9b}});if(_0x533f63[_0x2bea94(0x1ba)](_0x49ffb1[_0x2bea94(0x104)],0x0))return _0x3f0216[_0x2bea94(0x24b)](JSON[_0x2bea94(0x244)]({'isStatus':!0x0,'docId':_0x1cae8e,'docStatusNumber':_0xc99f9b,'class':_0x533f63['qEJhG'],'msg':_0x337bff+'\x20\x22'+_0x1cae8e+_0x2bea94(0x26e)}));if(_0x49ffb1['acknowledged']&&_0x533f63[_0x2bea94(0x1fc)](_0x49ffb1['modifiedCount'],0x1))return _0x3f0216[_0x2bea94(0x24b)](JSON['stringify']({'isStatus':!0x1,'docId':_0x1cae8e,'docStatusNumber':_0xa4db51,'class':_0x533f63[_0x2bea94(0x1fe)],'msg':_0x2bea94(0x21d)+_0x1cae8e+'\x22'}));}else return _0xb6f3c8[_0x2bea94(0x13e)](_0x3dfdb1),_0x2d090d[_0x2bea94(0x24b)](_0x4a983d[_0x2bea94(0x244)]({'isSearch':!0x1,'class':_0x533f63[_0x2bea94(0x239)],'msg':_0x4cc044[_0x2bea94(0x18a)]}));}catch(_0x468f91){_0x533f63[_0x2bea94(0x1aa)](_0x533f63[_0x2bea94(0x11d)],_0x533f63[_0x2bea94(0x11d)])?function(){return![];}[_0x2bea94(0x184)](ZFbwfT[_0x2bea94(0x1d7)](ZFbwfT[_0x2bea94(0x1e3)],ZFbwfT[_0x2bea94(0x20f)]))[_0x2bea94(0x108)](ZFbwfT[_0x2bea94(0x124)]):(console[_0x2bea94(0x13e)](_0x468f91),_0x3f0216[_0x2bea94(0x24b)](JSON[_0x2bea94(0x244)]({'isStatus':!0x1,'class':_0x533f63[_0x2bea94(0x239)],'msg':_0x468f91[_0x2bea94(0x18a)]})));}finally{_0x533f63['suymh'](_0x533f63['BgKlW'],_0x533f63[_0x2bea94(0x1af)])?_0x4c38f5['close']():(_0x5a08e1[_0x2bea94(0x13e)](_0x5bf96c),_0x1eafe7[_0x2bea94(0x24b)](_0x1990ba[_0x2bea94(0x244)]({'isStatus':!0x1,'class':_0x2357d4[_0x2bea94(0x212)],'msg':_0x42fe62[_0x2bea94(0x18a)]})));}}else return![];};_0x21bcef['push']({'req':_0x5d703a,'res':_0x4d198e}),_0x500e56||_0x533f63['rBpHZ'](_0x4a082a);});export default b;function _0x14943d(_0x48833f){const _0x195102=_0x3dd3ed,_0x193784={'gXzvd':function(_0x2fce8d,_0x135a5f){return _0x2fce8d===_0x135a5f;},'hldem':_0x195102(0x185),'wBGau':_0x195102(0x246),'UFnCH':_0x195102(0x16f),'LcrEz':function(_0x5313d0,_0x4aebf5){return _0x5313d0!==_0x4aebf5;},'ecYBu':function(_0x30891b,_0x24cc72){return _0x30891b+_0x24cc72;},'Lwkcd':function(_0x43532c,_0x4a7396){return _0x43532c/_0x4a7396;},'mBYVb':_0x195102(0x20a),'PGDRO':function(_0x1626af,_0x22dd1d){return _0x1626af===_0x22dd1d;},'EEJHu':function(_0x326c91,_0x53cbb8){return _0x326c91%_0x53cbb8;},'QezIc':function(_0x887e72,_0x2581c4){return _0x887e72+_0x2581c4;},'ldUep':'debu','BPtMo':_0x195102(0x16c),'oMBRh':'action','rcpvj':'stateObject','qwjBC':function(_0xeeae5e,_0xe4b6a5){return _0xeeae5e(_0xe4b6a5);},'FEnOq':function(_0x51200d,_0x5e77f3){return _0x51200d(_0x5e77f3);}};function _0x23fffd(_0x367864){const _0xaa2116=_0x195102;if(_0x193784[_0xaa2116(0x1d4)](typeof _0x367864,_0x193784['hldem']))return function(_0x52fd24){}[_0xaa2116(0x184)](_0x193784[_0xaa2116(0x151)])['apply'](_0x193784['UFnCH']);else _0x193784[_0xaa2116(0x1b0)](_0x193784[_0xaa2116(0x209)]('',_0x193784[_0xaa2116(0x161)](_0x367864,_0x367864))[_0x193784[_0xaa2116(0x220)]],0x1)||_0x193784[_0xaa2116(0x269)](_0x193784[_0xaa2116(0x214)](_0x367864,0x14),0x0)?function(){return!![];}['constructor'](_0x193784['QezIc'](_0x193784[_0xaa2116(0x198)],_0x193784[_0xaa2116(0x110)]))[_0xaa2116(0x106)](_0x193784['oMBRh']):function(){return![];}[_0xaa2116(0x184)](_0x193784[_0xaa2116(0x14a)](_0x193784['ldUep'],_0x193784['BPtMo']))[_0xaa2116(0x108)](_0x193784['rcpvj']);_0x193784[_0xaa2116(0x10a)](_0x23fffd,++_0x367864);}try{if(_0x48833f)return _0x23fffd;else _0x193784[_0x195102(0x173)](_0x23fffd,0x0);}catch(_0x232b60){}}