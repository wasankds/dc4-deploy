const _0x3383e3=_0x24b0;(function(_0x5a3069,_0x5a5714){const _0x3de965=_0x24b0,_0x58d36e=_0x5a3069();while(!![]){try{const _0x4f8f50=-parseInt(_0x3de965(0x154))/0x1+-parseInt(_0x3de965(0xfa))/0x2+-parseInt(_0x3de965(0x17c))/0x3+-parseInt(_0x3de965(0x1a6))/0x4*(parseInt(_0x3de965(0xe7))/0x5)+parseInt(_0x3de965(0x1ac))/0x6*(-parseInt(_0x3de965(0x102))/0x7)+-parseInt(_0x3de965(0x189))/0x8*(-parseInt(_0x3de965(0x1a3))/0x9)+parseInt(_0x3de965(0x139))/0xa*(parseInt(_0x3de965(0x107))/0xb);if(_0x4f8f50===_0x5a5714)break;else _0x58d36e['push'](_0x58d36e['shift']());}catch(_0x251ae9){_0x58d36e['push'](_0x58d36e['shift']());}}}(_0x319a,0x8f369));const _0x42642a=(function(){const _0x502924=_0x24b0,_0x1c9c18={'lGufa':function(_0x2e46d3,_0x415afc){return _0x2e46d3(_0x415afc);},'upbkZ':function(_0x4ad10e,_0x2ba772){return _0x4ad10e+_0x2ba772;},'BHyzh':_0x502924(0x148),'dKqLQ':_0x502924(0xe0),'FlLvG':function(_0x2ece6e,_0x5bd4a3){return _0x2ece6e!==_0x5bd4a3;},'lzlGx':_0x502924(0x105),'mhneH':function(_0xf0226f,_0x1a2a36){return _0xf0226f===_0x1a2a36;},'kDzsW':_0x502924(0xc7),'OCiJk':function(_0x1f7701,_0x43bc24){return _0x1f7701===_0x43bc24;},'JjaSr':_0x502924(0x1b4),'EeSVI':_0x502924(0x1c1)};let _0x1605c4=!![];return function(_0xfd460f,_0x12e8a5){const _0xe0f580=_0x502924;if(_0x1c9c18[_0xe0f580(0x11d)](_0x1c9c18[_0xe0f580(0x120)],_0x1c9c18['EeSVI'])){let _0xade6e7;try{_0xade6e7=_0x1c9c18[_0xe0f580(0x132)](_0x4e231f,_0x1c9c18[_0xe0f580(0x124)](_0x1c9c18[_0xe0f580(0x124)](_0x1c9c18[_0xe0f580(0x127)],_0x1c9c18[_0xe0f580(0x18d)]),');'))();}catch(_0x20bd20){_0xade6e7=_0xda2738;}return _0xade6e7;}else{const _0x3fde7c=_0x1605c4?function(){const _0x4ce41c=_0xe0f580;if(_0x1c9c18[_0x4ce41c(0x160)](_0x1c9c18[_0x4ce41c(0x1a2)],_0x1c9c18[_0x4ce41c(0x1a2)])){const _0x158398=_0x81f175[_0x4ce41c(0xb5)](_0x21e30b,arguments);return _0x23a48d=null,_0x158398;}else{if(_0x12e8a5){if(_0x1c9c18[_0x4ce41c(0xdc)](_0x1c9c18['kDzsW'],_0x1c9c18[_0x4ce41c(0x140)])){const _0x242b83=_0x12e8a5[_0x4ce41c(0xb5)](_0xfd460f,arguments);return _0x12e8a5=null,_0x242b83;}else return![];}}}:function(){};return _0x1605c4=![],_0x3fde7c;}};}());(function(){const _0x45b34b=_0x24b0,_0x5b5549={'NiPQl':function(_0x577a37,_0x52de58){return _0x577a37(_0x52de58);},'idpAN':function(_0x9e9414,_0x5e1a99){return _0x9e9414!==_0x5e1a99;},'gxtTT':_0x45b34b(0x166),'rzDoE':_0x45b34b(0x180),'EKRSy':_0x45b34b(0x134),'kZVvS':'\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','MHyOn':function(_0x25b843,_0x359a18){return _0x25b843(_0x359a18);},'ZnZrP':'init','YgzsA':function(_0x4c6b8c,_0x55b8a7){return _0x4c6b8c+_0x55b8a7;},'XXltO':_0x45b34b(0xf8),'LaMbU':'input','DUUMB':'FoZXo','TnQRD':_0x45b34b(0x169),'OxUXz':function(_0x36537c,_0x68c788){return _0x36537c!==_0x68c788;},'nosAI':'zuSMF','htIur':_0x45b34b(0x16a),'nUymD':function(_0x49eedd){return _0x49eedd();},'kjnsl':function(_0x42f598,_0x96e832,_0x2e6837){return _0x42f598(_0x96e832,_0x2e6837);}};_0x5b5549['kjnsl'](_0x42642a,this,function(){const _0x591128=_0x45b34b;if(_0x5b5549['idpAN'](_0x5b5549[_0x591128(0x123)],_0x5b5549['rzDoE'])){const _0x22f7aa=new RegExp(_0x5b5549[_0x591128(0x168)]),_0x5a9957=new RegExp(_0x5b5549[_0x591128(0x1ae)],'i'),_0x31dc00=_0x5b5549['MHyOn'](_0x4a1c49,_0x5b5549[_0x591128(0x19b)]);if(!_0x22f7aa[_0x591128(0x15b)](_0x5b5549[_0x591128(0x1bd)](_0x31dc00,_0x5b5549[_0x591128(0xff)]))||!_0x5a9957[_0x591128(0x15b)](_0x5b5549['YgzsA'](_0x31dc00,_0x5b5549[_0x591128(0x1b8)]))){if(_0x5b5549['idpAN'](_0x5b5549[_0x591128(0xec)],_0x5b5549[_0x591128(0x12d)]))_0x5b5549['NiPQl'](_0x31dc00,'0');else{_0x1d5999=!0x1;return;}}else{if(_0x5b5549[_0x591128(0xc0)](_0x5b5549[_0x591128(0x198)],_0x5b5549['htIur']))_0x5b5549['nUymD'](_0x4a1c49);else{const _0x4cead0=_0x157e6c[_0x591128(0xb5)](_0x49d514,arguments);return _0x524182=null,_0x4cead0;}}}else _0x5b5549['NiPQl'](_0x4ed61a,'0');})();}());const _0xaadb6b=(function(){const _0x2b5aa0=_0x24b0,_0x3877a5={'POQSc':function(_0x5d9ae5){return _0x5d9ae5();},'fDihK':function(_0x326f74,_0x33fe95){return _0x326f74(_0x33fe95);},'EDFYS':function(_0x172dad,_0x413adc){return _0x172dad+_0x413adc;},'IfCMP':_0x2b5aa0(0x148),'dfGXH':'{}.constructor(\x22return\x20this\x22)(\x20)','xnRfF':function(_0x18d4ee,_0x28aed3){return _0x18d4ee===_0x28aed3;},'tVKTJ':'HPhby','LTTyD':function(_0x39c29a,_0x3c77bd){return _0x39c29a!==_0x3c77bd;},'FrdXb':_0x2b5aa0(0xc8),'EPdxA':_0x2b5aa0(0x1b9),'ycWfO':function(_0x5981eb,_0x29c64b){return _0x5981eb===_0x29c64b;},'akNxq':_0x2b5aa0(0x14d)};let _0x4519ee=!![];return function(_0x3cacc8,_0x1c0118){const _0x51b922=_0x2b5aa0,_0x34f0be={'AAEDD':function(_0x1b1898,_0x2ace8d){return _0x3877a5['fDihK'](_0x1b1898,_0x2ace8d);},'NTHuS':function(_0x535bbc,_0x3b4c49){const _0x4e09da=_0x24b0;return _0x3877a5[_0x4e09da(0x173)](_0x535bbc,_0x3b4c49);},'soyKc':_0x3877a5[_0x51b922(0x12f)],'ZpUlm':_0x3877a5['dfGXH'],'nbKiX':function(_0x3c0748,_0xe16455){return _0x3877a5['xnRfF'](_0x3c0748,_0xe16455);},'VVERT':_0x3877a5['tVKTJ'],'cfuQu':function(_0x2023cd,_0x4f4ad8){const _0x5a3dfc=_0x51b922;return _0x3877a5[_0x5a3dfc(0x116)](_0x2023cd,_0x4f4ad8);},'SBHsP':_0x3877a5[_0x51b922(0x1a4)],'Kouny':_0x3877a5[_0x51b922(0x15e)]};if(_0x3877a5[_0x51b922(0x19a)](_0x3877a5[_0x51b922(0x19c)],_0x3877a5['akNxq'])){const _0x392e9c=_0x4519ee?function(){const _0x37a1d6=_0x51b922,_0x4f9d36={'BbeFy':function(_0x536b7b,_0x34ee01){const _0x1cf4e9=_0x24b0;return _0x34f0be[_0x1cf4e9(0xf2)](_0x536b7b,_0x34ee01);},'HLnqz':function(_0x42f369,_0x380481){const _0x10ee56=_0x24b0;return _0x34f0be[_0x10ee56(0x1b2)](_0x42f369,_0x380481);},'NczmV':_0x34f0be[_0x37a1d6(0xc3)],'ApWJr':_0x34f0be[_0x37a1d6(0x109)]};if(_0x34f0be[_0x37a1d6(0x1bc)](_0x34f0be[_0x37a1d6(0x1c4)],_0x34f0be[_0x37a1d6(0x1c4)])){if(_0x1c0118){if(_0x34f0be[_0x37a1d6(0x135)](_0x34f0be[_0x37a1d6(0xda)],_0x34f0be[_0x37a1d6(0xe1)])){const _0x1c843d=_0x1c0118[_0x37a1d6(0xb5)](_0x3cacc8,arguments);return _0x1c0118=null,_0x1c843d;}else _0x44a084=_0x4f9d36['BbeFy'](_0x195e12,_0x4f9d36[_0x37a1d6(0x172)](_0x4f9d36[_0x37a1d6(0x172)](_0x4f9d36[_0x37a1d6(0x10a)],_0x4f9d36[_0x37a1d6(0x10e)]),');'))();}}else{const _0x1015b4=_0x232d7b?function(){const _0x481151=_0x37a1d6;if(_0x398242){const _0x3b8264=_0x1cd19b[_0x481151(0xb5)](_0x5e7f8,arguments);return _0x177e33=null,_0x3b8264;}}:function(){};return _0x225036=![],_0x1015b4;}}:function(){};return _0x4519ee=![],_0x392e9c;}else _0x3877a5[_0x51b922(0x16d)](_0x255660);};}()),_0x481574=_0xaadb6b(this,function(){const _0x14906e=_0x24b0,_0x266c69={'TQARa':function(_0x10cc2c,_0xd6c109){return _0x10cc2c+_0xd6c109;},'RKnED':'debu','ivQXX':'gger','FfLgz':_0x14906e(0xcc),'sTTlT':function(_0x51d865,_0x79ce49){return _0x51d865!==_0x79ce49;},'Cupkz':_0x14906e(0xde),'umYab':function(_0x1397c9,_0x1c131d){return _0x1397c9===_0x1c131d;},'iwJUk':_0x14906e(0x112),'XgZVS':function(_0xf4709f,_0x51ceb1){return _0xf4709f(_0x51ceb1);},'tHerP':function(_0x1f47e6,_0x5cea2b){return _0x1f47e6+_0x5cea2b;},'bzuHj':_0x14906e(0x148),'UmIrj':_0x14906e(0xe0),'TwMrw':function(_0xfb2161,_0x34193e){return _0xfb2161===_0x34193e;},'IZtWr':_0x14906e(0xf1),'biguX':_0x14906e(0x131),'NnJzd':function(_0x545c76){return _0x545c76();},'Wdrkq':_0x14906e(0x165),'WxoCD':_0x14906e(0x142),'IGjBk':'info','ITymH':_0x14906e(0xe3),'OvepM':'exception','zrKkW':_0x14906e(0xf0),'lQlzj':_0x14906e(0x1cf),'pWkXS':function(_0x4e57e9,_0x412036){return _0x4e57e9<_0x412036;},'bbXKe':function(_0x216c5e,_0x506bd1){return _0x216c5e!==_0x506bd1;},'DYknU':_0x14906e(0x1d6)},_0x375cf5=function(){const _0x273939=_0x14906e,_0x44cf66={'VDpMH':function(_0x2b54d1,_0xeeec38){const _0x4ed5b9=_0x24b0;return _0x266c69[_0x4ed5b9(0xf9)](_0x2b54d1,_0xeeec38);},'rCfaT':_0x266c69[_0x273939(0x11a)],'TnhEH':_0x266c69['ivQXX'],'OTGPE':_0x266c69[_0x273939(0xd2)]};if(_0x266c69[_0x273939(0x143)](_0x266c69[_0x273939(0xce)],_0x266c69[_0x273939(0xce)])){if(_0x5cfc3b){const _0x5297a0=_0x397bc6[_0x273939(0xb5)](_0x5e1b7a,arguments);return _0x59a1a8=null,_0x5297a0;}}else{let _0x187a23;try{_0x266c69[_0x273939(0xd1)](_0x266c69['iwJUk'],_0x266c69[_0x273939(0x15d)])?_0x187a23=_0x266c69[_0x273939(0xdb)](Function,_0x266c69['TQARa'](_0x266c69['tHerP'](_0x266c69[_0x273939(0x1ba)],_0x266c69[_0x273939(0x1be)]),');'))():function(){return![];}[_0x273939(0xf5)](_0x44cf66[_0x273939(0x118)](_0x44cf66[_0x273939(0x10d)],_0x44cf66['TnhEH']))[_0x273939(0xb5)](_0x44cf66[_0x273939(0x13a)]);}catch(_0x1edc53){_0x266c69[_0x273939(0x199)](_0x266c69[_0x273939(0x12c)],_0x266c69['biguX'])?_0x2d8f6f=_0x44e838:_0x187a23=window;}return _0x187a23;}},_0x10bf98=_0x266c69['NnJzd'](_0x375cf5),_0x363bba=_0x10bf98['console']=_0x10bf98[_0x14906e(0x106)]||{},_0x38e914=[_0x266c69[_0x14906e(0x1c3)],_0x266c69['WxoCD'],_0x266c69['IGjBk'],_0x266c69['ITymH'],_0x266c69[_0x14906e(0x1cb)],_0x266c69[_0x14906e(0x1d0)],_0x266c69[_0x14906e(0x146)]];for(let _0x366200=0x0;_0x266c69[_0x14906e(0xef)](_0x366200,_0x38e914[_0x14906e(0x104)]);_0x366200++){if(_0x266c69['bbXKe'](_0x266c69[_0x14906e(0x149)],_0x266c69[_0x14906e(0x149)])){const _0x58bf11=_0x55b08a?function(){const _0x45a2f8=_0x14906e;if(_0x1b6b5d){const _0x5c2044=_0x8d7e51[_0x45a2f8(0xb5)](_0x1f474b,arguments);return _0x576cba=null,_0x5c2044;}}:function(){};return _0x1c5bb7=![],_0x58bf11;}else{const _0x9dc670=_0xaadb6b[_0x14906e(0xf5)]['prototype'][_0x14906e(0xe4)](_0xaadb6b),_0xbd8c39=_0x38e914[_0x366200],_0x273d2e=_0x363bba[_0xbd8c39]||_0x9dc670;_0x9dc670['__proto__']=_0xaadb6b['bind'](_0xaadb6b),_0x9dc670[_0x14906e(0x183)]=_0x273d2e[_0x14906e(0x183)][_0x14906e(0xe4)](_0x273d2e),_0x363bba[_0xbd8c39]=_0x9dc670;}}});_0x481574();import _0x3c3ada from'express';const p=_0x3c3ada[_0x3383e3(0x16b)]();function _0x24b0(_0x32c35a,_0x51e343){const _0x19c5de=_0x319a();return _0x24b0=function(_0x481574,_0xaadb6b){_0x481574=_0x481574-0xb5;let _0x3d06a0=_0x19c5de[_0x481574];return _0x3d06a0;},_0x24b0(_0x32c35a,_0x51e343);}import{MongoClient as _0x24122b}from'mongodb';function _0x319a(){const _0x51ce64=['BHyzh','tSgpm','send','kfxvM','updateOne','IZtWr','TnQRD','wnhnu','IfCMP','jBbkj','BwSho','lGufa','dbColl_quotation','function\x20*\x5c(\x20*\x5c)','cfuQu','sZAEX','uyBIb','green','690KZUkHR','OTGPE','cUkrg','OLgdb','kmUfk','vDjWx','\x20เรียบร้อยแล้ว','kDzsW','MrLoJ','warn','sTTlT','IQPPo','nBavG','lQlzj','wjEER','return\x20(function()\x20','DYknU','rJZxi','\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)','viCuz','gtuaE','wBNNW','yXeDe','yellow','izbOF','qULpM','ItCtB','446646ApRMSM','/myDocs.js','DOgef','VWxah','nqpHq','GCRJY','UaKvy','test','vnHeT','iwJUk','EPdxA','dbUrl','FlLvG','สถานะเอกสารผิดผลาด','slice','limit','AwgAs','log','fFwSO','qDeIM','EKRSy','nSHZS','aNNuT','Router','call','POQSc','YBpFM','yIvJC','PUzbM','renderView','HLnqz','EDFYS','FwHCD','uPeFa','SzRbi','sxKcb','bJVFu','nMWij','stringify','ZlLoD','1617855EGaITE','__proto__','ZhjHl','AvEVN','ovFud','GZaly','init','toString','DOC_STATUS','Dszyl','huHPc','getLogoBase64Src','shift','320lZUKzq','-00001','LCApl','PTNTf','dKqLQ','sidat','qBHSp','/myModule.js','padStart','acknowledged','../','jTGQM','jHTHv','XrRWj','sort','nosAI','TwMrw','ycWfO','ZnZrP','akNxq','dbColl_settings_Quotation','uZGFr','nBZJa','string','tCPnG','lzlGx','228888liHoFe','FrdXb','urxxi','8MZhRmS','close','message','aDCnp','modifiedCount','/print','774ROLIEE','wLeFm','kZVvS','lrFSl','gger','zhwBT','NTHuS','yivlK','ezMTB','find','toArray','action','LaMbU','kRLDR','bzuHj','\x22\x20ไม่มีการเปลี่ยนแปลงข้อมูล','nbKiX','YgzsA','UmIrj','sendFile','GceTR','iaUEV','ZoAIh','Wdrkq','VVERT','oBXZH','jgTre','hZoyP','tuQQQ','quotation.ejs','HxqPD','OvepM','GXjxA','grbEv','FrYqC','trace','zrKkW','counter','VigHw','zTtGC','ZgOfD','WEmiD','Yrfpo','apply','/save','wUIuR','/changes','WAyUa','while\x20(true)\x20{}','bGFoL','isAuth','flash','get','snGen','OxUXz','msg','Gwnjd','soyKc','BVKLn','/quotation','debu','HJCYw','qdqvY','input','zEbyK','\x20ได้','stateObject','prototype','Cupkz','KToMy','อัปเดท\x20','umYab','FfLgz','getSettingsByCollection','usqEa','getChangeHistory','collection','docId','HLcXP','chHeG','SBHsP','XgZVS','mhneH','Wmyil','BIKpW','oWapo','{}.constructor(\x22return\x20this\x22)(\x20)','Kouny','body','error','bind','red','feDwS','2750435EtAgGR','RBWmX','userFlash','convert_DocDataType','split','DUUMB','selectProposerSignature','mSaOr','pWkXS','table','DsaIV','AAEDD','PZEWl','xYOgd','constructor','kGBKO','XXSeb','chain','TQARa','2121512IjgOJR','getSettings','kunOI','/status','\x20เรียบร้อยแล้ว{{sep}}[บันทึกการแก้ไข]','XXltO','YZDCE','HaeLC','3647lSuxOy','zWxaF','length','dnuov','console','443729UiDZGa','QqVqh','ZpUlm','NczmV','/search','pCXSs','rCfaT','ApWJr','/load','findOne','TtjLi','MITWM','replace','สร้างเอกสารใหม่\x20','/myUsers.js','LTTyD','hBxpz','VDpMH','DmWLw','RKnED','qFvUq','TgXtK','OCiJk','TfiBk','QJEsp','JjaSr','docStatusNumber','status','gxtTT','upbkZ','getMonth','LOGO_QUOTATION_FILENAME'];_0x319a=function(){return _0x51ce64;};return _0x319a();}const y=await import(_0x3383e3(0x193)+mymoduleFolder+_0x3383e3(0x190)),N=await import('../'+mymoduleFolder+'/myDateTime.js'),O=await import(_0x3383e3(0x193)+mymoduleFolder+_0x3383e3(0x115)),_=await import(_0x3383e3(0x193)+mymoduleFolder+_0x3383e3(0x155));import _0x9aa2f4 from'../middleware/mainAuth.js';const i=_0x3383e3(0xc5),h=i+_0x3383e3(0xb6),E=i+_0x3383e3(0xb8),P=i+_0x3383e3(0x10f),H=i+_0x3383e3(0x10b),v=i+_0x3383e3(0xfd),J=i+_0x3383e3(0x1ab),M=i[_0x3383e3(0x113)](/\//g,'_'),L='/fetch/modal',T=global[_0x3383e3(0x133)],U=global[_0x3383e3(0x19d)],j=_0x3383e3(0x1c9),G=global[_0x3383e3(0x126)];p[_0x3383e3(0xbe)](i,_0x9aa2f4['isAuth'],async(_0x3af104,_0x218fe4)=>{const _0x109fd8=_0x3383e3,_0x5f2cb2={'viCuz':function(_0xf3f3e,_0x55c690){return _0xf3f3e===_0x55c690;},'qDeIM':_0x109fd8(0xb9),'DOgef':_0x109fd8(0x136),'JDsBd':_0x109fd8(0xc1),'oYBwE':_0x109fd8(0xe9),'BVKLn':function(_0x188e19,_0x57112f){return _0x188e19!==_0x57112f;},'JCLuI':_0x109fd8(0x108)},{docId:_0x2ae0e1,sip:_0x59e946}=_0x3af104['query'];try{if(_0x5f2cb2[_0x109fd8(0x14c)](_0x5f2cb2[_0x109fd8(0x167)],_0x5f2cb2[_0x109fd8(0x156)])){if(_0x2b0356){const _0x15e288=_0x5dd4dc['apply'](_0xd5691a,arguments);return _0x1fce34=null,_0x15e288;}}else{const {dataSettings:_0x5824a0}=await y[_0x109fd8(0xfb)](),{dataSettings:_0x5314bd}=await y[_0x109fd8(0xd3)](U),_0x28c8c7=O['getSessionData_sign'](_0x3af104),_0x188356=await y[_0x109fd8(0x171)](j,_0x218fe4,{'title':PAGE_QUOTATION,'time':N['getDate'](),'msg':_0x3af104[_0x109fd8(0xbd)](_0x5f2cb2['JDsBd']),'userFlash':_0x3af104['flash'](_0x5f2cb2['oYBwE']),'user':_0x28c8c7,'logoSrc_base64':y[_0x109fd8(0x187)](G),'dataSettings':_0x5824a0,..._0x5314bd,'PATH_MAIN':i,'PATH_SEARCH':H,'PATH_FETCH':L,'PATH_SAVE':h,'PATH_LOAD':P,'PATH_STATUS':v,'PATH_PRINT':J,'PATH_CHANGES':E,'PREFIX':M,'DOC_STATUS':JSON[_0x109fd8(0x17a)](global[_0x109fd8(0x184)]),'COLL_NAME':T,'DOC_ID':_0x2ae0e1,'SIP':_0x59e946});_0x218fe4[_0x109fd8(0x129)](_0x188356);}}catch(_0x27a77b){if(_0x5f2cb2[_0x109fd8(0xc4)](_0x5f2cb2['JCLuI'],_0x5f2cb2['JCLuI'])){const _0x144281=_0x2779d1[_0x109fd8(0xf5)][_0x109fd8(0xcd)][_0x109fd8(0xe4)](_0x144048),_0x48f6b9=_0x3df940[_0xb06c5f],_0x356077=_0x4127d2[_0x48f6b9]||_0x144281;_0x144281[_0x109fd8(0x17d)]=_0x57e81f[_0x109fd8(0xe4)](_0x4029c7),_0x144281[_0x109fd8(0x183)]=_0x356077[_0x109fd8(0x183)][_0x109fd8(0xe4)](_0x356077),_0x35cfec[_0x48f6b9]=_0x144281;}else console[_0x109fd8(0x165)](_0x27a77b),_0x218fe4[_0x109fd8(0x122)](0x194)[_0x109fd8(0x1bf)](file404);}}),p['post'](h,_0x9aa2f4[_0x3383e3(0xbc)],async(_0x301935,_0x23c681)=>{const _0x12ff80=_0x3383e3,_0x1aa3a3={'zTtGC':function(_0x1c5622,_0x57ada5){return _0x1c5622(_0x57ada5);},'FwHCD':function(_0x33f695,_0x491b40){return _0x33f695===_0x491b40;},'AMuzk':'SYnIT','OLgdb':_0x12ff80(0x100),'LCApl':function(_0x54e383,_0x43a3a6){return _0x54e383!==_0x43a3a6;},'hZoyP':'pzsHK','usqEa':function(_0x196f7d,_0x2a2b11,_0x2c5915){return _0x196f7d(_0x2a2b11,_0x2c5915);},'zWxaF':function(_0x18d5e1){return _0x18d5e1();},'GceTR':function(_0x4c1906,_0x170e57){return _0x4c1906(_0x170e57);},'DmWLw':function(_0x5e5499,_0x272074){return _0x5e5499(_0x272074);},'aDCnp':function(_0x140e23,_0x4e4827){return _0x140e23+_0x4e4827;},'chHeG':_0x12ff80(0x134),'urxxi':_0x12ff80(0x14b),'HaeLC':_0x12ff80(0x182),'Wmyil':function(_0x12f84f,_0x235092){return _0x12f84f+_0x235092;},'TfiBk':_0x12ff80(0xf8),'XXSeb':_0x12ff80(0xc9),'GXjxA':function(_0x12082a,_0x642b7c){return _0x12082a(_0x642b7c);},'kGBKO':function(_0xd936d7){return _0xd936d7();},'QJEsp':_0x12ff80(0xba),'wjEER':_0x12ff80(0x1d1),'nBZJa':function(_0x3fb0b8,_0x3bcd2a){return _0x3fb0b8+_0x3bcd2a;},'ItCtB':'debu','MrLoJ':_0x12ff80(0x1b0),'wsweg':_0x12ff80(0x1b7),'qULpM':_0x12ff80(0xe5),'HxqPD':function(_0xf495ce,_0x5a425c){return _0xf495ce+_0x5a425c;},'YBpFM':function(_0x3380d2){return _0x3380d2();},'hBxpz':_0x12ff80(0x1b3),'UaKvy':_0x12ff80(0xca),'TtjLi':_0x12ff80(0x164),'wUIuR':function(_0x3f5341,_0xa4aeae){return _0x3f5341&&_0xa4aeae;},'vnHeT':'XGvfP','kdoLC':_0x12ff80(0x128),'mSaOr':function(_0x69cc58,_0x176e12){return _0x69cc58+_0x176e12;},'PZEWl':function(_0x258886,_0x15b287){return _0x258886>_0x15b287;},'oBXZH':function(_0x4abe11,_0x157e37){return _0x4abe11!==_0x157e37;},'nqpHq':_0x12ff80(0x178),'yIvJC':_0x12ff80(0xf4),'gHxer':function(_0x536edb,_0x1cca75){return _0x536edb(_0x1cca75);},'ZoAIh':function(_0x4c89a0,_0xec004b){return _0x4c89a0(_0xec004b);},'TgXtK':_0x12ff80(0x138),'FRewi':function(_0x378ae7,_0x4a8c19){return _0x378ae7==_0x4a8c19;},'AvEVN':function(_0x5d61d2,_0x17d881){return _0x5d61d2===_0x17d881;},'cUkrg':_0x12ff80(0xe8),'zhwBT':'DxBHz','GZaly':'ไม่พบเอกสารที่ต้องการอัปเดท\x20หรือ{{sep}}ไม่สามารถบันทึกเอกสารที่ตนเองไม่ได้สร้าง','Gwnjd':function(_0x5d9517,_0x5580b6){return _0x5d9517>_0x5580b6;},'qXtTj':function(_0xdf4982,_0x59e4d8){return _0xdf4982!==_0x59e4d8;},'Dszyl':_0x12ff80(0x157),'PTNTf':_0x12ff80(0x14f),'ADKGl':function(_0x3fa6cb,_0x87e8ca){return _0x3fa6cb>_0x87e8ca;},'WEmiD':'WArxm','jTGQM':function(_0x137ef6,_0x11675b){return _0x137ef6<_0x11675b;},'VigHw':_0x12ff80(0x150),'qBHSp':function(_0x40dd34,_0x40b7dd){return _0x40dd34==_0x40b7dd;},'jHTHv':_0x12ff80(0x137),'tCPnG':function(_0x2f2c68,_0x4f4acd){return _0x2f2c68>_0x4f4acd;},'jgTre':function(_0x151348,_0x158c2a){return _0x151348<_0x158c2a;},'oZOmP':_0x12ff80(0x161),'qFvUq':_0x12ff80(0x196),'feDwS':'MuWZy','izbOF':function(_0x67e21d,_0x12e2c6){return _0x67e21d!==_0x12e2c6;},'wnhnu':_0x12ff80(0x177),'bGFoL':_0x12ff80(0x19e),'nMWij':function(_0xbbdab2){return _0xbbdab2();}},_0x247583=[];let _0x16e997=!0x1;const _0x39514a=async()=>{const _0x4542b9=_0x12ff80;if(_0x1aa3a3[_0x4542b9(0x174)](_0x1aa3a3['AMuzk'],_0x1aa3a3[_0x4542b9(0x13c)])){if(_0x20b9bc)return _0xb3bbb7;else HXGymV[_0x4542b9(0x1d3)](_0x2a2cca,0x0);}else{if(_0x1aa3a3['FwHCD'](_0x247583[_0x4542b9(0x104)],0x0)){if(_0x1aa3a3[_0x4542b9(0x18b)](_0x1aa3a3['hZoyP'],_0x1aa3a3[_0x4542b9(0x1c7)]))return!![];else{_0x16e997=!0x1;return;}}_0x16e997=!0x0;const {req:_0x2cd6de,res:_0x1ed9a1}=_0x247583[_0x4542b9(0x188)]();await _0x1aa3a3[_0x4542b9(0xd4)](_0x4f5868,_0x2cd6de,_0x1ed9a1),_0x1aa3a3[_0x4542b9(0x103)](_0x39514a);}},_0x4f5868=async(_0x1c2ac2,_0x41bba6)=>{const _0x47d25a=_0x12ff80,_0x389141={'gjQjw':_0x1aa3a3[_0x47d25a(0x11f)],'kunOI':_0x1aa3a3[_0x47d25a(0x147)],'wBNNW':function(_0x3ca6f5,_0x18eb13){const _0x5a7b02=_0x47d25a;return _0x1aa3a3[_0x5a7b02(0x19f)](_0x3ca6f5,_0x18eb13);},'BXYBF':_0x1aa3a3[_0x47d25a(0x153)],'rwfWk':_0x1aa3a3[_0x47d25a(0x141)],'uPeFa':_0x1aa3a3['wsweg'],'nBavG':_0x1aa3a3[_0x47d25a(0x152)],'kmUfk':_0x1aa3a3[_0x47d25a(0xd9)],'ZgOfD':_0x1aa3a3[_0x47d25a(0x1a5)],'GCRJY':function(_0x3a7aa3,_0x16aa2a){const _0x194eb6=_0x47d25a;return _0x1aa3a3[_0x194eb6(0x1c0)](_0x3a7aa3,_0x16aa2a);},'dRjDE':_0x1aa3a3[_0x47d25a(0x101)],'sidat':_0x1aa3a3['TfiBk'],'kfxvM':function(_0x44ad26,_0x12dca8){const _0x3cbf50=_0x47d25a;return _0x1aa3a3[_0x3cbf50(0x1ca)](_0x44ad26,_0x12dca8);},'wLeFm':_0x1aa3a3[_0x47d25a(0xf7)],'IQPPo':function(_0x571b86,_0x9ba9c9){return _0x1aa3a3['DmWLw'](_0x571b86,_0x9ba9c9);},'KToMy':function(_0x45b641){const _0x5869ca=_0x47d25a;return _0x1aa3a3[_0x5869ca(0x16e)](_0x45b641);},'SzRbi':function(_0x217903,_0x439048,_0x5aaa84){const _0x14d155=_0x47d25a;return _0x1aa3a3[_0x14d155(0xd4)](_0x217903,_0x439048,_0x5aaa84);}};if(_0x1aa3a3['FwHCD'](_0x1aa3a3[_0x47d25a(0x117)],_0x1aa3a3[_0x47d25a(0x15a)])){const _0xa24937=_0x5728f1[0x0][_0x47d25a(0xd7)]['split']('/'),_0x143931=_0x1aa3a3[_0x47d25a(0x1c0)](_0x5d5982,_0xa24937[0x1][_0x47d25a(0xeb)]('-')[0x1]);_0x458d15=_0x5a33c7+'/'+_0x5ad7be+'-'+_0x1aa3a3[_0x47d25a(0x119)](_0x1d03fb,_0x1aa3a3[_0x47d25a(0x1a9)](_0x143931,0x1))['padStart'](0x5,'0');}else{const _0x10cec2=new _0x24122b(global[_0x47d25a(0x15f)]);try{if(_0x1aa3a3[_0x47d25a(0x174)](_0x1aa3a3[_0x47d25a(0x111)],_0x1aa3a3['TtjLi'])){let {userId:_0x58775a,userFullname:_0x2643c6}=O['getSessionData'](_0x1c2ac2);_0x58775a=_0x58775a&&_0x1aa3a3['DmWLw'](Number,_0x58775a),_0x1c2ac2['body']=_[_0x47d25a(0xea)](_0x1c2ac2[_0x47d25a(0xe2)]);const _0x18505c=_0x10cec2['db'](global['dbName'])[_0x47d25a(0xd6)](T),_0x19745d=_0x1c2ac2[_0x47d25a(0xe2)][_0x47d25a(0x121)],_0x347db8=_0x1c2ac2['body']['docId']?_0x1c2ac2[_0x47d25a(0xe2)][_0x47d25a(0xd7)]:null;if(_0x1aa3a3[_0x47d25a(0xb7)](!_0x19745d,!_0x347db8)){if(_0x1aa3a3[_0x47d25a(0x174)](_0x1aa3a3[_0x47d25a(0x15c)],_0x1aa3a3['kdoLC']))_0x41c06c[_0x47d25a(0x165)](_0x5e011c),_0x2423d3[_0x47d25a(0x122)](0x194)[_0x47d25a(0x1bf)](_0x25601a);else{const _0x64f539=await _0x18505c[_0x47d25a(0x1b5)]()[_0x47d25a(0x197)]({'_id':-0x1})[_0x47d25a(0x163)](0x1)[_0x47d25a(0x1b6)](),_0x293b59=new Date()['getFullYear']()[_0x47d25a(0x183)]()[_0x47d25a(0x162)](-0x2),_0x2bbe05=_0x1aa3a3[_0x47d25a(0xee)](new Date()[_0x47d25a(0x125)](),0x1)[_0x47d25a(0x183)]()[_0x47d25a(0x191)](0x2,'0');let _0x2793d9=_0x293b59+'/'+_0x2bbe05+_0x47d25a(0x18a);if(_0x1aa3a3[_0x47d25a(0xf3)](_0x64f539[_0x47d25a(0x104)],0x0)){if(_0x1aa3a3['oBXZH'](_0x1aa3a3[_0x47d25a(0x158)],_0x1aa3a3[_0x47d25a(0x16f)])){const _0x5096e5=_0x64f539[0x0][_0x47d25a(0xd7)][_0x47d25a(0xeb)]('/'),_0x2211f8=_0x1aa3a3['gHxer'](Number,_0x5096e5[0x1][_0x47d25a(0xeb)]('-')[0x1]);_0x2793d9=_0x293b59+'/'+_0x2bbe05+'-'+_0x1aa3a3[_0x47d25a(0x1c2)](String,_0x1aa3a3['Wmyil'](_0x2211f8,0x1))[_0x47d25a(0x191)](0x5,'0');}else return function(_0x459073){}[_0x47d25a(0xf5)](FVeCCT['gjQjw'])['apply'](FVeCCT[_0x47d25a(0xfc)]);}_0x1c2ac2['body'][_0x47d25a(0xd7)]=_0x2793d9,_0x1c2ac2[_0x47d25a(0xe2)]['docStatusNumber']=0x1,await _0x18505c['insertOne'](_0x1c2ac2[_0x47d25a(0xe2)]),_0x41bba6['send'](JSON[_0x47d25a(0x17a)]({'isSave':!0x0,'class':_0x1aa3a3['TgXtK'],'msg':_0x47d25a(0x114)+_0x2793d9+_0x47d25a(0x13f),'docId':_0x2793d9,'docStatusNumber':0x1}));}}else{if(_0x1aa3a3['FRewi'](_0x19745d,0x1)&&_0x347db8){if(_0x1aa3a3[_0x47d25a(0x17f)](_0x1aa3a3[_0x47d25a(0x13b)],_0x1aa3a3[_0x47d25a(0x1b1)]))(function(){return!![];}['constructor'](FVeCCT[_0x47d25a(0x14e)](FVeCCT['BXYBF'],FVeCCT['rwfWk']))[_0x47d25a(0x16c)](FVeCCT[_0x47d25a(0x175)]));else{const _0x3e7222=await _0x18505c[_0x47d25a(0x110)]({'docId':_0x347db8,'proposerId':_0x58775a});if(!_0x3e7222)return _0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'isSave':!0x1,'class':_0x1aa3a3['qULpM'],'msg':_0x1aa3a3[_0x47d25a(0x181)]}));const _0x2d7edc=await _0x18505c[_0x47d25a(0x12b)]({'docId':_0x347db8,'proposerId':_0x58775a},{'$set':_0x1c2ac2[_0x47d25a(0xe2)]});if(_0x1aa3a3[_0x47d25a(0xc2)](_0x2d7edc[_0x47d25a(0x1aa)],0x0)){if(_0x1aa3a3['qXtTj'](_0x1aa3a3[_0x47d25a(0x185)],_0x1aa3a3[_0x47d25a(0x18c)])){const _0x3f57bc=_[_0x47d25a(0xd5)](_0x3e7222,_0x1c2ac2[_0x47d25a(0xe2)]);if(_0x1aa3a3['ADKGl'](_0x3f57bc[_0x47d25a(0x104)],0x0)){if(_0x1aa3a3['LCApl'](_0x1aa3a3[_0x47d25a(0x1d5)],_0x1aa3a3['WEmiD']))_0x5daa70[_0x47d25a(0x1a7)]();else{const _0xdcbc13={'dateTime':N['getDateTime'](),'userId':_0x58775a,'userFullname':_0x2643c6,'changes':_0x3f57bc};return await _0x18505c['updateOne']({'docId':_0x347db8},{'$push':{'changesHistory':{'$each':[_0xdcbc13],'$position':0x0}}}),_0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'docId':_0x347db8,'docStatusNumber':_0x19745d,'isSave':!0x0,'class':_0x1aa3a3['TgXtK'],'msg':_0x47d25a(0xd0)+_0x347db8+_0x47d25a(0xfe)}));}}else return _0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'docId':_0x347db8,'docStatusNumber':_0x19745d,'isSave':!0x0,'class':_0x1aa3a3[_0x47d25a(0x11c)],'msg':'อัปเดท\x20'+_0x347db8+_0x47d25a(0x13f)}));}else return _0x17b0cc;}else{if(_0x2d7edc[_0x47d25a(0x192)]&&_0x1aa3a3[_0x47d25a(0x194)](_0x2d7edc[_0x47d25a(0x1aa)],0x1))return _0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'docId':_0x347db8,'docStatusNumber':_0x19745d,'isSave':!0x1,'class':_0x1aa3a3['VigHw'],'msg':'\x22'+_0x347db8+_0x47d25a(0x1bb)}));}}}else{if(_0x1aa3a3[_0x47d25a(0x18f)](_0x19745d,0x2)&&_0x347db8){if(_0x1aa3a3['LCApl'](_0x1aa3a3[_0x47d25a(0x195)],_0x1aa3a3[_0x47d25a(0x195)])){const _0x44f5d0=new _0x1cf30b(HXGymV['chHeG']),_0xda375=new _0x260f04(HXGymV[_0x47d25a(0x1a5)],'i'),_0x27eb07=HXGymV['DmWLw'](_0x2b36a5,HXGymV[_0x47d25a(0x101)]);!_0x44f5d0[_0x47d25a(0x15b)](HXGymV[_0x47d25a(0xdd)](_0x27eb07,HXGymV[_0x47d25a(0x11e)]))||!_0xda375['test'](HXGymV['Wmyil'](_0x27eb07,HXGymV['XXSeb']))?HXGymV[_0x47d25a(0x1cc)](_0x27eb07,'0'):HXGymV[_0x47d25a(0xf6)](_0x22aa49);}else{if(!await _0x18505c[_0x47d25a(0x110)]({'docId':_0x347db8,'proposerId':_0x58775a}))return _0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'isSave':!0x1,'class':_0x1aa3a3['qULpM'],'msg':_0x1aa3a3[_0x47d25a(0x181)]}));const _0xb399d9=await _0x18505c[_0x47d25a(0x12b)]({'docId':_0x347db8,'proposerId':_0x58775a},{'$set':{'selectProposerSignature':_0x1c2ac2[_0x47d25a(0xe2)][_0x47d25a(0xed)]}});if(_0x1aa3a3[_0x47d25a(0x1a1)](_0xb399d9[_0x47d25a(0x1aa)],0x0))return _0x41bba6['send'](JSON[_0x47d25a(0x17a)]({'docId':_0x347db8,'docStatusNumber':_0x19745d,'isSave':!0x0,'class':_0x1aa3a3[_0x47d25a(0x11c)],'msg':_0x47d25a(0xd0)+_0x347db8+_0x47d25a(0x13f)}));if(_0xb399d9['acknowledged']&&_0x1aa3a3[_0x47d25a(0x1c6)](_0xb399d9[_0x47d25a(0x1aa)],0x1))return _0x41bba6[_0x47d25a(0x129)](JSON['stringify']({'docId':_0x347db8,'docStatusNumber':_0x19745d,'isSave':!0x1,'class':_0x1aa3a3[_0x47d25a(0x1d2)],'msg':'\x22'+_0x347db8+_0x47d25a(0x1bb)}));}}else return _0x1aa3a3[_0x47d25a(0x18f)](_0x19745d,0xa)?_0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'isSave':!0x1,'class':_0x1aa3a3[_0x47d25a(0x152)],'msg':'ไม่สามารถบันทึกเอกสาร\x20สถานะ\x20'+_0x19745d+_0x47d25a(0xcb)})):_0x41bba6['send'](JSON[_0x47d25a(0x17a)]({'isSave':!0x1,'class':_0x1aa3a3['qULpM'],'msg':_0x1aa3a3['oZOmP']}));}}}else _0x18bdc9[_0x47d25a(0x165)](_0x4a275b),_0x2e5ed0[_0x47d25a(0x129)](_0x5ce51c[_0x47d25a(0x17a)]({'isSave':!0x1,'class':_0x389141[_0x47d25a(0x145)],'msg':_0x1f6ad8['message']}));}catch(_0xeeb6b7){_0x1aa3a3[_0x47d25a(0x1c5)](_0x1aa3a3[_0x47d25a(0x11b)],_0x1aa3a3[_0x47d25a(0xe6)])?(console['log'](_0xeeb6b7),_0x41bba6[_0x47d25a(0x129)](JSON[_0x47d25a(0x17a)]({'isSave':!0x1,'class':_0x1aa3a3[_0x47d25a(0x152)],'msg':_0xeeb6b7[_0x47d25a(0x1a8)]}))):FVeCCT[_0x47d25a(0x176)](_0x4e0fb0,this,function(){const _0x135b0f=_0x47d25a,_0x251e14=new _0xc61ee5(FVeCCT[_0x135b0f(0x13d)]),_0x3e7d2e=new _0x21f0f3(FVeCCT[_0x135b0f(0x1d4)],'i'),_0xa96ef9=FVeCCT[_0x135b0f(0x159)](_0x5ca38d,FVeCCT['dRjDE']);!_0x251e14[_0x135b0f(0x15b)](FVeCCT[_0x135b0f(0x14e)](_0xa96ef9,FVeCCT[_0x135b0f(0x18e)]))||!_0x3e7d2e[_0x135b0f(0x15b)](FVeCCT[_0x135b0f(0x12a)](_0xa96ef9,FVeCCT[_0x135b0f(0x1ad)]))?FVeCCT[_0x135b0f(0x144)](_0xa96ef9,'0'):FVeCCT[_0x135b0f(0xcf)](_0x2b785c);})();}finally{_0x1aa3a3[_0x47d25a(0x151)](_0x1aa3a3[_0x47d25a(0x12e)],_0x1aa3a3[_0x47d25a(0xbb)])?_0x10cec2['close']():FVeCCT[_0x47d25a(0x144)](_0x11efc9,0x0);}}};_0x247583['push']({'req':_0x301935,'res':_0x23c681}),_0x16e997||_0x1aa3a3[_0x12ff80(0x179)](_0x39514a);});export default p;function _0x4a1c49(_0x54b3b2){const _0x4da99d=_0x3383e3,_0x368058={'jBbkj':function(_0xfc160b,_0x2a8f79){return _0xfc160b===_0x2a8f79;},'HLcXP':_0x4da99d(0x1a0),'huHPc':_0x4da99d(0xba),'PUzbM':_0x4da99d(0x1d1),'grbEv':function(_0x43f291,_0x34d665){return _0x43f291!==_0x34d665;},'ZlLoD':function(_0x4ea024,_0x31328c){return _0x4ea024+_0x31328c;},'pCXSs':function(_0x28e0ad,_0x461a34){return _0x28e0ad/_0x461a34;},'PmJhR':_0x4da99d(0x104),'ZhjHl':function(_0x4e3586,_0x590e4f){return _0x4e3586===_0x590e4f;},'lrFSl':function(_0x4dca7a,_0x3e7973){return _0x4dca7a%_0x3e7973;},'FrYqC':function(_0x28b5d6,_0x1e1ad7){return _0x28b5d6+_0x1e1ad7;},'oWapo':_0x4da99d(0xc6),'vDjWx':_0x4da99d(0x1b0),'rJZxi':_0x4da99d(0x1b7),'snGen':_0x4da99d(0xcc),'QpqFk':function(_0x56c69c,_0x2415f6){return _0x56c69c(_0x2415f6);},'tuQQQ':function(_0x27f29e,_0x5b581e){return _0x27f29e(_0x5b581e);}};function _0x43f9c3(_0xa0f9de){const _0x10592f=_0x4da99d;if(_0x368058[_0x10592f(0x130)](typeof _0xa0f9de,_0x368058[_0x10592f(0xd8)]))return function(_0x42e028){}[_0x10592f(0xf5)](_0x368058[_0x10592f(0x186)])['apply'](_0x368058[_0x10592f(0x170)]);else _0x368058[_0x10592f(0x1cd)](_0x368058[_0x10592f(0x17b)]('',_0x368058[_0x10592f(0x10c)](_0xa0f9de,_0xa0f9de))[_0x368058['PmJhR']],0x1)||_0x368058[_0x10592f(0x17e)](_0x368058[_0x10592f(0x1af)](_0xa0f9de,0x14),0x0)?function(){return!![];}[_0x10592f(0xf5)](_0x368058[_0x10592f(0x1ce)](_0x368058[_0x10592f(0xdf)],_0x368058[_0x10592f(0x13e)]))[_0x10592f(0x16c)](_0x368058[_0x10592f(0x14a)]):function(){return![];}['constructor'](_0x368058['ZlLoD'](_0x368058['oWapo'],_0x368058[_0x10592f(0x13e)]))[_0x10592f(0xb5)](_0x368058[_0x10592f(0xbf)]);_0x368058['QpqFk'](_0x43f9c3,++_0xa0f9de);}try{if(_0x54b3b2)return _0x43f9c3;else _0x368058[_0x4da99d(0x1c8)](_0x43f9c3,0x0);}catch(_0x2eddaf){}}