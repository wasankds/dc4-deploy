<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quotation</title>

  <!-- Font Awesome -->
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"> -->
  <link rel="stylesheet" href="../../public/cdn/fontawesome/css/all.min.css">
  <!-- SweetAlert2 -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> -->
  <script src="../../public/cdn/sweetalert2.all.min.js"></script>

  <!-- jQuery -->
  <!-- <script src="../../public/cdn/jquery.js"></script> -->
  <!-- Bootstrap -->
  <!-- <link rel="stylesheet" href="../../public/cdn/bootstrap.min.css"> -->
  <!-- <script src="../../public/cdn/bootstrap.bundle.min.js"></script> -->

  <!-- Flatpkr -->
  <link rel="stylesheet" href="../../public/cdn/flatpickr.min.css">
  <script src="../../public/cdn/flatpickr.js"></script>

  <!-- Custom Styles -->
  <link rel="stylesheet" href="../../public/css/utils.css">
  <link rel="stylesheet" href="../../public/css/fontsSarabun.css">
  <link rel="stylesheet" href="../../public/css/toast.css">
  <link rel="stylesheet" href="../../public/css/flex.css">
  <link rel="stylesheet" href="../../public/css/alink.css">
  <link rel="stylesheet" href="../../public/css/nav.css">
  <link rel="stylesheet" href="../../public/css/modal.css">
  <link rel="stylesheet" href="../../public/css/inputQuotation.css">
  <link rel="stylesheet" href="../../public/css/quotation.css">
</head>
<body class="bg-dodgerblue">

  <!-- nav -->
  <!-- <i class="fas fa-file-invoice-dollar"></i> -->
  <div class="nav-ctn">
    <nav> 
      <div class="nav-1">
        <a class="nav-link" href="/"><i class="fas fas fa-house mg-r-m"></i></a>
        <a class="nav-link active" href="/quotation"><i class="fas fa-file-signature mg-r-m"></i></a>
        <a class="nav-link" href="/invoice"><i class="fas fas fa-file-invoice-dollar mg-r-m"></i></a>
        <a class="nav-link" href="/receipt"><i class="fas fa-receipt mg-r-m"></i></a>
        <a class="nav-link" href="/delivery-bills"><i class="fas fa-truck mg-r-m"></i></a>
      </div>  
      <div class="nav-2 al-c" title="ชื่อผู้ใช้ : wasankds รหัสผู้ใช้ : 1000 สิทธิ์การใช้งาน : O">
        <a class="" href="/user"><i class="fas fa-user fc-liblue mg-r-m"></i>wasankds</a>
      </div>
      <div class="nav-3">
        <button class="nav-link nav-dropdown-toggle" id="navDropdownBtn" type="button">
          <i class="fas fa-bars"></i>
        </button>
        <div class="nav-dropdown-menu" id="navDropdownMenu">
          <a href="/manage/settings" class="nav-link " title="ตั้งค่า"><i class="fas fa-sliders-h mg-r-m"></i> ตั้งค่า</a>
          <a href="/manage/users" class="nav-link " title="จัดการผู้ใช้"><i class="fas fa-users-cog mg-r-m"></i> จัดการผู้ใช้งาน</a>
          <a href="/manage/sessions" class="nav-link " title="จัดการเซสชั่น"><i class="fas fa-user-clock mg-r-m"></i> จัดการเซสชั่น</a>
          <a class="nav-link" href="/term-and-conditions" title="Term and Conditions"><i class="fas fa-file-contract mg-r-m"></i> ข้อกำหนดและเงื่อนไข</a>
          <a class="nav-link" href="/logout" title="Logout"><i class="fas fa-sign-out-alt mg-r-m"></i> ออกจากระบบ</a>
        </div>
      </div>
    </nav>
  </div>

  <!-- Toolbar -->
  <header class="header-ctn">
    <section class="header-toolbar">

      <!-- 1 -->
      <form class="header-toolbar-1" action="<%= PATH_MAIN %>" method="get">
        <div class="d-flex align-items-center">
          <input class="al-c bdr3 no-x" type="search" autocomplete="off" 
                 style="max-width:120px;"
                 title="เลขที่/ปี-เดือน-วัน"
                 placeholder="เลขที่/ปี-เดือน-วัน" id="sip" name="sip">
          <button class="btn-xlh btn-sm bg-search" id="btnSearchDocs" title="ค้นหาเอกสาร">
            <i class="fa fa-search"></i>
          </button>

          <button class="btn-xlh btn-sm bg-clear mg-l-m" 
                  title="ล้างผลการค้นหา" 
                  id="btnClearSearch" 
                  onclick="event.preventDefault();clearSearchRes()">
            <i class="fa fa-broom"></i>
          </button>
          <select class="al-l w-100 h-100 bdr3" 
                  style="min-width:245px;"
                  id="selectDocToLoad" name="selectDocToLoad"></select>

          <input class="al-c bdr3" type="text"
                  style="width:40px;"
                  id="searchResNum" readonly>
          <button class="btn-xlh btn-sm bg-load" type="submit" id="btnLoadDoc" title="โหลดเอกสาร">
            <i class="fa fa-download"></i>
          </button>        
        </div>
      </form>

      <!-- 2 -->
      <div class="header-toolbar-2">
        <div class="d-flex align-items-center">
          <button class="btn-xlh btn-sm bg-finish" 
                  id="btnFinishDoc"  title="จบเอกสาร">
            <i class="fa fa-flag-checkered mg-r-s"></i>จบ
          </button>

          <button class="btn-xlh btn-sm bg-cancel" 
                  id="btnCancelDoc"  title="ยกเลิกเอกสาร">
            <i class="fa fa fa-times-circle  mg-r-s"></i>ยกเลิก
          </button>
        </div>
      </div>

      <!-- 3 -->
      <div class="header-toolbar-3" >
        <div class="d-flex align-items-center">
  
          <button class="btn-xlh btn-sm bg-download" id="btnDownloadDocImage" title="ดาวน์โหลดภาพ">
            <i class="fa fa fa-download mg-r-s"></i>ภาพ
          </button>
  
          <button class="btn-xlh btn-sm bg-download" id="btnDownloadDocPDF" title="ดาวน์โหลด PDF">
            <i class="fa fa fa-download mg-r-s"></i>PDF
          </button>
  
          <button class="btn-xlh btn-sm bg-print" type="button" title="พิมพ์" id="btnPrintDoc">
            <i class="fa-solid fa-print"></i>
          </button>
        </div>
      </div>

      <!-- 4 -->
      <div class="header-toolbar-4">
        <div class="d-flex align-items-center">
          <button class="btn-xlh btn-sm bg-new" 
                  id="btnNewDoc" title="สร้างเอกสารใหม่">
            <i class="fa fa-file-circle-plus mg-r-s"></i>ใหม่
          </button>

          <button class="btn-xlh btn-sm bg-save" id="btnSaveDoc" title="บันทึก">
            <i class="fa fa fa-save mg-r-s"></i>บันทึก
          </button>
        </div>
      </div>

      <!-- 5 -->
      <div class="header-toolbar-5">
        <div class="d-flex align-items-center">
          <button class="btn-xlh btn-sm bg-clear mg-l-xl" 
                  id="btnClearDoc" title="ล้างเอกสาร">
            <i class="fa fa-broom mg-r-s"></i>ล้าง
          </button>
        </div>
      </div>

    </section>
  </header>



  <!-- MAIN CONTAINER -->
  <main>

    <!-- PAPER FORM -->
    <form id="paperForm" class="mg-b-xxl" action="<%= PATH_MAIN %>" method="post" autocomplete="off">

      <section class="paper-ctn" id="paperCtn">

        <!-- #1 : Header  -->
        <div class="d-flex justify-content-between pd-t-m pd-b-m bb-thick">

          <!-- Logo -->
          <img src="../../public/images/logo.png" style="width:auto;height:50px;">

          <!-- ที่อยู่ -->
          <div class="al-r d-flex align-items-center">
            <div class="">
              <p class="fs-xm fw-b">บริษัท ทดสอบ จำกัด</p>
              <p class="fs-s fi">
                <span>1234 ซอยทดสอบ ถนนทดสอบ แขวงทดสอบ เขตทดสอบ กรุงเทพฯ 10000</span>
                <span class="fs-s fi">โทร./แฟกซ์ 0-2123-4567 มือถือ 08-1234-5678</span>
              </p>
              <p> 
                <span class="fs-s fi">เว็บ : wasankds.com, email : wasankds@gmail.com</span>
                <span class="fs-s fi">เลขประจำตัวผู้เสียภาษีอากร 0000000000000</span>
              </p>
            </div>
          </div>

        </div>

        <!-- #2 : Title ใบเสนอราคา  -->
        <div class="pd-t-xl pd-b-s" style="position: relative;">
          <!-- เพิ่มไอเท็ม -->
          <button class="ba-d bdr3 btn-sm bg-white mg-t-xl" title="ล้างข้อมูลลูกค้า และพิมพ์รายละเอียดลูกค้าเอง"
                  style="position:absolute;top:0;left:0px;color:orange!important;padding-bottom:4px!important;"
                  id="btnClearCustomer" >
            <i class="fa fa-broom"></i>
          </button>
          <div class="modalCtn ba-d bdr3 mg-t-xl" 
               style="position: absolute;top:0;left: 30px;">
            <input class="al-c pd-l-m w-100" type="text" style="min-width: 200px;"
                   placeholder="เลือกลูกค้า" autocomplete="off"
                   onfocus="popModalCustomers(event)" 
                   oninput="popModalCustomers(event)" >
            <div class="modal">
              <div class="modal-list"></div>
            </div>
          </div>

          <!-- Title -->
          <p class="al-c fw-b fs-xl">
            <span>ใบเสนอราคา</span> (<span>Quotation</span>)
          </p>

          <!--  -->
          <input class="ba-d al-c mg-t-xl no-arrow" type="number" 
                 readonly
                 name="docStatusNumber" id="docStatusNumber" 
                 style="position:absolute;top:0;right:0px;max-width:100px;border-radius:3px!important; "
                 title="สถานะเอกสาร"
                 placeholder="สถานะเอกสาร">
        </div> 
          
        <!-- #3 : ข้อมูลลูกค้า -->
        <div class="rowg pd-t-m pd-b-l">

          <!--  -->
          <input type="hidden" id="customerId" name="customerId">

          <!-- #3.1 : ข้อมูลลูกค้า - ซ้าย -->
          <div class="colg-1">     

            <!-- ชื่อลูกค้า -->
            <div class="row">
              <p class="col-18 al-l pd-l-s lh-4xs pd-t-l">
                <span class="fs-n">ชื่อลูกค้า :</span>
                <!-- <br><span class="fs-s fc-gray">Customer Name</span> -->
              </p>
              <input class="col-82 pd-l-s bb-d" type="text" 
                     required
                     id="customerName" name="customerName">
            </div>

            <!-- ที่อยู่1 -->
            <div class="row">
              <p class="col-10 al-l pd-l-s lh-4xs pd-t-l">
                <span class="fs-n">ที่อยู่  :</span>
                <!-- <br><span class="fs-s fc-gray">Address</span> -->
              </p>
              <input class="col-90 al-l pd-l-s pd-t-l bb-d" type="text" 
                     id="customerAddress1" name="customerAddress1">
            </div>

            <!-- ที่อยู่2 -->
            <div class="row">
              <p class="col-08 lh-4xs"></p>
              <input class="col-92 al-l pd-l-s bb-d" type="text" 
                     id="customerAddress2" name="customerAddress2">
            </div>
            
            <!-- ติดต่อ -->
            <div class="row">
              <p class="col-08 lh-4xs"></p>
              <input class="col-92 al-l pd-l-s bb-d" type="text" 
                     id="customerContact" name="customerContact">
            </div>

            <!-- เลขประจำตัวผู้เสียภาษีอากร -->
            <div class="row">
              <div class="col-08"></div>
              <div class="col-92 bb-d">
                <span class="lh-4xs al-l fs-ns fc-blue">เลขประจำตัวผู้เสียภาษีอากร :</span>
                <input class="lh-4xs" type="text" 
                       id="customerTaxId" name="customerTaxId" autocomplete="off">
              </div>
            </div>
            
          </div>

          <!-- #3.2 : ข้อมูลลูกค้า - ขวา -->
          <div class="colg-2">

            <!-- วันที่ -->
            <div class="row">
              <p class="col-20 lh-4xs pd-t-l">
                <span class="fs-n">วันที่ : </span>
                <!-- <br><span class="fs-s fc-gray">Date</span> -->
              </p>
              <input class="col-80 al-c bb-d bg-white" type="date" 
                     required
                     id="quotationDateTh" name="quotationDateTh">
            </div>

            <!-- เลขที่ -->
            <div class="row">
              <p class="col-20 lh-4xs pd-t-l">
                <span class="fs-n">เลขที่ : </span>
                <!-- <br><span class="fs-s fc-gray">ID</span> -->
              </p>
              <input class="col-80 bb-d pd-l-s" type="text"
                     readonly
                     id="quotationId" name="quotationId" >
            </div>

            <!-- อ้างอิง -->
            <div class="row">
              <p class="col-20 lh-4xs pd-t-l">
                <span class="fs-n" >อ้างอิง : </span>
                <!-- <br><span class="fs-s fc-gray">Ref</span></p> -->
              <input class="col-80 bb-d pd-l-s" type="text" 
                     id="refNo" name="refNo">
            </div>

            <!-- เพิ่มไอเท็ม -->
            <div class="modalCtn ba-d bdr3 pd-l-s mg-t-xl">
              <input class="al-c pd-l-m w-100" type="text" 
                     id="searchItems"
                     placeholder="เพิ่มรายการจากข้อมูลไอเท็ม"
                     onfocus="popModalItems(event)" 
                     oninput="popModalItems(event)" >
              <div class="modal">
                <div class="modal-list"></div>
              </div>
            </div>

          </div>

        </div>

        <!-- #4 --><!-- รายการ - Container -->
        <div id="tableListCtn">

          <!-- 1 - หัวตาราง -->
          <div class="row" style="position: relative;">
            <button class="undo-delete-row-btn" id="btnUndoDeleteRow" title="ยกเลิกลบแถว">
              <i class="fa fa-undo"></i>
            </button>

            <label class="col-07 lh-4xs al-c bt bb bl pd-t-s pd-b-s">
              <span class="fs-m">ลำดับ</span>
              <!-- <br><span class="fs-s fc-gray">No.</span> -->
            </label>
            <label class="col-50 lh-4xs al-c bt bb bl pd-t-s pd-b-s">
              <span class="fc-liblue clickable" onclick="sortItemsTableJs(2,'asc')">▲</span>
              <span class="fs-m">รายการ</span>
              <span class="fc-liblue clickable" onclick="sortItemsTableJs(2,'dsc')">▼</span>
              <!-- <br><span class="fs-s fc-gray">Description</span> -->
            </label>
            <label class="col-13 lh-4xs al-c bt bb bl pd-t-s pd-b-s">
              <span class="fs-m">ราคา/หน่วย</span>
              <!-- <br><span class="fs-s fc-gray">Price/Unit</span> -->
            </label>
            <label class="col-15 lh-4xs al-c bt bb bl pd-t-s pd-b-s">
              <span class="fs-m">จำนวน</span>
              <!-- <br><span class="fs-s fc-gray">Quantity</span> -->
            </label>
            <label class="col-15 lh-4xs al-c bt bb bl br pd-t-s pd-b-s">
              <span class="fs-m">จำนวนเงิน</span>
              <!-- <br><span class="fs-s fc-gray">Amount</span> -->
            </label>

            <!-- ปุ่ม + ลอยออกนอกตาราง -->
            <button class="add-row-btn" id="btnAddRow" title="เพิ่มแถว">
              <i class="fa fa-plus"></i>
            </button>
          </div>

          <!-- 2 - สำหรับสร้างรายการ -->
          <div id="listCtn"></div>

          <!-- โซนผลผรวม -->
          <div class="row " id="mainTotalCtn">
            <div class="col-70" id="paymentMethodCtn">
              <textarea name="quotationRemark" id="quotationRemark" 
                      class="w-100 h-100 al-l bd-n pd-m lh-3xs bg-white" 
                      placeholder="หมายเหตุ/เงื่อนไขการชำระเงิน"
                      style="resize: none;overflow: hidden;"
                      rows="7">วิธีชำระเงิน
1. เงินสด
2. โอนเงิน (บัญชี , บัญชีออมทรัพย์ ธนาคาร)
3. เช็ค (สั่งจ่ายเช็คในนาม)
ข้อเสนอนี้ มีอายุ 30 วันนับจากวันที่เสนอราคา</textarea>
            </div>

            <!-- total co#l2 -->
            <div class="col-30" id="columnTotalCtn">

              <!-- แถวรวม : Total Amount -->
              <div class="row" id="totalCtn">
                <p class="col-50 lh-4xs al-c bl-k bb-k pd-t-s pd-b-s">
                  <span class="fs-m">รวม</span>
                </p>
                <input class="col-50 al-r bl-k bb-k  br-k  pd-r-s" type="text" 
                       id="totalAmount" name="totalAmount" readonly>
              </div>

              <!-- แถว VAT -->
              <div class="row" id="totalVatCtn">
                <p class="col-50 lh-4xs al-c bl-k bb-k pd-t-s pd-b-s">
                  <span class="fs-m">ภาษีมูลค่าเพิ่ม 7%</span>
                </p>
                <input class="col-50 al-r bl-k bb-k br-k pd-r-s" type="text" 
                       id="vatAmount" name="vatAmount" readonly>

                <!-- ปุ่ม + ลอยออกนอกตาราง -->                
                <select class="select-vat-calculating" 
                        id="selectVatCalculating" name="selectVatCalculating"
                        title="เลือกวิธีคำนวณ Vat">
                  <option value="noVat" selected>ไม่มี Vat</option>
                  <option value="vatIn">คำนวณ Vat ใน</option>
                  <option value="vatOut">คำนวณ Vat นอก</option>
                </select> 
               
              </div>

              <!-- แถว Net Amount -->
              <div class="row" id="netCtn">
                <p class="col-50 al-c lh-4xs bl-k bb-k pd-t-s pd-b-s">
                  <span class="fs-m">รวมทั้งสิ้น</span>
                </p>
                <input class="col-50 al-r pd-r-s bl-k bb-k  br-k " type="text" id="netAmount" name="netAmount" min="0" readonly>
              </div>

            </div> <!-- total co#l2 -->
          </div>



        <!-- วิธีชำระเงิน -->
        <div class="row">

          <!--  -->
          <div class="col-50 bl ba-k pd-l fs-xm">
            <p class="underline">สำหรับลูกค้า :</p>
            <p>ยืนยันการว่างจ้างตามเงื่อนไขและราคาข้างต้น</p>
            <div style="min-height: 100px;"></div>
            <p class="al-c">ลายเซ็นผู้มีอำนาจ (ลงชื่อและประทับตรา)</p>
          </div>

          <!--  -->
          <div class="col-20 pd-m"></div>

          <!--  -->
          <div class="col-30 pd-m">
            <p class="fs-m lh-m al-c">ผู้เสนอราคา</p>
            <div class="al-c" style="min-height: 60px;">
              <img id="proposerImageSignature" src="../../public/images/signature.png" 
                   style="width:auto;height:60px;" alt="proposerSignature">
            </div>
            <div class="d-flex justify-content-between al-c">
              <input class="col-100 al-c bb-d" type="text" 
                     id="proposerId" name="proposerId" 
                     readonly
                     value="ชื่อคนล็อกอิน">
            </div>
            <div class="d-flex justify-content-between pd-t-s al-c lh-m">
              <span class="fs-s mg-r-s">วันที่</span>
              (<input class="col-100 al-c bg-white" type="date" 
                      required
                      id="proposerDateTh" name="proposerDateTh">)
            </div>
          </div>
          
        </div>   <!-- 5 -->  
        
        
      </section><!-- paper ctn -->
    </form>

    <!-- <div></div> -->
  </main>

  <script src="./docs_data.js"></script>
  
  <script>
    IS_PRODUCTION = false
    PATH_MAIN = `<%= PATH_MAIN %>`
    PATH_FETCH = `<%= PATH_FETCH %>`
    PATH_SAVE = `<%= PATH_SAVE %>`
    PATH_LOAD = `<%= PATH_LOAD %>`
    PATH_PRINT = `<%= PATH_PRINT %>`
    PATH_CANCEL = `<%= PATH_CANCEL %>`
    const MONTH_NAMES = ['มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน','กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'];
  </script>
  <script src="../../public/js/script_all.js"></script>
  <script src="./docs_crud.js"></script>
  <script src="./docs_paper.js"></script>

</body>
</html>


