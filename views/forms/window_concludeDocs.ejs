<!--  -->
<!-- <section class="window-ctn pd-xs col-100" > -->

  <!-- 
  <div class="window-title bg-window-2" name="windowTitle">
    <p class="bg-cornblue">
      <span class="titleText1 fc-white pd-l-m">สรุปเอกสารเดือน : </span>
      <span class="titleText2 fc-yellow fw-b"><= title ></span>
      <span class="titleText2 fc-lime fw-b">( จำนวนเอกสาร = <= data.length >)</span>
      <span class="close-window" onclick="closeWindow(this)">✖</span>
      <span class="expand-window" onclick="copyTable(this)">copy</span>
      <span class="clickable expand-window" 
            data-direction="up"
            onclick="moveWindow(this)">&#8679;</span>
      <span class="clickable expand-window" 
            data-direction="down"
            onclick="moveWindow(this)">&#8681;</span>
    </p>
  </div> 
  -->

  <div class="table-ctn" name="tableCtn">
    <table>

      <thead>
        <tr class="<%= bgClassColor %> al-l">
          <th class="<%= bgClassColor %>">
            <p>
              <span class="clickable close-window" onclick="closeWindow(this)">✖</span>
              <span class="expand-window" onclick="copyTable(this)">copy</span>
              <span class="clickable expand-window" 
                    data-direction="up"
                    onclick="moveWindow(this)">&#8679;</span>
              <span class="clickable expand-window" 
                    data-direction="down"
                    onclick="moveWindow(this)">&#8681;</span>              
            </p>
          </th>
          <th class="ov-hide" colspan="10">
            <p>
              <span class="fc-white pd-l-m">สรุปเอกสารเดือน : </span>
              <span class="fc-yellow"><%= title %></span>
              <span class="fc-lime">[<%= data.length %>]</span>
            </p>
          </th>
        </tr>

        <!--  -->
        <tr class="lh-xxl">
          <th class="bg-eee">เลขที่เอกสาร</th>
          <th class="bg-eee">สถานะ</th>
          <th class="bg-eee">วันที่</th>
          <th class="bg-eee">รวม</th>
          <% if(['quotation','invoice', 'receipt'].includes(docType)) { %>
          <th class="bg-eee">VAT</th>
          <th class="bg-eee">รวมทั้งสิ้น</th>
          <% }  %>
          <th class="bg-eee">ลูกค้า</th>
          <th class="bg-eee">ผู้เสนอ</th>
        </tr>
      </thead>

      <!--  -->
      <% 
        let sum_1_totalAmount = 0 
        let sum_1_totalVat = 0
        let sum_1_netAmount = 0

        let sum_2_totalAmount = 0 
        let sum_2_totalVat = 0
        let sum_2_netAmount = 0

        let sum_10_totalAmount = 0 
        let sum_10_totalVat = 0
        let sum_10_netAmount = 0
      %>
      <tbody>
        <% data.forEach( (doc,index) => { %>
        <% 
          if(doc.docStatusNumber == 1) {
            sum_1_totalAmount += (doc.totalAmount ?? 0)
            sum_1_totalVat += (doc.totalVat ?? 0)
            sum_1_netAmount += (doc.netAmount ?? 0)
          }else if(doc.docStatusNumber == 2) {
            sum_2_totalAmount += (doc.totalAmount ?? 0)
            sum_2_totalVat += (doc.totalVat ?? 0)
            sum_2_netAmount += (doc.netAmount ?? 0)
          }else if(doc.docStatusNumber == 10) {
            sum_10_totalAmount += (doc.totalAmount ?? 0)
            sum_10_totalVat += (doc.totalVat ?? 0)
            sum_10_netAmount += (doc.netAmount ?? 0)
          }
        %>
        <tr class="al-r" >
          <!-- ต้อง bg คอลัมน์แรกด้วยเพราะ lock คอลัมน์ -->
          <!-- <td class="al-c" style="background-color: white">
            <a href="<= global.DOMAIN_ALLOW >/quotation?docId=<= doc.docId >" target="_blank">
              <span class="<= doc.docStatusColor >"><= doc.docId ></span>
            </a>
          </td> -->

          <!-- 1 -->
          <td class="al-c <%= doc.docStatusColor %>" style="background-color: white">
            <span class="clickable" onclick="printDocById('<%= doc.docId %>')"><%= doc.docId %></span>
          </td>
          <!-- 2 -->
          <td class="al-l <%= doc.docStatusColor %>">[<%= doc.docStatusNumber %>] <%= doc.docStatus %></td>
          <!-- 3 -->
          <td class="al-l fc-dkcyan" title="<%= doc.docDate %>"><%= doc.docDate %></td>
          <!-- 4 -->
          <td class="al-r fc-blue pd-r-s"><%= doc.totalAmount ?? '-' %></td>
          <!-- 5,6 -->
          <% if(['quotation','invoice', 'receipt'].includes(docType)) { %>
          <td class="al-r fc-blue pd-r-s"><%= doc.totalVat ?? '-' %></td>
          <td class="al-r fc-blue pd-r-s"><%= doc.netAmount ?? '-' %></td>
          <% }  %>

          <% 
            let customerShow = ''
            if(doc.customerId) {
              customerShow = `<span class="fc-steelblue">[${doc.customerId}]</span>
                              <span class="fc-slateblue">${doc.customerName}</span>`
            }else{
              customerShow = `<span class="fc-slateblue">${doc.customerName}</span>`
            }
          %>

          <!-- 7 -->
          <td class="al-l"><%- customerShow %></td>
          <% 
            let proposerShow = ''
            const proposerSlice = doc.proposerFullname.length > 27 ? doc.proposerFullname.slice(0, 27) + '...' : doc.proposerFullname;
            if(doc.proposerId) {
              proposerShow = `<span class="fc-plum">[${doc.proposerId}]</span>
                              <span class="fc-mgt">${proposerSlice}</span>`
            }else{
              proposerShow = `<span class="fc-mgt">${proposerSlice}</span>`
            }
          %>
          
          <!-- 8 -->
          <td class="al-l" title="[<%= doc.proposerId %>] <%= doc.proposerFullname %>"><%- proposerShow %></td>
        </tr>
        <% }) %>

        <% 
          if(['quotation','invoice', 'receipt'].includes(docType)) {
            var lastColumn = `<th class="bg-eee al-l" colspan="2"></th>`
          }else{
            var lastColumn = ''
          } 
        %>

        <!-- 1 -->
        <tr>
          <th class="bg-eee"></th>
          <th class="bg-eee al-r mg-r-m">รวม [1]</th>
          <th class="bg-eee"></th>
          <th class="bg-eee al-r fc-blue"><%= sum_1_totalAmount > 0 ? sum_1_totalAmount : '-' %></th>
          <th class="bg-eee al-r fc-blue"><%= sum_1_totalVat > 0 ? sum_1_totalVat : '-' %></th>
          <th class="bg-eee al-r fc-blue"><%= sum_1_netAmount > 0 ? sum_1_netAmount : '-' %></th>
          <%- lastColumn %>
        </tr>
        <!-- 2 -->
        <tr>
          <th class="bg-eee"></th>
          <th class="bg-eee al-r mg-r-m">รวม [2]</th>
          <th class="bg-eee"></th>
          <th class="bg-eee al-r fc-blue"><%= sum_2_totalAmount > 0 ? sum_2_totalAmount : '-' %></th>
          <th class="bg-eee al-r fc-blue"><%= sum_2_totalVat > 0 ? sum_2_totalVat : '-' %></th>
          <th class="bg-eee al-r fc-blue"><%= sum_2_netAmount > 0 ? sum_2_netAmount : '-' %></th>
          <%- lastColumn %>
        </tr>
        <!-- 10 -->
        <tr>
          <th class="bg-eee"></th>
          <th class="bg-eee al-r mg-r-m">รวม [10]</th>
          <th class="bg-eee"></th>
          <th class="bg-eee al-r fc-blue"><%= sum_10_totalAmount > 0 ? sum_10_totalAmount : '-' %></th>
          <th class="bg-eee al-r fc-blue"><%= sum_10_totalVat > 0 ? sum_10_totalVat : '-' %></th>
          <th class="bg-eee al-r fc-blue"><%= sum_10_netAmount > 0 ? sum_10_netAmount : '-' %></th>
          <%- lastColumn %>
        </tr>

      </tbody>
    </table>
  </div>

<!-- </section> -->